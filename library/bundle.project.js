require=(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({"biz-socket":[function(require,module,exports){
cc._RFpush(module, '462a1boOOpB3pCoZ/FvwZch', 'biz-socket');
// biz/socket/biz-socket.js

'use strict';

var socketIO = require('../../lib/socket.io');
var utils = require('../../utils/index');

var BizSocket = (function () {
    var URI = '10.10.1.38:3000/tankControllers';
    var UID = utils.getUid();

    var ws = socketIO(URI + '?uid=' + UID);

    var connect = function connect() {
        ws.emit('c-enter');
    };

    var disconnect = function disconnect() {
        ws.emit('c-leave');
    };

    var on = function on(eventName, callback) {
        ws.on(eventName, callback);
    };

    var emit = function emit(eventName, eventObj) {
        ws.emit(eventName, {
            uid: UID,
            data: eventObj
        });
    };

    return {
        connect: connect,
        disconnect: disconnect,
        on: on,
        emit: emit
    };
})();

module.exports = BizSocket;

cc._RFpop();
},{"../../lib/socket.io":"socket.io","../../utils/index":"index"}],"controller":[function(require,module,exports){
cc._RFpush(module, 'f2d90q40wZO0r33JeQe1sFf', 'controller');
// biz/controller/script/controller.js

'use strict';

var bizSocket = require('../../socket/biz-socket');

cc.Class({
    'extends': cc.Component,

    properties: {},

    backToMain: function backToMain() {
        bizSocket.disconnect();
        cc.director.loadScene('main');
    },

    onLoad: function onLoad() {},

    update: function update(dt) {}
});

cc._RFpop();
},{"../../socket/biz-socket":"biz-socket"}],"data":[function(require,module,exports){
cc._RFpush(module, '19a03pBgr9P6KEGg7IRtEDG', 'data');
// biz/main/script/data.js

'use strict';

var updateData = function updateData(object) {};

var initArchives = function initArchives() {};

var updateArchives = function updateArchives() {};

var getArchives = function getArchives() {};

var data = {
    username: '',

    tankHead: 0,
    tankBody: 0,
    tankWheel: 0,

    money: 0,
    scoreKill: 0,
    scoreDeal: 0

};

module.exports = data;

cc._RFpop();
},{}],"directionCtrl":[function(require,module,exports){
cc._RFpush(module, '8dfd11I/pBAD7XnN4iH9tiV', 'directionCtrl');
// biz/controller/script/directionCtrl.js

'use strict';

var bizSocket = require('../../socket/biz-socket');

cc.Class({
    'extends': cc.Component,

    properties: {
        follower: {
            'default': null,
            type: cc.Node
        },
        followSpeed: 0,
        direction: 4
    },

    onLoad: function onLoad() {
        var self = this;
        this.setTouchControl();
        this.node.on('direction', function (event) {
            if (self.direction !== event.detail.direction) {
                self.direction = event.detail.direction;
                bizSocket.emit('c-direction', {
                    direction: self.direction
                });
            }
        });
    },

    setTouchControl: function setTouchControl() {
        var self = this;
        cc.eventManager.addListener({
            event: cc.EventListener.TOUCH_ONE_BY_ONE,
            onTouchBegan: self.onTouchBegan.bind(self),
            onTouchMoved: self.onTouchMoved.bind(self),
            onTouchEnded: self.onTouchEnded.bind(self)
        }, self.node);
    },

    __getAngle: function __getAngle(pos) {
        this.angle = Math.atan2(pos.y, pos.x) / cc.PI * 180;
        return this.angle;
    },

    __getRadians: function __getRadians(pos) {
        this.radians = Math.atan2(pos.y, pos.x);
        return this.radians;
    },

    __getLength: function __getLength(pos) {
        return Math.sqrt(pos.x * pos.x + pos.y * pos.y);
    },

    onUpdateDirection: function onUpdateDirection(length) {
        var direction;

        if (length <= 10) {
            return this.node.emit('direction', {
                direction: 4
            });
        }

        if (this.angle < 0) this.angle = this.angle + 360;

        if (this.angle >= 0 && this.angle <= 45 || this.angle > 315 && this.angle <= 360) {
            direction = 1;
        } else if (this.angle > 45 && this.angle <= 135) {
            direction = 0;
        } else if (this.angle > 135 && this.angle <= 225) {
            direction = 3;
        } else if (this.angle > 225 && this.angle <= 315) {
            direction = 2;
        }

        return this.node.emit('direction', {
            direction: direction
        });
    },

    onStop: function onStop() {
        this.node.emit('direction', {
            direction: 4
        });
    },

    onTouchBegan: function onTouchBegan(touch, event) {
        var target = this.follower;
        var touchLoc = touch.getLocation();

        var locInNode = this.node.convertToNodeSpaceAR(touchLoc);
        var tmpLength = this.__getLength(locInNode);

        return tmpLength < 103;
    },

    onTouchMoved: function onTouchMoved(touch, event) {
        var target = this.follower;
        var touchLoc = touch.getLocation();
        var locInNode = this.node.convertToNodeSpaceAR(touchLoc);
        this.__getAngle(locInNode);
        this.__getRadians(locInNode);
        var tmpLength = this.__getLength(locInNode);

        if (tmpLength < 103) {
            target.setPosition(locInNode);
        } else {
            var x = Math.cos(this.radians) * 103;
            var y = Math.sin(this.radians) * 103;
            target.setPosition(cc.p(x, y));
        }

        this.onUpdateDirection(tmpLength);
    },

    onTouchEnded: function onTouchEnded(touch, event) {
        var target = this.follower;
        target.setPosition({ x: 0, y: 0 });
        this.onStop();
    },

    update: function update(dt) {}
});

cc._RFpop();
},{"../../socket/biz-socket":"biz-socket"}],"fireCtrl":[function(require,module,exports){
cc._RFpush(module, 'a4023/XIFtI1Z1hB/fMjLNJ', 'fireCtrl');
// biz/controller/script/fireCtrl.js

'use strict';

var bizSocket = require('../../socket/biz-socket');

cc.Class({
    'extends': cc.Component,

    properties: {},

    onLoad: function onLoad() {},

    fire: function fire() {
        bizSocket.emit('c-fire', {
            fire: 'fire'
        });
    }
});

cc._RFpop();
},{"../../socket/biz-socket":"biz-socket"}],"index":[function(require,module,exports){
cc._RFpush(module, '626b7lEiD1Im5v5puIImRDy', 'index');
// utils/index.js

"use strict";

var uid = new Date().getTime().toString();

exports.getUid = function () {
    return uid;
    // return 'lisheng';
};

cc._RFpop();
},{}],"lodash":[function(require,module,exports){
(function (global){
cc._RFpush(module, '9f2f1hkSF9Nk6WvHxAs9uqP', 'lodash');
// lib/lodash.js

"use strict";(function(){var undefined;var VERSION="4.2.0";var BIND_FLAG=1,BIND_KEY_FLAG=2,CURRY_BOUND_FLAG=4,CURRY_FLAG=8,CURRY_RIGHT_FLAG=16,PARTIAL_FLAG=32,PARTIAL_RIGHT_FLAG=64,ARY_FLAG=128,REARG_FLAG=256,FLIP_FLAG=512;var UNORDERED_COMPARE_FLAG=1,PARTIAL_COMPARE_FLAG=2;var DEFAULT_TRUNC_LENGTH=30,DEFAULT_TRUNC_OMISSION="...";var HOT_COUNT=150,HOT_SPAN=16;var LARGE_ARRAY_SIZE=200;var LAZY_FILTER_FLAG=1,LAZY_MAP_FLAG=2,LAZY_WHILE_FLAG=3;var FUNC_ERROR_TEXT="Expected a function";var HASH_UNDEFINED="__lodash_hash_undefined__";var INFINITY=1 / 0,MAX_SAFE_INTEGER=9007199254740991,MAX_INTEGER=1.7976931348623157e308,NAN=0 / 0;var MAX_ARRAY_LENGTH=4294967295,MAX_ARRAY_INDEX=MAX_ARRAY_LENGTH - 1,HALF_MAX_ARRAY_LENGTH=MAX_ARRAY_LENGTH >>> 1;var PLACEHOLDER="__lodash_placeholder__";var argsTag="[object Arguments]",arrayTag="[object Array]",boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",funcTag="[object Function]",genTag="[object GeneratorFunction]",mapTag="[object Map]",numberTag="[object Number]",objectTag="[object Object]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",symbolTag="[object Symbol]",weakMapTag="[object WeakMap]";var arrayBufferTag="[object ArrayBuffer]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]";var reEmptyStringLeading=/\b__p \+= '';/g,reEmptyStringMiddle=/\b(__p \+=) '' \+/g,reEmptyStringTrailing=/(__e\(.*?\)|\b__t\)) \+\n'';/g;var reEscapedHtml=/&(?:amp|lt|gt|quot|#39|#96);/g,reUnescapedHtml=/[&<>"'`]/g,reHasEscapedHtml=RegExp(reEscapedHtml.source),reHasUnescapedHtml=RegExp(reUnescapedHtml.source);var reEscape=/<%-([\s\S]+?)%>/g,reEvaluate=/<%([\s\S]+?)%>/g,reInterpolate=/<%=([\s\S]+?)%>/g;var reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/,rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]/g;var reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reHasRegExpChar=RegExp(reRegExpChar.source);var reTrim=/^\s+|\s+$/g,reTrimStart=/^\s+/,reTrimEnd=/\s+$/;var reEscapeChar=/\\(\\)?/g;var reEsTemplate=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g;var reFlags=/\w*$/;var reHasHexPrefix=/^0x/i;var reIsBadHex=/^[-+]0x[0-9a-f]+$/i;var reIsBinary=/^0b[01]+$/i;var reIsHostCtor=/^\[object .+?Constructor\]$/;var reIsOctal=/^0o[0-7]+$/i;var reIsUint=/^(?:0|[1-9]\d*)$/;var reLatin1=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g;var reNoMatch=/($^)/;var reUnescapedString=/['\n\r\u2028\u2029\\]/g;var rsAstralRange="\\ud800-\\udfff",rsComboMarksRange="\\u0300-\\u036f\\ufe20-\\ufe23",rsComboSymbolsRange="\\u20d0-\\u20f0",rsDingbatRange="\\u2700-\\u27bf",rsLowerRange="a-z\\xdf-\\xf6\\xf8-\\xff",rsMathOpRange="\\xac\\xb1\\xd7\\xf7",rsNonCharRange="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",rsQuoteRange="\\u2018\\u2019\\u201c\\u201d",rsSpaceRange=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",rsUpperRange="A-Z\\xc0-\\xd6\\xd8-\\xde",rsVarRange="\\ufe0e\\ufe0f",rsBreakRange=rsMathOpRange + rsNonCharRange + rsQuoteRange + rsSpaceRange;var rsAstral="[" + rsAstralRange + "]",rsBreak="[" + rsBreakRange + "]",rsCombo="[" + rsComboMarksRange + rsComboSymbolsRange + "]",rsDigits="\\d+",rsDingbat="[" + rsDingbatRange + "]",rsLower="[" + rsLowerRange + "]",rsMisc="[^" + rsAstralRange + rsBreakRange + rsDigits + rsDingbatRange + rsLowerRange + rsUpperRange + "]",rsFitz="\\ud83c[\\udffb-\\udfff]",rsModifier="(?:" + rsCombo + "|" + rsFitz + ")",rsNonAstral="[^" + rsAstralRange + "]",rsRegional="(?:\\ud83c[\\udde6-\\uddff]){2}",rsSurrPair="[\\ud800-\\udbff][\\udc00-\\udfff]",rsUpper="[" + rsUpperRange + "]",rsZWJ="\\u200d";var rsLowerMisc="(?:" + rsLower + "|" + rsMisc + ")",rsUpperMisc="(?:" + rsUpper + "|" + rsMisc + ")",reOptMod=rsModifier + "?",rsOptVar="[" + rsVarRange + "]?",rsOptJoin="(?:" + rsZWJ + "(?:" + [rsNonAstral,rsRegional,rsSurrPair].join("|") + ")" + rsOptVar + reOptMod + ")*",rsSeq=rsOptVar + reOptMod + rsOptJoin,rsEmoji="(?:" + [rsDingbat,rsRegional,rsSurrPair].join("|") + ")" + rsSeq,rsSymbol="(?:" + [rsNonAstral + rsCombo + "?",rsCombo,rsRegional,rsSurrPair,rsAstral].join("|") + ")";var reComboMark=RegExp(rsCombo,"g");var reComplexSymbol=RegExp(rsFitz + "(?=" + rsFitz + ")|" + rsSymbol + rsSeq,"g");var reHasComplexSymbol=RegExp("[" + rsZWJ + rsAstralRange + rsComboMarksRange + rsComboSymbolsRange + rsVarRange + "]");var reBasicWord=/[a-zA-Z0-9]+/g;var reComplexWord=RegExp([rsUpper + "?" + rsLower + "+(?=" + [rsBreak,rsUpper,"$"].join("|") + ")",rsUpperMisc + "+(?=" + [rsBreak,rsUpper + rsLowerMisc,"$"].join("|") + ")",rsUpper + "?" + rsLowerMisc + "+",rsUpper + "+",rsDigits,rsEmoji].join("|"),"g");var reHasComplexWord=/[a-z][A-Z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;var contextProps=["Array","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Reflect","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"];var templateCounter=-1;var typedArrayTags={};typedArrayTags[float32Tag] = typedArrayTags[float64Tag] = typedArrayTags[int8Tag] = typedArrayTags[int16Tag] = typedArrayTags[int32Tag] = typedArrayTags[uint8Tag] = typedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] = typedArrayTags[uint32Tag] = true;typedArrayTags[argsTag] = typedArrayTags[arrayTag] = typedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] = typedArrayTags[dateTag] = typedArrayTags[errorTag] = typedArrayTags[funcTag] = typedArrayTags[mapTag] = typedArrayTags[numberTag] = typedArrayTags[objectTag] = typedArrayTags[regexpTag] = typedArrayTags[setTag] = typedArrayTags[stringTag] = typedArrayTags[weakMapTag] = false;var cloneableTags={};cloneableTags[argsTag] = cloneableTags[arrayTag] = cloneableTags[arrayBufferTag] = cloneableTags[boolTag] = cloneableTags[dateTag] = cloneableTags[float32Tag] = cloneableTags[float64Tag] = cloneableTags[int8Tag] = cloneableTags[int16Tag] = cloneableTags[int32Tag] = cloneableTags[mapTag] = cloneableTags[numberTag] = cloneableTags[objectTag] = cloneableTags[regexpTag] = cloneableTags[setTag] = cloneableTags[stringTag] = cloneableTags[symbolTag] = cloneableTags[uint8Tag] = cloneableTags[uint8ClampedTag] = cloneableTags[uint16Tag] = cloneableTags[uint32Tag] = true;cloneableTags[errorTag] = cloneableTags[funcTag] = cloneableTags[weakMapTag] = false;var deburredLetters={"脌":"A","脕":"A","脗":"A","脙":"A","脛":"A","脜":"A","脿":"a","谩":"a","芒":"a","茫":"a","盲":"a","氓":"a","脟":"C","莽":"c","脨":"D","冒":"d","脠":"E","脡":"E","脢":"E","脣":"E","猫":"e","茅":"e","锚":"e","毛":"e","脤":"I","脥":"I","脦":"I","脧":"I","矛":"i","铆":"i","卯":"i","茂":"i","脩":"N","帽":"n","脪":"O","脫":"O","脭":"O","脮":"O","脰":"O","脴":"O","貌":"o","贸":"o","么":"o","玫":"o","枚":"o","酶":"o","脵":"U","脷":"U","脹":"U","脺":"U","霉":"u","煤":"u","没":"u","眉":"u","脻":"Y","媒":"y","每":"y","脝":"Ae","忙":"ae","脼":"Th","镁":"th","脽":"ss"};var htmlEscapes={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"};var htmlUnescapes={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"};var objectTypes={"function":true,object:true};var stringEscapes={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"};var freeParseFloat=parseFloat,freeParseInt=parseInt;var freeExports=objectTypes[typeof exports] && exports && !exports.nodeType?exports:null;var freeModule=objectTypes[typeof module] && module && !module.nodeType?module:null;var freeGlobal=checkGlobal(freeExports && freeModule && typeof global == "object" && global);var freeSelf=checkGlobal(objectTypes[typeof self] && self);var freeWindow=checkGlobal(objectTypes[typeof window] && window);var moduleExports=freeModule && freeModule.exports === freeExports?freeExports:null;var thisGlobal=checkGlobal(objectTypes[typeof this] && this);var root=freeGlobal || freeWindow !== (thisGlobal && thisGlobal.window) && freeWindow || freeSelf || thisGlobal || Function("return this")();function addMapEntry(map,pair){map.set(pair[0],pair[1]);return map;}function addSetEntry(set,value){set.add(value);return set;}function apply(func,thisArg,args){var length=args.length;switch(length){case 0:return func.call(thisArg);case 1:return func.call(thisArg,args[0]);case 2:return func.call(thisArg,args[0],args[1]);case 3:return func.call(thisArg,args[0],args[1],args[2]);}return func.apply(thisArg,args);}function arrayAggregator(array,setter,iteratee,accumulator){var index=-1,length=array.length;while(++index < length) {var value=array[index];setter(accumulator,value,iteratee(value),array);}return accumulator;}function arrayConcat(array,other){var index=-1,length=array.length,othIndex=-1,othLength=other.length,result=Array(length + othLength);while(++index < length) {result[index] = array[index];}while(++othIndex < othLength) {result[index++] = other[othIndex];}return result;}function arrayEach(array,iteratee){var index=-1,length=array.length;while(++index < length) {if(iteratee(array[index],index,array) === false){break;}}return array;}function arrayEachRight(array,iteratee){var length=array.length;while(length--) {if(iteratee(array[length],length,array) === false){break;}}return array;}function arrayEvery(array,predicate){var index=-1,length=array.length;while(++index < length) {if(!predicate(array[index],index,array)){return false;}}return true;}function arrayFilter(array,predicate){var index=-1,length=array.length,resIndex=-1,result=[];while(++index < length) {var value=array[index];if(predicate(value,index,array)){result[++resIndex] = value;}}return result;}function arrayIncludes(array,value){return !!array.length && baseIndexOf(array,value,0) > -1;}function arrayIncludesWith(array,value,comparator){var index=-1,length=array.length;while(++index < length) {if(comparator(value,array[index])){return true;}}return false;}function arrayMap(array,iteratee){var index=-1,length=array.length,result=Array(length);while(++index < length) {result[index] = iteratee(array[index],index,array);}return result;}function arrayPush(array,values){var index=-1,length=values.length,offset=array.length;while(++index < length) {array[offset + index] = values[index];}return array;}function arrayReduce(array,iteratee,accumulator,initAccum){var index=-1,length=array.length;if(initAccum && length){accumulator = array[++index];}while(++index < length) {accumulator = iteratee(accumulator,array[index],index,array);}return accumulator;}function arrayReduceRight(array,iteratee,accumulator,initAccum){var length=array.length;if(initAccum && length){accumulator = array[--length];}while(length--) {accumulator = iteratee(accumulator,array[length],length,array);}return accumulator;}function arraySome(array,predicate){var index=-1,length=array.length;while(++index < length) {if(predicate(array[index],index,array)){return true;}}return false;}function baseExtremum(array,iteratee,comparator){var index=-1,length=array.length;while(++index < length) {var value=array[index],current=iteratee(value);if(current != null && (computed === undefined?current === current:comparator(current,computed))){var computed=current,result=value;}}return result;}function baseFind(collection,predicate,eachFunc,retKey){var result;eachFunc(collection,function(value,key,collection){if(predicate(value,key,collection)){result = retKey?key:value;return false;}});return result;}function baseFindIndex(array,predicate,fromRight){var length=array.length,index=fromRight?length:-1;while(fromRight?index--:++index < length) {if(predicate(array[index],index,array)){return index;}}return -1;}function baseIndexOf(array,value,fromIndex){if(value !== value){return indexOfNaN(array,fromIndex);}var index=fromIndex - 1,length=array.length;while(++index < length) {if(array[index] === value){return index;}}return -1;}function baseReduce(collection,iteratee,accumulator,initAccum,eachFunc){eachFunc(collection,function(value,index,collection){accumulator = initAccum?(initAccum = false,value):iteratee(accumulator,value,index,collection);});return accumulator;}function baseSortBy(array,comparer){var length=array.length;array.sort(comparer);while(length--) {array[length] = array[length].value;}return array;}function baseSum(array,iteratee){var result,index=-1,length=array.length;while(++index < length) {var current=iteratee(array[index]);if(current !== undefined){result = result === undefined?current:result + current;}}return result;}function baseTimes(n,iteratee){var index=-1,result=Array(n);while(++index < n) {result[index] = iteratee(index);}return result;}function baseToPairs(object,props){return arrayMap(props,function(key){return [key,object[key]];});}function baseUnary(func){return function(value){return func(value);};}function baseValues(object,props){return arrayMap(props,function(key){return object[key];});}function charsStartIndex(strSymbols,chrSymbols){var index=-1,length=strSymbols.length;while(++index < length && baseIndexOf(chrSymbols,strSymbols[index],0) > -1) {}return index;}function charsEndIndex(strSymbols,chrSymbols){var index=strSymbols.length;while(index-- && baseIndexOf(chrSymbols,strSymbols[index],0) > -1) {}return index;}function checkGlobal(value){return value && value.Object === Object?value:null;}function compareAscending(value,other){if(value !== other){var valIsNull=value === null,valIsUndef=value === undefined,valIsReflexive=value === value;var othIsNull=other === null,othIsUndef=other === undefined,othIsReflexive=other === other;if(value > other && !othIsNull || !valIsReflexive || valIsNull && !othIsUndef && othIsReflexive || valIsUndef && othIsReflexive){return 1;}if(value < other && !valIsNull || !othIsReflexive || othIsNull && !valIsUndef && valIsReflexive || othIsUndef && valIsReflexive){return -1;}}return 0;}function compareMultiple(object,other,orders){var index=-1,objCriteria=object.criteria,othCriteria=other.criteria,length=objCriteria.length,ordersLength=orders.length;while(++index < length) {var result=compareAscending(objCriteria[index],othCriteria[index]);if(result){if(index >= ordersLength){return result;}var order=orders[index];return result * (order == "desc"?-1:1);}}return object.index - other.index;}function deburrLetter(letter){return deburredLetters[letter];}function escapeHtmlChar(chr){return htmlEscapes[chr];}function escapeStringChar(chr){return "\\" + stringEscapes[chr];}function indexOfNaN(array,fromIndex,fromRight){var length=array.length,index=fromIndex + (fromRight?0:-1);while(fromRight?index--:++index < length) {var other=array[index];if(other !== other){return index;}}return -1;}function isHostObject(value){var result=false;if(value != null && typeof value.toString != "function"){try{result = !!(value + "");}catch(e) {}}return result;}function isIndex(value,length){value = typeof value == "number" || reIsUint.test(value)?+value:-1;length = length == null?MAX_SAFE_INTEGER:length;return value > -1 && value % 1 == 0 && value < length;}function iteratorToArray(iterator){var data,result=[];while(!(data = iterator.next()).done) {result.push(data.value);}return result;}function mapToArray(map){var index=-1,result=Array(map.size);map.forEach(function(value,key){result[++index] = [key,value];});return result;}function replaceHolders(array,placeholder){var index=-1,length=array.length,resIndex=-1,result=[];while(++index < length) {if(array[index] === placeholder){array[index] = PLACEHOLDER;result[++resIndex] = index;}}return result;}function setToArray(set){var index=-1,result=Array(set.size);set.forEach(function(value){result[++index] = value;});return result;}function stringSize(string){if(!(string && reHasComplexSymbol.test(string))){return string.length;}var result=reComplexSymbol.lastIndex = 0;while(reComplexSymbol.test(string)) {result++;}return result;}function stringToArray(string){return string.match(reComplexSymbol);}function unescapeHtmlChar(chr){return htmlUnescapes[chr];}function runInContext(context){context = context?_.defaults({},context,_.pick(root,contextProps)):root;var Date=context.Date,Error=context.Error,Math=context.Math,RegExp=context.RegExp,TypeError=context.TypeError;var arrayProto=context.Array.prototype,objectProto=context.Object.prototype;var funcToString=context.Function.prototype.toString;var hasOwnProperty=objectProto.hasOwnProperty;var idCounter=0;var objectCtorString=funcToString.call(Object);var objectToString=objectProto.toString;var oldDash=root._;var reIsNative=RegExp("^" + funcToString.call(hasOwnProperty).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?") + "$");var Reflect=context.Reflect,Symbol=context.Symbol,Uint8Array=context.Uint8Array,clearTimeout=context.clearTimeout,enumerate=Reflect?Reflect.enumerate:undefined,getPrototypeOf=Object.getPrototypeOf,getOwnPropertySymbols=Object.getOwnPropertySymbols,iteratorSymbol=typeof (iteratorSymbol = Symbol && Symbol.iterator) == "symbol"?iteratorSymbol:undefined,propertyIsEnumerable=objectProto.propertyIsEnumerable,setTimeout=context.setTimeout,splice=arrayProto.splice;var nativeCeil=Math.ceil,nativeFloor=Math.floor,nativeIsFinite=context.isFinite,nativeJoin=arrayProto.join,nativeKeys=Object.keys,nativeMax=Math.max,nativeMin=Math.min,nativeParseInt=context.parseInt,nativeRandom=Math.random,nativeReverse=arrayProto.reverse;var Map=getNative(context,"Map"),Set=getNative(context,"Set"),WeakMap=getNative(context,"WeakMap"),nativeCreate=getNative(Object,"create");var metaMap=WeakMap && new WeakMap();var mapCtorString=Map?funcToString.call(Map):"",setCtorString=Set?funcToString.call(Set):"";var symbolProto=Symbol?Symbol.prototype:undefined,symbolValueOf=Symbol?symbolProto.valueOf:undefined,symbolToString=Symbol?symbolProto.toString:undefined;var realNames={};function lodash(value){if(isObjectLike(value) && !isArray(value) && !(value instanceof LazyWrapper)){if(value instanceof LodashWrapper){return value;}if(hasOwnProperty.call(value,"__wrapped__")){return wrapperClone(value);}}return new LodashWrapper(value);}function baseLodash(){}function LodashWrapper(value,chainAll){this.__wrapped__ = value;this.__actions__ = [];this.__chain__ = !!chainAll;this.__index__ = 0;this.__values__ = undefined;}lodash.templateSettings = {escape:reEscape,evaluate:reEvaluate,interpolate:reInterpolate,variable:"",imports:{_:lodash}};function LazyWrapper(value){this.__wrapped__ = value;this.__actions__ = [];this.__dir__ = 1;this.__filtered__ = false;this.__iteratees__ = [];this.__takeCount__ = MAX_ARRAY_LENGTH;this.__views__ = [];}function lazyClone(){var result=new LazyWrapper(this.__wrapped__);result.__actions__ = copyArray(this.__actions__);result.__dir__ = this.__dir__;result.__filtered__ = this.__filtered__;result.__iteratees__ = copyArray(this.__iteratees__);result.__takeCount__ = this.__takeCount__;result.__views__ = copyArray(this.__views__);return result;}function lazyReverse(){if(this.__filtered__){var result=new LazyWrapper(this);result.__dir__ = -1;result.__filtered__ = true;}else {result = this.clone();result.__dir__ *= -1;}return result;}function lazyValue(){var array=this.__wrapped__.value(),dir=this.__dir__,isArr=isArray(array),isRight=dir < 0,arrLength=isArr?array.length:0,view=getView(0,arrLength,this.__views__),start=view.start,end=view.end,length=end - start,index=isRight?end:start - 1,iteratees=this.__iteratees__,iterLength=iteratees.length,resIndex=0,takeCount=nativeMin(length,this.__takeCount__);if(!isArr || arrLength < LARGE_ARRAY_SIZE || arrLength == length && takeCount == length){return baseWrapperValue(array,this.__actions__);}var result=[];outer: while(length-- && resIndex < takeCount) {index += dir;var iterIndex=-1,value=array[index];while(++iterIndex < iterLength) {var data=iteratees[iterIndex],iteratee=data.iteratee,type=data.type,computed=iteratee(value);if(type == LAZY_MAP_FLAG){value = computed;}else if(!computed){if(type == LAZY_FILTER_FLAG){continue outer;}else {break outer;}}}result[resIndex++] = value;}return result;}function Hash(){}function hashDelete(hash,key){return hashHas(hash,key) && delete hash[key];}function hashGet(hash,key){if(nativeCreate){var result=hash[key];return result === HASH_UNDEFINED?undefined:result;}return hasOwnProperty.call(hash,key)?hash[key]:undefined;}function hashHas(hash,key){return nativeCreate?hash[key] !== undefined:hasOwnProperty.call(hash,key);}function hashSet(hash,key,value){hash[key] = nativeCreate && value === undefined?HASH_UNDEFINED:value;}function MapCache(values){var index=-1,length=values?values.length:0;this.clear();while(++index < length) {var entry=values[index];this.set(entry[0],entry[1]);}}function mapClear(){this.__data__ = {hash:new Hash(),map:Map?new Map():[],string:new Hash()};}function mapDelete(key){var data=this.__data__;if(isKeyable(key)){return hashDelete(typeof key == "string"?data.string:data.hash,key);}return Map?data.map["delete"](key):assocDelete(data.map,key);}function mapGet(key){var data=this.__data__;if(isKeyable(key)){return hashGet(typeof key == "string"?data.string:data.hash,key);}return Map?data.map.get(key):assocGet(data.map,key);}function mapHas(key){var data=this.__data__;if(isKeyable(key)){return hashHas(typeof key == "string"?data.string:data.hash,key);}return Map?data.map.has(key):assocHas(data.map,key);}function mapSet(key,value){var data=this.__data__;if(isKeyable(key)){hashSet(typeof key == "string"?data.string:data.hash,key,value);}else if(Map){data.map.set(key,value);}else {assocSet(data.map,key,value);}return this;}function SetCache(values){var index=-1,length=values?values.length:0;this.__data__ = new MapCache();while(++index < length) {this.push(values[index]);}}function cacheHas(cache,value){var map=cache.__data__;if(isKeyable(value)){var data=map.__data__,hash=typeof value == "string"?data.string:data.hash;return hash[value] === HASH_UNDEFINED;}return map.has(value);}function cachePush(value){var map=this.__data__;if(isKeyable(value)){var data=map.__data__,hash=typeof value == "string"?data.string:data.hash;hash[value] = HASH_UNDEFINED;}else {map.set(value,HASH_UNDEFINED);}}function Stack(values){var index=-1,length=values?values.length:0;this.clear();while(++index < length) {var entry=values[index];this.set(entry[0],entry[1]);}}function stackClear(){this.__data__ = {array:[],map:null};}function stackDelete(key){var data=this.__data__,array=data.array;return array?assocDelete(array,key):data.map["delete"](key);}function stackGet(key){var data=this.__data__,array=data.array;return array?assocGet(array,key):data.map.get(key);}function stackHas(key){var data=this.__data__,array=data.array;return array?assocHas(array,key):data.map.has(key);}function stackSet(key,value){var data=this.__data__,array=data.array;if(array){if(array.length < LARGE_ARRAY_SIZE - 1){assocSet(array,key,value);}else {data.array = null;data.map = new MapCache(array);}}var map=data.map;if(map){map.set(key,value);}return this;}function assocDelete(array,key){var index=assocIndexOf(array,key);if(index < 0){return false;}var lastIndex=array.length - 1;if(index == lastIndex){array.pop();}else {splice.call(array,index,1);}return true;}function assocGet(array,key){var index=assocIndexOf(array,key);return index < 0?undefined:array[index][1];}function assocHas(array,key){return assocIndexOf(array,key) > -1;}function assocIndexOf(array,key){var length=array.length;while(length--) {if(eq(array[length][0],key)){return length;}}return -1;}function assocSet(array,key,value){var index=assocIndexOf(array,key);if(index < 0){array.push([key,value]);}else {array[index][1] = value;}}function assignInDefaults(objValue,srcValue,key,object){if(objValue === undefined || eq(objValue,objectProto[key]) && !hasOwnProperty.call(object,key)){return srcValue;}return objValue;}function assignMergeValue(object,key,value){if(value !== undefined && !eq(object[key],value) || typeof key == "number" && value === undefined && !(key in object)){object[key] = value;}}function assignValue(object,key,value){var objValue=object[key];if(!eq(objValue,value) || eq(objValue,objectProto[key]) && !hasOwnProperty.call(object,key) || value === undefined && !(key in object)){object[key] = value;}}function baseAggregator(collection,setter,iteratee,accumulator){baseEach(collection,function(value,key,collection){setter(accumulator,value,iteratee(value),collection);});return accumulator;}function baseAssign(object,source){return object && copyObject(source,keys(source),object);}function baseAt(object,paths){var index=-1,isNil=object == null,length=paths.length,result=Array(length);while(++index < length) {result[index] = isNil?undefined:get(object,paths[index]);}return result;}function baseClamp(number,lower,upper){if(number === number){if(upper !== undefined){number = number <= upper?number:upper;}if(lower !== undefined){number = number >= lower?number:lower;}}return number;}function baseClone(value,isDeep,customizer,key,object,stack){var result;if(customizer){result = object?customizer(value,key,object,stack):customizer(value);}if(result !== undefined){return result;}if(!isObject(value)){return value;}var isArr=isArray(value);if(isArr){result = initCloneArray(value);if(!isDeep){return copyArray(value,result);}}else {var tag=getTag(value),isFunc=tag == funcTag || tag == genTag;if(tag == objectTag || tag == argsTag || isFunc && !object){if(isHostObject(value)){return object?value:{};}result = initCloneObject(isFunc?{}:value);if(!isDeep){return copySymbols(value,baseAssign(result,value));}}else {return cloneableTags[tag]?initCloneByTag(value,tag,isDeep):object?value:{};}}stack || (stack = new Stack());var stacked=stack.get(value);if(stacked){return stacked;}stack.set(value,result);(isArr?arrayEach:baseForOwn)(value,function(subValue,key){assignValue(result,key,baseClone(subValue,isDeep,customizer,key,value,stack));});return isArr?result:copySymbols(value,result);}function baseConforms(source){var props=keys(source),length=props.length;return function(object){if(object == null){return !length;}var index=length;while(index--) {var key=props[index],predicate=source[key],value=object[key];if(value === undefined && !(key in Object(object)) || !predicate(value)){return false;}}return true;};}var baseCreate=(function(){function object(){}return function(prototype){if(isObject(prototype)){object.prototype = prototype;var result=new object();object.prototype = undefined;}return result || {};};})();function baseDelay(func,wait,args){if(typeof func != "function"){throw new TypeError(FUNC_ERROR_TEXT);}return setTimeout(function(){func.apply(undefined,args);},wait);}function baseDifference(array,values,iteratee,comparator){var index=-1,includes=arrayIncludes,isCommon=true,length=array.length,result=[],valuesLength=values.length;if(!length){return result;}if(iteratee){values = arrayMap(values,baseUnary(iteratee));}if(comparator){includes = arrayIncludesWith;isCommon = false;}else if(values.length >= LARGE_ARRAY_SIZE){includes = cacheHas;isCommon = false;values = new SetCache(values);}outer: while(++index < length) {var value=array[index],computed=iteratee?iteratee(value):value;if(isCommon && computed === computed){var valuesIndex=valuesLength;while(valuesIndex--) {if(values[valuesIndex] === computed){continue outer;}}result.push(value);}else if(!includes(values,computed,comparator)){result.push(value);}}return result;}var baseEach=createBaseEach(baseForOwn);var baseEachRight=createBaseEach(baseForOwnRight,true);function baseEvery(collection,predicate){var result=true;baseEach(collection,function(value,index,collection){result = !!predicate(value,index,collection);return result;});return result;}function baseFill(array,value,start,end){var length=array.length;start = toInteger(start);if(start < 0){start = -start > length?0:length + start;}end = end === undefined || end > length?length:toInteger(end);if(end < 0){end += length;}end = start > end?0:toLength(end);while(start < end) {array[start++] = value;}return array;}function baseFilter(collection,predicate){var result=[];baseEach(collection,function(value,index,collection){if(predicate(value,index,collection)){result.push(value);}});return result;}function baseFlatten(array,isDeep,isStrict,result){result || (result = []);var index=-1,length=array.length;while(++index < length) {var value=array[index];if(isArrayLikeObject(value) && (isStrict || isArray(value) || isArguments(value))){if(isDeep){baseFlatten(value,isDeep,isStrict,result);}else {arrayPush(result,value);}}else if(!isStrict){result[result.length] = value;}}return result;}var baseFor=createBaseFor();var baseForRight=createBaseFor(true);function baseForIn(object,iteratee){return object == null?object:baseFor(object,iteratee,keysIn);}function baseForOwn(object,iteratee){return object && baseFor(object,iteratee,keys);}function baseForOwnRight(object,iteratee){return object && baseForRight(object,iteratee,keys);}function baseFunctions(object,props){return arrayFilter(props,function(key){return isFunction(object[key]);});}function baseGet(object,path){path = isKey(path,object)?[path + ""]:baseToPath(path);var index=0,length=path.length;while(object != null && index < length) {object = object[path[index++]];}return index && index == length?object:undefined;}function baseHas(object,key){return hasOwnProperty.call(object,key) || typeof object == "object" && key in object && getPrototypeOf(object) === null;}function baseHasIn(object,key){return key in Object(object);}function baseInRange(number,start,end){return number >= nativeMin(start,end) && number < nativeMax(start,end);}function baseIntersection(arrays,iteratee,comparator){var includes=comparator?arrayIncludesWith:arrayIncludes,othLength=arrays.length,othIndex=othLength,caches=Array(othLength),result=[];while(othIndex--) {var array=arrays[othIndex];if(othIndex && iteratee){array = arrayMap(array,baseUnary(iteratee));}caches[othIndex] = !comparator && (iteratee || array.length >= 120)?new SetCache(othIndex && array):undefined;}array = arrays[0];var index=-1,length=array.length,seen=caches[0];outer: while(++index < length) {var value=array[index],computed=iteratee?iteratee(value):value;if(!(seen?cacheHas(seen,computed):includes(result,computed,comparator))){var othIndex=othLength;while(--othIndex) {var cache=caches[othIndex];if(!(cache?cacheHas(cache,computed):includes(arrays[othIndex],computed,comparator))){continue outer;}}if(seen){seen.push(computed);}result.push(value);}}return result;}function baseInverter(object,setter,iteratee,accumulator){baseForOwn(object,function(value,key,object){setter(accumulator,iteratee(value),key,object);});return accumulator;}function baseInvoke(object,path,args){if(!isKey(path,object)){path = baseToPath(path);object = parent(object,path);path = last(path);}var func=object == null?object:object[path];return func == null?undefined:apply(func,object,args);}function baseIsEqual(value,other,customizer,bitmask,stack){if(value === other){return true;}if(value == null || other == null || !isObject(value) && !isObjectLike(other)){return value !== value && other !== other;}return baseIsEqualDeep(value,other,baseIsEqual,customizer,bitmask,stack);}function baseIsEqualDeep(object,other,equalFunc,customizer,bitmask,stack){var objIsArr=isArray(object),othIsArr=isArray(other),objTag=arrayTag,othTag=arrayTag;if(!objIsArr){objTag = getTag(object);if(objTag == argsTag){objTag = objectTag;}else if(objTag != objectTag){objIsArr = isTypedArray(object);}}if(!othIsArr){othTag = getTag(other);if(othTag == argsTag){othTag = objectTag;}else if(othTag != objectTag){othIsArr = isTypedArray(other);}}var objIsObj=objTag == objectTag && !isHostObject(object),othIsObj=othTag == objectTag && !isHostObject(other),isSameTag=objTag == othTag;if(isSameTag && !(objIsArr || objIsObj)){return equalByTag(object,other,objTag,equalFunc,customizer,bitmask);}var isPartial=bitmask & PARTIAL_COMPARE_FLAG;if(!isPartial){var objIsWrapped=objIsObj && hasOwnProperty.call(object,"__wrapped__"),othIsWrapped=othIsObj && hasOwnProperty.call(other,"__wrapped__");if(objIsWrapped || othIsWrapped){return equalFunc(objIsWrapped?object.value():object,othIsWrapped?other.value():other,customizer,bitmask,stack);}}if(!isSameTag){return false;}stack || (stack = new Stack());return (objIsArr?equalArrays:equalObjects)(object,other,equalFunc,customizer,bitmask,stack);}function baseIsMatch(object,source,matchData,customizer){var index=matchData.length,length=index,noCustomizer=!customizer;if(object == null){return !length;}object = Object(object);while(index--) {var data=matchData[index];if(noCustomizer && data[2]?data[1] !== object[data[0]]:!(data[0] in object)){return false;}}while(++index < length) {data = matchData[index];var key=data[0],objValue=object[key],srcValue=data[1];if(noCustomizer && data[2]){if(objValue === undefined && !(key in object)){return false;}}else {var stack=new Stack(),result=customizer?customizer(objValue,srcValue,key,object,source,stack):undefined;if(!(result === undefined?baseIsEqual(srcValue,objValue,customizer,UNORDERED_COMPARE_FLAG | PARTIAL_COMPARE_FLAG,stack):result)){return false;}}}return true;}function baseIteratee(value){var type=typeof value;if(type == "function"){return value;}if(value == null){return identity;}if(type == "object"){return isArray(value)?baseMatchesProperty(value[0],value[1]):baseMatches(value);}return property(value);}function baseKeys(object){return nativeKeys(Object(object));}function baseKeysIn(object){object = object == null?object:Object(object);var result=[];for(var key in object) {result.push(key);}return result;}if(enumerate && !propertyIsEnumerable.call({valueOf:1},"valueOf")){baseKeysIn = function(object){return iteratorToArray(enumerate(object));};}function baseMap(collection,iteratee){var index=-1,result=isArrayLike(collection)?Array(collection.length):[];baseEach(collection,function(value,key,collection){result[++index] = iteratee(value,key,collection);});return result;}function baseMatches(source){var matchData=getMatchData(source);if(matchData.length == 1 && matchData[0][2]){var key=matchData[0][0],value=matchData[0][1];return function(object){if(object == null){return false;}return object[key] === value && (value !== undefined || key in Object(object));};}return function(object){return object === source || baseIsMatch(object,source,matchData);};}function baseMatchesProperty(path,srcValue){return function(object){var objValue=get(object,path);return objValue === undefined && objValue === srcValue?hasIn(object,path):baseIsEqual(srcValue,objValue,undefined,UNORDERED_COMPARE_FLAG | PARTIAL_COMPARE_FLAG);};}function baseMerge(object,source,srcIndex,customizer,stack){if(object === source){return;}var props=isArray(source) || isTypedArray(source)?undefined:keysIn(source);arrayEach(props || source,function(srcValue,key){if(props){key = srcValue;srcValue = source[key];}if(isObject(srcValue)){stack || (stack = new Stack());baseMergeDeep(object,source,key,srcIndex,baseMerge,customizer,stack);}else {var newValue=customizer?customizer(object[key],srcValue,key + "",object,source,stack):undefined;if(newValue === undefined){newValue = srcValue;}assignMergeValue(object,key,newValue);}});}function baseMergeDeep(object,source,key,srcIndex,mergeFunc,customizer,stack){var objValue=object[key],srcValue=source[key],stacked=stack.get(srcValue);if(stacked){assignMergeValue(object,key,stacked);return;}var newValue=customizer?customizer(objValue,srcValue,key + "",object,source,stack):undefined,isCommon=newValue === undefined;if(isCommon){newValue = srcValue;if(isArray(srcValue) || isTypedArray(srcValue)){if(isArray(objValue)){newValue = srcIndex?copyArray(objValue):objValue;}else if(isArrayLikeObject(objValue)){newValue = copyArray(objValue);}else {isCommon = false;newValue = baseClone(srcValue);}}else if(isPlainObject(srcValue) || isArguments(srcValue)){if(isArguments(objValue)){newValue = toPlainObject(objValue);}else if(!isObject(objValue) || srcIndex && isFunction(objValue)){isCommon = false;newValue = baseClone(srcValue);}else {newValue = srcIndex?baseClone(objValue):objValue;}}else {isCommon = false;}}stack.set(srcValue,newValue);if(isCommon){mergeFunc(newValue,srcValue,srcIndex,customizer,stack);}assignMergeValue(object,key,newValue);}function baseOrderBy(collection,iteratees,orders){var index=-1,toIteratee=getIteratee();iteratees = arrayMap(iteratees.length?iteratees:Array(1),function(iteratee){return toIteratee(iteratee);});var result=baseMap(collection,function(value,key,collection){var criteria=arrayMap(iteratees,function(iteratee){return iteratee(value);});return {criteria:criteria,index:++index,value:value};});return baseSortBy(result,function(object,other){return compareMultiple(object,other,orders);});}function basePick(object,props){object = Object(object);return arrayReduce(props,function(result,key){if(key in object){result[key] = object[key];}return result;},{});}function basePickBy(object,predicate){var result={};baseForIn(object,function(value,key){if(predicate(value,key)){result[key] = value;}});return result;}function baseProperty(key){return function(object){return object == null?undefined:object[key];};}function basePropertyDeep(path){return function(object){return baseGet(object,path);};}function basePullAll(array,values){return basePullAllBy(array,values);}function basePullAllBy(array,values,iteratee){var index=-1,length=values.length,seen=array;if(iteratee){seen = arrayMap(array,function(value){return iteratee(value);});}while(++index < length) {var fromIndex=0,value=values[index],computed=iteratee?iteratee(value):value;while((fromIndex = baseIndexOf(seen,computed,fromIndex)) > -1) {if(seen !== array){splice.call(seen,fromIndex,1);}splice.call(array,fromIndex,1);}}return array;}function basePullAt(array,indexes){var length=array?indexes.length:0,lastIndex=length - 1;while(length--) {var index=indexes[length];if(lastIndex == length || index != previous){var previous=index;if(isIndex(index)){splice.call(array,index,1);}else if(!isKey(index,array)){var path=baseToPath(index),object=parent(array,path);if(object != null){delete object[last(path)];}}else {delete array[index];}}}return array;}function baseRandom(lower,upper){return lower + nativeFloor(nativeRandom() * (upper - lower + 1));}function baseRange(start,end,step,fromRight){var index=-1,length=nativeMax(nativeCeil((end - start) / (step || 1)),0),result=Array(length);while(length--) {result[fromRight?length:++index] = start;start += step;}return result;}function baseSet(object,path,value,customizer){path = isKey(path,object)?[path + ""]:baseToPath(path);var index=-1,length=path.length,lastIndex=length - 1,nested=object;while(nested != null && ++index < length) {var key=path[index];if(isObject(nested)){var newValue=value;if(index != lastIndex){var objValue=nested[key];newValue = customizer?customizer(objValue,key,nested):undefined;if(newValue === undefined){newValue = objValue == null?isIndex(path[index + 1])?[]:{}:objValue;}}assignValue(nested,key,newValue);}nested = nested[key];}return object;}var baseSetData=!metaMap?identity:function(func,data){metaMap.set(func,data);return func;};function baseSlice(array,start,end){var index=-1,length=array.length;if(start < 0){start = -start > length?0:length + start;}end = end > length?length:end;if(end < 0){end += length;}length = start > end?0:end - start >>> 0;start >>>= 0;var result=Array(length);while(++index < length) {result[index] = array[index + start];}return result;}function baseSome(collection,predicate){var result;baseEach(collection,function(value,index,collection){result = predicate(value,index,collection);return !result;});return !!result;}function baseSortedIndex(array,value,retHighest){var low=0,high=array?array.length:low;if(typeof value == "number" && value === value && high <= HALF_MAX_ARRAY_LENGTH){while(low < high) {var mid=low + high >>> 1,computed=array[mid];if((retHighest?computed <= value:computed < value) && computed !== null){low = mid + 1;}else {high = mid;}}return high;}return baseSortedIndexBy(array,value,identity,retHighest);}function baseSortedIndexBy(array,value,iteratee,retHighest){value = iteratee(value);var low=0,high=array?array.length:0,valIsNaN=value !== value,valIsNull=value === null,valIsUndef=value === undefined;while(low < high) {var mid=nativeFloor((low + high) / 2),computed=iteratee(array[mid]),isDef=computed !== undefined,isReflexive=computed === computed;if(valIsNaN){var setLow=isReflexive || retHighest;}else if(valIsNull){setLow = isReflexive && isDef && (retHighest || computed != null);}else if(valIsUndef){setLow = isReflexive && (retHighest || isDef);}else if(computed == null){setLow = false;}else {setLow = retHighest?computed <= value:computed < value;}if(setLow){low = mid + 1;}else {high = mid;}}return nativeMin(high,MAX_ARRAY_INDEX);}function baseSortedUniq(array){return baseSortedUniqBy(array);}function baseSortedUniqBy(array,iteratee){var index=0,length=array.length,value=array[0],computed=iteratee?iteratee(value):value,seen=computed,resIndex=0,result=[value];while(++index < length) {value = array[index],computed = iteratee?iteratee(value):value;if(!eq(computed,seen)){seen = computed;result[++resIndex] = value;}}return result;}function baseToPath(value){return isArray(value)?value:stringToPath(value);}function baseUniq(array,iteratee,comparator){var index=-1,includes=arrayIncludes,length=array.length,isCommon=true,result=[],seen=result;if(comparator){isCommon = false;includes = arrayIncludesWith;}else if(length >= LARGE_ARRAY_SIZE){var set=iteratee?null:createSet(array);if(set){return setToArray(set);}isCommon = false;includes = cacheHas;seen = new SetCache();}else {seen = iteratee?[]:result;}outer: while(++index < length) {var value=array[index],computed=iteratee?iteratee(value):value;if(isCommon && computed === computed){var seenIndex=seen.length;while(seenIndex--) {if(seen[seenIndex] === computed){continue outer;}}if(iteratee){seen.push(computed);}result.push(value);}else if(!includes(seen,computed,comparator)){if(seen !== result){seen.push(computed);}result.push(value);}}return result;}function baseUnset(object,path){path = isKey(path,object)?[path + ""]:baseToPath(path);object = parent(object,path);var key=last(path);return object != null && has(object,key)?delete object[key]:true;}function baseWhile(array,predicate,isDrop,fromRight){var length=array.length,index=fromRight?length:-1;while((fromRight?index--:++index < length) && predicate(array[index],index,array)) {}return isDrop?baseSlice(array,fromRight?0:index,fromRight?index + 1:length):baseSlice(array,fromRight?index + 1:0,fromRight?length:index);}function baseWrapperValue(value,actions){var result=value;if(result instanceof LazyWrapper){result = result.value();}return arrayReduce(actions,function(result,action){return action.func.apply(action.thisArg,arrayPush([result],action.args));},result);}function baseXor(arrays,iteratee,comparator){var index=-1,length=arrays.length;while(++index < length) {var result=result?arrayPush(baseDifference(result,arrays[index],iteratee,comparator),baseDifference(arrays[index],result,iteratee,comparator)):arrays[index];}return result && result.length?baseUniq(result,iteratee,comparator):[];}function baseZipObject(props,values,assignFunc){var index=-1,length=props.length,valsLength=values.length,result={};while(++index < length) {assignFunc(result,props[index],index < valsLength?values[index]:undefined);}return result;}function cloneBuffer(buffer){var Ctor=buffer.constructor,result=new Ctor(buffer.byteLength),view=new Uint8Array(result);view.set(new Uint8Array(buffer));return result;}function cloneMap(map){var Ctor=map.constructor;return arrayReduce(mapToArray(map),addMapEntry,new Ctor());}function cloneRegExp(regexp){var Ctor=regexp.constructor,result=new Ctor(regexp.source,reFlags.exec(regexp));result.lastIndex = regexp.lastIndex;return result;}function cloneSet(set){var Ctor=set.constructor;return arrayReduce(setToArray(set),addSetEntry,new Ctor());}function cloneSymbol(symbol){return Symbol?Object(symbolValueOf.call(symbol)):{};}function cloneTypedArray(typedArray,isDeep){var buffer=typedArray.buffer,Ctor=typedArray.constructor;return new Ctor(isDeep?cloneBuffer(buffer):buffer,typedArray.byteOffset,typedArray.length);}function composeArgs(args,partials,holders){var holdersLength=holders.length,argsIndex=-1,argsLength=nativeMax(args.length - holdersLength,0),leftIndex=-1,leftLength=partials.length,result=Array(leftLength + argsLength);while(++leftIndex < leftLength) {result[leftIndex] = partials[leftIndex];}while(++argsIndex < holdersLength) {result[holders[argsIndex]] = args[argsIndex];}while(argsLength--) {result[leftIndex++] = args[argsIndex++];}return result;}function composeArgsRight(args,partials,holders){var holdersIndex=-1,holdersLength=holders.length,argsIndex=-1,argsLength=nativeMax(args.length - holdersLength,0),rightIndex=-1,rightLength=partials.length,result=Array(argsLength + rightLength);while(++argsIndex < argsLength) {result[argsIndex] = args[argsIndex];}var offset=argsIndex;while(++rightIndex < rightLength) {result[offset + rightIndex] = partials[rightIndex];}while(++holdersIndex < holdersLength) {result[offset + holders[holdersIndex]] = args[argsIndex++];}return result;}function copyArray(source,array){var index=-1,length=source.length;array || (array = Array(length));while(++index < length) {array[index] = source[index];}return array;}function copyObject(source,props,object){return copyObjectWith(source,props,object);}function copyObjectWith(source,props,object,customizer){object || (object = {});var index=-1,length=props.length;while(++index < length) {var key=props[index],newValue=customizer?customizer(object[key],source[key],key,object,source):source[key];assignValue(object,key,newValue);}return object;}function copySymbols(source,object){return copyObject(source,getSymbols(source),object);}function createAggregator(setter,initializer){return function(collection,iteratee){var func=isArray(collection)?arrayAggregator:baseAggregator,accumulator=initializer?initializer():{};return func(collection,setter,getIteratee(iteratee),accumulator);};}function createAssigner(assigner){return rest(function(object,sources){var index=-1,length=sources.length,customizer=length > 1?sources[length - 1]:undefined,guard=length > 2?sources[2]:undefined;customizer = typeof customizer == "function"?(length--,customizer):undefined;if(guard && isIterateeCall(sources[0],sources[1],guard)){customizer = length < 3?undefined:customizer;length = 1;}object = Object(object);while(++index < length) {var source=sources[index];if(source){assigner(object,source,index,customizer);}}return object;});}function createBaseEach(eachFunc,fromRight){return function(collection,iteratee){if(collection == null){return collection;}if(!isArrayLike(collection)){return eachFunc(collection,iteratee);}var length=collection.length,index=fromRight?length:-1,iterable=Object(collection);while(fromRight?index--:++index < length) {if(iteratee(iterable[index],index,iterable) === false){break;}}return collection;};}function createBaseFor(fromRight){return function(object,iteratee,keysFunc){var index=-1,iterable=Object(object),props=keysFunc(object),length=props.length;while(length--) {var key=props[fromRight?length:++index];if(iteratee(iterable[key],key,iterable) === false){break;}}return object;};}function createBaseWrapper(func,bitmask,thisArg){var isBind=bitmask & BIND_FLAG,Ctor=createCtorWrapper(func);function wrapper(){var fn=this && this !== root && this instanceof wrapper?Ctor:func;return fn.apply(isBind?thisArg:this,arguments);}return wrapper;}function createCaseFirst(methodName){return function(string){string = toString(string);var strSymbols=reHasComplexSymbol.test(string)?stringToArray(string):undefined,chr=strSymbols?strSymbols[0]:string.charAt(0),trailing=strSymbols?strSymbols.slice(1).join(""):string.slice(1);return chr[methodName]() + trailing;};}function createCompounder(callback){return function(string){return arrayReduce(words(deburr(string)),callback,"");};}function createCtorWrapper(Ctor){return function(){var args=arguments;switch(args.length){case 0:return new Ctor();case 1:return new Ctor(args[0]);case 2:return new Ctor(args[0],args[1]);case 3:return new Ctor(args[0],args[1],args[2]);case 4:return new Ctor(args[0],args[1],args[2],args[3]);case 5:return new Ctor(args[0],args[1],args[2],args[3],args[4]);case 6:return new Ctor(args[0],args[1],args[2],args[3],args[4],args[5]);case 7:return new Ctor(args[0],args[1],args[2],args[3],args[4],args[5],args[6]);}var thisBinding=baseCreate(Ctor.prototype),result=Ctor.apply(thisBinding,args);return isObject(result)?result:thisBinding;};}function createCurryWrapper(func,bitmask,arity){var Ctor=createCtorWrapper(func);function wrapper(){var length=arguments.length,index=length,args=Array(length),fn=this && this !== root && this instanceof wrapper?Ctor:func,placeholder=wrapper.placeholder;while(index--) {args[index] = arguments[index];}var holders=length < 3 && args[0] !== placeholder && args[length - 1] !== placeholder?[]:replaceHolders(args,placeholder);length -= holders.length;return length < arity?createRecurryWrapper(func,bitmask,createHybridWrapper,placeholder,undefined,args,holders,undefined,undefined,arity - length):apply(fn,this,args);}return wrapper;}function createFlow(fromRight){return rest(function(funcs){funcs = baseFlatten(funcs);var length=funcs.length,index=length,prereq=LodashWrapper.prototype.thru;if(fromRight){funcs.reverse();}while(index--) {var func=funcs[index];if(typeof func != "function"){throw new TypeError(FUNC_ERROR_TEXT);}if(prereq && !wrapper && getFuncName(func) == "wrapper"){var wrapper=new LodashWrapper([],true);}}index = wrapper?index:length;while(++index < length) {func = funcs[index];var funcName=getFuncName(func),data=funcName == "wrapper"?getData(func):undefined;if(data && isLaziable(data[0]) && data[1] == (ARY_FLAG | CURRY_FLAG | PARTIAL_FLAG | REARG_FLAG) && !data[4].length && data[9] == 1){wrapper = wrapper[getFuncName(data[0])].apply(wrapper,data[3]);}else {wrapper = func.length == 1 && isLaziable(func)?wrapper[funcName]():wrapper.thru(func);}}return function(){var args=arguments,value=args[0];if(wrapper && args.length == 1 && isArray(value) && value.length >= LARGE_ARRAY_SIZE){return wrapper.plant(value).value();}var index=0,result=length?funcs[index].apply(this,args):value;while(++index < length) {result = funcs[index].call(this,result);}return result;};});}function createHybridWrapper(func,bitmask,thisArg,partials,holders,partialsRight,holdersRight,argPos,ary,arity){var isAry=bitmask & ARY_FLAG,isBind=bitmask & BIND_FLAG,isBindKey=bitmask & BIND_KEY_FLAG,isCurry=bitmask & CURRY_FLAG,isCurryRight=bitmask & CURRY_RIGHT_FLAG,isFlip=bitmask & FLIP_FLAG,Ctor=isBindKey?undefined:createCtorWrapper(func);function wrapper(){var length=arguments.length,index=length,args=Array(length);while(index--) {args[index] = arguments[index];}if(partials){args = composeArgs(args,partials,holders);}if(partialsRight){args = composeArgsRight(args,partialsRight,holdersRight);}if(isCurry || isCurryRight){var placeholder=wrapper.placeholder,argsHolders=replaceHolders(args,placeholder);length -= argsHolders.length;if(length < arity){return createRecurryWrapper(func,bitmask,createHybridWrapper,placeholder,thisArg,args,argsHolders,argPos,ary,arity - length);}}var thisBinding=isBind?thisArg:this,fn=isBindKey?thisBinding[func]:func;if(argPos){args = reorder(args,argPos);}else if(isFlip && args.length > 1){args.reverse();}if(isAry && ary < args.length){args.length = ary;}if(this && this !== root && this instanceof wrapper){fn = Ctor || createCtorWrapper(fn);}return fn.apply(thisBinding,args);}return wrapper;}function createInverter(setter,toIteratee){return function(object,iteratee){return baseInverter(object,setter,toIteratee(iteratee),{});};}function createOver(arrayFunc){return rest(function(iteratees){iteratees = arrayMap(baseFlatten(iteratees),getIteratee());return rest(function(args){var thisArg=this;return arrayFunc(iteratees,function(iteratee){return apply(iteratee,thisArg,args);});});});}function createPadding(string,length,chars){length = toInteger(length);var strLength=stringSize(string);if(!length || strLength >= length){return "";}var padLength=length - strLength;chars = chars === undefined?" ":chars + "";var result=repeat(chars,nativeCeil(padLength / stringSize(chars)));return reHasComplexSymbol.test(chars)?stringToArray(result).slice(0,padLength).join(""):result.slice(0,padLength);}function createPartialWrapper(func,bitmask,thisArg,partials){var isBind=bitmask & BIND_FLAG,Ctor=createCtorWrapper(func);function wrapper(){var argsIndex=-1,argsLength=arguments.length,leftIndex=-1,leftLength=partials.length,args=Array(leftLength + argsLength),fn=this && this !== root && this instanceof wrapper?Ctor:func;while(++leftIndex < leftLength) {args[leftIndex] = partials[leftIndex];}while(argsLength--) {args[leftIndex++] = arguments[++argsIndex];}return apply(fn,isBind?thisArg:this,args);}return wrapper;}function createRange(fromRight){return function(start,end,step){if(step && typeof step != "number" && isIterateeCall(start,end,step)){end = step = undefined;}start = toNumber(start);start = start === start?start:0;if(end === undefined){end = start;start = 0;}else {end = toNumber(end) || 0;}step = step === undefined?start < end?1:-1:toNumber(step) || 0;return baseRange(start,end,step,fromRight);};}function createRecurryWrapper(func,bitmask,wrapFunc,placeholder,thisArg,partials,holders,argPos,ary,arity){var isCurry=bitmask & CURRY_FLAG,newArgPos=argPos?copyArray(argPos):undefined,newsHolders=isCurry?holders:undefined,newHoldersRight=isCurry?undefined:holders,newPartials=isCurry?partials:undefined,newPartialsRight=isCurry?undefined:partials;bitmask |= isCurry?PARTIAL_FLAG:PARTIAL_RIGHT_FLAG;bitmask &= ~(isCurry?PARTIAL_RIGHT_FLAG:PARTIAL_FLAG);if(!(bitmask & CURRY_BOUND_FLAG)){bitmask &= ~(BIND_FLAG | BIND_KEY_FLAG);}var newData=[func,bitmask,thisArg,newPartials,newsHolders,newPartialsRight,newHoldersRight,newArgPos,ary,arity],result=wrapFunc.apply(undefined,newData);if(isLaziable(func)){setData(result,newData);}result.placeholder = placeholder;return result;}function createRound(methodName){var func=Math[methodName];return function(number,precision){number = toNumber(number);precision = toInteger(precision);if(precision){var pair=(toString(number) + "e").split("e"),value=func(pair[0] + "e" + (+pair[1] + precision));pair = (toString(value) + "e").split("e");return +(pair[0] + "e" + (+pair[1] - precision));}return func(number);};}var createSet=!(Set && new Set([1,2]).size === 2)?noop:function(values){return new Set(values);};function createWrapper(func,bitmask,thisArg,partials,holders,argPos,ary,arity){var isBindKey=bitmask & BIND_KEY_FLAG;if(!isBindKey && typeof func != "function"){throw new TypeError(FUNC_ERROR_TEXT);}var length=partials?partials.length:0;if(!length){bitmask &= ~(PARTIAL_FLAG | PARTIAL_RIGHT_FLAG);partials = holders = undefined;}ary = ary === undefined?ary:nativeMax(toInteger(ary),0);arity = arity === undefined?arity:toInteger(arity);length -= holders?holders.length:0;if(bitmask & PARTIAL_RIGHT_FLAG){var partialsRight=partials,holdersRight=holders;partials = holders = undefined;}var data=isBindKey?undefined:getData(func),newData=[func,bitmask,thisArg,partials,holders,partialsRight,holdersRight,argPos,ary,arity];if(data){mergeData(newData,data);}func = newData[0];bitmask = newData[1];thisArg = newData[2];partials = newData[3];holders = newData[4];arity = newData[9] = newData[9] == null?isBindKey?0:func.length:nativeMax(newData[9] - length,0);if(!arity && bitmask & (CURRY_FLAG | CURRY_RIGHT_FLAG)){bitmask &= ~(CURRY_FLAG | CURRY_RIGHT_FLAG);}if(!bitmask || bitmask == BIND_FLAG){var result=createBaseWrapper(func,bitmask,thisArg);}else if(bitmask == CURRY_FLAG || bitmask == CURRY_RIGHT_FLAG){result = createCurryWrapper(func,bitmask,arity);}else if((bitmask == PARTIAL_FLAG || bitmask == (BIND_FLAG | PARTIAL_FLAG)) && !holders.length){result = createPartialWrapper(func,bitmask,thisArg,partials);}else {result = createHybridWrapper.apply(undefined,newData);}var setter=data?baseSetData:setData;return setter(result,newData);}function equalArrays(array,other,equalFunc,customizer,bitmask,stack){var index=-1,isPartial=bitmask & PARTIAL_COMPARE_FLAG,isUnordered=bitmask & UNORDERED_COMPARE_FLAG,arrLength=array.length,othLength=other.length;if(arrLength != othLength && !(isPartial && othLength > arrLength)){return false;}var stacked=stack.get(array);if(stacked){return stacked == other;}var result=true;stack.set(array,other);while(++index < arrLength) {var arrValue=array[index],othValue=other[index];if(customizer){var compared=isPartial?customizer(othValue,arrValue,index,other,array,stack):customizer(arrValue,othValue,index,array,other,stack);}if(compared !== undefined){if(compared){continue;}result = false;break;}if(isUnordered){if(!arraySome(other,function(othValue){return arrValue === othValue || equalFunc(arrValue,othValue,customizer,bitmask,stack);})){result = false;break;}}else if(!(arrValue === othValue || equalFunc(arrValue,othValue,customizer,bitmask,stack))){result = false;break;}}stack["delete"](array);return result;}function equalByTag(object,other,tag,equalFunc,customizer,bitmask){switch(tag){case arrayBufferTag:if(object.byteLength != other.byteLength || !equalFunc(new Uint8Array(object),new Uint8Array(other))){return false;}return true;case boolTag:case dateTag:return +object == +other;case errorTag:return object.name == other.name && object.message == other.message;case numberTag:return object != +object?other != +other:object == +other;case regexpTag:case stringTag:return object == other + "";case mapTag:var convert=mapToArray;case setTag:var isPartial=bitmask & PARTIAL_COMPARE_FLAG;convert || (convert = setToArray);return (isPartial || object.size == other.size) && equalFunc(convert(object),convert(other),customizer,bitmask | UNORDERED_COMPARE_FLAG);case symbolTag:return !!Symbol && symbolValueOf.call(object) == symbolValueOf.call(other);}return false;}function equalObjects(object,other,equalFunc,customizer,bitmask,stack){var isPartial=bitmask & PARTIAL_COMPARE_FLAG,objProps=keys(object),objLength=objProps.length,othProps=keys(other),othLength=othProps.length;if(objLength != othLength && !isPartial){return false;}var index=objLength;while(index--) {var key=objProps[index];if(!(isPartial?key in other:baseHas(other,key))){return false;}}var stacked=stack.get(object);if(stacked){return stacked == other;}var result=true;stack.set(object,other);var skipCtor=isPartial;while(++index < objLength) {key = objProps[index];var objValue=object[key],othValue=other[key];if(customizer){var compared=isPartial?customizer(othValue,objValue,key,other,object,stack):customizer(objValue,othValue,key,object,other,stack);}if(!(compared === undefined?objValue === othValue || equalFunc(objValue,othValue,customizer,bitmask,stack):compared)){result = false;break;}skipCtor || (skipCtor = key == "constructor");}if(result && !skipCtor){var objCtor=object.constructor,othCtor=other.constructor;if(objCtor != othCtor && "constructor" in object && "constructor" in other && !(typeof objCtor == "function" && objCtor instanceof objCtor && typeof othCtor == "function" && othCtor instanceof othCtor)){result = false;}}stack["delete"](object);return result;}var getData=!metaMap?noop:function(func){return metaMap.get(func);};function getFuncName(func){var result=func.name + "",array=realNames[result],length=hasOwnProperty.call(realNames,result)?array.length:0;while(length--) {var data=array[length],otherFunc=data.func;if(otherFunc == null || otherFunc == func){return data.name;}}return result;}function getIteratee(){var result=lodash.iteratee || iteratee;result = result === iteratee?baseIteratee:result;return arguments.length?result(arguments[0],arguments[1]):result;}var getLength=baseProperty("length");function getMatchData(object){var result=toPairs(object),length=result.length;while(length--) {result[length][2] = isStrictComparable(result[length][1]);}return result;}function getNative(object,key){var value=object == null?undefined:object[key];return isNative(value)?value:undefined;}var getSymbols=getOwnPropertySymbols || function(){return [];};function getTag(value){return objectToString.call(value);}if(Map && getTag(new Map()) != mapTag || Set && getTag(new Set()) != setTag){getTag = function(value){var result=objectToString.call(value),Ctor=result == objectTag?value.constructor:null,ctorString=typeof Ctor == "function"?funcToString.call(Ctor):"";if(ctorString){if(ctorString == mapCtorString){return mapTag;}if(ctorString == setCtorString){return setTag;}}return result;};}function getView(start,end,transforms){var index=-1,length=transforms.length;while(++index < length) {var data=transforms[index],size=data.size;switch(data.type){case "drop":start += size;break;case "dropRight":end -= size;break;case "take":end = nativeMin(end,start + size);break;case "takeRight":start = nativeMax(start,end - size);break;}}return {start:start,end:end};}function hasPath(object,path,hasFunc){if(object == null){return false;}var result=hasFunc(object,path);if(!result && !isKey(path)){path = baseToPath(path);object = parent(object,path);if(object != null){path = last(path);result = hasFunc(object,path);}}var length=object?object.length:undefined;return result || !!length && isLength(length) && isIndex(path,length) && (isArray(object) || isString(object) || isArguments(object));}function initCloneArray(array){var length=array.length,result=array.constructor(length);if(length && typeof array[0] == "string" && hasOwnProperty.call(array,"index")){result.index = array.index;result.input = array.input;}return result;}function initCloneObject(object){if(isPrototype(object)){return {};}var Ctor=object.constructor;return baseCreate(isFunction(Ctor)?Ctor.prototype:undefined);}function initCloneByTag(object,tag,isDeep){var Ctor=object.constructor;switch(tag){case arrayBufferTag:return cloneBuffer(object);case boolTag:case dateTag:return new Ctor(+object);case float32Tag:case float64Tag:case int8Tag:case int16Tag:case int32Tag:case uint8Tag:case uint8ClampedTag:case uint16Tag:case uint32Tag:return cloneTypedArray(object,isDeep);case mapTag:return cloneMap(object);case numberTag:case stringTag:return new Ctor(object);case regexpTag:return cloneRegExp(object);case setTag:return cloneSet(object);case symbolTag:return cloneSymbol(object);}}function indexKeys(object){var length=object?object.length:undefined;if(isLength(length) && (isArray(object) || isString(object) || isArguments(object))){return baseTimes(length,String);}return null;}function isIterateeCall(value,index,object){if(!isObject(object)){return false;}var type=typeof index;if(type == "number"?isArrayLike(object) && isIndex(index,object.length):type == "string" && index in object){return eq(object[index],value);}return false;}function isKey(value,object){if(typeof value == "number"){return true;}return !isArray(value) && (reIsPlainProp.test(value) || !reIsDeepProp.test(value) || object != null && value in Object(object));}function isKeyable(value){var type=typeof value;return type == "number" || type == "boolean" || type == "string" && value !== "__proto__" || value == null;}function isLaziable(func){var funcName=getFuncName(func),other=lodash[funcName];if(typeof other != "function" || !(funcName in LazyWrapper.prototype)){return false;}if(func === other){return true;}var data=getData(other);return !!data && func === data[0];}function isPrototype(value){var Ctor=value && value.constructor,proto=typeof Ctor == "function" && Ctor.prototype || objectProto;return value === proto;}function isStrictComparable(value){return value === value && !isObject(value);}function mergeData(data,source){var bitmask=data[1],srcBitmask=source[1],newBitmask=bitmask | srcBitmask,isCommon=newBitmask < (BIND_FLAG | BIND_KEY_FLAG | ARY_FLAG);var isCombo=srcBitmask == ARY_FLAG && bitmask == CURRY_FLAG || srcBitmask == ARY_FLAG && bitmask == REARG_FLAG && data[7].length <= source[8] || srcBitmask == (ARY_FLAG | REARG_FLAG) && source[7].length <= source[8] && bitmask == CURRY_FLAG;if(!(isCommon || isCombo)){return data;}if(srcBitmask & BIND_FLAG){data[2] = source[2];newBitmask |= bitmask & BIND_FLAG?0:CURRY_BOUND_FLAG;}var value=source[3];if(value){var partials=data[3];data[3] = partials?composeArgs(partials,value,source[4]):copyArray(value);data[4] = partials?replaceHolders(data[3],PLACEHOLDER):copyArray(source[4]);}value = source[5];if(value){partials = data[5];data[5] = partials?composeArgsRight(partials,value,source[6]):copyArray(value);data[6] = partials?replaceHolders(data[5],PLACEHOLDER):copyArray(source[6]);}value = source[7];if(value){data[7] = copyArray(value);}if(srcBitmask & ARY_FLAG){data[8] = data[8] == null?source[8]:nativeMin(data[8],source[8]);}if(data[9] == null){data[9] = source[9];}data[0] = source[0];data[1] = newBitmask;return data;}function mergeDefaults(objValue,srcValue,key,object,source,stack){if(isObject(objValue) && isObject(srcValue)){stack.set(srcValue,objValue);baseMerge(objValue,srcValue,undefined,mergeDefaults,stack);}return objValue;}function parent(object,path){return path.length == 1?object:get(object,baseSlice(path,0,-1));}function reorder(array,indexes){var arrLength=array.length,length=nativeMin(indexes.length,arrLength),oldArray=copyArray(array);while(length--) {var index=indexes[length];array[length] = isIndex(index,arrLength)?oldArray[index]:undefined;}return array;}var setData=(function(){var count=0,lastCalled=0;return function(key,value){var stamp=now(),remaining=HOT_SPAN - (stamp - lastCalled);lastCalled = stamp;if(remaining > 0){if(++count >= HOT_COUNT){return key;}}else {count = 0;}return baseSetData(key,value);};})();function stringToPath(string){var result=[];toString(string).replace(rePropName,function(match,number,quote,string){result.push(quote?string.replace(reEscapeChar,"$1"):number || match);});return result;}function toArrayLikeObject(value){return isArrayLikeObject(value)?value:[];}function toFunction(value){return typeof value == "function"?value:identity;}function wrapperClone(wrapper){if(wrapper instanceof LazyWrapper){return wrapper.clone();}var result=new LodashWrapper(wrapper.__wrapped__,wrapper.__chain__);result.__actions__ = copyArray(wrapper.__actions__);result.__index__ = wrapper.__index__;result.__values__ = wrapper.__values__;return result;}function chunk(array,size){size = nativeMax(toInteger(size),0);var length=array?array.length:0;if(!length || size < 1){return [];}var index=0,resIndex=-1,result=Array(nativeCeil(length / size));while(index < length) {result[++resIndex] = baseSlice(array,index,index += size);}return result;}function compact(array){var index=-1,length=array?array.length:0,resIndex=-1,result=[];while(++index < length) {var value=array[index];if(value){result[++resIndex] = value;}}return result;}var concat=rest(function(array,values){if(!isArray(array)){array = array == null?[]:[Object(array)];}values = baseFlatten(values);return arrayConcat(array,values);});var difference=rest(function(array,values){return isArrayLikeObject(array)?baseDifference(array,baseFlatten(values,false,true)):[];});var differenceBy=rest(function(array,values){var iteratee=last(values);if(isArrayLikeObject(iteratee)){iteratee = undefined;}return isArrayLikeObject(array)?baseDifference(array,baseFlatten(values,false,true),getIteratee(iteratee)):[];});var differenceWith=rest(function(array,values){var comparator=last(values);if(isArrayLikeObject(comparator)){comparator = undefined;}return isArrayLikeObject(array)?baseDifference(array,baseFlatten(values,false,true),undefined,comparator):[];});function drop(array,n,guard){var length=array?array.length:0;if(!length){return [];}n = guard || n === undefined?1:toInteger(n);return baseSlice(array,n < 0?0:n,length);}function dropRight(array,n,guard){var length=array?array.length:0;if(!length){return [];}n = guard || n === undefined?1:toInteger(n);n = length - n;return baseSlice(array,0,n < 0?0:n);}function dropRightWhile(array,predicate){return array && array.length?baseWhile(array,getIteratee(predicate,3),true,true):[];}function dropWhile(array,predicate){return array && array.length?baseWhile(array,getIteratee(predicate,3),true):[];}function fill(array,value,start,end){var length=array?array.length:0;if(!length){return [];}if(start && typeof start != "number" && isIterateeCall(array,value,start)){start = 0;end = length;}return baseFill(array,value,start,end);}function findIndex(array,predicate){return array && array.length?baseFindIndex(array,getIteratee(predicate,3)):-1;}function findLastIndex(array,predicate){return array && array.length?baseFindIndex(array,getIteratee(predicate,3),true):-1;}function flatten(array){var length=array?array.length:0;return length?baseFlatten(array):[];}function flattenDeep(array){var length=array?array.length:0;return length?baseFlatten(array,true):[];}function fromPairs(pairs){var index=-1,length=pairs?pairs.length:0,result={};while(++index < length) {var pair=pairs[index];result[pair[0]] = pair[1];}return result;}function head(array){return array?array[0]:undefined;}function indexOf(array,value,fromIndex){var length=array?array.length:0;if(!length){return -1;}fromIndex = toInteger(fromIndex);if(fromIndex < 0){fromIndex = nativeMax(length + fromIndex,0);}return baseIndexOf(array,value,fromIndex);}function initial(array){return dropRight(array,1);}var intersection=rest(function(arrays){var mapped=arrayMap(arrays,toArrayLikeObject);return mapped.length && mapped[0] === arrays[0]?baseIntersection(mapped):[];});var intersectionBy=rest(function(arrays){var iteratee=last(arrays),mapped=arrayMap(arrays,toArrayLikeObject);if(iteratee === last(mapped)){iteratee = undefined;}else {mapped.pop();}return mapped.length && mapped[0] === arrays[0]?baseIntersection(mapped,getIteratee(iteratee)):[];});var intersectionWith=rest(function(arrays){var comparator=last(arrays),mapped=arrayMap(arrays,toArrayLikeObject);if(comparator === last(mapped)){comparator = undefined;}else {mapped.pop();}return mapped.length && mapped[0] === arrays[0]?baseIntersection(mapped,undefined,comparator):[];});function join(array,separator){return array?nativeJoin.call(array,separator):"";}function last(array){var length=array?array.length:0;return length?array[length - 1]:undefined;}function lastIndexOf(array,value,fromIndex){var length=array?array.length:0;if(!length){return -1;}var index=length;if(fromIndex !== undefined){index = toInteger(fromIndex);index = (index < 0?nativeMax(length + index,0):nativeMin(index,length - 1)) + 1;}if(value !== value){return indexOfNaN(array,index,true);}while(index--) {if(array[index] === value){return index;}}return -1;}var pull=rest(pullAll);function pullAll(array,values){return array && array.length && values && values.length?basePullAll(array,values):array;}function pullAllBy(array,values,iteratee){return array && array.length && values && values.length?basePullAllBy(array,values,getIteratee(iteratee)):array;}var pullAt=rest(function(array,indexes){indexes = arrayMap(baseFlatten(indexes),String);var result=baseAt(array,indexes);basePullAt(array,indexes.sort(compareAscending));return result;});function remove(array,predicate){var result=[];if(!(array && array.length)){return result;}var index=-1,indexes=[],length=array.length;predicate = getIteratee(predicate,3);while(++index < length) {var value=array[index];if(predicate(value,index,array)){result.push(value);indexes.push(index);}}basePullAt(array,indexes);return result;}function reverse(array){return array?nativeReverse.call(array):array;}function slice(array,start,end){var length=array?array.length:0;if(!length){return [];}if(end && typeof end != "number" && isIterateeCall(array,start,end)){start = 0;end = length;}else {start = start == null?0:toInteger(start);end = end === undefined?length:toInteger(end);}return baseSlice(array,start,end);}function sortedIndex(array,value){return baseSortedIndex(array,value);}function sortedIndexBy(array,value,iteratee){return baseSortedIndexBy(array,value,getIteratee(iteratee));}function sortedIndexOf(array,value){var length=array?array.length:0;if(length){var index=baseSortedIndex(array,value);if(index < length && eq(array[index],value)){return index;}}return -1;}function sortedLastIndex(array,value){return baseSortedIndex(array,value,true);}function sortedLastIndexBy(array,value,iteratee){return baseSortedIndexBy(array,value,getIteratee(iteratee),true);}function sortedLastIndexOf(array,value){var length=array?array.length:0;if(length){var index=baseSortedIndex(array,value,true) - 1;if(eq(array[index],value)){return index;}}return -1;}function sortedUniq(array){return array && array.length?baseSortedUniq(array):[];}function sortedUniqBy(array,iteratee){return array && array.length?baseSortedUniqBy(array,getIteratee(iteratee)):[];}function tail(array){return drop(array,1);}function take(array,n,guard){if(!(array && array.length)){return [];}n = guard || n === undefined?1:toInteger(n);return baseSlice(array,0,n < 0?0:n);}function takeRight(array,n,guard){var length=array?array.length:0;if(!length){return [];}n = guard || n === undefined?1:toInteger(n);n = length - n;return baseSlice(array,n < 0?0:n,length);}function takeRightWhile(array,predicate){return array && array.length?baseWhile(array,getIteratee(predicate,3),false,true):[];}function takeWhile(array,predicate){return array && array.length?baseWhile(array,getIteratee(predicate,3)):[];}var union=rest(function(arrays){return baseUniq(baseFlatten(arrays,false,true));});var unionBy=rest(function(arrays){var iteratee=last(arrays);if(isArrayLikeObject(iteratee)){iteratee = undefined;}return baseUniq(baseFlatten(arrays,false,true),getIteratee(iteratee));});var unionWith=rest(function(arrays){var comparator=last(arrays);if(isArrayLikeObject(comparator)){comparator = undefined;}return baseUniq(baseFlatten(arrays,false,true),undefined,comparator);});function uniq(array){return array && array.length?baseUniq(array):[];}function uniqBy(array,iteratee){return array && array.length?baseUniq(array,getIteratee(iteratee)):[];}function uniqWith(array,comparator){return array && array.length?baseUniq(array,undefined,comparator):[];}function unzip(array){if(!(array && array.length)){return [];}var length=0;array = arrayFilter(array,function(group){if(isArrayLikeObject(group)){length = nativeMax(group.length,length);return true;}});return baseTimes(length,function(index){return arrayMap(array,baseProperty(index));});}function unzipWith(array,iteratee){if(!(array && array.length)){return [];}var result=unzip(array);if(iteratee == null){return result;}return arrayMap(result,function(group){return apply(iteratee,undefined,group);});}var without=rest(function(array,values){return isArrayLikeObject(array)?baseDifference(array,values):[];});var xor=rest(function(arrays){return baseXor(arrayFilter(arrays,isArrayLikeObject));});var xorBy=rest(function(arrays){var iteratee=last(arrays);if(isArrayLikeObject(iteratee)){iteratee = undefined;}return baseXor(arrayFilter(arrays,isArrayLikeObject),getIteratee(iteratee));});var xorWith=rest(function(arrays){var comparator=last(arrays);if(isArrayLikeObject(comparator)){comparator = undefined;}return baseXor(arrayFilter(arrays,isArrayLikeObject),undefined,comparator);});var zip=rest(unzip);function zipObject(props,values){return baseZipObject(props || [],values || [],assignValue);}function zipObjectDeep(props,values){return baseZipObject(props || [],values || [],baseSet);}var zipWith=rest(function(arrays){var length=arrays.length,iteratee=length > 1?arrays[length - 1]:undefined;iteratee = typeof iteratee == "function"?(arrays.pop(),iteratee):undefined;return unzipWith(arrays,iteratee);});function chain(value){var result=lodash(value);result.__chain__ = true;return result;}function tap(value,interceptor){interceptor(value);return value;}function thru(value,interceptor){return interceptor(value);}var wrapperAt=rest(function(paths){paths = baseFlatten(paths);var length=paths.length,start=length?paths[0]:0,value=this.__wrapped__,interceptor=function interceptor(object){return baseAt(object,paths);};if(length > 1 || this.__actions__.length || !(value instanceof LazyWrapper) || !isIndex(start)){return this.thru(interceptor);}value = value.slice(start,+start + (length?1:0));value.__actions__.push({func:thru,args:[interceptor],thisArg:undefined});return new LodashWrapper(value,this.__chain__).thru(function(array){if(length && !array.length){array.push(undefined);}return array;});});function wrapperChain(){return chain(this);}function wrapperCommit(){return new LodashWrapper(this.value(),this.__chain__);}function wrapperFlatMap(iteratee){return this.map(iteratee).flatten();}function wrapperNext(){if(this.__values__ === undefined){this.__values__ = toArray(this.value());}var done=this.__index__ >= this.__values__.length,value=done?undefined:this.__values__[this.__index__++];return {done:done,value:value};}function wrapperToIterator(){return this;}function wrapperPlant(value){var result,parent=this;while(parent instanceof baseLodash) {var clone=wrapperClone(parent);clone.__index__ = 0;clone.__values__ = undefined;if(result){previous.__wrapped__ = clone;}else {result = clone;}var previous=clone;parent = parent.__wrapped__;}previous.__wrapped__ = value;return result;}function wrapperReverse(){var value=this.__wrapped__;if(value instanceof LazyWrapper){var wrapped=value;if(this.__actions__.length){wrapped = new LazyWrapper(this);}wrapped = wrapped.reverse();wrapped.__actions__.push({func:thru,args:[reverse],thisArg:undefined});return new LodashWrapper(wrapped,this.__chain__);}return this.thru(reverse);}function wrapperValue(){return baseWrapperValue(this.__wrapped__,this.__actions__);}var countBy=createAggregator(function(result,value,key){hasOwnProperty.call(result,key)?++result[key]:result[key] = 1;});function every(collection,predicate,guard){var func=isArray(collection)?arrayEvery:baseEvery;if(guard && isIterateeCall(collection,predicate,guard)){predicate = undefined;}return func(collection,getIteratee(predicate,3));}function filter(collection,predicate){var func=isArray(collection)?arrayFilter:baseFilter;return func(collection,getIteratee(predicate,3));}function find(collection,predicate){predicate = getIteratee(predicate,3);if(isArray(collection)){var index=baseFindIndex(collection,predicate);return index > -1?collection[index]:undefined;}return baseFind(collection,predicate,baseEach);}function findLast(collection,predicate){predicate = getIteratee(predicate,3);if(isArray(collection)){var index=baseFindIndex(collection,predicate,true);return index > -1?collection[index]:undefined;}return baseFind(collection,predicate,baseEachRight);}function flatMap(collection,iteratee){return baseFlatten(map(collection,iteratee));}function forEach(collection,iteratee){return typeof iteratee == "function" && isArray(collection)?arrayEach(collection,iteratee):baseEach(collection,toFunction(iteratee));}function forEachRight(collection,iteratee){return typeof iteratee == "function" && isArray(collection)?arrayEachRight(collection,iteratee):baseEachRight(collection,toFunction(iteratee));}var groupBy=createAggregator(function(result,value,key){if(hasOwnProperty.call(result,key)){result[key].push(value);}else {result[key] = [value];}});function includes(collection,value,fromIndex,guard){collection = isArrayLike(collection)?collection:values(collection);fromIndex = fromIndex && !guard?toInteger(fromIndex):0;var length=collection.length;if(fromIndex < 0){fromIndex = nativeMax(length + fromIndex,0);}return isString(collection)?fromIndex <= length && collection.indexOf(value,fromIndex) > -1:!!length && baseIndexOf(collection,value,fromIndex) > -1;}var invokeMap=rest(function(collection,path,args){var index=-1,isFunc=typeof path == "function",isProp=isKey(path),result=isArrayLike(collection)?Array(collection.length):[];baseEach(collection,function(value){var func=isFunc?path:isProp && value != null?value[path]:undefined;result[++index] = func?apply(func,value,args):baseInvoke(value,path,args);});return result;});var keyBy=createAggregator(function(result,value,key){result[key] = value;});function map(collection,iteratee){var func=isArray(collection)?arrayMap:baseMap;return func(collection,getIteratee(iteratee,3));}function orderBy(collection,iteratees,orders,guard){if(collection == null){return [];}if(!isArray(iteratees)){iteratees = iteratees == null?[]:[iteratees];}orders = guard?undefined:orders;if(!isArray(orders)){orders = orders == null?[]:[orders];}return baseOrderBy(collection,iteratees,orders);}var partition=createAggregator(function(result,value,key){result[key?0:1].push(value);},function(){return [[],[]];});function reduce(collection,iteratee,accumulator){var func=isArray(collection)?arrayReduce:baseReduce,initAccum=arguments.length < 3;return func(collection,getIteratee(iteratee,4),accumulator,initAccum,baseEach);}function reduceRight(collection,iteratee,accumulator){var func=isArray(collection)?arrayReduceRight:baseReduce,initAccum=arguments.length < 3;return func(collection,getIteratee(iteratee,4),accumulator,initAccum,baseEachRight);}function reject(collection,predicate){var func=isArray(collection)?arrayFilter:baseFilter;predicate = getIteratee(predicate,3);return func(collection,function(value,index,collection){return !predicate(value,index,collection);});}function sample(collection){var array=isArrayLike(collection)?collection:values(collection),length=array.length;return length > 0?array[baseRandom(0,length - 1)]:undefined;}function sampleSize(collection,n){var index=-1,result=toArray(collection),length=result.length,lastIndex=length - 1;n = baseClamp(toInteger(n),0,length);while(++index < n) {var rand=baseRandom(index,lastIndex),value=result[rand];result[rand] = result[index];result[index] = value;}result.length = n;return result;}function shuffle(collection){return sampleSize(collection,MAX_ARRAY_LENGTH);}function size(collection){if(collection == null){return 0;}if(isArrayLike(collection)){var result=collection.length;return result && isString(collection)?stringSize(collection):result;}return keys(collection).length;}function some(collection,predicate,guard){var func=isArray(collection)?arraySome:baseSome;if(guard && isIterateeCall(collection,predicate,guard)){predicate = undefined;}return func(collection,getIteratee(predicate,3));}var sortBy=rest(function(collection,iteratees){if(collection == null){return [];}var length=iteratees.length;if(length > 1 && isIterateeCall(collection,iteratees[0],iteratees[1])){iteratees = [];}else if(length > 2 && isIterateeCall(iteratees[0],iteratees[1],iteratees[2])){iteratees.length = 1;}return baseOrderBy(collection,baseFlatten(iteratees),[]);});var now=Date.now;function after(n,func){if(typeof func != "function"){throw new TypeError(FUNC_ERROR_TEXT);}n = toInteger(n);return function(){if(--n < 1){return func.apply(this,arguments);}};}function ary(func,n,guard){n = guard?undefined:n;n = func && n == null?func.length:n;return createWrapper(func,ARY_FLAG,undefined,undefined,undefined,undefined,n);}function before(n,func){var result;if(typeof func != "function"){throw new TypeError(FUNC_ERROR_TEXT);}n = toInteger(n);return function(){if(--n > 0){result = func.apply(this,arguments);}if(n <= 1){func = undefined;}return result;};}var bind=rest(function(func,thisArg,partials){var bitmask=BIND_FLAG;if(partials.length){var holders=replaceHolders(partials,bind.placeholder);bitmask |= PARTIAL_FLAG;}return createWrapper(func,bitmask,thisArg,partials,holders);});var bindKey=rest(function(object,key,partials){var bitmask=BIND_FLAG | BIND_KEY_FLAG;if(partials.length){var holders=replaceHolders(partials,bindKey.placeholder);bitmask |= PARTIAL_FLAG;}return createWrapper(key,bitmask,object,partials,holders);});function curry(func,arity,guard){arity = guard?undefined:arity;var result=createWrapper(func,CURRY_FLAG,undefined,undefined,undefined,undefined,undefined,arity);result.placeholder = curry.placeholder;return result;}function curryRight(func,arity,guard){arity = guard?undefined:arity;var result=createWrapper(func,CURRY_RIGHT_FLAG,undefined,undefined,undefined,undefined,undefined,arity);result.placeholder = curryRight.placeholder;return result;}function debounce(func,wait,options){var args,maxTimeoutId,result,stamp,thisArg,timeoutId,trailingCall,lastCalled=0,leading=false,maxWait=false,trailing=true;if(typeof func != "function"){throw new TypeError(FUNC_ERROR_TEXT);}wait = toNumber(wait) || 0;if(isObject(options)){leading = !!options.leading;maxWait = "maxWait" in options && nativeMax(toNumber(options.maxWait) || 0,wait);trailing = "trailing" in options?!!options.trailing:trailing;}function cancel(){if(timeoutId){clearTimeout(timeoutId);}if(maxTimeoutId){clearTimeout(maxTimeoutId);}lastCalled = 0;args = maxTimeoutId = thisArg = timeoutId = trailingCall = undefined;}function complete(isCalled,id){if(id){clearTimeout(id);}maxTimeoutId = timeoutId = trailingCall = undefined;if(isCalled){lastCalled = now();result = func.apply(thisArg,args);if(!timeoutId && !maxTimeoutId){args = thisArg = undefined;}}}function delayed(){var remaining=wait - (now() - stamp);if(remaining <= 0 || remaining > wait){complete(trailingCall,maxTimeoutId);}else {timeoutId = setTimeout(delayed,remaining);}}function flush(){if(timeoutId && trailingCall || maxTimeoutId && trailing){result = func.apply(thisArg,args);}cancel();return result;}function maxDelayed(){complete(trailing,timeoutId);}function debounced(){args = arguments;stamp = now();thisArg = this;trailingCall = trailing && (timeoutId || !leading);if(maxWait === false){var leadingCall=leading && !timeoutId;}else {if(!maxTimeoutId && !leading){lastCalled = stamp;}var remaining=maxWait - (stamp - lastCalled),isCalled=remaining <= 0 || remaining > maxWait;if(isCalled){if(maxTimeoutId){maxTimeoutId = clearTimeout(maxTimeoutId);}lastCalled = stamp;result = func.apply(thisArg,args);}else if(!maxTimeoutId){maxTimeoutId = setTimeout(maxDelayed,remaining);}}if(isCalled && timeoutId){timeoutId = clearTimeout(timeoutId);}else if(!timeoutId && wait !== maxWait){timeoutId = setTimeout(delayed,wait);}if(leadingCall){isCalled = true;result = func.apply(thisArg,args);}if(isCalled && !timeoutId && !maxTimeoutId){args = thisArg = undefined;}return result;}debounced.cancel = cancel;debounced.flush = flush;return debounced;}var defer=rest(function(func,args){return baseDelay(func,1,args);});var delay=rest(function(func,wait,args){return baseDelay(func,toNumber(wait) || 0,args);});function flip(func){return createWrapper(func,FLIP_FLAG);}function memoize(func,resolver){if(typeof func != "function" || resolver && typeof resolver != "function"){throw new TypeError(FUNC_ERROR_TEXT);}var memoized=function memoized(){var args=arguments,key=resolver?resolver.apply(this,args):args[0],cache=memoized.cache;if(cache.has(key)){return cache.get(key);}var result=func.apply(this,args);memoized.cache = cache.set(key,result);return result;};memoized.cache = new memoize.Cache();return memoized;}function negate(predicate){if(typeof predicate != "function"){throw new TypeError(FUNC_ERROR_TEXT);}return function(){return !predicate.apply(this,arguments);};}function once(func){return before(2,func);}var overArgs=rest(function(func,transforms){transforms = arrayMap(baseFlatten(transforms),getIteratee());var funcsLength=transforms.length;return rest(function(args){var index=-1,length=nativeMin(args.length,funcsLength);while(++index < length) {args[index] = transforms[index].call(this,args[index]);}return apply(func,this,args);});});var partial=rest(function(func,partials){var holders=replaceHolders(partials,partial.placeholder);return createWrapper(func,PARTIAL_FLAG,undefined,partials,holders);});var partialRight=rest(function(func,partials){var holders=replaceHolders(partials,partialRight.placeholder);return createWrapper(func,PARTIAL_RIGHT_FLAG,undefined,partials,holders);});var rearg=rest(function(func,indexes){return createWrapper(func,REARG_FLAG,undefined,undefined,undefined,baseFlatten(indexes));});function rest(func,start){if(typeof func != "function"){throw new TypeError(FUNC_ERROR_TEXT);}start = nativeMax(start === undefined?func.length - 1:toInteger(start),0);return function(){var args=arguments,index=-1,length=nativeMax(args.length - start,0),array=Array(length);while(++index < length) {array[index] = args[start + index];}switch(start){case 0:return func.call(this,array);case 1:return func.call(this,args[0],array);case 2:return func.call(this,args[0],args[1],array);}var otherArgs=Array(start + 1);index = -1;while(++index < start) {otherArgs[index] = args[index];}otherArgs[start] = array;return apply(func,this,otherArgs);};}function spread(func,start){if(typeof func != "function"){throw new TypeError(FUNC_ERROR_TEXT);}start = start === undefined?0:nativeMax(toInteger(start),0);return rest(function(args){var array=args[start],otherArgs=args.slice(0,start);if(array){arrayPush(otherArgs,array);}return apply(func,this,otherArgs);});}function throttle(func,wait,options){var leading=true,trailing=true;if(typeof func != "function"){throw new TypeError(FUNC_ERROR_TEXT);}if(isObject(options)){leading = "leading" in options?!!options.leading:leading;trailing = "trailing" in options?!!options.trailing:trailing;}return debounce(func,wait,{leading:leading,maxWait:wait,trailing:trailing});}function unary(func){return ary(func,1);}function wrap(value,wrapper){wrapper = wrapper == null?identity:wrapper;return partial(wrapper,value);}function clone(value){return baseClone(value);}function cloneWith(value,customizer){return baseClone(value,false,customizer);}function cloneDeep(value){return baseClone(value,true);}function cloneDeepWith(value,customizer){return baseClone(value,true,customizer);}function eq(value,other){return value === other || value !== value && other !== other;}function gt(value,other){return value > other;}function gte(value,other){return value >= other;}function isArguments(value){return isArrayLikeObject(value) && hasOwnProperty.call(value,"callee") && (!propertyIsEnumerable.call(value,"callee") || objectToString.call(value) == argsTag);}var isArray=Array.isArray;function isArrayLike(value){return value != null && !(typeof value == "function" && isFunction(value)) && isLength(getLength(value));}function isArrayLikeObject(value){return isObjectLike(value) && isArrayLike(value);}function isBoolean(value){return value === true || value === false || isObjectLike(value) && objectToString.call(value) == boolTag;}function isDate(value){return isObjectLike(value) && objectToString.call(value) == dateTag;}function isElement(value){return !!value && value.nodeType === 1 && isObjectLike(value) && !isPlainObject(value);}function isEmpty(value){if(isArrayLike(value) && (isArray(value) || isString(value) || isFunction(value.splice) || isArguments(value))){return !value.length;}for(var key in value) {if(hasOwnProperty.call(value,key)){return false;}}return true;}function isEqual(value,other){return baseIsEqual(value,other);}function isEqualWith(value,other,customizer){customizer = typeof customizer == "function"?customizer:undefined;var result=customizer?customizer(value,other):undefined;return result === undefined?baseIsEqual(value,other,customizer):!!result;}function isError(value){return isObjectLike(value) && typeof value.message == "string" && objectToString.call(value) == errorTag;}function isFinite(value){return typeof value == "number" && nativeIsFinite(value);}function isFunction(value){var tag=isObject(value)?objectToString.call(value):"";return tag == funcTag || tag == genTag;}function isInteger(value){return typeof value == "number" && value == toInteger(value);}function isLength(value){return typeof value == "number" && value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;}function isObject(value){var type=typeof value;return !!value && (type == "object" || type == "function");}function isObjectLike(value){return !!value && typeof value == "object";}function isMatch(object,source){return object === source || baseIsMatch(object,source,getMatchData(source));}function isMatchWith(object,source,customizer){customizer = typeof customizer == "function"?customizer:undefined;return baseIsMatch(object,source,getMatchData(source),customizer);}function isNaN(value){return isNumber(value) && value != +value;}function isNative(value){if(value == null){return false;}if(isFunction(value)){return reIsNative.test(funcToString.call(value));}return isObjectLike(value) && (isHostObject(value)?reIsNative:reIsHostCtor).test(value);}function isNull(value){return value === null;}function isNil(value){return value == null;}function isNumber(value){return typeof value == "number" || isObjectLike(value) && objectToString.call(value) == numberTag;}function isPlainObject(value){if(!isObjectLike(value) || objectToString.call(value) != objectTag || isHostObject(value)){return false;}var proto=objectProto;if(typeof value.constructor == "function"){proto = getPrototypeOf(value);}if(proto === null){return true;}var Ctor=proto.constructor;return typeof Ctor == "function" && Ctor instanceof Ctor && funcToString.call(Ctor) == objectCtorString;}function isRegExp(value){return isObject(value) && objectToString.call(value) == regexpTag;}function isSafeInteger(value){return isInteger(value) && value >= -MAX_SAFE_INTEGER && value <= MAX_SAFE_INTEGER;}function isString(value){return typeof value == "string" || !isArray(value) && isObjectLike(value) && objectToString.call(value) == stringTag;}function isSymbol(value){return typeof value == "symbol" || isObjectLike(value) && objectToString.call(value) == symbolTag;}function isTypedArray(value){return isObjectLike(value) && isLength(value.length) && !!typedArrayTags[objectToString.call(value)];}function isUndefined(value){return value === undefined;}function lt(value,other){return value < other;}function lte(value,other){return value <= other;}function toArray(value){if(!value){return [];}if(isArrayLike(value)){return isString(value)?stringToArray(value):copyArray(value);}if(iteratorSymbol && value[iteratorSymbol]){return iteratorToArray(value[iteratorSymbol]());}var tag=getTag(value),func=tag == mapTag?mapToArray:tag == setTag?setToArray:values;return func(value);}function toInteger(value){if(!value){return value === 0?value:0;}value = toNumber(value);if(value === INFINITY || value === -INFINITY){var sign=value < 0?-1:1;return sign * MAX_INTEGER;}var remainder=value % 1;return value === value?remainder?value - remainder:value:0;}function toLength(value){return value?baseClamp(toInteger(value),0,MAX_ARRAY_LENGTH):0;}function toNumber(value){if(isObject(value)){var other=isFunction(value.valueOf)?value.valueOf():value;value = isObject(other)?other + "":other;}if(typeof value != "string"){return value === 0?value:+value;}value = value.replace(reTrim,"");var isBinary=reIsBinary.test(value);return isBinary || reIsOctal.test(value)?freeParseInt(value.slice(2),isBinary?2:8):reIsBadHex.test(value)?NAN:+value;}function toPlainObject(value){return copyObject(value,keysIn(value));}function toSafeInteger(value){return baseClamp(toInteger(value),-MAX_SAFE_INTEGER,MAX_SAFE_INTEGER);}function toString(value){if(typeof value == "string"){return value;}if(value == null){return "";}if(isSymbol(value)){return Symbol?symbolToString.call(value):"";}var result=value + "";return result == "0" && 1 / value == -INFINITY?"-0":result;}var assign=createAssigner(function(object,source){copyObject(source,keys(source),object);});var assignIn=createAssigner(function(object,source){copyObject(source,keysIn(source),object);});var assignInWith=createAssigner(function(object,source,srcIndex,customizer){copyObjectWith(source,keysIn(source),object,customizer);});var assignWith=createAssigner(function(object,source,srcIndex,customizer){copyObjectWith(source,keys(source),object,customizer);});var at=rest(function(object,paths){return baseAt(object,baseFlatten(paths));});function create(prototype,properties){var result=baseCreate(prototype);return properties?baseAssign(result,properties):result;}var defaults=rest(function(args){args.push(undefined,assignInDefaults);return apply(assignInWith,undefined,args);});var defaultsDeep=rest(function(args){args.push(undefined,mergeDefaults);return apply(mergeWith,undefined,args);});function findKey(object,predicate){return baseFind(object,getIteratee(predicate,3),baseForOwn,true);}function findLastKey(object,predicate){return baseFind(object,getIteratee(predicate,3),baseForOwnRight,true);}function forIn(object,iteratee){return object == null?object:baseFor(object,toFunction(iteratee),keysIn);}function forInRight(object,iteratee){return object == null?object:baseForRight(object,toFunction(iteratee),keysIn);}function forOwn(object,iteratee){return object && baseForOwn(object,toFunction(iteratee));}function forOwnRight(object,iteratee){return object && baseForOwnRight(object,toFunction(iteratee));}function functions(object){return object == null?[]:baseFunctions(object,keys(object));}function functionsIn(object){return object == null?[]:baseFunctions(object,keysIn(object));}function get(object,path,defaultValue){var result=object == null?undefined:baseGet(object,path);return result === undefined?defaultValue:result;}function has(object,path){return hasPath(object,path,baseHas);}function hasIn(object,path){return hasPath(object,path,baseHasIn);}var invert=createInverter(function(result,value,key){result[value] = key;},constant(identity));var invertBy=createInverter(function(result,value,key){if(hasOwnProperty.call(result,value)){result[value].push(key);}else {result[value] = [key];}},getIteratee);var invoke=rest(baseInvoke);function keys(object){var isProto=isPrototype(object);if(!(isProto || isArrayLike(object))){return baseKeys(object);}var indexes=indexKeys(object),skipIndexes=!!indexes,result=indexes || [],length=result.length;for(var key in object) {if(baseHas(object,key) && !(skipIndexes && (key == "length" || isIndex(key,length))) && !(isProto && key == "constructor")){result.push(key);}}return result;}function keysIn(object){var index=-1,isProto=isPrototype(object),props=baseKeysIn(object),propsLength=props.length,indexes=indexKeys(object),skipIndexes=!!indexes,result=indexes || [],length=result.length;while(++index < propsLength) {var key=props[index];if(!(skipIndexes && (key == "length" || isIndex(key,length))) && !(key == "constructor" && (isProto || !hasOwnProperty.call(object,key)))){result.push(key);}}return result;}function mapKeys(object,iteratee){var result={};iteratee = getIteratee(iteratee,3);baseForOwn(object,function(value,key,object){result[iteratee(value,key,object)] = value;});return result;}function mapValues(object,iteratee){var result={};iteratee = getIteratee(iteratee,3);baseForOwn(object,function(value,key,object){result[key] = iteratee(value,key,object);});return result;}var merge=createAssigner(function(object,source,srcIndex){baseMerge(object,source,srcIndex);});var mergeWith=createAssigner(function(object,source,srcIndex,customizer){baseMerge(object,source,srcIndex,customizer);});var omit=rest(function(object,props){if(object == null){return {};}props = arrayMap(baseFlatten(props),String);return basePick(object,baseDifference(keysIn(object),props));});function omitBy(object,predicate){predicate = getIteratee(predicate,2);return basePickBy(object,function(value,key){return !predicate(value,key);});}var pick=rest(function(object,props){return object == null?{}:basePick(object,baseFlatten(props));});function pickBy(object,predicate){return object == null?{}:basePickBy(object,getIteratee(predicate,2));}function result(object,path,defaultValue){if(!isKey(path,object)){path = baseToPath(path);var result=get(object,path);object = parent(object,path);}else {result = object == null?undefined:object[path];}if(result === undefined){result = defaultValue;}return isFunction(result)?result.call(object):result;}function set(object,path,value){return object == null?object:baseSet(object,path,value);}function setWith(object,path,value,customizer){customizer = typeof customizer == "function"?customizer:undefined;return object == null?object:baseSet(object,path,value,customizer);}function toPairs(object){return baseToPairs(object,keys(object));}function toPairsIn(object){return baseToPairs(object,keysIn(object));}function transform(object,iteratee,accumulator){var isArr=isArray(object) || isTypedArray(object);iteratee = getIteratee(iteratee,4);if(accumulator == null){if(isArr || isObject(object)){var Ctor=object.constructor;if(isArr){accumulator = isArray(object)?new Ctor():[];}else {accumulator = baseCreate(isFunction(Ctor)?Ctor.prototype:undefined);}}else {accumulator = {};}}(isArr?arrayEach:baseForOwn)(object,function(value,index,object){return iteratee(accumulator,value,index,object);});return accumulator;}function unset(object,path){return object == null?true:baseUnset(object,path);}function values(object){return object?baseValues(object,keys(object)):[];}function valuesIn(object){return object == null?baseValues(object,keysIn(object)):[];}function clamp(number,lower,upper){if(upper === undefined){upper = lower;lower = undefined;}if(upper !== undefined){upper = toNumber(upper);upper = upper === upper?upper:0;}if(lower !== undefined){lower = toNumber(lower);lower = lower === lower?lower:0;}return baseClamp(toNumber(number),lower,upper);}function inRange(number,start,end){start = toNumber(start) || 0;if(end === undefined){end = start;start = 0;}else {end = toNumber(end) || 0;}number = toNumber(number);return baseInRange(number,start,end);}function random(lower,upper,floating){if(floating && typeof floating != "boolean" && isIterateeCall(lower,upper,floating)){upper = floating = undefined;}if(floating === undefined){if(typeof upper == "boolean"){floating = upper;upper = undefined;}else if(typeof lower == "boolean"){floating = lower;lower = undefined;}}if(lower === undefined && upper === undefined){lower = 0;upper = 1;}else {lower = toNumber(lower) || 0;if(upper === undefined){upper = lower;lower = 0;}else {upper = toNumber(upper) || 0;}}if(lower > upper){var temp=lower;lower = upper;upper = temp;}if(floating || lower % 1 || upper % 1){var rand=nativeRandom();return nativeMin(lower + rand * (upper - lower + freeParseFloat("1e-" + ((rand + "").length - 1))),upper);}return baseRandom(lower,upper);}var camelCase=createCompounder(function(result,word,index){word = word.toLowerCase();return result + (index?capitalize(word):word);});function capitalize(string){return upperFirst(toString(string).toLowerCase());}function deburr(string){string = toString(string);return string && string.replace(reLatin1,deburrLetter).replace(reComboMark,"");}function endsWith(string,target,position){string = toString(string);target = typeof target == "string"?target:target + "";var length=string.length;position = position === undefined?length:baseClamp(toInteger(position),0,length);position -= target.length;return position >= 0 && string.indexOf(target,position) == position;}function escape(string){string = toString(string);return string && reHasUnescapedHtml.test(string)?string.replace(reUnescapedHtml,escapeHtmlChar):string;}function escapeRegExp(string){string = toString(string);return string && reHasRegExpChar.test(string)?string.replace(reRegExpChar,"\\$&"):string;}var kebabCase=createCompounder(function(result,word,index){return result + (index?"-":"") + word.toLowerCase();});var lowerCase=createCompounder(function(result,word,index){return result + (index?" ":"") + word.toLowerCase();});var lowerFirst=createCaseFirst("toLowerCase");var upperFirst=createCaseFirst("toUpperCase");function pad(string,length,chars){string = toString(string);length = toInteger(length);var strLength=stringSize(string);if(!length || strLength >= length){return string;}var mid=(length - strLength) / 2,leftLength=nativeFloor(mid),rightLength=nativeCeil(mid);return createPadding("",leftLength,chars) + string + createPadding("",rightLength,chars);}function padEnd(string,length,chars){string = toString(string);return string + createPadding(string,length,chars);}function padStart(string,length,chars){string = toString(string);return createPadding(string,length,chars) + string;}function parseInt(string,radix,guard){if(guard || radix == null){radix = 0;}else if(radix){radix = +radix;}string = toString(string).replace(reTrim,"");return nativeParseInt(string,radix || (reHasHexPrefix.test(string)?16:10));}function repeat(string,n){string = toString(string);n = toInteger(n);var result="";if(!string || n < 1 || n > MAX_SAFE_INTEGER){return result;}do {if(n % 2){result += string;}n = nativeFloor(n / 2);string += string;}while(n);return result;}function replace(){var args=arguments,string=toString(args[0]);return args.length < 3?string:string.replace(args[1],args[2]);}var snakeCase=createCompounder(function(result,word,index){return result + (index?"_":"") + word.toLowerCase();});function split(string,separator,limit){return toString(string).split(separator,limit);}var startCase=createCompounder(function(result,word,index){return result + (index?" ":"") + capitalize(word);});function startsWith(string,target,position){string = toString(string);position = baseClamp(toInteger(position),0,string.length);return string.lastIndexOf(target,position) == position;}function template(string,options,guard){var settings=lodash.templateSettings;if(guard && isIterateeCall(string,options,guard)){options = undefined;}string = toString(string);options = assignInWith({},options,settings,assignInDefaults);var imports=assignInWith({},options.imports,settings.imports,assignInDefaults),importsKeys=keys(imports),importsValues=baseValues(imports,importsKeys);var isEscaping,isEvaluating,index=0,interpolate=options.interpolate || reNoMatch,source="__p += '";var reDelimiters=RegExp((options.escape || reNoMatch).source + "|" + interpolate.source + "|" + (interpolate === reInterpolate?reEsTemplate:reNoMatch).source + "|" + (options.evaluate || reNoMatch).source + "|$","g");var sourceURL="//# sourceURL=" + ("sourceURL" in options?options.sourceURL:"lodash.templateSources[" + ++templateCounter + "]") + "\n";string.replace(reDelimiters,function(match,escapeValue,interpolateValue,esTemplateValue,evaluateValue,offset){interpolateValue || (interpolateValue = esTemplateValue);source += string.slice(index,offset).replace(reUnescapedString,escapeStringChar);if(escapeValue){isEscaping = true;source += "' +\n__e(" + escapeValue + ") +\n'";}if(evaluateValue){isEvaluating = true;source += "';\n" + evaluateValue + ";\n__p += '";}if(interpolateValue){source += "' +\n((__t = (" + interpolateValue + ")) == null ? '' : __t) +\n'";}index = offset + match.length;return match;});source += "';\n";var variable=options.variable;if(!variable){source = "with (obj) {\n" + source + "\n}\n";}source = (isEvaluating?source.replace(reEmptyStringLeading,""):source).replace(reEmptyStringMiddle,"$1").replace(reEmptyStringTrailing,"$1;");source = "function(" + (variable || "obj") + ") {\n" + (variable?"":"obj || (obj = {});\n") + "var __t, __p = ''" + (isEscaping?", __e = _.escape":"") + (isEvaluating?", __j = Array.prototype.join;\n" + "function print() { __p += __j.call(arguments, '') }\n":";\n") + source + "return __p\n}";var result=attempt(function(){return Function(importsKeys,sourceURL + "return " + source).apply(undefined,importsValues);});result.source = source;if(isError(result)){throw result;}return result;}function toLower(value){return toString(value).toLowerCase();}function toUpper(value){return toString(value).toUpperCase();}function trim(string,chars,guard){string = toString(string);if(!string){return string;}if(guard || chars === undefined){return string.replace(reTrim,"");}chars = chars + "";if(!chars){return string;}var strSymbols=stringToArray(string),chrSymbols=stringToArray(chars);return strSymbols.slice(charsStartIndex(strSymbols,chrSymbols),charsEndIndex(strSymbols,chrSymbols) + 1).join("");}function trimEnd(string,chars,guard){string = toString(string);if(!string){return string;}if(guard || chars === undefined){return string.replace(reTrimEnd,"");}chars = chars + "";if(!chars){return string;}var strSymbols=stringToArray(string);return strSymbols.slice(0,charsEndIndex(strSymbols,stringToArray(chars)) + 1).join("");}function trimStart(string,chars,guard){string = toString(string);if(!string){return string;}if(guard || chars === undefined){return string.replace(reTrimStart,"");}chars = chars + "";if(!chars){return string;}var strSymbols=stringToArray(string);return strSymbols.slice(charsStartIndex(strSymbols,stringToArray(chars))).join("");}function truncate(string,options){var length=DEFAULT_TRUNC_LENGTH,omission=DEFAULT_TRUNC_OMISSION;if(isObject(options)){var separator="separator" in options?options.separator:separator;length = "length" in options?toInteger(options.length):length;omission = "omission" in options?toString(options.omission):omission;}string = toString(string);var strLength=string.length;if(reHasComplexSymbol.test(string)){var strSymbols=stringToArray(string);strLength = strSymbols.length;}if(length >= strLength){return string;}var end=length - stringSize(omission);if(end < 1){return omission;}var result=strSymbols?strSymbols.slice(0,end).join(""):string.slice(0,end);if(separator === undefined){return result + omission;}if(strSymbols){end += result.length - end;}if(isRegExp(separator)){if(string.slice(end).search(separator)){var match,substring=result;if(!separator.global){separator = RegExp(separator.source,toString(reFlags.exec(separator)) + "g");}separator.lastIndex = 0;while(match = separator.exec(substring)) {var newEnd=match.index;}result = result.slice(0,newEnd === undefined?end:newEnd);}}else if(string.indexOf(separator,end) != end){var index=result.lastIndexOf(separator);if(index > -1){result = result.slice(0,index);}}return result + omission;}function unescape(string){string = toString(string);return string && reHasEscapedHtml.test(string)?string.replace(reEscapedHtml,unescapeHtmlChar):string;}var upperCase=createCompounder(function(result,word,index){return result + (index?" ":"") + word.toUpperCase();});function words(string,pattern,guard){string = toString(string);pattern = guard?undefined:pattern;if(pattern === undefined){pattern = reHasComplexWord.test(string)?reComplexWord:reBasicWord;}return string.match(pattern) || [];}var attempt=rest(function(func,args){try{return apply(func,undefined,args);}catch(e) {return isObject(e)?e:new Error(e);}});var bindAll=rest(function(object,methodNames){arrayEach(baseFlatten(methodNames),function(key){object[key] = bind(object[key],object);});return object;});function cond(pairs){var length=pairs?pairs.length:0,toIteratee=getIteratee();pairs = !length?[]:arrayMap(pairs,function(pair){if(typeof pair[1] != "function"){throw new TypeError(FUNC_ERROR_TEXT);}return [toIteratee(pair[0]),pair[1]];});return rest(function(args){var index=-1;while(++index < length) {var pair=pairs[index];if(apply(pair[0],this,args)){return apply(pair[1],this,args);}}});}function conforms(source){return baseConforms(baseClone(source,true));}function constant(value){return function(){return value;};}var flow=createFlow();var flowRight=createFlow(true);function identity(value){return value;}function iteratee(func){return baseIteratee(typeof func == "function"?func:baseClone(func,true));}function matches(source){return baseMatches(baseClone(source,true));}function matchesProperty(path,srcValue){return baseMatchesProperty(path,baseClone(srcValue,true));}var method=rest(function(path,args){return function(object){return baseInvoke(object,path,args);};});var methodOf=rest(function(object,args){return function(path){return baseInvoke(object,path,args);};});function mixin(object,source,options){var props=keys(source),methodNames=baseFunctions(source,props);if(options == null && !(isObject(source) && (methodNames.length || !props.length))){options = source;source = object;object = this;methodNames = baseFunctions(source,keys(source));}var chain=isObject(options) && "chain" in options?options.chain:true,isFunc=isFunction(object);arrayEach(methodNames,function(methodName){var func=source[methodName];object[methodName] = func;if(isFunc){object.prototype[methodName] = function(){var chainAll=this.__chain__;if(chain || chainAll){var result=object(this.__wrapped__),actions=result.__actions__ = copyArray(this.__actions__);actions.push({func:func,args:arguments,thisArg:object});result.__chain__ = chainAll;return result;}return func.apply(object,arrayPush([this.value()],arguments));};}});return object;}function noConflict(){if(root._ === this){root._ = oldDash;}return this;}function noop(){}function nthArg(n){n = toInteger(n);return function(){return arguments[n];};}var over=createOver(arrayMap);var overEvery=createOver(arrayEvery);var overSome=createOver(arraySome);function property(path){return isKey(path)?baseProperty(path):basePropertyDeep(path);}function propertyOf(object){return function(path){return object == null?undefined:baseGet(object,path);};}var range=createRange();var rangeRight=createRange(true);function times(n,iteratee){n = toInteger(n);if(n < 1 || n > MAX_SAFE_INTEGER){return [];}var index=MAX_ARRAY_LENGTH,length=nativeMin(n,MAX_ARRAY_LENGTH);iteratee = toFunction(iteratee);n -= MAX_ARRAY_LENGTH;var result=baseTimes(length,iteratee);while(++index < n) {iteratee(index);}return result;}function toPath(value){return isArray(value)?arrayMap(value,String):stringToPath(value);}function uniqueId(prefix){var id=++idCounter;return toString(prefix) + id;}function add(augend,addend){var result;if(augend !== undefined){result = augend;}if(addend !== undefined){result = result === undefined?addend:result + addend;}return result;}var ceil=createRound("ceil");var floor=createRound("floor");function max(array){return array && array.length?baseExtremum(array,identity,gt):undefined;}function maxBy(array,iteratee){return array && array.length?baseExtremum(array,getIteratee(iteratee),gt):undefined;}function mean(array){return sum(array) / (array?array.length:0);}function min(array){return array && array.length?baseExtremum(array,identity,lt):undefined;}function minBy(array,iteratee){return array && array.length?baseExtremum(array,getIteratee(iteratee),lt):undefined;}var round=createRound("round");function subtract(minuend,subtrahend){var result;if(minuend !== undefined){result = minuend;}if(subtrahend !== undefined){result = result === undefined?subtrahend:result - subtrahend;}return result;}function sum(array){return array && array.length?baseSum(array,identity):0;}function sumBy(array,iteratee){return array && array.length?baseSum(array,getIteratee(iteratee)):0;}lodash.prototype = baseLodash.prototype;LodashWrapper.prototype = baseCreate(baseLodash.prototype);LodashWrapper.prototype.constructor = LodashWrapper;LazyWrapper.prototype = baseCreate(baseLodash.prototype);LazyWrapper.prototype.constructor = LazyWrapper;Hash.prototype = nativeCreate?nativeCreate(null):objectProto;MapCache.prototype.clear = mapClear;MapCache.prototype["delete"] = mapDelete;MapCache.prototype.get = mapGet;MapCache.prototype.has = mapHas;MapCache.prototype.set = mapSet;SetCache.prototype.push = cachePush;Stack.prototype.clear = stackClear;Stack.prototype["delete"] = stackDelete;Stack.prototype.get = stackGet;Stack.prototype.has = stackHas;Stack.prototype.set = stackSet;memoize.Cache = MapCache;lodash.after = after;lodash.ary = ary;lodash.assign = assign;lodash.assignIn = assignIn;lodash.assignInWith = assignInWith;lodash.assignWith = assignWith;lodash.at = at;lodash.before = before;lodash.bind = bind;lodash.bindAll = bindAll;lodash.bindKey = bindKey;lodash.chain = chain;lodash.chunk = chunk;lodash.compact = compact;lodash.concat = concat;lodash.cond = cond;lodash.conforms = conforms;lodash.constant = constant;lodash.countBy = countBy;lodash.create = create;lodash.curry = curry;lodash.curryRight = curryRight;lodash.debounce = debounce;lodash.defaults = defaults;lodash.defaultsDeep = defaultsDeep;lodash.defer = defer;lodash.delay = delay;lodash.difference = difference;lodash.differenceBy = differenceBy;lodash.differenceWith = differenceWith;lodash.drop = drop;lodash.dropRight = dropRight;lodash.dropRightWhile = dropRightWhile;lodash.dropWhile = dropWhile;lodash.fill = fill;lodash.filter = filter;lodash.flatMap = flatMap;lodash.flatten = flatten;lodash.flattenDeep = flattenDeep;lodash.flip = flip;lodash.flow = flow;lodash.flowRight = flowRight;lodash.fromPairs = fromPairs;lodash.functions = functions;lodash.functionsIn = functionsIn;lodash.groupBy = groupBy;lodash.initial = initial;lodash.intersection = intersection;lodash.intersectionBy = intersectionBy;lodash.intersectionWith = intersectionWith;lodash.invert = invert;lodash.invertBy = invertBy;lodash.invokeMap = invokeMap;lodash.iteratee = iteratee;lodash.keyBy = keyBy;lodash.keys = keys;lodash.keysIn = keysIn;lodash.map = map;lodash.mapKeys = mapKeys;lodash.mapValues = mapValues;lodash.matches = matches;lodash.matchesProperty = matchesProperty;lodash.memoize = memoize;lodash.merge = merge;lodash.mergeWith = mergeWith;lodash.method = method;lodash.methodOf = methodOf;lodash.mixin = mixin;lodash.negate = negate;lodash.nthArg = nthArg;lodash.omit = omit;lodash.omitBy = omitBy;lodash.once = once;lodash.orderBy = orderBy;lodash.over = over;lodash.overArgs = overArgs;lodash.overEvery = overEvery;lodash.overSome = overSome;lodash.partial = partial;lodash.partialRight = partialRight;lodash.partition = partition;lodash.pick = pick;lodash.pickBy = pickBy;lodash.property = property;lodash.propertyOf = propertyOf;lodash.pull = pull;lodash.pullAll = pullAll;lodash.pullAllBy = pullAllBy;lodash.pullAt = pullAt;lodash.range = range;lodash.rangeRight = rangeRight;lodash.rearg = rearg;lodash.reject = reject;lodash.remove = remove;lodash.rest = rest;lodash.reverse = reverse;lodash.sampleSize = sampleSize;lodash.set = set;lodash.setWith = setWith;lodash.shuffle = shuffle;lodash.slice = slice;lodash.sortBy = sortBy;lodash.sortedUniq = sortedUniq;lodash.sortedUniqBy = sortedUniqBy;lodash.split = split;lodash.spread = spread;lodash.tail = tail;lodash.take = take;lodash.takeRight = takeRight;lodash.takeRightWhile = takeRightWhile;lodash.takeWhile = takeWhile;lodash.tap = tap;lodash.throttle = throttle;lodash.thru = thru;lodash.toArray = toArray;lodash.toPairs = toPairs;lodash.toPairsIn = toPairsIn;lodash.toPath = toPath;lodash.toPlainObject = toPlainObject;lodash.transform = transform;lodash.unary = unary;lodash.union = union;lodash.unionBy = unionBy;lodash.unionWith = unionWith;lodash.uniq = uniq;lodash.uniqBy = uniqBy;lodash.uniqWith = uniqWith;lodash.unset = unset;lodash.unzip = unzip;lodash.unzipWith = unzipWith;lodash.values = values;lodash.valuesIn = valuesIn;lodash.without = without;lodash.words = words;lodash.wrap = wrap;lodash.xor = xor;lodash.xorBy = xorBy;lodash.xorWith = xorWith;lodash.zip = zip;lodash.zipObject = zipObject;lodash.zipObjectDeep = zipObjectDeep;lodash.zipWith = zipWith;lodash.extend = assignIn;lodash.extendWith = assignInWith;mixin(lodash,lodash);lodash.add = add;lodash.attempt = attempt;lodash.camelCase = camelCase;lodash.capitalize = capitalize;lodash.ceil = ceil;lodash.clamp = clamp;lodash.clone = clone;lodash.cloneDeep = cloneDeep;lodash.cloneDeepWith = cloneDeepWith;lodash.cloneWith = cloneWith;lodash.deburr = deburr;lodash.endsWith = endsWith;lodash.eq = eq;lodash.escape = escape;lodash.escapeRegExp = escapeRegExp;lodash.every = every;lodash.find = find;lodash.findIndex = findIndex;lodash.findKey = findKey;lodash.findLast = findLast;lodash.findLastIndex = findLastIndex;lodash.findLastKey = findLastKey;lodash.floor = floor;lodash.forEach = forEach;lodash.forEachRight = forEachRight;lodash.forIn = forIn;lodash.forInRight = forInRight;lodash.forOwn = forOwn;lodash.forOwnRight = forOwnRight;lodash.get = get;lodash.gt = gt;lodash.gte = gte;lodash.has = has;lodash.hasIn = hasIn;lodash.head = head;lodash.identity = identity;lodash.includes = includes;lodash.indexOf = indexOf;lodash.inRange = inRange;lodash.invoke = invoke;lodash.isArguments = isArguments;lodash.isArray = isArray;lodash.isArrayLike = isArrayLike;lodash.isArrayLikeObject = isArrayLikeObject;lodash.isBoolean = isBoolean;lodash.isDate = isDate;lodash.isElement = isElement;lodash.isEmpty = isEmpty;lodash.isEqual = isEqual;lodash.isEqualWith = isEqualWith;lodash.isError = isError;lodash.isFinite = isFinite;lodash.isFunction = isFunction;lodash.isInteger = isInteger;lodash.isLength = isLength;lodash.isMatch = isMatch;lodash.isMatchWith = isMatchWith;lodash.isNaN = isNaN;lodash.isNative = isNative;lodash.isNil = isNil;lodash.isNull = isNull;lodash.isNumber = isNumber;lodash.isObject = isObject;lodash.isObjectLike = isObjectLike;lodash.isPlainObject = isPlainObject;lodash.isRegExp = isRegExp;lodash.isSafeInteger = isSafeInteger;lodash.isString = isString;lodash.isSymbol = isSymbol;lodash.isTypedArray = isTypedArray;lodash.isUndefined = isUndefined;lodash.join = join;lodash.kebabCase = kebabCase;lodash.last = last;lodash.lastIndexOf = lastIndexOf;lodash.lowerCase = lowerCase;lodash.lowerFirst = lowerFirst;lodash.lt = lt;lodash.lte = lte;lodash.max = max;lodash.maxBy = maxBy;lodash.mean = mean;lodash.min = min;lodash.minBy = minBy;lodash.noConflict = noConflict;lodash.noop = noop;lodash.now = now;lodash.pad = pad;lodash.padEnd = padEnd;lodash.padStart = padStart;lodash.parseInt = parseInt;lodash.random = random;lodash.reduce = reduce;lodash.reduceRight = reduceRight;lodash.repeat = repeat;lodash.replace = replace;lodash.result = result;lodash.round = round;lodash.runInContext = runInContext;lodash.sample = sample;lodash.size = size;lodash.snakeCase = snakeCase;lodash.some = some;lodash.sortedIndex = sortedIndex;lodash.sortedIndexBy = sortedIndexBy;lodash.sortedIndexOf = sortedIndexOf;lodash.sortedLastIndex = sortedLastIndex;lodash.sortedLastIndexBy = sortedLastIndexBy;lodash.sortedLastIndexOf = sortedLastIndexOf;lodash.startCase = startCase;lodash.startsWith = startsWith;lodash.subtract = subtract;lodash.sum = sum;lodash.sumBy = sumBy;lodash.template = template;lodash.times = times;lodash.toInteger = toInteger;lodash.toLength = toLength;lodash.toLower = toLower;lodash.toNumber = toNumber;lodash.toSafeInteger = toSafeInteger;lodash.toString = toString;lodash.toUpper = toUpper;lodash.trim = trim;lodash.trimEnd = trimEnd;lodash.trimStart = trimStart;lodash.truncate = truncate;lodash.unescape = unescape;lodash.uniqueId = uniqueId;lodash.upperCase = upperCase;lodash.upperFirst = upperFirst;lodash.each = forEach;lodash.eachRight = forEachRight;lodash.first = head;mixin(lodash,(function(){var source={};baseForOwn(lodash,function(func,methodName){if(!hasOwnProperty.call(lodash.prototype,methodName)){source[methodName] = func;}});return source;})(),{chain:false});lodash.VERSION = VERSION;arrayEach(["bind","bindKey","curry","curryRight","partial","partialRight"],function(methodName){lodash[methodName].placeholder = lodash;});arrayEach(["drop","take"],function(methodName,index){LazyWrapper.prototype[methodName] = function(n){var filtered=this.__filtered__;if(filtered && !index){return new LazyWrapper(this);}n = n === undefined?1:nativeMax(toInteger(n),0);var result=this.clone();if(filtered){result.__takeCount__ = nativeMin(n,result.__takeCount__);}else {result.__views__.push({size:nativeMin(n,MAX_ARRAY_LENGTH),type:methodName + (result.__dir__ < 0?"Right":"")});}return result;};LazyWrapper.prototype[methodName + "Right"] = function(n){return this.reverse()[methodName](n).reverse();};});arrayEach(["filter","map","takeWhile"],function(methodName,index){var type=index + 1,isFilter=type == LAZY_FILTER_FLAG || type == LAZY_WHILE_FLAG;LazyWrapper.prototype[methodName] = function(iteratee){var result=this.clone();result.__iteratees__.push({iteratee:getIteratee(iteratee,3),type:type});result.__filtered__ = result.__filtered__ || isFilter;return result;};});arrayEach(["head","last"],function(methodName,index){var takeName="take" + (index?"Right":"");LazyWrapper.prototype[methodName] = function(){return this[takeName](1).value()[0];};});arrayEach(["initial","tail"],function(methodName,index){var dropName="drop" + (index?"":"Right");LazyWrapper.prototype[methodName] = function(){return this.__filtered__?new LazyWrapper(this):this[dropName](1);};});LazyWrapper.prototype.compact = function(){return this.filter(identity);};LazyWrapper.prototype.find = function(predicate){return this.filter(predicate).head();};LazyWrapper.prototype.findLast = function(predicate){return this.reverse().find(predicate);};LazyWrapper.prototype.invokeMap = rest(function(path,args){if(typeof path == "function"){return new LazyWrapper(this);}return this.map(function(value){return baseInvoke(value,path,args);});});LazyWrapper.prototype.reject = function(predicate){predicate = getIteratee(predicate,3);return this.filter(function(value){return !predicate(value);});};LazyWrapper.prototype.slice = function(start,end){start = toInteger(start);var result=this;if(result.__filtered__ && (start > 0 || end < 0)){return new LazyWrapper(result);}if(start < 0){result = result.takeRight(-start);}else if(start){result = result.drop(start);}if(end !== undefined){end = toInteger(end);result = end < 0?result.dropRight(-end):result.take(end - start);}return result;};LazyWrapper.prototype.takeRightWhile = function(predicate){return this.reverse().takeWhile(predicate).reverse();};LazyWrapper.prototype.toArray = function(){return this.take(MAX_ARRAY_LENGTH);};baseForOwn(LazyWrapper.prototype,function(func,methodName){var checkIteratee=/^(?:filter|find|map|reject)|While$/.test(methodName),isTaker=/^(?:head|last)$/.test(methodName),lodashFunc=lodash[isTaker?"take" + (methodName == "last"?"Right":""):methodName],retUnwrapped=isTaker || /^find/.test(methodName);if(!lodashFunc){return;}lodash.prototype[methodName] = function(){var value=this.__wrapped__,args=isTaker?[1]:arguments,isLazy=value instanceof LazyWrapper,iteratee=args[0],useLazy=isLazy || isArray(value);var interceptor=function interceptor(value){var result=lodashFunc.apply(lodash,arrayPush([value],args));return isTaker && chainAll?result[0]:result;};if(useLazy && checkIteratee && typeof iteratee == "function" && iteratee.length != 1){isLazy = useLazy = false;}var chainAll=this.__chain__,isHybrid=!!this.__actions__.length,isUnwrapped=retUnwrapped && !chainAll,onlyLazy=isLazy && !isHybrid;if(!retUnwrapped && useLazy){value = onlyLazy?value:new LazyWrapper(this);var result=func.apply(value,args);result.__actions__.push({func:thru,args:[interceptor],thisArg:undefined});return new LodashWrapper(result,chainAll);}if(isUnwrapped && onlyLazy){return func.apply(this,args);}result = this.thru(interceptor);return isUnwrapped?isTaker?result.value()[0]:result.value():result;};});arrayEach(["pop","push","shift","sort","splice","unshift"],function(methodName){var func=arrayProto[methodName],chainName=/^(?:push|sort|unshift)$/.test(methodName)?"tap":"thru",retUnwrapped=/^(?:pop|shift)$/.test(methodName);lodash.prototype[methodName] = function(){var args=arguments;if(retUnwrapped && !this.__chain__){return func.apply(this.value(),args);}return this[chainName](function(value){return func.apply(value,args);});};});baseForOwn(LazyWrapper.prototype,function(func,methodName){var lodashFunc=lodash[methodName];if(lodashFunc){var key=lodashFunc.name + "",names=realNames[key] || (realNames[key] = []);names.push({name:methodName,func:lodashFunc});}});realNames[createHybridWrapper(undefined,BIND_KEY_FLAG).name] = [{name:"wrapper",func:undefined}];LazyWrapper.prototype.clone = lazyClone;LazyWrapper.prototype.reverse = lazyReverse;LazyWrapper.prototype.value = lazyValue;lodash.prototype.at = wrapperAt;lodash.prototype.chain = wrapperChain;lodash.prototype.commit = wrapperCommit;lodash.prototype.flatMap = wrapperFlatMap;lodash.prototype.next = wrapperNext;lodash.prototype.plant = wrapperPlant;lodash.prototype.reverse = wrapperReverse;lodash.prototype.toJSON = lodash.prototype.valueOf = lodash.prototype.value = wrapperValue;if(iteratorSymbol){lodash.prototype[iteratorSymbol] = wrapperToIterator;}return lodash;}var _=runInContext();(freeWindow || freeSelf || {})._ = _;if(typeof define == "function" && typeof define.amd == "object" && define.amd){define(function(){return _;});}else if(freeExports && freeModule){if(moduleExports){(freeModule.exports = _)._ = _;}freeExports._ = _;}else {root._ = _;}}).call(undefined);

cc._RFpop();
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],"main":[function(require,module,exports){
cc._RFpush(module, '4788eVMSFhL2qgCgTN1rpuj', 'main');
// biz/main/script/main.js

'use strict';

var bizSocket = require('../../socket/biz-socket');

cc.Class({
    'extends': cc.Component,

    properties: {},

    enterAction: function enterAction() {
        cc.director.loadScene('controller');
        bizSocket.connect();
    },

    onLoad: function onLoad() {},

    update: function update(dt) {}
});

cc._RFpop();
},{"../../socket/biz-socket":"biz-socket"}],"socket.io":[function(require,module,exports){
(function (global){
cc._RFpush(module, '342756pPltPvItiKud7zucD', 'socket.io');
// lib/socket.io.js

"use strict";

(function (f) {
  if (typeof exports === "object" && typeof module !== "undefined") {
    module.exports = f();
  } else if (typeof define === "function" && define.amd) {
    define([], f);
  } else {
    var g;if (typeof window !== "undefined") {
      g = window;
    } else if (typeof global !== "undefined") {
      g = global;
    } else if (typeof self !== "undefined") {
      g = self;
    } else {
      g = this;
    }g.io = f();
  }
})(function () {
  var define, module, exports;return (function e(t, n, r) {
    function s(o, u) {
      if (!n[o]) {
        if (!t[o]) {
          var a = typeof require == "function" && require;if (!u && a) return a(o, !0);if (i) return i(o, !0);var f = new Error("Cannot find module '" + o + "'");throw (f.code = "MODULE_NOT_FOUND", f);
        }var l = n[o] = { exports: {} };t[o][0].call(l.exports, function (e) {
          var n = t[o][1][e];return s(n ? n : e);
        }, l, l.exports, e, t, n, r);
      }return n[o].exports;
    }var i = typeof require == "function" && require;for (var o = 0; o < r.length; o++) s(r[o]);return s;
  })({ 1: [function (_dereq_, module, exports) {
      module.exports = _dereq_("./lib/");
    }, { "./lib/": 2 }], 2: [function (_dereq_, module, exports) {
      module.exports = _dereq_("./socket");module.exports.parser = _dereq_("engine.io-parser");
    }, { "./socket": 3, "engine.io-parser": 19 }], 3: [function (_dereq_, module, exports) {
      (function (global) {
        var transports = _dereq_("./transports");var Emitter = _dereq_("component-emitter");var debug = _dereq_("debug")("engine.io-client:socket");var index = _dereq_("indexof");var parser = _dereq_("engine.io-parser");var parseuri = _dereq_("parseuri");var parsejson = _dereq_("parsejson");var parseqs = _dereq_("parseqs");module.exports = Socket;function noop() {}function Socket(uri, opts) {
          if (!(this instanceof Socket)) return new Socket(uri, opts);opts = opts || {};if (uri && "object" == typeof uri) {
            opts = uri;uri = null;
          }if (uri) {
            uri = parseuri(uri);opts.hostname = uri.host;opts.secure = uri.protocol == "https" || uri.protocol == "wss";opts.port = uri.port;if (uri.query) opts.query = uri.query;
          } else if (opts.host) {
            opts.hostname = parseuri(opts.host).host;
          }this.secure = null != opts.secure ? opts.secure : global.location && "https:" == location.protocol;if (opts.hostname && !opts.port) {
            opts.port = this.secure ? "443" : "80";
          }this.agent = opts.agent || false;this.hostname = opts.hostname || (global.location ? location.hostname : "localhost");this.port = opts.port || (global.location && location.port ? location.port : this.secure ? 443 : 80);this.query = opts.query || {};if ("string" == typeof this.query) this.query = parseqs.decode(this.query);this.upgrade = false !== opts.upgrade;this.path = (opts.path || "/engine.io").replace(/\/$/, "") + "/";this.forceJSONP = !!opts.forceJSONP;this.jsonp = false !== opts.jsonp;this.forceBase64 = !!opts.forceBase64;this.enablesXDR = !!opts.enablesXDR;this.timestampParam = opts.timestampParam || "t";this.timestampRequests = opts.timestampRequests;this.transports = opts.transports || ["polling", "websocket"];this.readyState = "";this.writeBuffer = [];this.policyPort = opts.policyPort || 843;this.rememberUpgrade = opts.rememberUpgrade || false;this.binaryType = null;this.onlyBinaryUpgrades = opts.onlyBinaryUpgrades;this.perMessageDeflate = false !== opts.perMessageDeflate ? opts.perMessageDeflate || {} : false;if (true === this.perMessageDeflate) this.perMessageDeflate = {};if (this.perMessageDeflate && null == this.perMessageDeflate.threshold) {
            this.perMessageDeflate.threshold = 1024;
          }this.pfx = opts.pfx || null;this.key = opts.key || null;this.passphrase = opts.passphrase || null;this.cert = opts.cert || null;this.ca = opts.ca || null;this.ciphers = opts.ciphers || null;this.rejectUnauthorized = opts.rejectUnauthorized === undefined ? null : opts.rejectUnauthorized;var freeGlobal = typeof global == "object" && global;if (freeGlobal.global === freeGlobal) {
            if (opts.extraHeaders && Object.keys(opts.extraHeaders).length > 0) {
              this.extraHeaders = opts.extraHeaders;
            }
          }this.open();
        }Socket.priorWebsocketSuccess = false;Emitter(Socket.prototype);Socket.protocol = parser.protocol;Socket.Socket = Socket;Socket.Transport = _dereq_("./transport");Socket.transports = _dereq_("./transports");Socket.parser = _dereq_("engine.io-parser");Socket.prototype.createTransport = function (name) {
          debug('creating transport "%s"', name);var query = clone(this.query);query.EIO = parser.protocol;query.transport = name;if (this.id) query.sid = this.id;var transport = new transports[name]({ agent: this.agent, hostname: this.hostname, port: this.port, secure: this.secure, path: this.path, query: query, forceJSONP: this.forceJSONP, jsonp: this.jsonp, forceBase64: this.forceBase64, enablesXDR: this.enablesXDR, timestampRequests: this.timestampRequests, timestampParam: this.timestampParam, policyPort: this.policyPort, socket: this, pfx: this.pfx, key: this.key, passphrase: this.passphrase, cert: this.cert, ca: this.ca, ciphers: this.ciphers, rejectUnauthorized: this.rejectUnauthorized, perMessageDeflate: this.perMessageDeflate, extraHeaders: this.extraHeaders });return transport;
        };function clone(obj) {
          var o = {};for (var i in obj) {
            if (obj.hasOwnProperty(i)) {
              o[i] = obj[i];
            }
          }return o;
        }Socket.prototype.open = function () {
          var transport;if (this.rememberUpgrade && Socket.priorWebsocketSuccess && this.transports.indexOf("websocket") != -1) {
            transport = "websocket";
          } else if (0 === this.transports.length) {
            var self = this;setTimeout(function () {
              self.emit("error", "No transports available");
            }, 0);return;
          } else {
            transport = this.transports[0];
          }this.readyState = "opening";try {
            transport = this.createTransport(transport);
          } catch (e) {
            this.transports.shift();this.open();return;
          }transport.open();this.setTransport(transport);
        };Socket.prototype.setTransport = function (transport) {
          debug("setting transport %s", transport.name);var self = this;if (this.transport) {
            debug("clearing existing transport %s", this.transport.name);this.transport.removeAllListeners();
          }this.transport = transport;transport.on("drain", function () {
            self.onDrain();
          }).on("packet", function (packet) {
            self.onPacket(packet);
          }).on("error", function (e) {
            self.onError(e);
          }).on("close", function () {
            self.onClose("transport close");
          });
        };Socket.prototype.probe = function (name) {
          debug('probing transport "%s"', name);var transport = this.createTransport(name, { probe: 1 }),
              failed = false,
              self = this;Socket.priorWebsocketSuccess = false;function onTransportOpen() {
            if (self.onlyBinaryUpgrades) {
              var upgradeLosesBinary = !this.supportsBinary && self.transport.supportsBinary;failed = failed || upgradeLosesBinary;
            }if (failed) return;debug('probe transport "%s" opened', name);transport.send([{ type: "ping", data: "probe" }]);transport.once("packet", function (msg) {
              if (failed) return;if ("pong" == msg.type && "probe" == msg.data) {
                debug('probe transport "%s" pong', name);self.upgrading = true;self.emit("upgrading", transport);if (!transport) return;Socket.priorWebsocketSuccess = "websocket" == transport.name;debug('pausing current transport "%s"', self.transport.name);self.transport.pause(function () {
                  if (failed) return;if ("closed" == self.readyState) return;debug("changing transport and sending upgrade packet");cleanup();self.setTransport(transport);transport.send([{ type: "upgrade" }]);self.emit("upgrade", transport);transport = null;self.upgrading = false;self.flush();
                });
              } else {
                debug('probe transport "%s" failed', name);var err = new Error("probe error");err.transport = transport.name;self.emit("upgradeError", err);
              }
            });
          }function freezeTransport() {
            if (failed) return;failed = true;cleanup();transport.close();transport = null;
          }function onerror(err) {
            var error = new Error("probe error: " + err);error.transport = transport.name;freezeTransport();debug('probe transport "%s" failed because of error: %s', name, err);self.emit("upgradeError", error);
          }function onTransportClose() {
            onerror("transport closed");
          }function onclose() {
            onerror("socket closed");
          }function onupgrade(to) {
            if (transport && to.name != transport.name) {
              debug('"%s" works - aborting "%s"', to.name, transport.name);freezeTransport();
            }
          }function cleanup() {
            transport.removeListener("open", onTransportOpen);transport.removeListener("error", onerror);transport.removeListener("close", onTransportClose);self.removeListener("close", onclose);self.removeListener("upgrading", onupgrade);
          }transport.once("open", onTransportOpen);transport.once("error", onerror);transport.once("close", onTransportClose);this.once("close", onclose);this.once("upgrading", onupgrade);transport.open();
        };Socket.prototype.onOpen = function () {
          debug("socket open");this.readyState = "open";Socket.priorWebsocketSuccess = "websocket" == this.transport.name;this.emit("open");this.flush();if ("open" == this.readyState && this.upgrade && this.transport.pause) {
            debug("starting upgrade probes");for (var i = 0, l = this.upgrades.length; i < l; i++) {
              this.probe(this.upgrades[i]);
            }
          }
        };Socket.prototype.onPacket = function (packet) {
          if ("opening" == this.readyState || "open" == this.readyState) {
            debug('socket receive: type "%s", data "%s"', packet.type, packet.data);this.emit("packet", packet);this.emit("heartbeat");switch (packet.type) {case "open":
                this.onHandshake(parsejson(packet.data));break;case "pong":
                this.setPing();this.emit("pong");break;case "error":
                var err = new Error("server error");err.code = packet.data;this.onError(err);break;case "message":
                this.emit("data", packet.data);this.emit("message", packet.data);break;}
          } else {
            debug('packet received with socket readyState "%s"', this.readyState);
          }
        };Socket.prototype.onHandshake = function (data) {
          this.emit("handshake", data);this.id = data.sid;this.transport.query.sid = data.sid;this.upgrades = this.filterUpgrades(data.upgrades);this.pingInterval = data.pingInterval;this.pingTimeout = data.pingTimeout;this.onOpen();if ("closed" == this.readyState) return;this.setPing();this.removeListener("heartbeat", this.onHeartbeat);this.on("heartbeat", this.onHeartbeat);
        };Socket.prototype.onHeartbeat = function (timeout) {
          clearTimeout(this.pingTimeoutTimer);var self = this;self.pingTimeoutTimer = setTimeout(function () {
            if ("closed" == self.readyState) return;self.onClose("ping timeout");
          }, timeout || self.pingInterval + self.pingTimeout);
        };Socket.prototype.setPing = function () {
          var self = this;clearTimeout(self.pingIntervalTimer);self.pingIntervalTimer = setTimeout(function () {
            debug("writing ping packet - expecting pong within %sms", self.pingTimeout);self.ping();self.onHeartbeat(self.pingTimeout);
          }, self.pingInterval);
        };Socket.prototype.ping = function () {
          var self = this;this.sendPacket("ping", function () {
            self.emit("ping");
          });
        };Socket.prototype.onDrain = function () {
          this.writeBuffer.splice(0, this.prevBufferLen);this.prevBufferLen = 0;if (0 === this.writeBuffer.length) {
            this.emit("drain");
          } else {
            this.flush();
          }
        };Socket.prototype.flush = function () {
          if ("closed" != this.readyState && this.transport.writable && !this.upgrading && this.writeBuffer.length) {
            debug("flushing %d packets in socket", this.writeBuffer.length);this.transport.send(this.writeBuffer);this.prevBufferLen = this.writeBuffer.length;this.emit("flush");
          }
        };Socket.prototype.write = Socket.prototype.send = function (msg, options, fn) {
          this.sendPacket("message", msg, options, fn);return this;
        };Socket.prototype.sendPacket = function (type, data, options, fn) {
          if ("function" == typeof data) {
            fn = data;data = undefined;
          }if ("function" == typeof options) {
            fn = options;options = null;
          }if ("closing" == this.readyState || "closed" == this.readyState) {
            return;
          }options = options || {};options.compress = false !== options.compress;var packet = { type: type, data: data, options: options };this.emit("packetCreate", packet);this.writeBuffer.push(packet);if (fn) this.once("flush", fn);this.flush();
        };Socket.prototype.close = function () {
          if ("opening" == this.readyState || "open" == this.readyState) {
            this.readyState = "closing";var self = this;if (this.writeBuffer.length) {
              this.once("drain", function () {
                if (this.upgrading) {
                  waitForUpgrade();
                } else {
                  close();
                }
              });
            } else if (this.upgrading) {
              waitForUpgrade();
            } else {
              close();
            }
          }function close() {
            self.onClose("forced close");debug("socket closing - telling transport to close");self.transport.close();
          }function cleanupAndClose() {
            self.removeListener("upgrade", cleanupAndClose);self.removeListener("upgradeError", cleanupAndClose);close();
          }function waitForUpgrade() {
            self.once("upgrade", cleanupAndClose);self.once("upgradeError", cleanupAndClose);
          }return this;
        };Socket.prototype.onError = function (err) {
          debug("socket error %j", err);Socket.priorWebsocketSuccess = false;this.emit("error", err);this.onClose("transport error", err);
        };Socket.prototype.onClose = function (reason, desc) {
          if ("opening" == this.readyState || "open" == this.readyState || "closing" == this.readyState) {
            debug('socket close with reason: "%s"', reason);var self = this;clearTimeout(this.pingIntervalTimer);clearTimeout(this.pingTimeoutTimer);this.transport.removeAllListeners("close");this.transport.close();this.transport.removeAllListeners();this.readyState = "closed";this.id = null;this.emit("close", reason, desc);self.writeBuffer = [];self.prevBufferLen = 0;
          }
        };Socket.prototype.filterUpgrades = function (upgrades) {
          var filteredUpgrades = [];for (var i = 0, j = upgrades.length; i < j; i++) {
            if (~index(this.transports, upgrades[i])) filteredUpgrades.push(upgrades[i]);
          }return filteredUpgrades;
        };
      }).call(this, typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {});
    }, { "./transport": 4, "./transports": 5, "component-emitter": 15, debug: 17, "engine.io-parser": 19, indexof: 23, parsejson: 26, parseqs: 27, parseuri: 28 }], 4: [function (_dereq_, module, exports) {
      var parser = _dereq_("engine.io-parser");var Emitter = _dereq_("component-emitter");module.exports = Transport;function Transport(opts) {
        this.path = opts.path;this.hostname = opts.hostname;this.port = opts.port;this.secure = opts.secure;this.query = opts.query;this.timestampParam = opts.timestampParam;this.timestampRequests = opts.timestampRequests;this.readyState = "";this.agent = opts.agent || false;this.socket = opts.socket;this.enablesXDR = opts.enablesXDR;this.pfx = opts.pfx;this.key = opts.key;this.passphrase = opts.passphrase;this.cert = opts.cert;this.ca = opts.ca;this.ciphers = opts.ciphers;this.rejectUnauthorized = opts.rejectUnauthorized;this.extraHeaders = opts.extraHeaders;
      }Emitter(Transport.prototype);Transport.prototype.onError = function (msg, desc) {
        var err = new Error(msg);err.type = "TransportError";err.description = desc;this.emit("error", err);return this;
      };Transport.prototype.open = function () {
        if ("closed" == this.readyState || "" == this.readyState) {
          this.readyState = "opening";this.doOpen();
        }return this;
      };Transport.prototype.close = function () {
        if ("opening" == this.readyState || "open" == this.readyState) {
          this.doClose();this.onClose();
        }return this;
      };Transport.prototype.send = function (packets) {
        if ("open" == this.readyState) {
          this.write(packets);
        } else {
          throw new Error("Transport not open");
        }
      };Transport.prototype.onOpen = function () {
        this.readyState = "open";this.writable = true;this.emit("open");
      };Transport.prototype.onData = function (data) {
        var packet = parser.decodePacket(data, this.socket.binaryType);this.onPacket(packet);
      };Transport.prototype.onPacket = function (packet) {
        this.emit("packet", packet);
      };Transport.prototype.onClose = function () {
        this.readyState = "closed";this.emit("close");
      };
    }, { "component-emitter": 15, "engine.io-parser": 19 }], 5: [function (_dereq_, module, exports) {
      (function (global) {
        var XMLHttpRequest = _dereq_("xmlhttprequest-ssl");var XHR = _dereq_("./polling-xhr");var JSONP = _dereq_("./polling-jsonp");var websocket = _dereq_("./websocket");exports.polling = polling;exports.websocket = websocket;function polling(opts) {
          var xhr;var xd = false;var xs = false;var jsonp = false !== opts.jsonp;if (global.location) {
            var isSSL = "https:" == location.protocol;var port = location.port;if (!port) {
              port = isSSL ? 443 : 80;
            }xd = opts.hostname != location.hostname || port != opts.port;xs = opts.secure != isSSL;
          }opts.xdomain = xd;opts.xscheme = xs;xhr = new XMLHttpRequest(opts);if ("open" in xhr && !opts.forceJSONP) {
            return new XHR(opts);
          } else {
            if (!jsonp) throw new Error("JSONP disabled");return new JSONP(opts);
          }
        }
      }).call(this, typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {});
    }, { "./polling-jsonp": 6, "./polling-xhr": 7, "./websocket": 9, "xmlhttprequest-ssl": 10 }], 6: [function (_dereq_, module, exports) {
      (function (global) {
        var Polling = _dereq_("./polling");var inherit = _dereq_("component-inherit");module.exports = JSONPPolling;var rNewline = /\n/g;var rEscapedNewline = /\\n/g;var callbacks;var index = 0;function empty() {}function JSONPPolling(opts) {
          Polling.call(this, opts);this.query = this.query || {};if (!callbacks) {
            if (!global.___eio) global.___eio = [];callbacks = global.___eio;
          }this.index = callbacks.length;var self = this;callbacks.push(function (msg) {
            self.onData(msg);
          });this.query.j = this.index;if (global.document && global.addEventListener) {
            global.addEventListener("beforeunload", function () {
              if (self.script) self.script.onerror = empty;
            }, false);
          }
        }inherit(JSONPPolling, Polling);JSONPPolling.prototype.supportsBinary = false;JSONPPolling.prototype.doClose = function () {
          if (this.script) {
            this.script.parentNode.removeChild(this.script);this.script = null;
          }if (this.form) {
            this.form.parentNode.removeChild(this.form);this.form = null;this.iframe = null;
          }Polling.prototype.doClose.call(this);
        };JSONPPolling.prototype.doPoll = function () {
          var self = this;var script = document.createElement("script");if (this.script) {
            this.script.parentNode.removeChild(this.script);this.script = null;
          }script.async = true;script.src = this.uri();script.onerror = function (e) {
            self.onError("jsonp poll error", e);
          };var insertAt = document.getElementsByTagName("script")[0];if (insertAt) {
            insertAt.parentNode.insertBefore(script, insertAt);
          } else {
            (document.head || document.body).appendChild(script);
          }this.script = script;var isUAgecko = "undefined" != typeof navigator && /gecko/i.test(navigator.userAgent);if (isUAgecko) {
            setTimeout(function () {
              var iframe = document.createElement("iframe");document.body.appendChild(iframe);document.body.removeChild(iframe);
            }, 100);
          }
        };JSONPPolling.prototype.doWrite = function (data, fn) {
          var self = this;if (!this.form) {
            var form = document.createElement("form");var area = document.createElement("textarea");var id = this.iframeId = "eio_iframe_" + this.index;var iframe;form.className = "socketio";form.style.position = "absolute";form.style.top = "-1000px";form.style.left = "-1000px";form.target = id;form.method = "POST";form.setAttribute("accept-charset", "utf-8");area.name = "d";form.appendChild(area);document.body.appendChild(form);this.form = form;this.area = area;
          }this.form.action = this.uri();function complete() {
            initIframe();fn();
          }function initIframe() {
            if (self.iframe) {
              try {
                self.form.removeChild(self.iframe);
              } catch (e) {
                self.onError("jsonp polling iframe removal error", e);
              }
            }try {
              var html = '<iframe src="javascript:0" name="' + self.iframeId + '">';iframe = document.createElement(html);
            } catch (e) {
              iframe = document.createElement("iframe");iframe.name = self.iframeId;iframe.src = "javascript:0";
            }iframe.id = self.iframeId;self.form.appendChild(iframe);self.iframe = iframe;
          }initIframe();data = data.replace(rEscapedNewline, "\\\n");this.area.value = data.replace(rNewline, "\\n");try {
            this.form.submit();
          } catch (e) {}if (this.iframe.attachEvent) {
            this.iframe.onreadystatechange = function () {
              if (self.iframe.readyState == "complete") {
                complete();
              }
            };
          } else {
            this.iframe.onload = complete;
          }
        };
      }).call(this, typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {});
    }, { "./polling": 8, "component-inherit": 16 }], 7: [function (_dereq_, module, exports) {
      (function (global) {
        var XMLHttpRequest = _dereq_("xmlhttprequest-ssl");var Polling = _dereq_("./polling");var Emitter = _dereq_("component-emitter");var inherit = _dereq_("component-inherit");var debug = _dereq_("debug")("engine.io-client:polling-xhr");module.exports = XHR;module.exports.Request = Request;function empty() {}function XHR(opts) {
          Polling.call(this, opts);if (global.location) {
            var isSSL = "https:" == location.protocol;var port = location.port;if (!port) {
              port = isSSL ? 443 : 80;
            }this.xd = opts.hostname != global.location.hostname || port != opts.port;this.xs = opts.secure != isSSL;
          } else {
            this.extraHeaders = opts.extraHeaders;
          }
        }inherit(XHR, Polling);XHR.prototype.supportsBinary = true;XHR.prototype.request = function (opts) {
          opts = opts || {};opts.uri = this.uri();opts.xd = this.xd;opts.xs = this.xs;opts.agent = this.agent || false;opts.supportsBinary = this.supportsBinary;opts.enablesXDR = this.enablesXDR;opts.pfx = this.pfx;opts.key = this.key;opts.passphrase = this.passphrase;opts.cert = this.cert;opts.ca = this.ca;opts.ciphers = this.ciphers;opts.rejectUnauthorized = this.rejectUnauthorized;opts.extraHeaders = this.extraHeaders;return new Request(opts);
        };XHR.prototype.doWrite = function (data, fn) {
          var isBinary = typeof data !== "string" && data !== undefined;var req = this.request({ method: "POST", data: data, isBinary: isBinary });var self = this;req.on("success", fn);req.on("error", function (err) {
            self.onError("xhr post error", err);
          });this.sendXhr = req;
        };XHR.prototype.doPoll = function () {
          debug("xhr poll");var req = this.request();var self = this;req.on("data", function (data) {
            self.onData(data);
          });req.on("error", function (err) {
            self.onError("xhr poll error", err);
          });this.pollXhr = req;
        };function Request(opts) {
          this.method = opts.method || "GET";this.uri = opts.uri;this.xd = !!opts.xd;this.xs = !!opts.xs;this.async = false !== opts.async;this.data = undefined != opts.data ? opts.data : null;this.agent = opts.agent;this.isBinary = opts.isBinary;this.supportsBinary = opts.supportsBinary;this.enablesXDR = opts.enablesXDR;this.pfx = opts.pfx;this.key = opts.key;this.passphrase = opts.passphrase;this.cert = opts.cert;this.ca = opts.ca;this.ciphers = opts.ciphers;this.rejectUnauthorized = opts.rejectUnauthorized;this.extraHeaders = opts.extraHeaders;this.create();
        }Emitter(Request.prototype);Request.prototype.create = function () {
          var opts = { agent: this.agent, xdomain: this.xd, xscheme: this.xs, enablesXDR: this.enablesXDR };opts.pfx = this.pfx;opts.key = this.key;opts.passphrase = this.passphrase;opts.cert = this.cert;opts.ca = this.ca;opts.ciphers = this.ciphers;opts.rejectUnauthorized = this.rejectUnauthorized;var xhr = this.xhr = new XMLHttpRequest(opts);var self = this;try {
            debug("xhr open %s: %s", this.method, this.uri);xhr.open(this.method, this.uri, this.async);try {
              if (this.extraHeaders) {
                xhr.setDisableHeaderCheck(true);for (var i in this.extraHeaders) {
                  if (this.extraHeaders.hasOwnProperty(i)) {
                    xhr.setRequestHeader(i, this.extraHeaders[i]);
                  }
                }
              }
            } catch (e) {}if (this.supportsBinary) {
              xhr.responseType = "arraybuffer";
            }if ("POST" == this.method) {
              try {
                if (this.isBinary) {
                  xhr.setRequestHeader("Content-type", "application/octet-stream");
                } else {
                  xhr.setRequestHeader("Content-type", "text/plain;charset=UTF-8");
                }
              } catch (e) {}
            }if ("withCredentials" in xhr) {
              xhr.withCredentials = true;
            }if (this.hasXDR()) {
              xhr.onload = function () {
                self.onLoad();
              };xhr.onerror = function () {
                self.onError(xhr.responseText);
              };
            } else {
              xhr.onreadystatechange = function () {
                if (4 != xhr.readyState) return;if (200 == xhr.status || 1223 == xhr.status) {
                  self.onLoad();
                } else {
                  setTimeout(function () {
                    self.onError(xhr.status);
                  }, 0);
                }
              };
            }debug("xhr data %s", this.data);xhr.send(this.data);
          } catch (e) {
            setTimeout(function () {
              self.onError(e);
            }, 0);return;
          }if (global.document) {
            this.index = Request.requestsCount++;Request.requests[this.index] = this;
          }
        };Request.prototype.onSuccess = function () {
          this.emit("success");this.cleanup();
        };Request.prototype.onData = function (data) {
          this.emit("data", data);this.onSuccess();
        };Request.prototype.onError = function (err) {
          this.emit("error", err);this.cleanup(true);
        };Request.prototype.cleanup = function (fromError) {
          if ("undefined" == typeof this.xhr || null === this.xhr) {
            return;
          }if (this.hasXDR()) {
            this.xhr.onload = this.xhr.onerror = empty;
          } else {
            this.xhr.onreadystatechange = empty;
          }if (fromError) {
            try {
              this.xhr.abort();
            } catch (e) {}
          }if (global.document) {
            delete Request.requests[this.index];
          }this.xhr = null;
        };Request.prototype.onLoad = function () {
          var data;try {
            var contentType;try {
              contentType = this.xhr.getResponseHeader("Content-Type").split(";")[0];
            } catch (e) {}if (contentType === "application/octet-stream") {
              data = this.xhr.response;
            } else {
              if (!this.supportsBinary) {
                data = this.xhr.responseText;
              } else {
                try {
                  data = String.fromCharCode.apply(null, new Uint8Array(this.xhr.response));
                } catch (e) {
                  var ui8Arr = new Uint8Array(this.xhr.response);var dataArray = [];for (var idx = 0, length = ui8Arr.length; idx < length; idx++) {
                    dataArray.push(ui8Arr[idx]);
                  }data = String.fromCharCode.apply(null, dataArray);
                }
              }
            }
          } catch (e) {
            this.onError(e);
          }if (null != data) {
            this.onData(data);
          }
        };Request.prototype.hasXDR = function () {
          return "undefined" !== typeof global.XDomainRequest && !this.xs && this.enablesXDR;
        };Request.prototype.abort = function () {
          this.cleanup();
        };if (global.document) {
          Request.requestsCount = 0;Request.requests = {};if (global.attachEvent) {
            global.attachEvent("onunload", unloadHandler);
          } else if (global.addEventListener) {
            global.addEventListener("beforeunload", unloadHandler, false);
          }
        }function unloadHandler() {
          for (var i in Request.requests) {
            if (Request.requests.hasOwnProperty(i)) {
              Request.requests[i].abort();
            }
          }
        }
      }).call(this, typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {});
    }, { "./polling": 8, "component-emitter": 15, "component-inherit": 16, debug: 17, "xmlhttprequest-ssl": 10 }], 8: [function (_dereq_, module, exports) {
      var Transport = _dereq_("../transport");var parseqs = _dereq_("parseqs");var parser = _dereq_("engine.io-parser");var inherit = _dereq_("component-inherit");var yeast = _dereq_("yeast");var debug = _dereq_("debug")("engine.io-client:polling");module.exports = Polling;var hasXHR2 = (function () {
        var XMLHttpRequest = _dereq_("xmlhttprequest-ssl");var xhr = new XMLHttpRequest({ xdomain: false });return null != xhr.responseType;
      })();function Polling(opts) {
        var forceBase64 = opts && opts.forceBase64;if (!hasXHR2 || forceBase64) {
          this.supportsBinary = false;
        }Transport.call(this, opts);
      }inherit(Polling, Transport);Polling.prototype.name = "polling";Polling.prototype.doOpen = function () {
        this.poll();
      };Polling.prototype.pause = function (onPause) {
        var pending = 0;var self = this;this.readyState = "pausing";function pause() {
          debug("paused");self.readyState = "paused";onPause();
        }if (this.polling || !this.writable) {
          var total = 0;if (this.polling) {
            debug("we are currently polling - waiting to pause");total++;this.once("pollComplete", function () {
              debug("pre-pause polling complete");--total || pause();
            });
          }if (!this.writable) {
            debug("we are currently writing - waiting to pause");total++;this.once("drain", function () {
              debug("pre-pause writing complete");--total || pause();
            });
          }
        } else {
          pause();
        }
      };Polling.prototype.poll = function () {
        debug("polling");this.polling = true;this.doPoll();this.emit("poll");
      };Polling.prototype.onData = function (data) {
        var self = this;debug("polling got data %s", data);var callback = function callback(packet, index, total) {
          if ("opening" == self.readyState) {
            self.onOpen();
          }if ("close" == packet.type) {
            self.onClose();return false;
          }self.onPacket(packet);
        };parser.decodePayload(data, this.socket.binaryType, callback);if ("closed" != this.readyState) {
          this.polling = false;this.emit("pollComplete");if ("open" == this.readyState) {
            this.poll();
          } else {
            debug('ignoring poll - transport state "%s"', this.readyState);
          }
        }
      };Polling.prototype.doClose = function () {
        var self = this;function close() {
          debug("writing close packet");self.write([{ type: "close" }]);
        }if ("open" == this.readyState) {
          debug("transport open - closing");close();
        } else {
          debug("transport not open - deferring close");this.once("open", close);
        }
      };Polling.prototype.write = function (packets) {
        var self = this;this.writable = false;var callbackfn = function callbackfn() {
          self.writable = true;self.emit("drain");
        };var self = this;parser.encodePayload(packets, this.supportsBinary, function (data) {
          self.doWrite(data, callbackfn);
        });
      };Polling.prototype.uri = function () {
        var query = this.query || {};var schema = this.secure ? "https" : "http";var port = "";if (false !== this.timestampRequests) {
          query[this.timestampParam] = yeast();
        }if (!this.supportsBinary && !query.sid) {
          query.b64 = 1;
        }query = parseqs.encode(query);if (this.port && ("https" == schema && this.port != 443 || "http" == schema && this.port != 80)) {
          port = ":" + this.port;
        }if (query.length) {
          query = "?" + query;
        }var ipv6 = this.hostname.indexOf(":") !== -1;return schema + "://" + (ipv6 ? "[" + this.hostname + "]" : this.hostname) + port + this.path + query;
      };
    }, { "../transport": 4, "component-inherit": 16, debug: 17, "engine.io-parser": 19, parseqs: 27, "xmlhttprequest-ssl": 10, yeast: 30 }], 9: [function (_dereq_, module, exports) {
      (function (global) {
        var Transport = _dereq_("../transport");var parser = _dereq_("engine.io-parser");var parseqs = _dereq_("parseqs");var inherit = _dereq_("component-inherit");var yeast = _dereq_("yeast");var debug = _dereq_("debug")("engine.io-client:websocket");var BrowserWebSocket = global.WebSocket || global.MozWebSocket;var WebSocket = BrowserWebSocket;if (!WebSocket && typeof window === "undefined") {
          try {
            WebSocket = _dereq_("ws");
          } catch (e) {}
        }module.exports = WS;function WS(opts) {
          var forceBase64 = opts && opts.forceBase64;if (forceBase64) {
            this.supportsBinary = false;
          }this.perMessageDeflate = opts.perMessageDeflate;Transport.call(this, opts);
        }inherit(WS, Transport);WS.prototype.name = "websocket";WS.prototype.supportsBinary = true;WS.prototype.doOpen = function () {
          if (!this.check()) {
            return;
          }var self = this;var uri = this.uri();var protocols = void 0;var opts = { agent: this.agent, perMessageDeflate: this.perMessageDeflate };opts.pfx = this.pfx;opts.key = this.key;opts.passphrase = this.passphrase;opts.cert = this.cert;opts.ca = this.ca;opts.ciphers = this.ciphers;opts.rejectUnauthorized = this.rejectUnauthorized;if (this.extraHeaders) {
            opts.headers = this.extraHeaders;
          }this.ws = BrowserWebSocket ? new WebSocket(uri) : new WebSocket(uri, protocols, opts);if (this.ws.binaryType === undefined) {
            this.supportsBinary = false;
          }if (this.ws.supports && this.ws.supports.binary) {
            this.supportsBinary = true;this.ws.binaryType = "buffer";
          } else {
            this.ws.binaryType = "arraybuffer";
          }this.addEventListeners();
        };WS.prototype.addEventListeners = function () {
          var self = this;this.ws.onopen = function () {
            self.onOpen();
          };this.ws.onclose = function () {
            self.onClose();
          };this.ws.onmessage = function (ev) {
            self.onData(ev.data);
          };this.ws.onerror = function (e) {
            self.onError("websocket error", e);
          };
        };if ("undefined" != typeof navigator && /iPad|iPhone|iPod/i.test(navigator.userAgent)) {
          WS.prototype.onData = function (data) {
            var self = this;setTimeout(function () {
              Transport.prototype.onData.call(self, data);
            }, 0);
          };
        }WS.prototype.write = function (packets) {
          var self = this;this.writable = false;var total = packets.length;for (var i = 0, l = total; i < l; i++) {
            (function (packet) {
              parser.encodePacket(packet, self.supportsBinary, function (data) {
                if (!BrowserWebSocket) {
                  var opts = {};if (packet.options) {
                    opts.compress = packet.options.compress;
                  }if (self.perMessageDeflate) {
                    var len = "string" == typeof data ? global.Buffer.byteLength(data) : data.length;if (len < self.perMessageDeflate.threshold) {
                      opts.compress = false;
                    }
                  }
                }try {
                  if (BrowserWebSocket) {
                    self.ws.send(data);
                  } else {
                    self.ws.send(data, opts);
                  }
                } catch (e) {
                  debug("websocket closed before onclose event");
                }--total || done();
              });
            })(packets[i]);
          }function done() {
            self.emit("flush");setTimeout(function () {
              self.writable = true;self.emit("drain");
            }, 0);
          }
        };WS.prototype.onClose = function () {
          Transport.prototype.onClose.call(this);
        };WS.prototype.doClose = function () {
          if (typeof this.ws !== "undefined") {
            this.ws.close();
          }
        };WS.prototype.uri = function () {
          var query = this.query || {};var schema = this.secure ? "wss" : "ws";var port = "";if (this.port && ("wss" == schema && this.port != 443 || "ws" == schema && this.port != 80)) {
            port = ":" + this.port;
          }if (this.timestampRequests) {
            query[this.timestampParam] = yeast();
          }if (!this.supportsBinary) {
            query.b64 = 1;
          }query = parseqs.encode(query);if (query.length) {
            query = "?" + query;
          }var ipv6 = this.hostname.indexOf(":") !== -1;return schema + "://" + (ipv6 ? "[" + this.hostname + "]" : this.hostname) + port + this.path + query;
        };WS.prototype.check = function () {
          return !!WebSocket && !("__initialize" in WebSocket && this.name === WS.prototype.name);
        };
      }).call(this, typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {});
    }, { "../transport": 4, "component-inherit": 16, debug: 17, "engine.io-parser": 19, parseqs: 27, ws: undefined, yeast: 30 }], 10: [function (_dereq_, module, exports) {
      var hasCORS = _dereq_("has-cors");module.exports = function (opts) {
        var xdomain = opts.xdomain;var xscheme = opts.xscheme;var enablesXDR = opts.enablesXDR;try {
          if ("undefined" != typeof XMLHttpRequest && (!xdomain || hasCORS)) {
            return new XMLHttpRequest();
          }
        } catch (e) {}try {
          if ("undefined" != typeof XDomainRequest && !xscheme && enablesXDR) {
            return new XDomainRequest();
          }
        } catch (e) {}if (!xdomain) {
          try {
            return new ActiveXObject("Microsoft.XMLHTTP");
          } catch (e) {}
        }
      };
    }, { "has-cors": 22 }], 11: [function (_dereq_, module, exports) {
      module.exports = after;function after(count, callback, err_cb) {
        var bail = false;err_cb = err_cb || noop;proxy.count = count;return count === 0 ? callback() : proxy;function proxy(err, result) {
          if (proxy.count <= 0) {
            throw new Error("after called too many times");
          }--proxy.count;if (err) {
            bail = true;callback(err);callback = err_cb;
          } else if (proxy.count === 0 && !bail) {
            callback(null, result);
          }
        }
      }function noop() {}
    }, {}], 12: [function (_dereq_, module, exports) {
      module.exports = function (arraybuffer, start, end) {
        var bytes = arraybuffer.byteLength;start = start || 0;end = end || bytes;if (arraybuffer.slice) {
          return arraybuffer.slice(start, end);
        }if (start < 0) {
          start += bytes;
        }if (end < 0) {
          end += bytes;
        }if (end > bytes) {
          end = bytes;
        }if (start >= bytes || start >= end || bytes === 0) {
          return new ArrayBuffer(0);
        }var abv = new Uint8Array(arraybuffer);var result = new Uint8Array(end - start);for (var i = start, ii = 0; i < end; i++, ii++) {
          result[ii] = abv[i];
        }return result.buffer;
      };
    }, {}], 13: [function (_dereq_, module, exports) {
      (function (chars) {
        "use strict";exports.encode = function (arraybuffer) {
          var bytes = new Uint8Array(arraybuffer),
              i,
              len = bytes.length,
              base64 = "";for (i = 0; i < len; i += 3) {
            base64 += chars[bytes[i] >> 2];
            base64 += chars[(bytes[i] & 3) << 4 | bytes[i + 1] >> 4];base64 += chars[(bytes[i + 1] & 15) << 2 | bytes[i + 2] >> 6];base64 += chars[bytes[i + 2] & 63];
          }if (len % 3 === 2) {
            base64 = base64.substring(0, base64.length - 1) + "=";
          } else if (len % 3 === 1) {
            base64 = base64.substring(0, base64.length - 2) + "==";
          }return base64;
        };exports.decode = function (base64) {
          var bufferLength = base64.length * .75,
              len = base64.length,
              i,
              p = 0,
              encoded1,
              encoded2,
              encoded3,
              encoded4;if (base64[base64.length - 1] === "=") {
            bufferLength--;if (base64[base64.length - 2] === "=") {
              bufferLength--;
            }
          }var arraybuffer = new ArrayBuffer(bufferLength),
              bytes = new Uint8Array(arraybuffer);for (i = 0; i < len; i += 4) {
            encoded1 = chars.indexOf(base64[i]);encoded2 = chars.indexOf(base64[i + 1]);encoded3 = chars.indexOf(base64[i + 2]);encoded4 = chars.indexOf(base64[i + 3]);bytes[p++] = encoded1 << 2 | encoded2 >> 4;bytes[p++] = (encoded2 & 15) << 4 | encoded3 >> 2;bytes[p++] = (encoded3 & 3) << 6 | encoded4 & 63;
          }return arraybuffer;
        };
      })("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/");
    }, {}], 14: [function (_dereq_, module, exports) {
      (function (global) {
        var BlobBuilder = global.BlobBuilder || global.WebKitBlobBuilder || global.MSBlobBuilder || global.MozBlobBuilder;var blobSupported = (function () {
          try {
            var a = new Blob(["hi"]);return a.size === 2;
          } catch (e) {
            return false;
          }
        })();var blobSupportsArrayBufferView = blobSupported && (function () {
          try {
            var b = new Blob([new Uint8Array([1, 2])]);return b.size === 2;
          } catch (e) {
            return false;
          }
        })();var blobBuilderSupported = BlobBuilder && BlobBuilder.prototype.append && BlobBuilder.prototype.getBlob;function mapArrayBufferViews(ary) {
          for (var i = 0; i < ary.length; i++) {
            var chunk = ary[i];if (chunk.buffer instanceof ArrayBuffer) {
              var buf = chunk.buffer;if (chunk.byteLength !== buf.byteLength) {
                var copy = new Uint8Array(chunk.byteLength);copy.set(new Uint8Array(buf, chunk.byteOffset, chunk.byteLength));buf = copy.buffer;
              }ary[i] = buf;
            }
          }
        }function BlobBuilderConstructor(ary, options) {
          options = options || {};var bb = new BlobBuilder();mapArrayBufferViews(ary);for (var i = 0; i < ary.length; i++) {
            bb.append(ary[i]);
          }return options.type ? bb.getBlob(options.type) : bb.getBlob();
        }function BlobConstructor(ary, options) {
          mapArrayBufferViews(ary);return new Blob(ary, options || {});
        }module.exports = (function () {
          if (blobSupported) {
            return blobSupportsArrayBufferView ? global.Blob : BlobConstructor;
          } else if (blobBuilderSupported) {
            return BlobBuilderConstructor;
          } else {
            return undefined;
          }
        })();
      }).call(this, typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {});
    }, {}], 15: [function (_dereq_, module, exports) {
      module.exports = Emitter;function Emitter(obj) {
        if (obj) return mixin(obj);
      }function mixin(obj) {
        for (var key in Emitter.prototype) {
          obj[key] = Emitter.prototype[key];
        }return obj;
      }Emitter.prototype.on = Emitter.prototype.addEventListener = function (event, fn) {
        this._callbacks = this._callbacks || {};(this._callbacks[event] = this._callbacks[event] || []).push(fn);return this;
      };Emitter.prototype.once = function (event, fn) {
        var self = this;this._callbacks = this._callbacks || {};function on() {
          self.off(event, on);fn.apply(this, arguments);
        }on.fn = fn;this.on(event, on);return this;
      };Emitter.prototype.off = Emitter.prototype.removeListener = Emitter.prototype.removeAllListeners = Emitter.prototype.removeEventListener = function (event, fn) {
        this._callbacks = this._callbacks || {};if (0 == arguments.length) {
          this._callbacks = {};return this;
        }var callbacks = this._callbacks[event];if (!callbacks) return this;if (1 == arguments.length) {
          delete this._callbacks[event];return this;
        }var cb;for (var i = 0; i < callbacks.length; i++) {
          cb = callbacks[i];if (cb === fn || cb.fn === fn) {
            callbacks.splice(i, 1);break;
          }
        }return this;
      };Emitter.prototype.emit = function (event) {
        this._callbacks = this._callbacks || {};var args = [].slice.call(arguments, 1),
            callbacks = this._callbacks[event];if (callbacks) {
          callbacks = callbacks.slice(0);for (var i = 0, len = callbacks.length; i < len; ++i) {
            callbacks[i].apply(this, args);
          }
        }return this;
      };Emitter.prototype.listeners = function (event) {
        this._callbacks = this._callbacks || {};return this._callbacks[event] || [];
      };Emitter.prototype.hasListeners = function (event) {
        return !!this.listeners(event).length;
      };
    }, {}], 16: [function (_dereq_, module, exports) {
      module.exports = function (a, b) {
        var fn = function fn() {};fn.prototype = b.prototype;a.prototype = new fn();a.prototype.constructor = a;
      };
    }, {}], 17: [function (_dereq_, module, exports) {
      exports = module.exports = _dereq_("./debug");exports.log = log;exports.formatArgs = formatArgs;exports.save = save;exports.load = load;exports.useColors = useColors;exports.storage = "undefined" != typeof chrome && "undefined" != typeof chrome.storage ? chrome.storage.local : localstorage();exports.colors = ["lightseagreen", "forestgreen", "goldenrod", "dodgerblue", "darkorchid", "crimson"];function useColors() {
        return "WebkitAppearance" in document.documentElement.style || window.console && (console.firebug || console.exception && console.table) || navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/) && parseInt(RegExp.$1, 10) >= 31;
      }exports.formatters.j = function (v) {
        return JSON.stringify(v);
      };function formatArgs() {
        var args = arguments;var useColors = this.useColors;args[0] = (useColors ? "%c" : "") + this.namespace + (useColors ? " %c" : " ") + args[0] + (useColors ? "%c " : " ") + "+" + exports.humanize(this.diff);if (!useColors) return args;var c = "color: " + this.color;args = [args[0], c, "color: inherit"].concat(Array.prototype.slice.call(args, 1));var index = 0;var lastC = 0;args[0].replace(/%[a-z%]/g, function (match) {
          if ("%%" === match) return;index++;if ("%c" === match) {
            lastC = index;
          }
        });args.splice(lastC, 0, c);return args;
      }function log() {
        return "object" === typeof console && console.log && Function.prototype.apply.call(console.log, console, arguments);
      }function save(namespaces) {
        try {
          if (null == namespaces) {
            exports.storage.removeItem("debug");
          } else {
            exports.storage.debug = namespaces;
          }
        } catch (e) {}
      }function load() {
        var r;try {
          r = exports.storage.debug;
        } catch (e) {}return r;
      }exports.enable(load());function localstorage() {
        try {
          return window.localStorage;
        } catch (e) {}
      }
    }, { "./debug": 18 }], 18: [function (_dereq_, module, exports) {
      exports = module.exports = debug;exports.coerce = coerce;exports.disable = disable;exports.enable = enable;exports.enabled = enabled;exports.humanize = _dereq_("ms");exports.names = [];exports.skips = [];exports.formatters = {};var prevColor = 0;var prevTime;function selectColor() {
        return exports.colors[prevColor++ % exports.colors.length];
      }function debug(namespace) {
        function disabled() {}disabled.enabled = false;function enabled() {
          var self = enabled;var curr = +new Date();var ms = curr - (prevTime || curr);self.diff = ms;self.prev = prevTime;self.curr = curr;prevTime = curr;if (null == self.useColors) self.useColors = exports.useColors();if (null == self.color && self.useColors) self.color = selectColor();var args = Array.prototype.slice.call(arguments);args[0] = exports.coerce(args[0]);if ("string" !== typeof args[0]) {
            args = ["%o"].concat(args);
          }var index = 0;args[0] = args[0].replace(/%([a-z%])/g, function (match, format) {
            if (match === "%%") return match;index++;var formatter = exports.formatters[format];if ("function" === typeof formatter) {
              var val = args[index];match = formatter.call(self, val);args.splice(index, 1);index--;
            }return match;
          });if ("function" === typeof exports.formatArgs) {
            args = exports.formatArgs.apply(self, args);
          }var logFn = enabled.log || exports.log || console.log.bind(console);logFn.apply(self, args);
        }enabled.enabled = true;var fn = exports.enabled(namespace) ? enabled : disabled;fn.namespace = namespace;return fn;
      }function enable(namespaces) {
        exports.save(namespaces);var split = (namespaces || "").split(/[\s,]+/);var len = split.length;for (var i = 0; i < len; i++) {
          if (!split[i]) continue;namespaces = split[i].replace(/\*/g, ".*?");if (namespaces[0] === "-") {
            exports.skips.push(new RegExp("^" + namespaces.substr(1) + "$"));
          } else {
            exports.names.push(new RegExp("^" + namespaces + "$"));
          }
        }
      }function disable() {
        exports.enable("");
      }function enabled(name) {
        var i, len;for (i = 0, len = exports.skips.length; i < len; i++) {
          if (exports.skips[i].test(name)) {
            return false;
          }
        }for (i = 0, len = exports.names.length; i < len; i++) {
          if (exports.names[i].test(name)) {
            return true;
          }
        }return false;
      }function coerce(val) {
        if (val instanceof Error) return val.stack || val.message;return val;
      }
    }, { ms: 25 }], 19: [function (_dereq_, module, exports) {
      (function (global) {
        var keys = _dereq_("./keys");var hasBinary = _dereq_("has-binary");var sliceBuffer = _dereq_("arraybuffer.slice");var base64encoder = _dereq_("base64-arraybuffer");var after = _dereq_("after");var utf8 = _dereq_("utf8");var isAndroid = navigator.userAgent.match(/Android/i);var isPhantomJS = /PhantomJS/i.test(navigator.userAgent);var dontSendBlobs = isAndroid || isPhantomJS;exports.protocol = 3;var packets = exports.packets = { open: 0, close: 1, ping: 2, pong: 3, message: 4, upgrade: 5, noop: 6 };var packetslist = keys(packets);var err = { type: "error", data: "parser error" };var Blob = _dereq_("blob");exports.encodePacket = function (packet, supportsBinary, utf8encode, callback) {
          if ("function" == typeof supportsBinary) {
            callback = supportsBinary;supportsBinary = false;
          }if ("function" == typeof utf8encode) {
            callback = utf8encode;utf8encode = null;
          }var data = packet.data === undefined ? undefined : packet.data.buffer || packet.data;if (global.ArrayBuffer && data instanceof ArrayBuffer) {
            return encodeArrayBuffer(packet, supportsBinary, callback);
          } else if (Blob && data instanceof global.Blob) {
            return encodeBlob(packet, supportsBinary, callback);
          }if (data && data.base64) {
            return encodeBase64Object(packet, callback);
          }var encoded = packets[packet.type];if (undefined !== packet.data) {
            encoded += utf8encode ? utf8.encode(String(packet.data)) : String(packet.data);
          }return callback("" + encoded);
        };function encodeBase64Object(packet, callback) {
          var message = "b" + exports.packets[packet.type] + packet.data.data;return callback(message);
        }function encodeArrayBuffer(packet, supportsBinary, callback) {
          if (!supportsBinary) {
            return exports.encodeBase64Packet(packet, callback);
          }var data = packet.data;var contentArray = new Uint8Array(data);var resultBuffer = new Uint8Array(1 + data.byteLength);resultBuffer[0] = packets[packet.type];for (var i = 0; i < contentArray.length; i++) {
            resultBuffer[i + 1] = contentArray[i];
          }return callback(resultBuffer.buffer);
        }function encodeBlobAsArrayBuffer(packet, supportsBinary, callback) {
          if (!supportsBinary) {
            return exports.encodeBase64Packet(packet, callback);
          }var fr = new FileReader();fr.onload = function () {
            packet.data = fr.result;exports.encodePacket(packet, supportsBinary, true, callback);
          };return fr.readAsArrayBuffer(packet.data);
        }function encodeBlob(packet, supportsBinary, callback) {
          if (!supportsBinary) {
            return exports.encodeBase64Packet(packet, callback);
          }if (dontSendBlobs) {
            return encodeBlobAsArrayBuffer(packet, supportsBinary, callback);
          }var length = new Uint8Array(1);length[0] = packets[packet.type];var blob = new Blob([length.buffer, packet.data]);return callback(blob);
        }exports.encodeBase64Packet = function (packet, callback) {
          var message = "b" + exports.packets[packet.type];if (Blob && packet.data instanceof global.Blob) {
            var fr = new FileReader();fr.onload = function () {
              var b64 = fr.result.split(",")[1];callback(message + b64);
            };return fr.readAsDataURL(packet.data);
          }var b64data;try {
            b64data = String.fromCharCode.apply(null, new Uint8Array(packet.data));
          } catch (e) {
            var typed = new Uint8Array(packet.data);var basic = new Array(typed.length);for (var i = 0; i < typed.length; i++) {
              basic[i] = typed[i];
            }b64data = String.fromCharCode.apply(null, basic);
          }message += global.btoa(b64data);return callback(message);
        };exports.decodePacket = function (data, binaryType, utf8decode) {
          if (typeof data == "string" || data === undefined) {
            if (data.charAt(0) == "b") {
              return exports.decodeBase64Packet(data.substr(1), binaryType);
            }if (utf8decode) {
              try {
                data = utf8.decode(data);
              } catch (e) {
                return err;
              }
            }var type = data.charAt(0);if (Number(type) != type || !packetslist[type]) {
              return err;
            }if (data.length > 1) {
              return { type: packetslist[type], data: data.substring(1) };
            } else {
              return { type: packetslist[type] };
            }
          }var asArray = new Uint8Array(data);var type = asArray[0];var rest = sliceBuffer(data, 1);if (Blob && binaryType === "blob") {
            rest = new Blob([rest]);
          }return { type: packetslist[type], data: rest };
        };exports.decodeBase64Packet = function (msg, binaryType) {
          var type = packetslist[msg.charAt(0)];if (!global.ArrayBuffer) {
            return { type: type, data: { base64: true, data: msg.substr(1) } };
          }var data = base64encoder.decode(msg.substr(1));if (binaryType === "blob" && Blob) {
            data = new Blob([data]);
          }return { type: type, data: data };
        };exports.encodePayload = function (packets, supportsBinary, callback) {
          if (typeof supportsBinary == "function") {
            callback = supportsBinary;supportsBinary = null;
          }var isBinary = hasBinary(packets);if (supportsBinary && isBinary) {
            if (Blob && !dontSendBlobs) {
              return exports.encodePayloadAsBlob(packets, callback);
            }return exports.encodePayloadAsArrayBuffer(packets, callback);
          }if (!packets.length) {
            return callback("0:");
          }function setLengthHeader(message) {
            return message.length + ":" + message;
          }function encodeOne(packet, doneCallback) {
            exports.encodePacket(packet, !isBinary ? false : supportsBinary, true, function (message) {
              doneCallback(null, setLengthHeader(message));
            });
          }map(packets, encodeOne, function (err, results) {
            return callback(results.join(""));
          });
        };function map(ary, each, done) {
          var result = new Array(ary.length);var next = after(ary.length, done);var eachWithIndex = function eachWithIndex(i, el, cb) {
            each(el, function (error, msg) {
              result[i] = msg;cb(error, result);
            });
          };for (var i = 0; i < ary.length; i++) {
            eachWithIndex(i, ary[i], next);
          }
        }exports.decodePayload = function (data, binaryType, callback) {
          if (typeof data != "string") {
            return exports.decodePayloadAsBinary(data, binaryType, callback);
          }if (typeof binaryType === "function") {
            callback = binaryType;binaryType = null;
          }var packet;if (data == "") {
            return callback(err, 0, 1);
          }var length = "",
              n,
              msg;for (var i = 0, l = data.length; i < l; i++) {
            var chr = data.charAt(i);if (":" != chr) {
              length += chr;
            } else {
              if ("" == length || length != (n = Number(length))) {
                return callback(err, 0, 1);
              }msg = data.substr(i + 1, n);if (length != msg.length) {
                return callback(err, 0, 1);
              }if (msg.length) {
                packet = exports.decodePacket(msg, binaryType, true);if (err.type == packet.type && err.data == packet.data) {
                  return callback(err, 0, 1);
                }var ret = callback(packet, i + n, l);if (false === ret) return;
              }i += n;length = "";
            }
          }if (length != "") {
            return callback(err, 0, 1);
          }
        };exports.encodePayloadAsArrayBuffer = function (packets, callback) {
          if (!packets.length) {
            return callback(new ArrayBuffer(0));
          }function encodeOne(packet, doneCallback) {
            exports.encodePacket(packet, true, true, function (data) {
              return doneCallback(null, data);
            });
          }map(packets, encodeOne, function (err, encodedPackets) {
            var totalLength = encodedPackets.reduce(function (acc, p) {
              var len;if (typeof p === "string") {
                len = p.length;
              } else {
                len = p.byteLength;
              }return acc + len.toString().length + len + 2;
            }, 0);var resultArray = new Uint8Array(totalLength);var bufferIndex = 0;encodedPackets.forEach(function (p) {
              var isString = typeof p === "string";var ab = p;if (isString) {
                var view = new Uint8Array(p.length);for (var i = 0; i < p.length; i++) {
                  view[i] = p.charCodeAt(i);
                }ab = view.buffer;
              }if (isString) {
                resultArray[bufferIndex++] = 0;
              } else {
                resultArray[bufferIndex++] = 1;
              }var lenStr = ab.byteLength.toString();for (var i = 0; i < lenStr.length; i++) {
                resultArray[bufferIndex++] = parseInt(lenStr[i]);
              }resultArray[bufferIndex++] = 255;var view = new Uint8Array(ab);for (var i = 0; i < view.length; i++) {
                resultArray[bufferIndex++] = view[i];
              }
            });return callback(resultArray.buffer);
          });
        };exports.encodePayloadAsBlob = function (packets, callback) {
          function encodeOne(packet, doneCallback) {
            exports.encodePacket(packet, true, true, function (encoded) {
              var binaryIdentifier = new Uint8Array(1);binaryIdentifier[0] = 1;if (typeof encoded === "string") {
                var view = new Uint8Array(encoded.length);for (var i = 0; i < encoded.length; i++) {
                  view[i] = encoded.charCodeAt(i);
                }encoded = view.buffer;binaryIdentifier[0] = 0;
              }var len = encoded instanceof ArrayBuffer ? encoded.byteLength : encoded.size;var lenStr = len.toString();var lengthAry = new Uint8Array(lenStr.length + 1);for (var i = 0; i < lenStr.length; i++) {
                lengthAry[i] = parseInt(lenStr[i]);
              }lengthAry[lenStr.length] = 255;if (Blob) {
                var blob = new Blob([binaryIdentifier.buffer, lengthAry.buffer, encoded]);doneCallback(null, blob);
              }
            });
          }map(packets, encodeOne, function (err, results) {
            return callback(new Blob(results));
          });
        };exports.decodePayloadAsBinary = function (data, binaryType, callback) {
          if (typeof binaryType === "function") {
            callback = binaryType;binaryType = null;
          }var bufferTail = data;var buffers = [];var numberTooLong = false;while (bufferTail.byteLength > 0) {
            var tailArray = new Uint8Array(bufferTail);var isString = tailArray[0] === 0;var msgLength = "";for (var i = 1;; i++) {
              if (tailArray[i] == 255) break;if (msgLength.length > 310) {
                numberTooLong = true;break;
              }msgLength += tailArray[i];
            }if (numberTooLong) return callback(err, 0, 1);bufferTail = sliceBuffer(bufferTail, 2 + msgLength.length);msgLength = parseInt(msgLength);var msg = sliceBuffer(bufferTail, 0, msgLength);if (isString) {
              try {
                msg = String.fromCharCode.apply(null, new Uint8Array(msg));
              } catch (e) {
                var typed = new Uint8Array(msg);msg = "";for (var i = 0; i < typed.length; i++) {
                  msg += String.fromCharCode(typed[i]);
                }
              }
            }buffers.push(msg);bufferTail = sliceBuffer(bufferTail, msgLength);
          }var total = buffers.length;buffers.forEach(function (buffer, i) {
            callback(exports.decodePacket(buffer, binaryType, true), i, total);
          });
        };
      }).call(this, typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {});
    }, { "./keys": 20, after: 11, "arraybuffer.slice": 12, "base64-arraybuffer": 13, blob: 14, "has-binary": 21, utf8: 29 }], 20: [function (_dereq_, module, exports) {
      module.exports = Object.keys || function keys(obj) {
        var arr = [];var has = Object.prototype.hasOwnProperty;for (var i in obj) {
          if (has.call(obj, i)) {
            arr.push(i);
          }
        }return arr;
      };
    }, {}], 21: [function (_dereq_, module, exports) {
      (function (global) {
        var isArray = _dereq_("isarray");module.exports = hasBinary;function hasBinary(data) {
          function _hasBinary(obj) {
            if (!obj) return false;if (global.Buffer && global.Buffer.isBuffer(obj) || global.ArrayBuffer && obj instanceof ArrayBuffer || global.Blob && obj instanceof Blob || global.File && obj instanceof File) {
              return true;
            }if (isArray(obj)) {
              for (var i = 0; i < obj.length; i++) {
                if (_hasBinary(obj[i])) {
                  return true;
                }
              }
            } else if (obj && "object" == typeof obj) {
              if (obj.toJSON) {
                obj = obj.toJSON();
              }for (var key in obj) {
                if (Object.prototype.hasOwnProperty.call(obj, key) && _hasBinary(obj[key])) {
                  return true;
                }
              }
            }return false;
          }return _hasBinary(data);
        }
      }).call(this, typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {});
    }, { isarray: 24 }], 22: [function (_dereq_, module, exports) {
      try {
        module.exports = typeof XMLHttpRequest !== "undefined" && "withCredentials" in new XMLHttpRequest();
      } catch (err) {
        module.exports = false;
      }
    }, {}], 23: [function (_dereq_, module, exports) {
      var indexOf = [].indexOf;module.exports = function (arr, obj) {
        if (indexOf) return arr.indexOf(obj);for (var i = 0; i < arr.length; ++i) {
          if (arr[i] === obj) return i;
        }return -1;
      };
    }, {}], 24: [function (_dereq_, module, exports) {
      module.exports = Array.isArray || function (arr) {
        return Object.prototype.toString.call(arr) == "[object Array]";
      };
    }, {}], 25: [function (_dereq_, module, exports) {
      var s = 1e3;var m = s * 60;var h = m * 60;var d = h * 24;var y = d * 365.25;module.exports = function (val, options) {
        options = options || {};if ("string" == typeof val) return parse(val);return options.long ? long(val) : short(val);
      };function parse(str) {
        str = "" + str;if (str.length > 1e4) return;var match = /^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(str);if (!match) return;var n = parseFloat(match[1]);var type = (match[2] || "ms").toLowerCase();switch (type) {case "years":case "year":case "yrs":case "yr":case "y":
            return n * y;case "days":case "day":case "d":
            return n * d;case "hours":case "hour":case "hrs":case "hr":case "h":
            return n * h;case "minutes":case "minute":case "mins":case "min":case "m":
            return n * m;case "seconds":case "second":case "secs":case "sec":case "s":
            return n * s;case "milliseconds":case "millisecond":case "msecs":case "msec":case "ms":
            return n;}
      }function short(ms) {
        if (ms >= d) return Math.round(ms / d) + "d";if (ms >= h) return Math.round(ms / h) + "h";if (ms >= m) return Math.round(ms / m) + "m";if (ms >= s) return Math.round(ms / s) + "s";return ms + "ms";
      }function long(ms) {
        return plural(ms, d, "day") || plural(ms, h, "hour") || plural(ms, m, "minute") || plural(ms, s, "second") || ms + " ms";
      }function plural(ms, n, name) {
        if (ms < n) return;if (ms < n * 1.5) return Math.floor(ms / n) + " " + name;return Math.ceil(ms / n) + " " + name + "s";
      }
    }, {}], 26: [function (_dereq_, module, exports) {
      (function (global) {
        var rvalidchars = /^[\],:{}\s]*$/;var rvalidescape = /\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g;var rvalidtokens = /"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g;var rvalidbraces = /(?:^|:|,)(?:\s*\[)+/g;var rtrimLeft = /^\s+/;var rtrimRight = /\s+$/;module.exports = function parsejson(data) {
          if ("string" != typeof data || !data) {
            return null;
          }data = data.replace(rtrimLeft, "").replace(rtrimRight, "");if (global.JSON && JSON.parse) {
            return JSON.parse(data);
          }if (rvalidchars.test(data.replace(rvalidescape, "@").replace(rvalidtokens, "]").replace(rvalidbraces, ""))) {
            return new Function("return " + data)();
          }
        };
      }).call(this, typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {});
    }, {}], 27: [function (_dereq_, module, exports) {
      exports.encode = function (obj) {
        var str = "";for (var i in obj) {
          if (obj.hasOwnProperty(i)) {
            if (str.length) str += "&";str += encodeURIComponent(i) + "=" + encodeURIComponent(obj[i]);
          }
        }return str;
      };exports.decode = function (qs) {
        var qry = {};var pairs = qs.split("&");for (var i = 0, l = pairs.length; i < l; i++) {
          var pair = pairs[i].split("=");qry[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1]);
        }return qry;
      };
    }, {}], 28: [function (_dereq_, module, exports) {
      var re = /^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;var parts = ["source", "protocol", "authority", "userInfo", "user", "password", "host", "port", "relative", "path", "directory", "file", "query", "anchor"];module.exports = function parseuri(str) {
        var src = str,
            b = str.indexOf("["),
            e = str.indexOf("]");if (b != -1 && e != -1) {
          str = str.substring(0, b) + str.substring(b, e).replace(/:/g, ";") + str.substring(e, str.length);
        }var m = re.exec(str || ""),
            uri = {},
            i = 14;while (i--) {
          uri[parts[i]] = m[i] || "";
        }if (b != -1 && e != -1) {
          uri.source = src;uri.host = uri.host.substring(1, uri.host.length - 1).replace(/;/g, ":");uri.authority = uri.authority.replace("[", "").replace("]", "").replace(/;/g, ":");uri.ipv6uri = true;
        }return uri;
      };
    }, {}], 29: [function (_dereq_, module, exports) {
      (function (global) {
        (function (root) {
          var freeExports = typeof exports == "object" && exports;var freeModule = typeof module == "object" && module && module.exports == freeExports && module;var freeGlobal = typeof global == "object" && global;if (freeGlobal.global === freeGlobal || freeGlobal.window === freeGlobal) {
            root = freeGlobal;
          }var stringFromCharCode = String.fromCharCode;function ucs2decode(string) {
            var output = [];var counter = 0;var length = string.length;var value;var extra;while (counter < length) {
              value = string.charCodeAt(counter++);if (value >= 55296 && value <= 56319 && counter < length) {
                extra = string.charCodeAt(counter++);if ((extra & 64512) == 56320) {
                  output.push(((value & 1023) << 10) + (extra & 1023) + 65536);
                } else {
                  output.push(value);counter--;
                }
              } else {
                output.push(value);
              }
            }return output;
          }function ucs2encode(array) {
            var length = array.length;var index = -1;var value;var output = "";while (++index < length) {
              value = array[index];if (value > 65535) {
                value -= 65536;output += stringFromCharCode(value >>> 10 & 1023 | 55296);value = 56320 | value & 1023;
              }output += stringFromCharCode(value);
            }return output;
          }function checkScalarValue(codePoint) {
            if (codePoint >= 55296 && codePoint <= 57343) {
              throw Error("Lone surrogate U+" + codePoint.toString(16).toUpperCase() + " is not a scalar value");
            }
          }function createByte(codePoint, shift) {
            return stringFromCharCode(codePoint >> shift & 63 | 128);
          }function encodeCodePoint(codePoint) {
            if ((codePoint & 4294967168) == 0) {
              return stringFromCharCode(codePoint);
            }var symbol = "";if ((codePoint & 4294965248) == 0) {
              symbol = stringFromCharCode(codePoint >> 6 & 31 | 192);
            } else if ((codePoint & 4294901760) == 0) {
              checkScalarValue(codePoint);symbol = stringFromCharCode(codePoint >> 12 & 15 | 224);symbol += createByte(codePoint, 6);
            } else if ((codePoint & 4292870144) == 0) {
              symbol = stringFromCharCode(codePoint >> 18 & 7 | 240);symbol += createByte(codePoint, 12);symbol += createByte(codePoint, 6);
            }symbol += stringFromCharCode(codePoint & 63 | 128);return symbol;
          }function utf8encode(string) {
            var codePoints = ucs2decode(string);var length = codePoints.length;var index = -1;var codePoint;var byteString = "";while (++index < length) {
              codePoint = codePoints[index];byteString += encodeCodePoint(codePoint);
            }return byteString;
          }function readContinuationByte() {
            if (byteIndex >= byteCount) {
              throw Error("Invalid byte index");
            }var continuationByte = byteArray[byteIndex] & 255;byteIndex++;if ((continuationByte & 192) == 128) {
              return continuationByte & 63;
            }throw Error("Invalid continuation byte");
          }function decodeSymbol() {
            var byte1;var byte2;var byte3;var byte4;var codePoint;if (byteIndex > byteCount) {
              throw Error("Invalid byte index");
            }if (byteIndex == byteCount) {
              return false;
            }byte1 = byteArray[byteIndex] & 255;byteIndex++;if ((byte1 & 128) == 0) {
              return byte1;
            }if ((byte1 & 224) == 192) {
              var byte2 = readContinuationByte();codePoint = (byte1 & 31) << 6 | byte2;if (codePoint >= 128) {
                return codePoint;
              } else {
                throw Error("Invalid continuation byte");
              }
            }if ((byte1 & 240) == 224) {
              byte2 = readContinuationByte();byte3 = readContinuationByte();codePoint = (byte1 & 15) << 12 | byte2 << 6 | byte3;if (codePoint >= 2048) {
                checkScalarValue(codePoint);return codePoint;
              } else {
                throw Error("Invalid continuation byte");
              }
            }if ((byte1 & 248) == 240) {
              byte2 = readContinuationByte();byte3 = readContinuationByte();byte4 = readContinuationByte();codePoint = (byte1 & 15) << 18 | byte2 << 12 | byte3 << 6 | byte4;if (codePoint >= 65536 && codePoint <= 1114111) {
                return codePoint;
              }
            }throw Error("Invalid UTF-8 detected");
          }var byteArray;var byteCount;var byteIndex;function utf8decode(byteString) {
            byteArray = ucs2decode(byteString);byteCount = byteArray.length;byteIndex = 0;var codePoints = [];var tmp;while ((tmp = decodeSymbol()) !== false) {
              codePoints.push(tmp);
            }return ucs2encode(codePoints);
          }var utf8 = { version: "2.0.0", encode: utf8encode, decode: utf8decode };if (typeof define == "function" && typeof define.amd == "object" && define.amd) {
            define(function () {
              return utf8;
            });
          } else if (freeExports && !freeExports.nodeType) {
            if (freeModule) {
              freeModule.exports = utf8;
            } else {
              var object = {};var hasOwnProperty = object.hasOwnProperty;for (var key in utf8) {
                hasOwnProperty.call(utf8, key) && (freeExports[key] = utf8[key]);
              }
            }
          } else {
            root.utf8 = utf8;
          }
        })(this);
      }).call(this, typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {});
    }, {}], 30: [function (_dereq_, module, exports) {
      "use strict";var alphabet = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),
          length = 64,
          map = {},
          seed = 0,
          i = 0,
          prev;function encode(num) {
        var encoded = "";do {
          encoded = alphabet[num % length] + encoded;num = Math.floor(num / length);
        } while (num > 0);return encoded;
      }function decode(str) {
        var decoded = 0;for (i = 0; i < str.length; i++) {
          decoded = decoded * length + map[str.charAt(i)];
        }return decoded;
      }function yeast() {
        var now = encode(+new Date());if (now !== prev) return seed = 0, prev = now;return now + "." + encode(seed++);
      }for (; i < length; i++) map[alphabet[i]] = i;yeast.encode = encode;yeast.decode = decode;module.exports = yeast;
    }, {}], 31: [function (_dereq_, module, exports) {
      var url = _dereq_("./url");var parser = _dereq_("socket.io-parser");var Manager = _dereq_("./manager");var debug = _dereq_("debug")("socket.io-client");module.exports = exports = lookup;var cache = exports.managers = {};function lookup(uri, opts) {
        if (typeof uri == "object") {
          opts = uri;uri = undefined;
        }opts = opts || {};var parsed = url(uri);var source = parsed.source;var id = parsed.id;var path = parsed.path;var sameNamespace = cache[id] && path in cache[id].nsps;var newConnection = opts.forceNew || opts["force new connection"] || false === opts.multiplex || sameNamespace;var io;if (newConnection) {
          debug("ignoring socket cache for %s", source);io = Manager(source, opts);
        } else {
          if (!cache[id]) {
            debug("new io instance for %s", source);cache[id] = Manager(source, opts);
          }io = cache[id];
        }return io.socket(parsed.path);
      }exports.protocol = parser.protocol;exports.connect = lookup;exports.Manager = _dereq_("./manager");exports.Socket = _dereq_("./socket");
    }, { "./manager": 32, "./socket": 34, "./url": 35, debug: 39, "socket.io-parser": 47 }], 32: [function (_dereq_, module, exports) {
      var eio = _dereq_("engine.io-client");var Socket = _dereq_("./socket");var Emitter = _dereq_("component-emitter");var parser = _dereq_("socket.io-parser");var on = _dereq_("./on");var bind = _dereq_("component-bind");var debug = _dereq_("debug")("socket.io-client:manager");var indexOf = _dereq_("indexof");var Backoff = _dereq_("backo2");var has = Object.prototype.hasOwnProperty;module.exports = Manager;function Manager(uri, opts) {
        if (!(this instanceof Manager)) return new Manager(uri, opts);if (uri && "object" == typeof uri) {
          opts = uri;uri = undefined;
        }opts = opts || {};opts.path = opts.path || "/socket.io";this.nsps = {};this.subs = [];this.opts = opts;this.reconnection(opts.reconnection !== false);this.reconnectionAttempts(opts.reconnectionAttempts || Infinity);this.reconnectionDelay(opts.reconnectionDelay || 1e3);this.reconnectionDelayMax(opts.reconnectionDelayMax || 5e3);this.randomizationFactor(opts.randomizationFactor || .5);this.backoff = new Backoff({ min: this.reconnectionDelay(), max: this.reconnectionDelayMax(), jitter: this.randomizationFactor() });this.timeout(null == opts.timeout ? 2e4 : opts.timeout);this.readyState = "closed";this.uri = uri;this.connecting = [];this.lastPing = null;this.encoding = false;this.packetBuffer = [];this.encoder = new parser.Encoder();this.decoder = new parser.Decoder();this.autoConnect = opts.autoConnect !== false;if (this.autoConnect) this.open();
      }Manager.prototype.emitAll = function () {
        this.emit.apply(this, arguments);for (var nsp in this.nsps) {
          if (has.call(this.nsps, nsp)) {
            this.nsps[nsp].emit.apply(this.nsps[nsp], arguments);
          }
        }
      };Manager.prototype.updateSocketIds = function () {
        for (var nsp in this.nsps) {
          if (has.call(this.nsps, nsp)) {
            this.nsps[nsp].id = this.engine.id;
          }
        }
      };Emitter(Manager.prototype);Manager.prototype.reconnection = function (v) {
        if (!arguments.length) return this._reconnection;this._reconnection = !!v;return this;
      };Manager.prototype.reconnectionAttempts = function (v) {
        if (!arguments.length) return this._reconnectionAttempts;this._reconnectionAttempts = v;return this;
      };Manager.prototype.reconnectionDelay = function (v) {
        if (!arguments.length) return this._reconnectionDelay;this._reconnectionDelay = v;this.backoff && this.backoff.setMin(v);return this;
      };Manager.prototype.randomizationFactor = function (v) {
        if (!arguments.length) return this._randomizationFactor;this._randomizationFactor = v;this.backoff && this.backoff.setJitter(v);return this;
      };Manager.prototype.reconnectionDelayMax = function (v) {
        if (!arguments.length) return this._reconnectionDelayMax;this._reconnectionDelayMax = v;this.backoff && this.backoff.setMax(v);return this;
      };Manager.prototype.timeout = function (v) {
        if (!arguments.length) return this._timeout;this._timeout = v;return this;
      };Manager.prototype.maybeReconnectOnOpen = function () {
        if (!this.reconnecting && this._reconnection && this.backoff.attempts === 0) {
          this.reconnect();
        }
      };Manager.prototype.open = Manager.prototype.connect = function (fn) {
        debug("readyState %s", this.readyState);if (~this.readyState.indexOf("open")) return this;debug("opening %s", this.uri);this.engine = eio(this.uri, this.opts);var socket = this.engine;var self = this;this.readyState = "opening";this.skipReconnect = false;var openSub = on(socket, "open", function () {
          self.onopen();fn && fn();
        });var errorSub = on(socket, "error", function (data) {
          debug("connect_error");self.cleanup();self.readyState = "closed";self.emitAll("connect_error", data);if (fn) {
            var err = new Error("Connection error");err.data = data;fn(err);
          } else {
            self.maybeReconnectOnOpen();
          }
        });if (false !== this._timeout) {
          var timeout = this._timeout;debug("connect attempt will timeout after %d", timeout);var timer = setTimeout(function () {
            debug("connect attempt timed out after %d", timeout);openSub.destroy();socket.close();socket.emit("error", "timeout");self.emitAll("connect_timeout", timeout);
          }, timeout);this.subs.push({ destroy: function destroy() {
              clearTimeout(timer);
            } });
        }this.subs.push(openSub);this.subs.push(errorSub);return this;
      };Manager.prototype.onopen = function () {
        debug("open");this.cleanup();this.readyState = "open";this.emit("open");var socket = this.engine;this.subs.push(on(socket, "data", bind(this, "ondata")));this.subs.push(on(socket, "ping", bind(this, "onping")));this.subs.push(on(socket, "pong", bind(this, "onpong")));this.subs.push(on(socket, "error", bind(this, "onerror")));this.subs.push(on(socket, "close", bind(this, "onclose")));this.subs.push(on(this.decoder, "decoded", bind(this, "ondecoded")));
      };Manager.prototype.onping = function () {
        this.lastPing = new Date();this.emitAll("ping");
      };Manager.prototype.onpong = function () {
        this.emitAll("pong", new Date() - this.lastPing);
      };Manager.prototype.ondata = function (data) {
        this.decoder.add(data);
      };Manager.prototype.ondecoded = function (packet) {
        this.emit("packet", packet);
      };Manager.prototype.onerror = function (err) {
        debug("error", err);this.emitAll("error", err);
      };Manager.prototype.socket = function (nsp) {
        var socket = this.nsps[nsp];if (!socket) {
          socket = new Socket(this, nsp);this.nsps[nsp] = socket;var self = this;socket.on("connecting", onConnecting);
          socket.on("connect", function () {
            socket.id = self.engine.id;
          });if (this.autoConnect) {
            onConnecting();
          }
        }function onConnecting() {
          if (! ~indexOf(self.connecting, socket)) {
            self.connecting.push(socket);
          }
        }return socket;
      };Manager.prototype.destroy = function (socket) {
        var index = indexOf(this.connecting, socket);if (~index) this.connecting.splice(index, 1);if (this.connecting.length) return;this.close();
      };Manager.prototype.packet = function (packet) {
        debug("writing packet %j", packet);var self = this;if (!self.encoding) {
          self.encoding = true;this.encoder.encode(packet, function (encodedPackets) {
            for (var i = 0; i < encodedPackets.length; i++) {
              self.engine.write(encodedPackets[i], packet.options);
            }self.encoding = false;self.processPacketQueue();
          });
        } else {
          self.packetBuffer.push(packet);
        }
      };Manager.prototype.processPacketQueue = function () {
        if (this.packetBuffer.length > 0 && !this.encoding) {
          var pack = this.packetBuffer.shift();this.packet(pack);
        }
      };Manager.prototype.cleanup = function () {
        debug("cleanup");var sub;while (sub = this.subs.shift()) sub.destroy();this.packetBuffer = [];this.encoding = false;this.lastPing = null;this.decoder.destroy();
      };Manager.prototype.close = Manager.prototype.disconnect = function () {
        debug("disconnect");this.skipReconnect = true;this.reconnecting = false;if ("opening" == this.readyState) {
          this.cleanup();
        }this.backoff.reset();this.readyState = "closed";if (this.engine) this.engine.close();
      };Manager.prototype.onclose = function (reason) {
        debug("onclose");this.cleanup();this.backoff.reset();this.readyState = "closed";this.emit("close", reason);if (this._reconnection && !this.skipReconnect) {
          this.reconnect();
        }
      };Manager.prototype.reconnect = function () {
        if (this.reconnecting || this.skipReconnect) return this;var self = this;if (this.backoff.attempts >= this._reconnectionAttempts) {
          debug("reconnect failed");this.backoff.reset();this.emitAll("reconnect_failed");this.reconnecting = false;
        } else {
          var delay = this.backoff.duration();debug("will wait %dms before reconnect attempt", delay);this.reconnecting = true;var timer = setTimeout(function () {
            if (self.skipReconnect) return;debug("attempting reconnect");self.emitAll("reconnect_attempt", self.backoff.attempts);self.emitAll("reconnecting", self.backoff.attempts);if (self.skipReconnect) return;self.open(function (err) {
              if (err) {
                debug("reconnect attempt error");self.reconnecting = false;self.reconnect();self.emitAll("reconnect_error", err.data);
              } else {
                debug("reconnect success");self.onreconnect();
              }
            });
          }, delay);this.subs.push({ destroy: function destroy() {
              clearTimeout(timer);
            } });
        }
      };Manager.prototype.onreconnect = function () {
        var attempt = this.backoff.attempts;this.reconnecting = false;this.backoff.reset();this.updateSocketIds();this.emitAll("reconnect", attempt);
      };
    }, { "./on": 33, "./socket": 34, backo2: 36, "component-bind": 37, "component-emitter": 38, debug: 39, "engine.io-client": 1, indexof: 42, "socket.io-parser": 47 }], 33: [function (_dereq_, module, exports) {
      module.exports = on;function on(obj, ev, fn) {
        obj.on(ev, fn);return { destroy: function destroy() {
            obj.removeListener(ev, fn);
          } };
      }
    }, {}], 34: [function (_dereq_, module, exports) {
      var parser = _dereq_("socket.io-parser");var Emitter = _dereq_("component-emitter");var toArray = _dereq_("to-array");var on = _dereq_("./on");var bind = _dereq_("component-bind");var debug = _dereq_("debug")("socket.io-client:socket");var hasBin = _dereq_("has-binary");module.exports = exports = Socket;var events = { connect: 1, connect_error: 1, connect_timeout: 1, connecting: 1, disconnect: 1, error: 1, reconnect: 1, reconnect_attempt: 1, reconnect_failed: 1, reconnect_error: 1, reconnecting: 1, ping: 1, pong: 1 };var emit = Emitter.prototype.emit;function Socket(io, nsp) {
        this.io = io;this.nsp = nsp;this.json = this;this.ids = 0;this.acks = {};this.receiveBuffer = [];this.sendBuffer = [];this.connected = false;this.disconnected = true;if (this.io.autoConnect) this.open();
      }Emitter(Socket.prototype);Socket.prototype.subEvents = function () {
        if (this.subs) return;var io = this.io;this.subs = [on(io, "open", bind(this, "onopen")), on(io, "packet", bind(this, "onpacket")), on(io, "close", bind(this, "onclose"))];
      };Socket.prototype.open = Socket.prototype.connect = function () {
        if (this.connected) return this;this.subEvents();this.io.open();if ("open" == this.io.readyState) this.onopen();this.emit("connecting");return this;
      };Socket.prototype.send = function () {
        var args = toArray(arguments);args.unshift("message");this.emit.apply(this, args);return this;
      };Socket.prototype.emit = function (ev) {
        if (events.hasOwnProperty(ev)) {
          emit.apply(this, arguments);return this;
        }var args = toArray(arguments);var parserType = parser.EVENT;if (hasBin(args)) {
          parserType = parser.BINARY_EVENT;
        }var packet = { type: parserType, data: args };packet.options = {};packet.options.compress = !this.flags || false !== this.flags.compress;if ("function" == typeof args[args.length - 1]) {
          debug("emitting packet with ack id %d", this.ids);this.acks[this.ids] = args.pop();packet.id = this.ids++;
        }if (this.connected) {
          this.packet(packet);
        } else {
          this.sendBuffer.push(packet);
        }delete this.flags;return this;
      };Socket.prototype.packet = function (packet) {
        packet.nsp = this.nsp;this.io.packet(packet);
      };Socket.prototype.onopen = function () {
        debug("transport is open - connecting");if ("/" != this.nsp) {
          this.packet({ type: parser.CONNECT });
        }
      };Socket.prototype.onclose = function (reason) {
        debug("close (%s)", reason);this.connected = false;this.disconnected = true;delete this.id;this.emit("disconnect", reason);
      };Socket.prototype.onpacket = function (packet) {
        if (packet.nsp != this.nsp) return;switch (packet.type) {case parser.CONNECT:
            this.onconnect();break;case parser.EVENT:
            this.onevent(packet);break;case parser.BINARY_EVENT:
            this.onevent(packet);break;case parser.ACK:
            this.onack(packet);break;case parser.BINARY_ACK:
            this.onack(packet);break;case parser.DISCONNECT:
            this.ondisconnect();break;case parser.ERROR:
            this.emit("error", packet.data);break;}
      };Socket.prototype.onevent = function (packet) {
        var args = packet.data || [];debug("emitting event %j", args);if (null != packet.id) {
          debug("attaching ack callback to event");args.push(this.ack(packet.id));
        }if (this.connected) {
          emit.apply(this, args);
        } else {
          this.receiveBuffer.push(args);
        }
      };Socket.prototype.ack = function (id) {
        var self = this;var sent = false;return function () {
          if (sent) return;sent = true;var args = toArray(arguments);debug("sending ack %j", args);var type = hasBin(args) ? parser.BINARY_ACK : parser.ACK;self.packet({ type: type, id: id, data: args });
        };
      };Socket.prototype.onack = function (packet) {
        var ack = this.acks[packet.id];if ("function" == typeof ack) {
          debug("calling ack %s with %j", packet.id, packet.data);ack.apply(this, packet.data);delete this.acks[packet.id];
        } else {
          debug("bad ack %s", packet.id);
        }
      };Socket.prototype.onconnect = function () {
        this.connected = true;this.disconnected = false;this.emit("connect");this.emitBuffered();
      };Socket.prototype.emitBuffered = function () {
        var i;for (i = 0; i < this.receiveBuffer.length; i++) {
          emit.apply(this, this.receiveBuffer[i]);
        }this.receiveBuffer = [];for (i = 0; i < this.sendBuffer.length; i++) {
          this.packet(this.sendBuffer[i]);
        }this.sendBuffer = [];
      };Socket.prototype.ondisconnect = function () {
        debug("server disconnect (%s)", this.nsp);this.destroy();this.onclose("io server disconnect");
      };Socket.prototype.destroy = function () {
        if (this.subs) {
          for (var i = 0; i < this.subs.length; i++) {
            this.subs[i].destroy();
          }this.subs = null;
        }this.io.destroy(this);
      };Socket.prototype.close = Socket.prototype.disconnect = function () {
        if (this.connected) {
          debug("performing disconnect (%s)", this.nsp);this.packet({ type: parser.DISCONNECT });
        }this.destroy();if (this.connected) {
          this.onclose("io client disconnect");
        }return this;
      };Socket.prototype.compress = function (compress) {
        this.flags = this.flags || {};this.flags.compress = compress;return this;
      };
    }, { "./on": 33, "component-bind": 37, "component-emitter": 38, debug: 39, "has-binary": 41, "socket.io-parser": 47, "to-array": 51 }], 35: [function (_dereq_, module, exports) {
      (function (global) {
        var parseuri = _dereq_("parseuri");var debug = _dereq_("debug")("socket.io-client:url");module.exports = url;function url(uri, loc) {
          var obj = uri;var loc = loc || global.location;if (null == uri) uri = loc.protocol + "//" + loc.host;if ("string" == typeof uri) {
            if ("/" == uri.charAt(0)) {
              if ("/" == uri.charAt(1)) {
                uri = loc.protocol + uri;
              } else {
                uri = loc.host + uri;
              }
            }if (!/^(https?|wss?):\/\//.test(uri)) {
              debug("protocol-less url %s", uri);if ("undefined" != typeof loc) {
                uri = loc.protocol + "//" + uri;
              } else {
                uri = "https://" + uri;
              }
            }debug("parse %s", uri);obj = parseuri(uri);
          }if (!obj.port) {
            if (/^(http|ws)$/.test(obj.protocol)) {
              obj.port = "80";
            } else if (/^(http|ws)s$/.test(obj.protocol)) {
              obj.port = "443";
            }
          }obj.path = obj.path || "/";var ipv6 = obj.host.indexOf(":") !== -1;var host = ipv6 ? "[" + obj.host + "]" : obj.host;obj.id = obj.protocol + "://" + host + ":" + obj.port;obj.href = obj.protocol + "://" + host + (loc && loc.port == obj.port ? "" : ":" + obj.port);return obj;
        }
      }).call(this, typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {});
    }, { debug: 39, parseuri: 45 }], 36: [function (_dereq_, module, exports) {
      module.exports = Backoff;function Backoff(opts) {
        opts = opts || {};this.ms = opts.min || 100;this.max = opts.max || 1e4;this.factor = opts.factor || 2;this.jitter = opts.jitter > 0 && opts.jitter <= 1 ? opts.jitter : 0;this.attempts = 0;
      }Backoff.prototype.duration = function () {
        var ms = this.ms * Math.pow(this.factor, this.attempts++);if (this.jitter) {
          var rand = Math.random();var deviation = Math.floor(rand * this.jitter * ms);ms = (Math.floor(rand * 10) & 1) == 0 ? ms - deviation : ms + deviation;
        }return Math.min(ms, this.max) | 0;
      };Backoff.prototype.reset = function () {
        this.attempts = 0;
      };Backoff.prototype.setMin = function (min) {
        this.ms = min;
      };Backoff.prototype.setMax = function (max) {
        this.max = max;
      };Backoff.prototype.setJitter = function (jitter) {
        this.jitter = jitter;
      };
    }, {}], 37: [function (_dereq_, module, exports) {
      var slice = [].slice;module.exports = function (obj, fn) {
        if ("string" == typeof fn) fn = obj[fn];if ("function" != typeof fn) throw new Error("bind() requires a function");var args = slice.call(arguments, 2);return function () {
          return fn.apply(obj, args.concat(slice.call(arguments)));
        };
      };
    }, {}], 38: [function (_dereq_, module, exports) {
      module.exports = Emitter;function Emitter(obj) {
        if (obj) return mixin(obj);
      }function mixin(obj) {
        for (var key in Emitter.prototype) {
          obj[key] = Emitter.prototype[key];
        }return obj;
      }Emitter.prototype.on = Emitter.prototype.addEventListener = function (event, fn) {
        this._callbacks = this._callbacks || {};(this._callbacks["$" + event] = this._callbacks["$" + event] || []).push(fn);return this;
      };Emitter.prototype.once = function (event, fn) {
        function on() {
          this.off(event, on);fn.apply(this, arguments);
        }on.fn = fn;this.on(event, on);return this;
      };Emitter.prototype.off = Emitter.prototype.removeListener = Emitter.prototype.removeAllListeners = Emitter.prototype.removeEventListener = function (event, fn) {
        this._callbacks = this._callbacks || {};if (0 == arguments.length) {
          this._callbacks = {};return this;
        }var callbacks = this._callbacks["$" + event];if (!callbacks) return this;if (1 == arguments.length) {
          delete this._callbacks["$" + event];return this;
        }var cb;for (var i = 0; i < callbacks.length; i++) {
          cb = callbacks[i];if (cb === fn || cb.fn === fn) {
            callbacks.splice(i, 1);break;
          }
        }return this;
      };Emitter.prototype.emit = function (event) {
        this._callbacks = this._callbacks || {};var args = [].slice.call(arguments, 1),
            callbacks = this._callbacks["$" + event];if (callbacks) {
          callbacks = callbacks.slice(0);for (var i = 0, len = callbacks.length; i < len; ++i) {
            callbacks[i].apply(this, args);
          }
        }return this;
      };Emitter.prototype.listeners = function (event) {
        this._callbacks = this._callbacks || {};return this._callbacks["$" + event] || [];
      };Emitter.prototype.hasListeners = function (event) {
        return !!this.listeners(event).length;
      };
    }, {}], 39: [function (_dereq_, module, exports) {
      arguments[4][17][0].apply(exports, arguments);
    }, { "./debug": 40, dup: 17 }], 40: [function (_dereq_, module, exports) {
      arguments[4][18][0].apply(exports, arguments);
    }, { dup: 18, ms: 44 }], 41: [function (_dereq_, module, exports) {
      (function (global) {
        var isArray = _dereq_("isarray");module.exports = hasBinary;function hasBinary(data) {
          function _hasBinary(obj) {
            if (!obj) return false;if (global.Buffer && global.Buffer.isBuffer && global.Buffer.isBuffer(obj) || global.ArrayBuffer && obj instanceof ArrayBuffer || global.Blob && obj instanceof Blob || global.File && obj instanceof File) {
              return true;
            }if (isArray(obj)) {
              for (var i = 0; i < obj.length; i++) {
                if (_hasBinary(obj[i])) {
                  return true;
                }
              }
            } else if (obj && "object" == typeof obj) {
              if (obj.toJSON && "function" == typeof obj.toJSON) {
                obj = obj.toJSON();
              }for (var key in obj) {
                if (Object.prototype.hasOwnProperty.call(obj, key) && _hasBinary(obj[key])) {
                  return true;
                }
              }
            }return false;
          }return _hasBinary(data);
        }
      }).call(this, typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {});
    }, { isarray: 43 }], 42: [function (_dereq_, module, exports) {
      arguments[4][23][0].apply(exports, arguments);
    }, { dup: 23 }], 43: [function (_dereq_, module, exports) {
      arguments[4][24][0].apply(exports, arguments);
    }, { dup: 24 }], 44: [function (_dereq_, module, exports) {
      arguments[4][25][0].apply(exports, arguments);
    }, { dup: 25 }], 45: [function (_dereq_, module, exports) {
      arguments[4][28][0].apply(exports, arguments);
    }, { dup: 28 }], 46: [function (_dereq_, module, exports) {
      (function (global) {
        var isArray = _dereq_("isarray");var isBuf = _dereq_("./is-buffer");exports.deconstructPacket = function (packet) {
          var buffers = [];var packetData = packet.data;function _deconstructPacket(data) {
            if (!data) return data;if (isBuf(data)) {
              var placeholder = { _placeholder: true, num: buffers.length };buffers.push(data);return placeholder;
            } else if (isArray(data)) {
              var newData = new Array(data.length);for (var i = 0; i < data.length; i++) {
                newData[i] = _deconstructPacket(data[i]);
              }return newData;
            } else if ("object" == typeof data && !(data instanceof Date)) {
              var newData = {};for (var key in data) {
                newData[key] = _deconstructPacket(data[key]);
              }return newData;
            }return data;
          }var pack = packet;pack.data = _deconstructPacket(packetData);pack.attachments = buffers.length;return { packet: pack, buffers: buffers };
        };exports.reconstructPacket = function (packet, buffers) {
          var curPlaceHolder = 0;function _reconstructPacket(data) {
            if (data && data._placeholder) {
              var buf = buffers[data.num];return buf;
            } else if (isArray(data)) {
              for (var i = 0; i < data.length; i++) {
                data[i] = _reconstructPacket(data[i]);
              }return data;
            } else if (data && "object" == typeof data) {
              for (var key in data) {
                data[key] = _reconstructPacket(data[key]);
              }return data;
            }return data;
          }packet.data = _reconstructPacket(packet.data);packet.attachments = undefined;return packet;
        };exports.removeBlobs = function (data, callback) {
          function _removeBlobs(obj, curKey, containingObject) {
            if (!obj) return obj;if (global.Blob && obj instanceof Blob || global.File && obj instanceof File) {
              pendingBlobs++;var fileReader = new FileReader();fileReader.onload = function () {
                if (containingObject) {
                  containingObject[curKey] = this.result;
                } else {
                  bloblessData = this.result;
                }if (! --pendingBlobs) {
                  callback(bloblessData);
                }
              };fileReader.readAsArrayBuffer(obj);
            } else if (isArray(obj)) {
              for (var i = 0; i < obj.length; i++) {
                _removeBlobs(obj[i], i, obj);
              }
            } else if (obj && "object" == typeof obj && !isBuf(obj)) {
              for (var key in obj) {
                _removeBlobs(obj[key], key, obj);
              }
            }
          }var pendingBlobs = 0;var bloblessData = data;_removeBlobs(bloblessData);if (!pendingBlobs) {
            callback(bloblessData);
          }
        };
      }).call(this, typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {});
    }, { "./is-buffer": 48, isarray: 43 }], 47: [function (_dereq_, module, exports) {
      var debug = _dereq_("debug")("socket.io-parser");var json = _dereq_("json3");var isArray = _dereq_("isarray");var Emitter = _dereq_("component-emitter");var binary = _dereq_("./binary");var isBuf = _dereq_("./is-buffer");exports.protocol = 4;exports.types = ["CONNECT", "DISCONNECT", "EVENT", "BINARY_EVENT", "ACK", "BINARY_ACK", "ERROR"];exports.CONNECT = 0;exports.DISCONNECT = 1;exports.EVENT = 2;exports.ACK = 3;exports.ERROR = 4;exports.BINARY_EVENT = 5;exports.BINARY_ACK = 6;exports.Encoder = Encoder;exports.Decoder = Decoder;function Encoder() {}Encoder.prototype.encode = function (obj, callback) {
        debug("encoding packet %j", obj);if (exports.BINARY_EVENT == obj.type || exports.BINARY_ACK == obj.type) {
          encodeAsBinary(obj, callback);
        } else {
          var encoding = encodeAsString(obj);callback([encoding]);
        }
      };function encodeAsString(obj) {
        var str = "";var nsp = false;str += obj.type;if (exports.BINARY_EVENT == obj.type || exports.BINARY_ACK == obj.type) {
          str += obj.attachments;str += "-";
        }if (obj.nsp && "/" != obj.nsp) {
          nsp = true;str += obj.nsp;
        }if (null != obj.id) {
          if (nsp) {
            str += ",";nsp = false;
          }str += obj.id;
        }if (null != obj.data) {
          if (nsp) str += ",";str += json.stringify(obj.data);
        }debug("encoded %j as %s", obj, str);return str;
      }function encodeAsBinary(obj, callback) {
        function writeEncoding(bloblessData) {
          var deconstruction = binary.deconstructPacket(bloblessData);var pack = encodeAsString(deconstruction.packet);var buffers = deconstruction.buffers;buffers.unshift(pack);callback(buffers);
        }binary.removeBlobs(obj, writeEncoding);
      }function Decoder() {
        this.reconstructor = null;
      }Emitter(Decoder.prototype);Decoder.prototype.add = function (obj) {
        var packet;if ("string" == typeof obj) {
          packet = decodeString(obj);if (exports.BINARY_EVENT == packet.type || exports.BINARY_ACK == packet.type) {
            this.reconstructor = new BinaryReconstructor(packet);if (this.reconstructor.reconPack.attachments === 0) {
              this.emit("decoded", packet);
            }
          } else {
            this.emit("decoded", packet);
          }
        } else if (isBuf(obj) || obj.base64) {
          if (!this.reconstructor) {
            throw new Error("got binary data when not reconstructing a packet");
          } else {
            packet = this.reconstructor.takeBinaryData(obj);if (packet) {
              this.reconstructor = null;this.emit("decoded", packet);
            }
          }
        } else {
          throw new Error("Unknown type: " + obj);
        }
      };function decodeString(str) {
        var p = {};var i = 0;p.type = Number(str.charAt(0));if (null == exports.types[p.type]) return error();if (exports.BINARY_EVENT == p.type || exports.BINARY_ACK == p.type) {
          var buf = "";while (str.charAt(++i) != "-") {
            buf += str.charAt(i);if (i == str.length) break;
          }if (buf != Number(buf) || str.charAt(i) != "-") {
            throw new Error("Illegal attachments");
          }p.attachments = Number(buf);
        }if ("/" == str.charAt(i + 1)) {
          p.nsp = "";while (++i) {
            var c = str.charAt(i);if ("," == c) break;p.nsp += c;if (i == str.length) break;
          }
        } else {
          p.nsp = "/";
        }var next = str.charAt(i + 1);if ("" !== next && Number(next) == next) {
          p.id = "";while (++i) {
            var c = str.charAt(i);if (null == c || Number(c) != c) {
              --i;break;
            }p.id += str.charAt(i);if (i == str.length) break;
          }p.id = Number(p.id);
        }if (str.charAt(++i)) {
          try {
            p.data = json.parse(str.substr(i));
          } catch (e) {
            return error();
          }
        }debug("decoded %s as %j", str, p);return p;
      }Decoder.prototype.destroy = function () {
        if (this.reconstructor) {
          this.reconstructor.finishedReconstruction();
        }
      };function BinaryReconstructor(packet) {
        this.reconPack = packet;this.buffers = [];
      }BinaryReconstructor.prototype.takeBinaryData = function (binData) {
        this.buffers.push(binData);if (this.buffers.length == this.reconPack.attachments) {
          var packet = binary.reconstructPacket(this.reconPack, this.buffers);this.finishedReconstruction();return packet;
        }return null;
      };BinaryReconstructor.prototype.finishedReconstruction = function () {
        this.reconPack = null;this.buffers = [];
      };function error(data) {
        return { type: exports.ERROR, data: "parser error" };
      }
    }, { "./binary": 46, "./is-buffer": 48, "component-emitter": 49, debug: 39, isarray: 43, json3: 50 }], 48: [function (_dereq_, module, exports) {
      (function (global) {
        module.exports = isBuf;function isBuf(obj) {
          return global.Buffer && global.Buffer.isBuffer(obj) || global.ArrayBuffer && obj instanceof ArrayBuffer;
        }
      }).call(this, typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {});
    }, {}], 49: [function (_dereq_, module, exports) {
      arguments[4][15][0].apply(exports, arguments);
    }, { dup: 15 }], 50: [function (_dereq_, module, exports) {
      (function (global) {
        (function () {
          var isLoader = typeof define === "function" && define.amd;var objectTypes = { "function": true, object: true };var freeExports = objectTypes[typeof exports] && exports && !exports.nodeType && exports;var root = objectTypes[typeof window] && window || this,
              freeGlobal = freeExports && objectTypes[typeof module] && module && !module.nodeType && typeof global == "object" && global;if (freeGlobal && (freeGlobal["global"] === freeGlobal || freeGlobal["window"] === freeGlobal || freeGlobal["self"] === freeGlobal)) {
            root = freeGlobal;
          }function runInContext(context, exports) {
            context || (context = root["Object"]());exports || (exports = root["Object"]());var Number = context["Number"] || root["Number"],
                String = context["String"] || root["String"],
                Object = context["Object"] || root["Object"],
                Date = context["Date"] || root["Date"],
                SyntaxError = context["SyntaxError"] || root["SyntaxError"],
                TypeError = context["TypeError"] || root["TypeError"],
                Math = context["Math"] || root["Math"],
                nativeJSON = context["JSON"] || root["JSON"];if (typeof nativeJSON == "object" && nativeJSON) {
              exports.stringify = nativeJSON.stringify;exports.parse = nativeJSON.parse;
            }var objectProto = Object.prototype,
                getClass = objectProto.toString,
                isProperty,
                forEach,
                undef;var isExtended = new Date(-0xc782b5b800cec);try {
              isExtended = isExtended.getUTCFullYear() == -109252 && isExtended.getUTCMonth() === 0 && isExtended.getUTCDate() === 1 && isExtended.getUTCHours() == 10 && isExtended.getUTCMinutes() == 37 && isExtended.getUTCSeconds() == 6 && isExtended.getUTCMilliseconds() == 708;
            } catch (exception) {}function has(name) {
              if (has[name] !== undef) {
                return has[name];
              }var isSupported;if (name == "bug-string-char-index") {
                isSupported = "a"[0] != "a";
              } else if (name == "json") {
                isSupported = has("json-stringify") && has("json-parse");
              } else {
                var value,
                    serialized = "{\"a\":[1,true,false,null,\"\\u0000\\b\\n\\f\\r\\t\"]}";if (name == "json-stringify") {
                  var stringify = exports.stringify,
                      stringifySupported = typeof stringify == "function" && isExtended;if (stringifySupported) {
                    (value = function () {
                      return 1;
                    }).toJSON = value;try {
                      stringifySupported = stringify(0) === "0" && stringify(new Number()) === "0" && stringify(new String()) == '""' && stringify(getClass) === undef && stringify(undef) === undef && stringify() === undef && stringify(value) === "1" && stringify([value]) == "[1]" && stringify([undef]) == "[null]" && stringify(null) == "null" && stringify([undef, getClass, null]) == "[null,null,null]" && stringify({ a: [value, true, false, null, "\x00\b\n\f\r	"] }) == serialized && stringify(null, value) === "1" && stringify([1, 2], null, 1) == "[\n 1,\n 2\n]" && stringify(new Date(-864e13)) == '"-271821-04-20T00:00:00.000Z"' && stringify(new Date(864e13)) == '"+275760-09-13T00:00:00.000Z"' && stringify(new Date(-621987552e5)) == '"-000001-01-01T00:00:00.000Z"' && stringify(new Date(-1)) == '"1969-12-31T23:59:59.999Z"';
                    } catch (exception) {
                      stringifySupported = false;
                    }
                  }isSupported = stringifySupported;
                }if (name == "json-parse") {
                  var parse = exports.parse;if (typeof parse == "function") {
                    try {
                      if (parse("0") === 0 && !parse(false)) {
                        value = parse(serialized);var parseSupported = value["a"].length == 5 && value["a"][0] === 1;if (parseSupported) {
                          try {
                            parseSupported = !parse('"	"');
                          } catch (exception) {}if (parseSupported) {
                            try {
                              parseSupported = parse("01") !== 1;
                            } catch (exception) {}
                          }if (parseSupported) {
                            try {
                              parseSupported = parse("1.") !== 1;
                            } catch (exception) {}
                          }
                        }
                      }
                    } catch (exception) {
                      parseSupported = false;
                    }
                  }isSupported = parseSupported;
                }
              }return has[name] = !!isSupported;
            }if (!has("json")) {
              var functionClass = "[object Function]",
                  dateClass = "[object Date]",
                  numberClass = "[object Number]",
                  stringClass = "[object String]",
                  arrayClass = "[object Array]",
                  booleanClass = "[object Boolean]";var charIndexBuggy = has("bug-string-char-index");if (!isExtended) {
                var floor = Math.floor;var Months = [0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334];var getDay = function getDay(year, month) {
                  return Months[month] + 365 * (year - 1970) + floor((year - 1969 + (month = +(month > 1))) / 4) - floor((year - 1901 + month) / 100) + floor((year - 1601 + month) / 400);
                };
              }if (!(isProperty = objectProto.hasOwnProperty)) {
                isProperty = function (property) {
                  var members = {},
                      constructor;if ((members.__proto__ = null, members.__proto__ = { toString: 1 }, members).toString != getClass) {
                    isProperty = function (property) {
                      var original = this.__proto__,
                          result = (property in (this.__proto__ = null, this));this.__proto__ = original;return result;
                    };
                  } else {
                    constructor = members.constructor;isProperty = function (property) {
                      var parent = (this.constructor || constructor).prototype;return property in this && !(property in parent && this[property] === parent[property]);
                    };
                  }members = null;return isProperty.call(this, property);
                };
              }forEach = function (object, callback) {
                var size = 0,
                    Properties,
                    members,
                    property;(Properties = function () {
                  this.valueOf = 0;
                }).prototype.valueOf = 0;members = new Properties();for (property in members) {
                  if (isProperty.call(members, property)) {
                    size++;
                  }
                }Properties = members = null;if (!size) {
                  members = ["valueOf", "toString", "toLocaleString", "propertyIsEnumerable", "isPrototypeOf", "hasOwnProperty", "constructor"];forEach = function (object, callback) {
                    var isFunction = getClass.call(object) == functionClass,
                        property,
                        length;var hasProperty = !isFunction && typeof object.constructor != "function" && objectTypes[typeof object.hasOwnProperty] && object.hasOwnProperty || isProperty;for (property in object) {
                      if (!(isFunction && property == "prototype") && hasProperty.call(object, property)) {
                        callback(property);
                      }
                    }for (length = members.length; property = members[--length]; hasProperty.call(object, property) && callback(property));
                  };
                } else if (size == 2) {
                  forEach = function (object, callback) {
                    var members = {},
                        isFunction = getClass.call(object) == functionClass,
                        property;for (property in object) {
                      if (!(isFunction && property == "prototype") && !isProperty.call(members, property) && (members[property] = 1) && isProperty.call(object, property)) {
                        callback(property);
                      }
                    }
                  };
                } else {
                  forEach = function (object, callback) {
                    var isFunction = getClass.call(object) == functionClass,
                        property,
                        isConstructor;for (property in object) {
                      if (!(isFunction && property == "prototype") && isProperty.call(object, property) && !(isConstructor = property === "constructor")) {
                        callback(property);
                      }
                    }if (isConstructor || isProperty.call(object, property = "constructor")) {
                      callback(property);
                    }
                  };
                }return forEach(object, callback);
              };if (!has("json-stringify")) {
                var Escapes = { 92: "\\\\", 34: '\\"', 8: "\\b", 12: "\\f", 10: "\\n", 13: "\\r", 9: "\\t" };var leadingZeroes = "000000";var toPaddedString = function toPaddedString(width, value) {
                  return (leadingZeroes + (value || 0)).slice(-width);
                };var unicodePrefix = "\\u00";var quote = function quote(value) {
                  var result = '"',
                      index = 0,
                      length = value.length,
                      useCharIndex = !charIndexBuggy || length > 10;var symbols = useCharIndex && (charIndexBuggy ? value.split("") : value);for (; index < length; index++) {
                    var charCode = value.charCodeAt(index);switch (charCode) {case 8:case 9:case 10:case 12:case 13:case 34:case 92:
                        result += Escapes[charCode];break;default:
                        if (charCode < 32) {
                          result += unicodePrefix + toPaddedString(2, charCode.toString(16));break;
                        }result += useCharIndex ? symbols[index] : value.charAt(index);}
                  }return result + '"';
                };var serialize = function serialize(property, object, callback, properties, whitespace, indentation, stack) {
                  var value, className, year, month, date, time, hours, minutes, seconds, milliseconds, results, element, index, length, prefix, result;try {
                    value = object[property];
                  } catch (exception) {}if (typeof value == "object" && value) {
                    className = getClass.call(value);if (className == dateClass && !isProperty.call(value, "toJSON")) {
                      if (value > -1 / 0 && value < 1 / 0) {
                        if (getDay) {
                          date = floor(value / 864e5);for (year = floor(date / 365.2425) + 1970 - 1; getDay(year + 1, 0) <= date; year++);for (month = floor((date - getDay(year, 0)) / 30.42); getDay(year, month + 1) <= date; month++);date = 1 + date - getDay(year, month);time = (value % 864e5 + 864e5) % 864e5;hours = floor(time / 36e5) % 24;minutes = floor(time / 6e4) % 60;seconds = floor(time / 1e3) % 60;milliseconds = time % 1e3;
                        } else {
                          year = value.getUTCFullYear();month = value.getUTCMonth();date = value.getUTCDate();hours = value.getUTCHours();minutes = value.getUTCMinutes();seconds = value.getUTCSeconds();milliseconds = value.getUTCMilliseconds();
                        }value = (year <= 0 || year >= 1e4 ? (year < 0 ? "-" : "+") + toPaddedString(6, year < 0 ? -year : year) : toPaddedString(4, year)) + "-" + toPaddedString(2, month + 1) + "-" + toPaddedString(2, date) + "T" + toPaddedString(2, hours) + ":" + toPaddedString(2, minutes) + ":" + toPaddedString(2, seconds) + "." + toPaddedString(3, milliseconds) + "Z";
                      } else {
                        value = null;
                      }
                    } else if (typeof value.toJSON == "function" && (className != numberClass && className != stringClass && className != arrayClass || isProperty.call(value, "toJSON"))) {
                      value = value.toJSON(property);
                    }
                  }if (callback) {
                    value = callback.call(object, property, value);
                  }if (value === null) {
                    return "null";
                  }className = getClass.call(value);if (className == booleanClass) {
                    return "" + value;
                  } else if (className == numberClass) {
                    return value > -1 / 0 && value < 1 / 0 ? "" + value : "null";
                  } else if (className == stringClass) {
                    return quote("" + value);
                  }if (typeof value == "object") {
                    for (length = stack.length; length--;) {
                      if (stack[length] === value) {
                        throw TypeError();
                      }
                    }stack.push(value);results = [];prefix = indentation;indentation += whitespace;if (className == arrayClass) {
                      for (index = 0, length = value.length; index < length; index++) {
                        element = serialize(index, value, callback, properties, whitespace, indentation, stack);results.push(element === undef ? "null" : element);
                      }result = results.length ? whitespace ? "[\n" + indentation + results.join(",\n" + indentation) + "\n" + prefix + "]" : "[" + results.join(",") + "]" : "[]";
                    } else {
                      forEach(properties || value, function (property) {
                        var element = serialize(property, value, callback, properties, whitespace, indentation, stack);if (element !== undef) {
                          results.push(quote(property) + ":" + (whitespace ? " " : "") + element);
                        }
                      });result = results.length ? whitespace ? "{\n" + indentation + results.join(",\n" + indentation) + "\n" + prefix + "}" : "{" + results.join(",") + "}" : "{}";
                    }stack.pop();return result;
                  }
                };exports.stringify = function (source, filter, width) {
                  var whitespace, callback, properties, className;if (objectTypes[typeof filter] && filter) {
                    if ((className = getClass.call(filter)) == functionClass) {
                      callback = filter;
                    } else if (className == arrayClass) {
                      properties = {};for (var index = 0, length = filter.length, value; index < length; value = filter[index++], (className = getClass.call(value), className == stringClass || className == numberClass) && (properties[value] = 1));
                    }
                  }if (width) {
                    if ((className = getClass.call(width)) == numberClass) {
                      if ((width -= width % 1) > 0) {
                        for (whitespace = "", width > 10 && (width = 10); whitespace.length < width; whitespace += " ");
                      }
                    } else if (className == stringClass) {
                      whitespace = width.length <= 10 ? width : width.slice(0, 10);
                    }
                  }return serialize("", (value = {}, value[""] = source, value), callback, properties, whitespace, "", []);
                };
              }if (!has("json-parse")) {
                var fromCharCode = String.fromCharCode;var Unescapes = { 92: "\\", 34: '"', 47: "/", 98: "\b", 116: "	", 110: "\n", 102: "\f", 114: "\r" };var Index, Source;var abort = function abort() {
                  Index = Source = null;throw SyntaxError();
                };var lex = function lex() {
                  var source = Source,
                      length = source.length,
                      value,
                      begin,
                      position,
                      isSigned,
                      charCode;while (Index < length) {
                    charCode = source.charCodeAt(Index);switch (charCode) {case 9:case 10:case 13:case 32:
                        Index++;break;case 123:case 125:case 91:case 93:case 58:case 44:
                        value = charIndexBuggy ? source.charAt(Index) : source[Index];Index++;return value;case 34:
                        for (value = "@", Index++; Index < length;) {
                          charCode = source.charCodeAt(Index);if (charCode < 32) {
                            abort();
                          } else if (charCode == 92) {
                            charCode = source.charCodeAt(++Index);switch (charCode) {case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:
                                value += Unescapes[charCode];Index++;break;case 117:
                                begin = ++Index;for (position = Index + 4; Index < position; Index++) {
                                  charCode = source.charCodeAt(Index);if (!(charCode >= 48 && charCode <= 57 || charCode >= 97 && charCode <= 102 || charCode >= 65 && charCode <= 70)) {
                                    abort();
                                  }
                                }value += fromCharCode("0x" + source.slice(begin, Index));break;default:
                                abort();}
                          } else {
                            if (charCode == 34) {
                              break;
                            }charCode = source.charCodeAt(Index);begin = Index;while (charCode >= 32 && charCode != 92 && charCode != 34) {
                              charCode = source.charCodeAt(++Index);
                            }value += source.slice(begin, Index);
                          }
                        }if (source.charCodeAt(Index) == 34) {
                          Index++;return value;
                        }abort();default:
                        begin = Index;if (charCode == 45) {
                          isSigned = true;charCode = source.charCodeAt(++Index);
                        }if (charCode >= 48 && charCode <= 57) {
                          if (charCode == 48 && (charCode = source.charCodeAt(Index + 1), charCode >= 48 && charCode <= 57)) {
                            abort();
                          }isSigned = false;for (; Index < length && (charCode = source.charCodeAt(Index), charCode >= 48 && charCode <= 57); Index++);if (source.charCodeAt(Index) == 46) {
                            position = ++Index;for (; position < length && (charCode = source.charCodeAt(position), charCode >= 48 && charCode <= 57); position++);if (position == Index) {
                              abort();
                            }Index = position;
                          }charCode = source.charCodeAt(Index);if (charCode == 101 || charCode == 69) {
                            charCode = source.charCodeAt(++Index);if (charCode == 43 || charCode == 45) {
                              Index++;
                            }for (position = Index; position < length && (charCode = source.charCodeAt(position), charCode >= 48 && charCode <= 57); position++);if (position == Index) {
                              abort();
                            }Index = position;
                          }return +source.slice(begin, Index);
                        }if (isSigned) {
                          abort();
                        }if (source.slice(Index, Index + 4) == "true") {
                          Index += 4;return true;
                        } else if (source.slice(Index, Index + 5) == "false") {
                          Index += 5;return false;
                        } else if (source.slice(Index, Index + 4) == "null") {
                          Index += 4;return null;
                        }abort();}
                  }return "$";
                };var get = function get(value) {
                  var results, hasMembers;if (value == "$") {
                    abort();
                  }if (typeof value == "string") {
                    if ((charIndexBuggy ? value.charAt(0) : value[0]) == "@") {
                      return value.slice(1);
                    }if (value == "[") {
                      results = [];for (;; hasMembers || (hasMembers = true)) {
                        value = lex();if (value == "]") {
                          break;
                        }if (hasMembers) {
                          if (value == ",") {
                            value = lex();if (value == "]") {
                              abort();
                            }
                          } else {
                            abort();
                          }
                        }if (value == ",") {
                          abort();
                        }results.push(get(value));
                      }return results;
                    } else if (value == "{") {
                      results = {};for (;; hasMembers || (hasMembers = true)) {
                        value = lex();if (value == "}") {
                          break;
                        }if (hasMembers) {
                          if (value == ",") {
                            value = lex();if (value == "}") {
                              abort();
                            }
                          } else {
                            abort();
                          }
                        }if (value == "," || typeof value != "string" || (charIndexBuggy ? value.charAt(0) : value[0]) != "@" || lex() != ":") {
                          abort();
                        }results[value.slice(1)] = get(lex());
                      }return results;
                    }abort();
                  }return value;
                };var update = function update(source, property, callback) {
                  var element = walk(source, property, callback);if (element === undef) {
                    delete source[property];
                  } else {
                    source[property] = element;
                  }
                };var walk = function walk(source, property, callback) {
                  var value = source[property],
                      length;if (typeof value == "object" && value) {
                    if (getClass.call(value) == arrayClass) {
                      for (length = value.length; length--;) {
                        update(value, length, callback);
                      }
                    } else {
                      forEach(value, function (property) {
                        update(value, property, callback);
                      });
                    }
                  }return callback.call(source, property, value);
                };exports.parse = function (source, callback) {
                  var result, value;Index = 0;Source = "" + source;result = get(lex());if (lex() != "$") {
                    abort();
                  }Index = Source = null;return callback && getClass.call(callback) == functionClass ? walk((value = {}, value[""] = result, value), "", callback) : result;
                };
              }
            }exports["runInContext"] = runInContext;return exports;
          }if (freeExports && !isLoader) {
            runInContext(root, freeExports);
          } else {
            var nativeJSON = root.JSON,
                previousJSON = root["JSON3"],
                isRestored = false;var JSON3 = runInContext(root, root["JSON3"] = { noConflict: function noConflict() {
                if (!isRestored) {
                  isRestored = true;root.JSON = nativeJSON;root["JSON3"] = previousJSON;nativeJSON = previousJSON = null;
                }return JSON3;
              } });root.JSON = { parse: JSON3.parse, stringify: JSON3.stringify };
          }if (isLoader) {
            define(function () {
              return JSON3;
            });
          }
        }).call(this);
      }).call(this, typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {});
    }, {}], 51: [function (_dereq_, module, exports) {
      module.exports = toArray;function toArray(list, index) {
        var array = [];index = index || 0;for (var i = index || 0; i < list.length; i++) {
          array[i - index] = list[i];
        }return array;
      }
    }, {}] }, {}, [31])(31);
});

cc._RFpop();
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}]},{},["data","socket.io","biz-socket","main","index","directionCtrl","fireCtrl","lodash","controller"])
//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL0FwcGxpY2F0aW9ucy9Db2Nvc0NyZWF0b3IuYXBwL0NvbnRlbnRzL1Jlc291cmNlcy9hcHAuYXNhci9ub2RlX21vZHVsZXMvYnJvd3Nlci1wYWNrL19wcmVsdWRlLmpzIiwiYXNzZXRzL2Jpei9zb2NrZXQvYml6LXNvY2tldC5qcyIsImFzc2V0cy9iaXovY29udHJvbGxlci9zY3JpcHQvY29udHJvbGxlci5qcyIsImFzc2V0cy9iaXovbWFpbi9zY3JpcHQvZGF0YS5qcyIsImFzc2V0cy9iaXovY29udHJvbGxlci9zY3JpcHQvZGlyZWN0aW9uQ3RybC5qcyIsImFzc2V0cy9iaXovY29udHJvbGxlci9zY3JpcHQvZmlyZUN0cmwuanMiLCJhc3NldHMvdXRpbHMvaW5kZXguanMiLCJhc3NldHMvbGliL2xvZGFzaC5qcyIsImFzc2V0cy9iaXovbWFpbi9zY3JpcHQvbWFpbi5qcyIsImFzc2V0cy9saWIvc29ja2V0LmlvLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDWkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FDTEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDdEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJjYy5fUkZwdXNoKG1vZHVsZSwgJzQ2MmExYm9PT3BCM3BDb1ovRnZ3WmNoJywgJ2Jpei1zb2NrZXQnKTtcbi8vIGJpei9zb2NrZXQvYml6LXNvY2tldC5qc1xuXG4ndXNlIHN0cmljdCc7XG5cbnZhciBzb2NrZXRJTyA9IHJlcXVpcmUoJy4uLy4uL2xpYi9zb2NrZXQuaW8nKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJy4uLy4uL3V0aWxzL2luZGV4Jyk7XG5cbnZhciBCaXpTb2NrZXQgPSAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBVUkkgPSAnMTAuMTAuMS4zODozMDAwL3RhbmtDb250cm9sbGVycyc7XG4gICAgdmFyIFVJRCA9IHV0aWxzLmdldFVpZCgpO1xuXG4gICAgdmFyIHdzID0gc29ja2V0SU8oVVJJICsgJz91aWQ9JyArIFVJRCk7XG5cbiAgICB2YXIgY29ubmVjdCA9IGZ1bmN0aW9uIGNvbm5lY3QoKSB7XG4gICAgICAgIHdzLmVtaXQoJ2MtZW50ZXInKTtcbiAgICB9O1xuXG4gICAgdmFyIGRpc2Nvbm5lY3QgPSBmdW5jdGlvbiBkaXNjb25uZWN0KCkge1xuICAgICAgICB3cy5lbWl0KCdjLWxlYXZlJyk7XG4gICAgfTtcblxuICAgIHZhciBvbiA9IGZ1bmN0aW9uIG9uKGV2ZW50TmFtZSwgY2FsbGJhY2spIHtcbiAgICAgICAgd3Mub24oZXZlbnROYW1lLCBjYWxsYmFjayk7XG4gICAgfTtcblxuICAgIHZhciBlbWl0ID0gZnVuY3Rpb24gZW1pdChldmVudE5hbWUsIGV2ZW50T2JqKSB7XG4gICAgICAgIHdzLmVtaXQoZXZlbnROYW1lLCB7XG4gICAgICAgICAgICB1aWQ6IFVJRCxcbiAgICAgICAgICAgIGRhdGE6IGV2ZW50T2JqXG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBjb25uZWN0OiBjb25uZWN0LFxuICAgICAgICBkaXNjb25uZWN0OiBkaXNjb25uZWN0LFxuICAgICAgICBvbjogb24sXG4gICAgICAgIGVtaXQ6IGVtaXRcbiAgICB9O1xufSkoKTtcblxubW9kdWxlLmV4cG9ydHMgPSBCaXpTb2NrZXQ7XG5cbmNjLl9SRnBvcCgpOyIsImNjLl9SRnB1c2gobW9kdWxlLCAnZjJkOTBxNDB3Wk8wcjMzSmVRZTFzRmYnLCAnY29udHJvbGxlcicpO1xuLy8gYml6L2NvbnRyb2xsZXIvc2NyaXB0L2NvbnRyb2xsZXIuanNcblxuJ3VzZSBzdHJpY3QnO1xuXG52YXIgYml6U29ja2V0ID0gcmVxdWlyZSgnLi4vLi4vc29ja2V0L2Jpei1zb2NrZXQnKTtcblxuY2MuQ2xhc3Moe1xuICAgICdleHRlbmRzJzogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge30sXG5cbiAgICBiYWNrVG9NYWluOiBmdW5jdGlvbiBiYWNrVG9NYWluKCkge1xuICAgICAgICBiaXpTb2NrZXQuZGlzY29ubmVjdCgpO1xuICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ21haW4nKTtcbiAgICB9LFxuXG4gICAgb25Mb2FkOiBmdW5jdGlvbiBvbkxvYWQoKSB7fSxcblxuICAgIHVwZGF0ZTogZnVuY3Rpb24gdXBkYXRlKGR0KSB7fVxufSk7XG5cbmNjLl9SRnBvcCgpOyIsImNjLl9SRnB1c2gobW9kdWxlLCAnMTlhMDNwQmdyOVA2S0VHZzdJUnRFREcnLCAnZGF0YScpO1xuLy8gYml6L21haW4vc2NyaXB0L2RhdGEuanNcblxuJ3VzZSBzdHJpY3QnO1xuXG52YXIgdXBkYXRlRGF0YSA9IGZ1bmN0aW9uIHVwZGF0ZURhdGEob2JqZWN0KSB7fTtcblxudmFyIGluaXRBcmNoaXZlcyA9IGZ1bmN0aW9uIGluaXRBcmNoaXZlcygpIHt9O1xuXG52YXIgdXBkYXRlQXJjaGl2ZXMgPSBmdW5jdGlvbiB1cGRhdGVBcmNoaXZlcygpIHt9O1xuXG52YXIgZ2V0QXJjaGl2ZXMgPSBmdW5jdGlvbiBnZXRBcmNoaXZlcygpIHt9O1xuXG52YXIgZGF0YSA9IHtcbiAgICB1c2VybmFtZTogJycsXG5cbiAgICB0YW5rSGVhZDogMCxcbiAgICB0YW5rQm9keTogMCxcbiAgICB0YW5rV2hlZWw6IDAsXG5cbiAgICBtb25leTogMCxcbiAgICBzY29yZUtpbGw6IDAsXG4gICAgc2NvcmVEZWFsOiAwXG5cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gZGF0YTtcblxuY2MuX1JGcG9wKCk7IiwiY2MuX1JGcHVzaChtb2R1bGUsICc4ZGZkMTFJL3BCQUQ3WG5ONGlIOXRpVicsICdkaXJlY3Rpb25DdHJsJyk7XG4vLyBiaXovY29udHJvbGxlci9zY3JpcHQvZGlyZWN0aW9uQ3RybC5qc1xuXG4ndXNlIHN0cmljdCc7XG5cbnZhciBiaXpTb2NrZXQgPSByZXF1aXJlKCcuLi8uLi9zb2NrZXQvYml6LXNvY2tldCcpO1xuXG5jYy5DbGFzcyh7XG4gICAgJ2V4dGVuZHMnOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIGZvbGxvd2VyOiB7XG4gICAgICAgICAgICAnZGVmYXVsdCc6IG51bGwsXG4gICAgICAgICAgICB0eXBlOiBjYy5Ob2RlXG4gICAgICAgIH0sXG4gICAgICAgIGZvbGxvd1NwZWVkOiAwLFxuICAgICAgICBkaXJlY3Rpb246IDRcbiAgICB9LFxuXG4gICAgb25Mb2FkOiBmdW5jdGlvbiBvbkxvYWQoKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdGhpcy5zZXRUb3VjaENvbnRyb2woKTtcbiAgICAgICAgdGhpcy5ub2RlLm9uKCdkaXJlY3Rpb24nLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgIGlmIChzZWxmLmRpcmVjdGlvbiAhPT0gZXZlbnQuZGV0YWlsLmRpcmVjdGlvbikge1xuICAgICAgICAgICAgICAgIHNlbGYuZGlyZWN0aW9uID0gZXZlbnQuZGV0YWlsLmRpcmVjdGlvbjtcbiAgICAgICAgICAgICAgICBiaXpTb2NrZXQuZW1pdCgnYy1kaXJlY3Rpb24nLCB7XG4gICAgICAgICAgICAgICAgICAgIGRpcmVjdGlvbjogc2VsZi5kaXJlY3Rpb25cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIHNldFRvdWNoQ29udHJvbDogZnVuY3Rpb24gc2V0VG91Y2hDb250cm9sKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIGNjLmV2ZW50TWFuYWdlci5hZGRMaXN0ZW5lcih7XG4gICAgICAgICAgICBldmVudDogY2MuRXZlbnRMaXN0ZW5lci5UT1VDSF9PTkVfQllfT05FLFxuICAgICAgICAgICAgb25Ub3VjaEJlZ2FuOiBzZWxmLm9uVG91Y2hCZWdhbi5iaW5kKHNlbGYpLFxuICAgICAgICAgICAgb25Ub3VjaE1vdmVkOiBzZWxmLm9uVG91Y2hNb3ZlZC5iaW5kKHNlbGYpLFxuICAgICAgICAgICAgb25Ub3VjaEVuZGVkOiBzZWxmLm9uVG91Y2hFbmRlZC5iaW5kKHNlbGYpXG4gICAgICAgIH0sIHNlbGYubm9kZSk7XG4gICAgfSxcblxuICAgIF9fZ2V0QW5nbGU6IGZ1bmN0aW9uIF9fZ2V0QW5nbGUocG9zKSB7XG4gICAgICAgIHRoaXMuYW5nbGUgPSBNYXRoLmF0YW4yKHBvcy55LCBwb3MueCkgLyBjYy5QSSAqIDE4MDtcbiAgICAgICAgcmV0dXJuIHRoaXMuYW5nbGU7XG4gICAgfSxcblxuICAgIF9fZ2V0UmFkaWFuczogZnVuY3Rpb24gX19nZXRSYWRpYW5zKHBvcykge1xuICAgICAgICB0aGlzLnJhZGlhbnMgPSBNYXRoLmF0YW4yKHBvcy55LCBwb3MueCk7XG4gICAgICAgIHJldHVybiB0aGlzLnJhZGlhbnM7XG4gICAgfSxcblxuICAgIF9fZ2V0TGVuZ3RoOiBmdW5jdGlvbiBfX2dldExlbmd0aChwb3MpIHtcbiAgICAgICAgcmV0dXJuIE1hdGguc3FydChwb3MueCAqIHBvcy54ICsgcG9zLnkgKiBwb3MueSk7XG4gICAgfSxcblxuICAgIG9uVXBkYXRlRGlyZWN0aW9uOiBmdW5jdGlvbiBvblVwZGF0ZURpcmVjdGlvbihsZW5ndGgpIHtcbiAgICAgICAgdmFyIGRpcmVjdGlvbjtcblxuICAgICAgICBpZiAobGVuZ3RoIDw9IDEwKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5ub2RlLmVtaXQoJ2RpcmVjdGlvbicsIHtcbiAgICAgICAgICAgICAgICBkaXJlY3Rpb246IDRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuYW5nbGUgPCAwKSB0aGlzLmFuZ2xlID0gdGhpcy5hbmdsZSArIDM2MDtcblxuICAgICAgICBpZiAodGhpcy5hbmdsZSA+PSAwICYmIHRoaXMuYW5nbGUgPD0gNDUgfHwgdGhpcy5hbmdsZSA+IDMxNSAmJiB0aGlzLmFuZ2xlIDw9IDM2MCkge1xuICAgICAgICAgICAgZGlyZWN0aW9uID0gMTtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLmFuZ2xlID4gNDUgJiYgdGhpcy5hbmdsZSA8PSAxMzUpIHtcbiAgICAgICAgICAgIGRpcmVjdGlvbiA9IDA7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5hbmdsZSA+IDEzNSAmJiB0aGlzLmFuZ2xlIDw9IDIyNSkge1xuICAgICAgICAgICAgZGlyZWN0aW9uID0gMztcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLmFuZ2xlID4gMjI1ICYmIHRoaXMuYW5nbGUgPD0gMzE1KSB7XG4gICAgICAgICAgICBkaXJlY3Rpb24gPSAyO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXMubm9kZS5lbWl0KCdkaXJlY3Rpb24nLCB7XG4gICAgICAgICAgICBkaXJlY3Rpb246IGRpcmVjdGlvblxuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgb25TdG9wOiBmdW5jdGlvbiBvblN0b3AoKSB7XG4gICAgICAgIHRoaXMubm9kZS5lbWl0KCdkaXJlY3Rpb24nLCB7XG4gICAgICAgICAgICBkaXJlY3Rpb246IDRcbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIG9uVG91Y2hCZWdhbjogZnVuY3Rpb24gb25Ub3VjaEJlZ2FuKHRvdWNoLCBldmVudCkge1xuICAgICAgICB2YXIgdGFyZ2V0ID0gdGhpcy5mb2xsb3dlcjtcbiAgICAgICAgdmFyIHRvdWNoTG9jID0gdG91Y2guZ2V0TG9jYXRpb24oKTtcblxuICAgICAgICB2YXIgbG9jSW5Ob2RlID0gdGhpcy5ub2RlLmNvbnZlcnRUb05vZGVTcGFjZUFSKHRvdWNoTG9jKTtcbiAgICAgICAgdmFyIHRtcExlbmd0aCA9IHRoaXMuX19nZXRMZW5ndGgobG9jSW5Ob2RlKTtcblxuICAgICAgICByZXR1cm4gdG1wTGVuZ3RoIDwgMTAzO1xuICAgIH0sXG5cbiAgICBvblRvdWNoTW92ZWQ6IGZ1bmN0aW9uIG9uVG91Y2hNb3ZlZCh0b3VjaCwgZXZlbnQpIHtcbiAgICAgICAgdmFyIHRhcmdldCA9IHRoaXMuZm9sbG93ZXI7XG4gICAgICAgIHZhciB0b3VjaExvYyA9IHRvdWNoLmdldExvY2F0aW9uKCk7XG4gICAgICAgIHZhciBsb2NJbk5vZGUgPSB0aGlzLm5vZGUuY29udmVydFRvTm9kZVNwYWNlQVIodG91Y2hMb2MpO1xuICAgICAgICB0aGlzLl9fZ2V0QW5nbGUobG9jSW5Ob2RlKTtcbiAgICAgICAgdGhpcy5fX2dldFJhZGlhbnMobG9jSW5Ob2RlKTtcbiAgICAgICAgdmFyIHRtcExlbmd0aCA9IHRoaXMuX19nZXRMZW5ndGgobG9jSW5Ob2RlKTtcblxuICAgICAgICBpZiAodG1wTGVuZ3RoIDwgMTAzKSB7XG4gICAgICAgICAgICB0YXJnZXQuc2V0UG9zaXRpb24obG9jSW5Ob2RlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZhciB4ID0gTWF0aC5jb3ModGhpcy5yYWRpYW5zKSAqIDEwMztcbiAgICAgICAgICAgIHZhciB5ID0gTWF0aC5zaW4odGhpcy5yYWRpYW5zKSAqIDEwMztcbiAgICAgICAgICAgIHRhcmdldC5zZXRQb3NpdGlvbihjYy5wKHgsIHkpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMub25VcGRhdGVEaXJlY3Rpb24odG1wTGVuZ3RoKTtcbiAgICB9LFxuXG4gICAgb25Ub3VjaEVuZGVkOiBmdW5jdGlvbiBvblRvdWNoRW5kZWQodG91Y2gsIGV2ZW50KSB7XG4gICAgICAgIHZhciB0YXJnZXQgPSB0aGlzLmZvbGxvd2VyO1xuICAgICAgICB0YXJnZXQuc2V0UG9zaXRpb24oeyB4OiAwLCB5OiAwIH0pO1xuICAgICAgICB0aGlzLm9uU3RvcCgpO1xuICAgIH0sXG5cbiAgICB1cGRhdGU6IGZ1bmN0aW9uIHVwZGF0ZShkdCkge31cbn0pO1xuXG5jYy5fUkZwb3AoKTsiLCJjYy5fUkZwdXNoKG1vZHVsZSwgJ2E0MDIzL1hJRnRJMVoxaEIvZk1qTE5KJywgJ2ZpcmVDdHJsJyk7XG4vLyBiaXovY29udHJvbGxlci9zY3JpcHQvZmlyZUN0cmwuanNcblxuJ3VzZSBzdHJpY3QnO1xuXG52YXIgYml6U29ja2V0ID0gcmVxdWlyZSgnLi4vLi4vc29ja2V0L2Jpei1zb2NrZXQnKTtcblxuY2MuQ2xhc3Moe1xuICAgICdleHRlbmRzJzogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge30sXG5cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uIG9uTG9hZCgpIHt9LFxuXG4gICAgZmlyZTogZnVuY3Rpb24gZmlyZSgpIHtcbiAgICAgICAgYml6U29ja2V0LmVtaXQoJ2MtZmlyZScsIHtcbiAgICAgICAgICAgIGZpcmU6ICdmaXJlJ1xuICAgICAgICB9KTtcbiAgICB9XG59KTtcblxuY2MuX1JGcG9wKCk7IiwiY2MuX1JGcHVzaChtb2R1bGUsICc2MjZiN2xFaUQxSW01djVwdUlJbVJEeScsICdpbmRleCcpO1xuLy8gdXRpbHMvaW5kZXguanNcblxuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciB1aWQgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKS50b1N0cmluZygpO1xuXG5leHBvcnRzLmdldFVpZCA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gdWlkO1xuICAgIC8vIHJldHVybiAnbGlzaGVuZyc7XG59O1xuXG5jYy5fUkZwb3AoKTsiLCJjYy5fUkZwdXNoKG1vZHVsZSwgJzlmMmYxaGtTRjlOazZXdkh4QXM5dXFQJywgJ2xvZGFzaCcpO1xuLy8gbGliL2xvZGFzaC5qc1xuXG5cInVzZSBzdHJpY3RcIjsoZnVuY3Rpb24oKXt2YXIgdW5kZWZpbmVkO3ZhciBWRVJTSU9OPVwiNC4yLjBcIjt2YXIgQklORF9GTEFHPTEsQklORF9LRVlfRkxBRz0yLENVUlJZX0JPVU5EX0ZMQUc9NCxDVVJSWV9GTEFHPTgsQ1VSUllfUklHSFRfRkxBRz0xNixQQVJUSUFMX0ZMQUc9MzIsUEFSVElBTF9SSUdIVF9GTEFHPTY0LEFSWV9GTEFHPTEyOCxSRUFSR19GTEFHPTI1NixGTElQX0ZMQUc9NTEyO3ZhciBVTk9SREVSRURfQ09NUEFSRV9GTEFHPTEsUEFSVElBTF9DT01QQVJFX0ZMQUc9Mjt2YXIgREVGQVVMVF9UUlVOQ19MRU5HVEg9MzAsREVGQVVMVF9UUlVOQ19PTUlTU0lPTj1cIi4uLlwiO3ZhciBIT1RfQ09VTlQ9MTUwLEhPVF9TUEFOPTE2O3ZhciBMQVJHRV9BUlJBWV9TSVpFPTIwMDt2YXIgTEFaWV9GSUxURVJfRkxBRz0xLExBWllfTUFQX0ZMQUc9MixMQVpZX1dISUxFX0ZMQUc9Mzt2YXIgRlVOQ19FUlJPUl9URVhUPVwiRXhwZWN0ZWQgYSBmdW5jdGlvblwiO3ZhciBIQVNIX1VOREVGSU5FRD1cIl9fbG9kYXNoX2hhc2hfdW5kZWZpbmVkX19cIjt2YXIgSU5GSU5JVFk9MSAvIDAsTUFYX1NBRkVfSU5URUdFUj05MDA3MTk5MjU0NzQwOTkxLE1BWF9JTlRFR0VSPTEuNzk3NjkzMTM0ODYyMzE1N2UzMDgsTkFOPTAgLyAwO3ZhciBNQVhfQVJSQVlfTEVOR1RIPTQyOTQ5NjcyOTUsTUFYX0FSUkFZX0lOREVYPU1BWF9BUlJBWV9MRU5HVEggLSAxLEhBTEZfTUFYX0FSUkFZX0xFTkdUSD1NQVhfQVJSQVlfTEVOR1RIID4+PiAxO3ZhciBQTEFDRUhPTERFUj1cIl9fbG9kYXNoX3BsYWNlaG9sZGVyX19cIjt2YXIgYXJnc1RhZz1cIltvYmplY3QgQXJndW1lbnRzXVwiLGFycmF5VGFnPVwiW29iamVjdCBBcnJheV1cIixib29sVGFnPVwiW29iamVjdCBCb29sZWFuXVwiLGRhdGVUYWc9XCJbb2JqZWN0IERhdGVdXCIsZXJyb3JUYWc9XCJbb2JqZWN0IEVycm9yXVwiLGZ1bmNUYWc9XCJbb2JqZWN0IEZ1bmN0aW9uXVwiLGdlblRhZz1cIltvYmplY3QgR2VuZXJhdG9yRnVuY3Rpb25dXCIsbWFwVGFnPVwiW29iamVjdCBNYXBdXCIsbnVtYmVyVGFnPVwiW29iamVjdCBOdW1iZXJdXCIsb2JqZWN0VGFnPVwiW29iamVjdCBPYmplY3RdXCIscmVnZXhwVGFnPVwiW29iamVjdCBSZWdFeHBdXCIsc2V0VGFnPVwiW29iamVjdCBTZXRdXCIsc3RyaW5nVGFnPVwiW29iamVjdCBTdHJpbmddXCIsc3ltYm9sVGFnPVwiW29iamVjdCBTeW1ib2xdXCIsd2Vha01hcFRhZz1cIltvYmplY3QgV2Vha01hcF1cIjt2YXIgYXJyYXlCdWZmZXJUYWc9XCJbb2JqZWN0IEFycmF5QnVmZmVyXVwiLGZsb2F0MzJUYWc9XCJbb2JqZWN0IEZsb2F0MzJBcnJheV1cIixmbG9hdDY0VGFnPVwiW29iamVjdCBGbG9hdDY0QXJyYXldXCIsaW50OFRhZz1cIltvYmplY3QgSW50OEFycmF5XVwiLGludDE2VGFnPVwiW29iamVjdCBJbnQxNkFycmF5XVwiLGludDMyVGFnPVwiW29iamVjdCBJbnQzMkFycmF5XVwiLHVpbnQ4VGFnPVwiW29iamVjdCBVaW50OEFycmF5XVwiLHVpbnQ4Q2xhbXBlZFRhZz1cIltvYmplY3QgVWludDhDbGFtcGVkQXJyYXldXCIsdWludDE2VGFnPVwiW29iamVjdCBVaW50MTZBcnJheV1cIix1aW50MzJUYWc9XCJbb2JqZWN0IFVpbnQzMkFycmF5XVwiO3ZhciByZUVtcHR5U3RyaW5nTGVhZGluZz0vXFxiX19wIFxcKz0gJyc7L2cscmVFbXB0eVN0cmluZ01pZGRsZT0vXFxiKF9fcCBcXCs9KSAnJyBcXCsvZyxyZUVtcHR5U3RyaW5nVHJhaWxpbmc9LyhfX2VcXCguKj9cXCl8XFxiX190XFwpKSBcXCtcXG4nJzsvZzt2YXIgcmVFc2NhcGVkSHRtbD0vJig/OmFtcHxsdHxndHxxdW90fCMzOXwjOTYpOy9nLHJlVW5lc2NhcGVkSHRtbD0vWyY8PlwiJ2BdL2cscmVIYXNFc2NhcGVkSHRtbD1SZWdFeHAocmVFc2NhcGVkSHRtbC5zb3VyY2UpLHJlSGFzVW5lc2NhcGVkSHRtbD1SZWdFeHAocmVVbmVzY2FwZWRIdG1sLnNvdXJjZSk7dmFyIHJlRXNjYXBlPS88JS0oW1xcc1xcU10rPyklPi9nLHJlRXZhbHVhdGU9LzwlKFtcXHNcXFNdKz8pJT4vZyxyZUludGVycG9sYXRlPS88JT0oW1xcc1xcU10rPyklPi9nO3ZhciByZUlzRGVlcFByb3A9L1xcLnxcXFsoPzpbXltcXF1dKnwoW1wiJ10pKD86KD8hXFwxKVteXFxcXF18XFxcXC4pKj9cXDEpXFxdLyxyZUlzUGxhaW5Qcm9wPS9eXFx3KiQvLHJlUHJvcE5hbWU9L1teLltcXF1dK3xcXFsoPzooLT9cXGQrKD86XFwuXFxkKyk/KXwoW1wiJ10pKCg/Oig/IVxcMilbXlxcXFxdfFxcXFwuKSo/KVxcMilcXF0vZzt2YXIgcmVSZWdFeHBDaGFyPS9bXFxcXF4kLiorPygpW1xcXXt9fF0vZyxyZUhhc1JlZ0V4cENoYXI9UmVnRXhwKHJlUmVnRXhwQ2hhci5zb3VyY2UpO3ZhciByZVRyaW09L15cXHMrfFxccyskL2cscmVUcmltU3RhcnQ9L15cXHMrLyxyZVRyaW1FbmQ9L1xccyskLzt2YXIgcmVFc2NhcGVDaGFyPS9cXFxcKFxcXFwpPy9nO3ZhciByZUVzVGVtcGxhdGU9L1xcJFxceyhbXlxcXFx9XSooPzpcXFxcLlteXFxcXH1dKikqKVxcfS9nO3ZhciByZUZsYWdzPS9cXHcqJC87dmFyIHJlSGFzSGV4UHJlZml4PS9eMHgvaTt2YXIgcmVJc0JhZEhleD0vXlstK10weFswLTlhLWZdKyQvaTt2YXIgcmVJc0JpbmFyeT0vXjBiWzAxXSskL2k7dmFyIHJlSXNIb3N0Q3Rvcj0vXlxcW29iamVjdCAuKz9Db25zdHJ1Y3RvclxcXSQvO3ZhciByZUlzT2N0YWw9L14wb1swLTddKyQvaTt2YXIgcmVJc1VpbnQ9L14oPzowfFsxLTldXFxkKikkLzt2YXIgcmVMYXRpbjE9L1tcXHhjMC1cXHhkNlxceGQ4LVxceGRlXFx4ZGYtXFx4ZjZcXHhmOC1cXHhmZl0vZzt2YXIgcmVOb01hdGNoPS8oJF4pLzt2YXIgcmVVbmVzY2FwZWRTdHJpbmc9L1snXFxuXFxyXFx1MjAyOFxcdTIwMjlcXFxcXS9nO3ZhciByc0FzdHJhbFJhbmdlPVwiXFxcXHVkODAwLVxcXFx1ZGZmZlwiLHJzQ29tYm9NYXJrc1JhbmdlPVwiXFxcXHUwMzAwLVxcXFx1MDM2ZlxcXFx1ZmUyMC1cXFxcdWZlMjNcIixyc0NvbWJvU3ltYm9sc1JhbmdlPVwiXFxcXHUyMGQwLVxcXFx1MjBmMFwiLHJzRGluZ2JhdFJhbmdlPVwiXFxcXHUyNzAwLVxcXFx1MjdiZlwiLHJzTG93ZXJSYW5nZT1cImEtelxcXFx4ZGYtXFxcXHhmNlxcXFx4ZjgtXFxcXHhmZlwiLHJzTWF0aE9wUmFuZ2U9XCJcXFxceGFjXFxcXHhiMVxcXFx4ZDdcXFxceGY3XCIscnNOb25DaGFyUmFuZ2U9XCJcXFxceDAwLVxcXFx4MmZcXFxceDNhLVxcXFx4NDBcXFxceDViLVxcXFx4NjBcXFxceDdiLVxcXFx4YmZcIixyc1F1b3RlUmFuZ2U9XCJcXFxcdTIwMThcXFxcdTIwMTlcXFxcdTIwMWNcXFxcdTIwMWRcIixyc1NwYWNlUmFuZ2U9XCIgXFxcXHRcXFxceDBiXFxcXGZcXFxceGEwXFxcXHVmZWZmXFxcXG5cXFxcclxcXFx1MjAyOFxcXFx1MjAyOVxcXFx1MTY4MFxcXFx1MTgwZVxcXFx1MjAwMFxcXFx1MjAwMVxcXFx1MjAwMlxcXFx1MjAwM1xcXFx1MjAwNFxcXFx1MjAwNVxcXFx1MjAwNlxcXFx1MjAwN1xcXFx1MjAwOFxcXFx1MjAwOVxcXFx1MjAwYVxcXFx1MjAyZlxcXFx1MjA1ZlxcXFx1MzAwMFwiLHJzVXBwZXJSYW5nZT1cIkEtWlxcXFx4YzAtXFxcXHhkNlxcXFx4ZDgtXFxcXHhkZVwiLHJzVmFyUmFuZ2U9XCJcXFxcdWZlMGVcXFxcdWZlMGZcIixyc0JyZWFrUmFuZ2U9cnNNYXRoT3BSYW5nZSArIHJzTm9uQ2hhclJhbmdlICsgcnNRdW90ZVJhbmdlICsgcnNTcGFjZVJhbmdlO3ZhciByc0FzdHJhbD1cIltcIiArIHJzQXN0cmFsUmFuZ2UgKyBcIl1cIixyc0JyZWFrPVwiW1wiICsgcnNCcmVha1JhbmdlICsgXCJdXCIscnNDb21ibz1cIltcIiArIHJzQ29tYm9NYXJrc1JhbmdlICsgcnNDb21ib1N5bWJvbHNSYW5nZSArIFwiXVwiLHJzRGlnaXRzPVwiXFxcXGQrXCIscnNEaW5nYmF0PVwiW1wiICsgcnNEaW5nYmF0UmFuZ2UgKyBcIl1cIixyc0xvd2VyPVwiW1wiICsgcnNMb3dlclJhbmdlICsgXCJdXCIscnNNaXNjPVwiW15cIiArIHJzQXN0cmFsUmFuZ2UgKyByc0JyZWFrUmFuZ2UgKyByc0RpZ2l0cyArIHJzRGluZ2JhdFJhbmdlICsgcnNMb3dlclJhbmdlICsgcnNVcHBlclJhbmdlICsgXCJdXCIscnNGaXR6PVwiXFxcXHVkODNjW1xcXFx1ZGZmYi1cXFxcdWRmZmZdXCIscnNNb2RpZmllcj1cIig/OlwiICsgcnNDb21ibyArIFwifFwiICsgcnNGaXR6ICsgXCIpXCIscnNOb25Bc3RyYWw9XCJbXlwiICsgcnNBc3RyYWxSYW5nZSArIFwiXVwiLHJzUmVnaW9uYWw9XCIoPzpcXFxcdWQ4M2NbXFxcXHVkZGU2LVxcXFx1ZGRmZl0pezJ9XCIscnNTdXJyUGFpcj1cIltcXFxcdWQ4MDAtXFxcXHVkYmZmXVtcXFxcdWRjMDAtXFxcXHVkZmZmXVwiLHJzVXBwZXI9XCJbXCIgKyByc1VwcGVyUmFuZ2UgKyBcIl1cIixyc1pXSj1cIlxcXFx1MjAwZFwiO3ZhciByc0xvd2VyTWlzYz1cIig/OlwiICsgcnNMb3dlciArIFwifFwiICsgcnNNaXNjICsgXCIpXCIscnNVcHBlck1pc2M9XCIoPzpcIiArIHJzVXBwZXIgKyBcInxcIiArIHJzTWlzYyArIFwiKVwiLHJlT3B0TW9kPXJzTW9kaWZpZXIgKyBcIj9cIixyc09wdFZhcj1cIltcIiArIHJzVmFyUmFuZ2UgKyBcIl0/XCIscnNPcHRKb2luPVwiKD86XCIgKyByc1pXSiArIFwiKD86XCIgKyBbcnNOb25Bc3RyYWwscnNSZWdpb25hbCxyc1N1cnJQYWlyXS5qb2luKFwifFwiKSArIFwiKVwiICsgcnNPcHRWYXIgKyByZU9wdE1vZCArIFwiKSpcIixyc1NlcT1yc09wdFZhciArIHJlT3B0TW9kICsgcnNPcHRKb2luLHJzRW1vamk9XCIoPzpcIiArIFtyc0RpbmdiYXQscnNSZWdpb25hbCxyc1N1cnJQYWlyXS5qb2luKFwifFwiKSArIFwiKVwiICsgcnNTZXEscnNTeW1ib2w9XCIoPzpcIiArIFtyc05vbkFzdHJhbCArIHJzQ29tYm8gKyBcIj9cIixyc0NvbWJvLHJzUmVnaW9uYWwscnNTdXJyUGFpcixyc0FzdHJhbF0uam9pbihcInxcIikgKyBcIilcIjt2YXIgcmVDb21ib01hcms9UmVnRXhwKHJzQ29tYm8sXCJnXCIpO3ZhciByZUNvbXBsZXhTeW1ib2w9UmVnRXhwKHJzRml0eiArIFwiKD89XCIgKyByc0ZpdHogKyBcIil8XCIgKyByc1N5bWJvbCArIHJzU2VxLFwiZ1wiKTt2YXIgcmVIYXNDb21wbGV4U3ltYm9sPVJlZ0V4cChcIltcIiArIHJzWldKICsgcnNBc3RyYWxSYW5nZSArIHJzQ29tYm9NYXJrc1JhbmdlICsgcnNDb21ib1N5bWJvbHNSYW5nZSArIHJzVmFyUmFuZ2UgKyBcIl1cIik7dmFyIHJlQmFzaWNXb3JkPS9bYS16QS1aMC05XSsvZzt2YXIgcmVDb21wbGV4V29yZD1SZWdFeHAoW3JzVXBwZXIgKyBcIj9cIiArIHJzTG93ZXIgKyBcIisoPz1cIiArIFtyc0JyZWFrLHJzVXBwZXIsXCIkXCJdLmpvaW4oXCJ8XCIpICsgXCIpXCIscnNVcHBlck1pc2MgKyBcIisoPz1cIiArIFtyc0JyZWFrLHJzVXBwZXIgKyByc0xvd2VyTWlzYyxcIiRcIl0uam9pbihcInxcIikgKyBcIilcIixyc1VwcGVyICsgXCI/XCIgKyByc0xvd2VyTWlzYyArIFwiK1wiLHJzVXBwZXIgKyBcIitcIixyc0RpZ2l0cyxyc0Vtb2ppXS5qb2luKFwifFwiKSxcImdcIik7dmFyIHJlSGFzQ29tcGxleFdvcmQ9L1thLXpdW0EtWl18WzAtOV1bYS16QS1aXXxbYS16QS1aXVswLTldfFteYS16QS1aMC05IF0vO3ZhciBjb250ZXh0UHJvcHM9W1wiQXJyYXlcIixcIkRhdGVcIixcIkVycm9yXCIsXCJGbG9hdDMyQXJyYXlcIixcIkZsb2F0NjRBcnJheVwiLFwiRnVuY3Rpb25cIixcIkludDhBcnJheVwiLFwiSW50MTZBcnJheVwiLFwiSW50MzJBcnJheVwiLFwiTWFwXCIsXCJNYXRoXCIsXCJPYmplY3RcIixcIlJlZmxlY3RcIixcIlJlZ0V4cFwiLFwiU2V0XCIsXCJTdHJpbmdcIixcIlN5bWJvbFwiLFwiVHlwZUVycm9yXCIsXCJVaW50OEFycmF5XCIsXCJVaW50OENsYW1wZWRBcnJheVwiLFwiVWludDE2QXJyYXlcIixcIlVpbnQzMkFycmF5XCIsXCJXZWFrTWFwXCIsXCJfXCIsXCJjbGVhclRpbWVvdXRcIixcImlzRmluaXRlXCIsXCJwYXJzZUludFwiLFwic2V0VGltZW91dFwiXTt2YXIgdGVtcGxhdGVDb3VudGVyPS0xO3ZhciB0eXBlZEFycmF5VGFncz17fTt0eXBlZEFycmF5VGFnc1tmbG9hdDMyVGFnXSA9IHR5cGVkQXJyYXlUYWdzW2Zsb2F0NjRUYWddID0gdHlwZWRBcnJheVRhZ3NbaW50OFRhZ10gPSB0eXBlZEFycmF5VGFnc1tpbnQxNlRhZ10gPSB0eXBlZEFycmF5VGFnc1tpbnQzMlRhZ10gPSB0eXBlZEFycmF5VGFnc1t1aW50OFRhZ10gPSB0eXBlZEFycmF5VGFnc1t1aW50OENsYW1wZWRUYWddID0gdHlwZWRBcnJheVRhZ3NbdWludDE2VGFnXSA9IHR5cGVkQXJyYXlUYWdzW3VpbnQzMlRhZ10gPSB0cnVlO3R5cGVkQXJyYXlUYWdzW2FyZ3NUYWddID0gdHlwZWRBcnJheVRhZ3NbYXJyYXlUYWddID0gdHlwZWRBcnJheVRhZ3NbYXJyYXlCdWZmZXJUYWddID0gdHlwZWRBcnJheVRhZ3NbYm9vbFRhZ10gPSB0eXBlZEFycmF5VGFnc1tkYXRlVGFnXSA9IHR5cGVkQXJyYXlUYWdzW2Vycm9yVGFnXSA9IHR5cGVkQXJyYXlUYWdzW2Z1bmNUYWddID0gdHlwZWRBcnJheVRhZ3NbbWFwVGFnXSA9IHR5cGVkQXJyYXlUYWdzW251bWJlclRhZ10gPSB0eXBlZEFycmF5VGFnc1tvYmplY3RUYWddID0gdHlwZWRBcnJheVRhZ3NbcmVnZXhwVGFnXSA9IHR5cGVkQXJyYXlUYWdzW3NldFRhZ10gPSB0eXBlZEFycmF5VGFnc1tzdHJpbmdUYWddID0gdHlwZWRBcnJheVRhZ3Nbd2Vha01hcFRhZ10gPSBmYWxzZTt2YXIgY2xvbmVhYmxlVGFncz17fTtjbG9uZWFibGVUYWdzW2FyZ3NUYWddID0gY2xvbmVhYmxlVGFnc1thcnJheVRhZ10gPSBjbG9uZWFibGVUYWdzW2FycmF5QnVmZmVyVGFnXSA9IGNsb25lYWJsZVRhZ3NbYm9vbFRhZ10gPSBjbG9uZWFibGVUYWdzW2RhdGVUYWddID0gY2xvbmVhYmxlVGFnc1tmbG9hdDMyVGFnXSA9IGNsb25lYWJsZVRhZ3NbZmxvYXQ2NFRhZ10gPSBjbG9uZWFibGVUYWdzW2ludDhUYWddID0gY2xvbmVhYmxlVGFnc1tpbnQxNlRhZ10gPSBjbG9uZWFibGVUYWdzW2ludDMyVGFnXSA9IGNsb25lYWJsZVRhZ3NbbWFwVGFnXSA9IGNsb25lYWJsZVRhZ3NbbnVtYmVyVGFnXSA9IGNsb25lYWJsZVRhZ3Nbb2JqZWN0VGFnXSA9IGNsb25lYWJsZVRhZ3NbcmVnZXhwVGFnXSA9IGNsb25lYWJsZVRhZ3Nbc2V0VGFnXSA9IGNsb25lYWJsZVRhZ3Nbc3RyaW5nVGFnXSA9IGNsb25lYWJsZVRhZ3Nbc3ltYm9sVGFnXSA9IGNsb25lYWJsZVRhZ3NbdWludDhUYWddID0gY2xvbmVhYmxlVGFnc1t1aW50OENsYW1wZWRUYWddID0gY2xvbmVhYmxlVGFnc1t1aW50MTZUYWddID0gY2xvbmVhYmxlVGFnc1t1aW50MzJUYWddID0gdHJ1ZTtjbG9uZWFibGVUYWdzW2Vycm9yVGFnXSA9IGNsb25lYWJsZVRhZ3NbZnVuY1RhZ10gPSBjbG9uZWFibGVUYWdzW3dlYWtNYXBUYWddID0gZmFsc2U7dmFyIGRlYnVycmVkTGV0dGVycz17XCLohIxcIjpcIkFcIixcIuiElVwiOlwiQVwiLFwi6ISXXCI6XCJBXCIsXCLohJlcIjpcIkFcIixcIuiEm1wiOlwiQVwiLFwi6IScXCI6XCJBXCIsXCLohL9cIjpcImFcIixcIuiwqVwiOlwiYVwiLFwi6IqSXCI6XCJhXCIsXCLojKtcIjpcImFcIixcIuebslwiOlwiYVwiLFwi5rCTXCI6XCJhXCIsXCLohJ9cIjpcIkNcIixcIuiOvVwiOlwiY1wiLFwi6ISoXCI6XCJEXCIsXCLlhpJcIjpcImRcIixcIuiEoFwiOlwiRVwiLFwi6IShXCI6XCJFXCIsXCLohKJcIjpcIkVcIixcIuiEo1wiOlwiRVwiLFwi54yrXCI6XCJlXCIsXCLojIVcIjpcImVcIixcIumUmlwiOlwiZVwiLFwi5q+bXCI6XCJlXCIsXCLohKRcIjpcIklcIixcIuiEpVwiOlwiSVwiLFwi6ISmXCI6XCJJXCIsXCLohKdcIjpcIklcIixcIuefm1wiOlwiaVwiLFwi6ZOGXCI6XCJpXCIsXCLlja9cIjpcImlcIixcIuiMglwiOlwiaVwiLFwi6ISpXCI6XCJOXCIsXCLluL1cIjpcIm5cIixcIuiEqlwiOlwiT1wiLFwi6ISrXCI6XCJPXCIsXCLohK1cIjpcIk9cIixcIuiErlwiOlwiT1wiLFwi6ISwXCI6XCJPXCIsXCLohLRcIjpcIk9cIixcIuiyjFwiOlwib1wiLFwi6LS4XCI6XCJvXCIsXCLkuYhcIjpcIm9cIixcIueOq1wiOlwib1wiLFwi5p6aXCI6XCJvXCIsXCLphbZcIjpcIm9cIixcIuiEtVwiOlwiVVwiLFwi6IS3XCI6XCJVXCIsXCLohLlcIjpcIlVcIixcIuiEulwiOlwiVVwiLFwi6ZyJXCI6XCJ1XCIsXCLnhaRcIjpcInVcIixcIuayoVwiOlwidVwiLFwi55yJXCI6XCJ1XCIsXCLohLtcIjpcIllcIixcIuWqklwiOlwieVwiLFwi5q+PXCI6XCJ5XCIsXCLohJ1cIjpcIkFlXCIsXCLlv5lcIjpcImFlXCIsXCLohLxcIjpcIlRoXCIsXCLplYFcIjpcInRoXCIsXCLohL1cIjpcInNzXCJ9O3ZhciBodG1sRXNjYXBlcz17XCImXCI6XCImYW1wO1wiLFwiPFwiOlwiJmx0O1wiLFwiPlwiOlwiJmd0O1wiLCdcIic6XCImcXVvdDtcIixcIidcIjpcIiYjMzk7XCIsXCJgXCI6XCImIzk2O1wifTt2YXIgaHRtbFVuZXNjYXBlcz17XCImYW1wO1wiOlwiJlwiLFwiJmx0O1wiOlwiPFwiLFwiJmd0O1wiOlwiPlwiLFwiJnF1b3Q7XCI6J1wiJyxcIiYjMzk7XCI6XCInXCIsXCImIzk2O1wiOlwiYFwifTt2YXIgb2JqZWN0VHlwZXM9e1wiZnVuY3Rpb25cIjp0cnVlLG9iamVjdDp0cnVlfTt2YXIgc3RyaW5nRXNjYXBlcz17XCJcXFxcXCI6XCJcXFxcXCIsXCInXCI6XCInXCIsXCJcXG5cIjpcIm5cIixcIlxcclwiOlwiclwiLFwiXFx1MjAyOFwiOlwidTIwMjhcIixcIlxcdTIwMjlcIjpcInUyMDI5XCJ9O3ZhciBmcmVlUGFyc2VGbG9hdD1wYXJzZUZsb2F0LGZyZWVQYXJzZUludD1wYXJzZUludDt2YXIgZnJlZUV4cG9ydHM9b2JqZWN0VHlwZXNbdHlwZW9mIGV4cG9ydHNdICYmIGV4cG9ydHMgJiYgIWV4cG9ydHMubm9kZVR5cGU/ZXhwb3J0czpudWxsO3ZhciBmcmVlTW9kdWxlPW9iamVjdFR5cGVzW3R5cGVvZiBtb2R1bGVdICYmIG1vZHVsZSAmJiAhbW9kdWxlLm5vZGVUeXBlP21vZHVsZTpudWxsO3ZhciBmcmVlR2xvYmFsPWNoZWNrR2xvYmFsKGZyZWVFeHBvcnRzICYmIGZyZWVNb2R1bGUgJiYgdHlwZW9mIGdsb2JhbCA9PSBcIm9iamVjdFwiICYmIGdsb2JhbCk7dmFyIGZyZWVTZWxmPWNoZWNrR2xvYmFsKG9iamVjdFR5cGVzW3R5cGVvZiBzZWxmXSAmJiBzZWxmKTt2YXIgZnJlZVdpbmRvdz1jaGVja0dsb2JhbChvYmplY3RUeXBlc1t0eXBlb2Ygd2luZG93XSAmJiB3aW5kb3cpO3ZhciBtb2R1bGVFeHBvcnRzPWZyZWVNb2R1bGUgJiYgZnJlZU1vZHVsZS5leHBvcnRzID09PSBmcmVlRXhwb3J0cz9mcmVlRXhwb3J0czpudWxsO3ZhciB0aGlzR2xvYmFsPWNoZWNrR2xvYmFsKG9iamVjdFR5cGVzW3R5cGVvZiB0aGlzXSAmJiB0aGlzKTt2YXIgcm9vdD1mcmVlR2xvYmFsIHx8IGZyZWVXaW5kb3cgIT09ICh0aGlzR2xvYmFsICYmIHRoaXNHbG9iYWwud2luZG93KSAmJiBmcmVlV2luZG93IHx8IGZyZWVTZWxmIHx8IHRoaXNHbG9iYWwgfHwgRnVuY3Rpb24oXCJyZXR1cm4gdGhpc1wiKSgpO2Z1bmN0aW9uIGFkZE1hcEVudHJ5KG1hcCxwYWlyKXttYXAuc2V0KHBhaXJbMF0scGFpclsxXSk7cmV0dXJuIG1hcDt9ZnVuY3Rpb24gYWRkU2V0RW50cnkoc2V0LHZhbHVlKXtzZXQuYWRkKHZhbHVlKTtyZXR1cm4gc2V0O31mdW5jdGlvbiBhcHBseShmdW5jLHRoaXNBcmcsYXJncyl7dmFyIGxlbmd0aD1hcmdzLmxlbmd0aDtzd2l0Y2gobGVuZ3RoKXtjYXNlIDA6cmV0dXJuIGZ1bmMuY2FsbCh0aGlzQXJnKTtjYXNlIDE6cmV0dXJuIGZ1bmMuY2FsbCh0aGlzQXJnLGFyZ3NbMF0pO2Nhc2UgMjpyZXR1cm4gZnVuYy5jYWxsKHRoaXNBcmcsYXJnc1swXSxhcmdzWzFdKTtjYXNlIDM6cmV0dXJuIGZ1bmMuY2FsbCh0aGlzQXJnLGFyZ3NbMF0sYXJnc1sxXSxhcmdzWzJdKTt9cmV0dXJuIGZ1bmMuYXBwbHkodGhpc0FyZyxhcmdzKTt9ZnVuY3Rpb24gYXJyYXlBZ2dyZWdhdG9yKGFycmF5LHNldHRlcixpdGVyYXRlZSxhY2N1bXVsYXRvcil7dmFyIGluZGV4PS0xLGxlbmd0aD1hcnJheS5sZW5ndGg7d2hpbGUoKytpbmRleCA8IGxlbmd0aCkge3ZhciB2YWx1ZT1hcnJheVtpbmRleF07c2V0dGVyKGFjY3VtdWxhdG9yLHZhbHVlLGl0ZXJhdGVlKHZhbHVlKSxhcnJheSk7fXJldHVybiBhY2N1bXVsYXRvcjt9ZnVuY3Rpb24gYXJyYXlDb25jYXQoYXJyYXksb3RoZXIpe3ZhciBpbmRleD0tMSxsZW5ndGg9YXJyYXkubGVuZ3RoLG90aEluZGV4PS0xLG90aExlbmd0aD1vdGhlci5sZW5ndGgscmVzdWx0PUFycmF5KGxlbmd0aCArIG90aExlbmd0aCk7d2hpbGUoKytpbmRleCA8IGxlbmd0aCkge3Jlc3VsdFtpbmRleF0gPSBhcnJheVtpbmRleF07fXdoaWxlKCsrb3RoSW5kZXggPCBvdGhMZW5ndGgpIHtyZXN1bHRbaW5kZXgrK10gPSBvdGhlcltvdGhJbmRleF07fXJldHVybiByZXN1bHQ7fWZ1bmN0aW9uIGFycmF5RWFjaChhcnJheSxpdGVyYXRlZSl7dmFyIGluZGV4PS0xLGxlbmd0aD1hcnJheS5sZW5ndGg7d2hpbGUoKytpbmRleCA8IGxlbmd0aCkge2lmKGl0ZXJhdGVlKGFycmF5W2luZGV4XSxpbmRleCxhcnJheSkgPT09IGZhbHNlKXticmVhazt9fXJldHVybiBhcnJheTt9ZnVuY3Rpb24gYXJyYXlFYWNoUmlnaHQoYXJyYXksaXRlcmF0ZWUpe3ZhciBsZW5ndGg9YXJyYXkubGVuZ3RoO3doaWxlKGxlbmd0aC0tKSB7aWYoaXRlcmF0ZWUoYXJyYXlbbGVuZ3RoXSxsZW5ndGgsYXJyYXkpID09PSBmYWxzZSl7YnJlYWs7fX1yZXR1cm4gYXJyYXk7fWZ1bmN0aW9uIGFycmF5RXZlcnkoYXJyYXkscHJlZGljYXRlKXt2YXIgaW5kZXg9LTEsbGVuZ3RoPWFycmF5Lmxlbmd0aDt3aGlsZSgrK2luZGV4IDwgbGVuZ3RoKSB7aWYoIXByZWRpY2F0ZShhcnJheVtpbmRleF0saW5kZXgsYXJyYXkpKXtyZXR1cm4gZmFsc2U7fX1yZXR1cm4gdHJ1ZTt9ZnVuY3Rpb24gYXJyYXlGaWx0ZXIoYXJyYXkscHJlZGljYXRlKXt2YXIgaW5kZXg9LTEsbGVuZ3RoPWFycmF5Lmxlbmd0aCxyZXNJbmRleD0tMSxyZXN1bHQ9W107d2hpbGUoKytpbmRleCA8IGxlbmd0aCkge3ZhciB2YWx1ZT1hcnJheVtpbmRleF07aWYocHJlZGljYXRlKHZhbHVlLGluZGV4LGFycmF5KSl7cmVzdWx0WysrcmVzSW5kZXhdID0gdmFsdWU7fX1yZXR1cm4gcmVzdWx0O31mdW5jdGlvbiBhcnJheUluY2x1ZGVzKGFycmF5LHZhbHVlKXtyZXR1cm4gISFhcnJheS5sZW5ndGggJiYgYmFzZUluZGV4T2YoYXJyYXksdmFsdWUsMCkgPiAtMTt9ZnVuY3Rpb24gYXJyYXlJbmNsdWRlc1dpdGgoYXJyYXksdmFsdWUsY29tcGFyYXRvcil7dmFyIGluZGV4PS0xLGxlbmd0aD1hcnJheS5sZW5ndGg7d2hpbGUoKytpbmRleCA8IGxlbmd0aCkge2lmKGNvbXBhcmF0b3IodmFsdWUsYXJyYXlbaW5kZXhdKSl7cmV0dXJuIHRydWU7fX1yZXR1cm4gZmFsc2U7fWZ1bmN0aW9uIGFycmF5TWFwKGFycmF5LGl0ZXJhdGVlKXt2YXIgaW5kZXg9LTEsbGVuZ3RoPWFycmF5Lmxlbmd0aCxyZXN1bHQ9QXJyYXkobGVuZ3RoKTt3aGlsZSgrK2luZGV4IDwgbGVuZ3RoKSB7cmVzdWx0W2luZGV4XSA9IGl0ZXJhdGVlKGFycmF5W2luZGV4XSxpbmRleCxhcnJheSk7fXJldHVybiByZXN1bHQ7fWZ1bmN0aW9uIGFycmF5UHVzaChhcnJheSx2YWx1ZXMpe3ZhciBpbmRleD0tMSxsZW5ndGg9dmFsdWVzLmxlbmd0aCxvZmZzZXQ9YXJyYXkubGVuZ3RoO3doaWxlKCsraW5kZXggPCBsZW5ndGgpIHthcnJheVtvZmZzZXQgKyBpbmRleF0gPSB2YWx1ZXNbaW5kZXhdO31yZXR1cm4gYXJyYXk7fWZ1bmN0aW9uIGFycmF5UmVkdWNlKGFycmF5LGl0ZXJhdGVlLGFjY3VtdWxhdG9yLGluaXRBY2N1bSl7dmFyIGluZGV4PS0xLGxlbmd0aD1hcnJheS5sZW5ndGg7aWYoaW5pdEFjY3VtICYmIGxlbmd0aCl7YWNjdW11bGF0b3IgPSBhcnJheVsrK2luZGV4XTt9d2hpbGUoKytpbmRleCA8IGxlbmd0aCkge2FjY3VtdWxhdG9yID0gaXRlcmF0ZWUoYWNjdW11bGF0b3IsYXJyYXlbaW5kZXhdLGluZGV4LGFycmF5KTt9cmV0dXJuIGFjY3VtdWxhdG9yO31mdW5jdGlvbiBhcnJheVJlZHVjZVJpZ2h0KGFycmF5LGl0ZXJhdGVlLGFjY3VtdWxhdG9yLGluaXRBY2N1bSl7dmFyIGxlbmd0aD1hcnJheS5sZW5ndGg7aWYoaW5pdEFjY3VtICYmIGxlbmd0aCl7YWNjdW11bGF0b3IgPSBhcnJheVstLWxlbmd0aF07fXdoaWxlKGxlbmd0aC0tKSB7YWNjdW11bGF0b3IgPSBpdGVyYXRlZShhY2N1bXVsYXRvcixhcnJheVtsZW5ndGhdLGxlbmd0aCxhcnJheSk7fXJldHVybiBhY2N1bXVsYXRvcjt9ZnVuY3Rpb24gYXJyYXlTb21lKGFycmF5LHByZWRpY2F0ZSl7dmFyIGluZGV4PS0xLGxlbmd0aD1hcnJheS5sZW5ndGg7d2hpbGUoKytpbmRleCA8IGxlbmd0aCkge2lmKHByZWRpY2F0ZShhcnJheVtpbmRleF0saW5kZXgsYXJyYXkpKXtyZXR1cm4gdHJ1ZTt9fXJldHVybiBmYWxzZTt9ZnVuY3Rpb24gYmFzZUV4dHJlbXVtKGFycmF5LGl0ZXJhdGVlLGNvbXBhcmF0b3Ipe3ZhciBpbmRleD0tMSxsZW5ndGg9YXJyYXkubGVuZ3RoO3doaWxlKCsraW5kZXggPCBsZW5ndGgpIHt2YXIgdmFsdWU9YXJyYXlbaW5kZXhdLGN1cnJlbnQ9aXRlcmF0ZWUodmFsdWUpO2lmKGN1cnJlbnQgIT0gbnVsbCAmJiAoY29tcHV0ZWQgPT09IHVuZGVmaW5lZD9jdXJyZW50ID09PSBjdXJyZW50OmNvbXBhcmF0b3IoY3VycmVudCxjb21wdXRlZCkpKXt2YXIgY29tcHV0ZWQ9Y3VycmVudCxyZXN1bHQ9dmFsdWU7fX1yZXR1cm4gcmVzdWx0O31mdW5jdGlvbiBiYXNlRmluZChjb2xsZWN0aW9uLHByZWRpY2F0ZSxlYWNoRnVuYyxyZXRLZXkpe3ZhciByZXN1bHQ7ZWFjaEZ1bmMoY29sbGVjdGlvbixmdW5jdGlvbih2YWx1ZSxrZXksY29sbGVjdGlvbil7aWYocHJlZGljYXRlKHZhbHVlLGtleSxjb2xsZWN0aW9uKSl7cmVzdWx0ID0gcmV0S2V5P2tleTp2YWx1ZTtyZXR1cm4gZmFsc2U7fX0pO3JldHVybiByZXN1bHQ7fWZ1bmN0aW9uIGJhc2VGaW5kSW5kZXgoYXJyYXkscHJlZGljYXRlLGZyb21SaWdodCl7dmFyIGxlbmd0aD1hcnJheS5sZW5ndGgsaW5kZXg9ZnJvbVJpZ2h0P2xlbmd0aDotMTt3aGlsZShmcm9tUmlnaHQ/aW5kZXgtLTorK2luZGV4IDwgbGVuZ3RoKSB7aWYocHJlZGljYXRlKGFycmF5W2luZGV4XSxpbmRleCxhcnJheSkpe3JldHVybiBpbmRleDt9fXJldHVybiAtMTt9ZnVuY3Rpb24gYmFzZUluZGV4T2YoYXJyYXksdmFsdWUsZnJvbUluZGV4KXtpZih2YWx1ZSAhPT0gdmFsdWUpe3JldHVybiBpbmRleE9mTmFOKGFycmF5LGZyb21JbmRleCk7fXZhciBpbmRleD1mcm9tSW5kZXggLSAxLGxlbmd0aD1hcnJheS5sZW5ndGg7d2hpbGUoKytpbmRleCA8IGxlbmd0aCkge2lmKGFycmF5W2luZGV4XSA9PT0gdmFsdWUpe3JldHVybiBpbmRleDt9fXJldHVybiAtMTt9ZnVuY3Rpb24gYmFzZVJlZHVjZShjb2xsZWN0aW9uLGl0ZXJhdGVlLGFjY3VtdWxhdG9yLGluaXRBY2N1bSxlYWNoRnVuYyl7ZWFjaEZ1bmMoY29sbGVjdGlvbixmdW5jdGlvbih2YWx1ZSxpbmRleCxjb2xsZWN0aW9uKXthY2N1bXVsYXRvciA9IGluaXRBY2N1bT8oaW5pdEFjY3VtID0gZmFsc2UsdmFsdWUpOml0ZXJhdGVlKGFjY3VtdWxhdG9yLHZhbHVlLGluZGV4LGNvbGxlY3Rpb24pO30pO3JldHVybiBhY2N1bXVsYXRvcjt9ZnVuY3Rpb24gYmFzZVNvcnRCeShhcnJheSxjb21wYXJlcil7dmFyIGxlbmd0aD1hcnJheS5sZW5ndGg7YXJyYXkuc29ydChjb21wYXJlcik7d2hpbGUobGVuZ3RoLS0pIHthcnJheVtsZW5ndGhdID0gYXJyYXlbbGVuZ3RoXS52YWx1ZTt9cmV0dXJuIGFycmF5O31mdW5jdGlvbiBiYXNlU3VtKGFycmF5LGl0ZXJhdGVlKXt2YXIgcmVzdWx0LGluZGV4PS0xLGxlbmd0aD1hcnJheS5sZW5ndGg7d2hpbGUoKytpbmRleCA8IGxlbmd0aCkge3ZhciBjdXJyZW50PWl0ZXJhdGVlKGFycmF5W2luZGV4XSk7aWYoY3VycmVudCAhPT0gdW5kZWZpbmVkKXtyZXN1bHQgPSByZXN1bHQgPT09IHVuZGVmaW5lZD9jdXJyZW50OnJlc3VsdCArIGN1cnJlbnQ7fX1yZXR1cm4gcmVzdWx0O31mdW5jdGlvbiBiYXNlVGltZXMobixpdGVyYXRlZSl7dmFyIGluZGV4PS0xLHJlc3VsdD1BcnJheShuKTt3aGlsZSgrK2luZGV4IDwgbikge3Jlc3VsdFtpbmRleF0gPSBpdGVyYXRlZShpbmRleCk7fXJldHVybiByZXN1bHQ7fWZ1bmN0aW9uIGJhc2VUb1BhaXJzKG9iamVjdCxwcm9wcyl7cmV0dXJuIGFycmF5TWFwKHByb3BzLGZ1bmN0aW9uKGtleSl7cmV0dXJuIFtrZXksb2JqZWN0W2tleV1dO30pO31mdW5jdGlvbiBiYXNlVW5hcnkoZnVuYyl7cmV0dXJuIGZ1bmN0aW9uKHZhbHVlKXtyZXR1cm4gZnVuYyh2YWx1ZSk7fTt9ZnVuY3Rpb24gYmFzZVZhbHVlcyhvYmplY3QscHJvcHMpe3JldHVybiBhcnJheU1hcChwcm9wcyxmdW5jdGlvbihrZXkpe3JldHVybiBvYmplY3Rba2V5XTt9KTt9ZnVuY3Rpb24gY2hhcnNTdGFydEluZGV4KHN0clN5bWJvbHMsY2hyU3ltYm9scyl7dmFyIGluZGV4PS0xLGxlbmd0aD1zdHJTeW1ib2xzLmxlbmd0aDt3aGlsZSgrK2luZGV4IDwgbGVuZ3RoICYmIGJhc2VJbmRleE9mKGNoclN5bWJvbHMsc3RyU3ltYm9sc1tpbmRleF0sMCkgPiAtMSkge31yZXR1cm4gaW5kZXg7fWZ1bmN0aW9uIGNoYXJzRW5kSW5kZXgoc3RyU3ltYm9scyxjaHJTeW1ib2xzKXt2YXIgaW5kZXg9c3RyU3ltYm9scy5sZW5ndGg7d2hpbGUoaW5kZXgtLSAmJiBiYXNlSW5kZXhPZihjaHJTeW1ib2xzLHN0clN5bWJvbHNbaW5kZXhdLDApID4gLTEpIHt9cmV0dXJuIGluZGV4O31mdW5jdGlvbiBjaGVja0dsb2JhbCh2YWx1ZSl7cmV0dXJuIHZhbHVlICYmIHZhbHVlLk9iamVjdCA9PT0gT2JqZWN0P3ZhbHVlOm51bGw7fWZ1bmN0aW9uIGNvbXBhcmVBc2NlbmRpbmcodmFsdWUsb3RoZXIpe2lmKHZhbHVlICE9PSBvdGhlcil7dmFyIHZhbElzTnVsbD12YWx1ZSA9PT0gbnVsbCx2YWxJc1VuZGVmPXZhbHVlID09PSB1bmRlZmluZWQsdmFsSXNSZWZsZXhpdmU9dmFsdWUgPT09IHZhbHVlO3ZhciBvdGhJc051bGw9b3RoZXIgPT09IG51bGwsb3RoSXNVbmRlZj1vdGhlciA9PT0gdW5kZWZpbmVkLG90aElzUmVmbGV4aXZlPW90aGVyID09PSBvdGhlcjtpZih2YWx1ZSA+IG90aGVyICYmICFvdGhJc051bGwgfHwgIXZhbElzUmVmbGV4aXZlIHx8IHZhbElzTnVsbCAmJiAhb3RoSXNVbmRlZiAmJiBvdGhJc1JlZmxleGl2ZSB8fCB2YWxJc1VuZGVmICYmIG90aElzUmVmbGV4aXZlKXtyZXR1cm4gMTt9aWYodmFsdWUgPCBvdGhlciAmJiAhdmFsSXNOdWxsIHx8ICFvdGhJc1JlZmxleGl2ZSB8fCBvdGhJc051bGwgJiYgIXZhbElzVW5kZWYgJiYgdmFsSXNSZWZsZXhpdmUgfHwgb3RoSXNVbmRlZiAmJiB2YWxJc1JlZmxleGl2ZSl7cmV0dXJuIC0xO319cmV0dXJuIDA7fWZ1bmN0aW9uIGNvbXBhcmVNdWx0aXBsZShvYmplY3Qsb3RoZXIsb3JkZXJzKXt2YXIgaW5kZXg9LTEsb2JqQ3JpdGVyaWE9b2JqZWN0LmNyaXRlcmlhLG90aENyaXRlcmlhPW90aGVyLmNyaXRlcmlhLGxlbmd0aD1vYmpDcml0ZXJpYS5sZW5ndGgsb3JkZXJzTGVuZ3RoPW9yZGVycy5sZW5ndGg7d2hpbGUoKytpbmRleCA8IGxlbmd0aCkge3ZhciByZXN1bHQ9Y29tcGFyZUFzY2VuZGluZyhvYmpDcml0ZXJpYVtpbmRleF0sb3RoQ3JpdGVyaWFbaW5kZXhdKTtpZihyZXN1bHQpe2lmKGluZGV4ID49IG9yZGVyc0xlbmd0aCl7cmV0dXJuIHJlc3VsdDt9dmFyIG9yZGVyPW9yZGVyc1tpbmRleF07cmV0dXJuIHJlc3VsdCAqIChvcmRlciA9PSBcImRlc2NcIj8tMToxKTt9fXJldHVybiBvYmplY3QuaW5kZXggLSBvdGhlci5pbmRleDt9ZnVuY3Rpb24gZGVidXJyTGV0dGVyKGxldHRlcil7cmV0dXJuIGRlYnVycmVkTGV0dGVyc1tsZXR0ZXJdO31mdW5jdGlvbiBlc2NhcGVIdG1sQ2hhcihjaHIpe3JldHVybiBodG1sRXNjYXBlc1tjaHJdO31mdW5jdGlvbiBlc2NhcGVTdHJpbmdDaGFyKGNocil7cmV0dXJuIFwiXFxcXFwiICsgc3RyaW5nRXNjYXBlc1tjaHJdO31mdW5jdGlvbiBpbmRleE9mTmFOKGFycmF5LGZyb21JbmRleCxmcm9tUmlnaHQpe3ZhciBsZW5ndGg9YXJyYXkubGVuZ3RoLGluZGV4PWZyb21JbmRleCArIChmcm9tUmlnaHQ/MDotMSk7d2hpbGUoZnJvbVJpZ2h0P2luZGV4LS06KytpbmRleCA8IGxlbmd0aCkge3ZhciBvdGhlcj1hcnJheVtpbmRleF07aWYob3RoZXIgIT09IG90aGVyKXtyZXR1cm4gaW5kZXg7fX1yZXR1cm4gLTE7fWZ1bmN0aW9uIGlzSG9zdE9iamVjdCh2YWx1ZSl7dmFyIHJlc3VsdD1mYWxzZTtpZih2YWx1ZSAhPSBudWxsICYmIHR5cGVvZiB2YWx1ZS50b1N0cmluZyAhPSBcImZ1bmN0aW9uXCIpe3RyeXtyZXN1bHQgPSAhISh2YWx1ZSArIFwiXCIpO31jYXRjaChlKSB7fX1yZXR1cm4gcmVzdWx0O31mdW5jdGlvbiBpc0luZGV4KHZhbHVlLGxlbmd0aCl7dmFsdWUgPSB0eXBlb2YgdmFsdWUgPT0gXCJudW1iZXJcIiB8fCByZUlzVWludC50ZXN0KHZhbHVlKT8rdmFsdWU6LTE7bGVuZ3RoID0gbGVuZ3RoID09IG51bGw/TUFYX1NBRkVfSU5URUdFUjpsZW5ndGg7cmV0dXJuIHZhbHVlID4gLTEgJiYgdmFsdWUgJSAxID09IDAgJiYgdmFsdWUgPCBsZW5ndGg7fWZ1bmN0aW9uIGl0ZXJhdG9yVG9BcnJheShpdGVyYXRvcil7dmFyIGRhdGEscmVzdWx0PVtdO3doaWxlKCEoZGF0YSA9IGl0ZXJhdG9yLm5leHQoKSkuZG9uZSkge3Jlc3VsdC5wdXNoKGRhdGEudmFsdWUpO31yZXR1cm4gcmVzdWx0O31mdW5jdGlvbiBtYXBUb0FycmF5KG1hcCl7dmFyIGluZGV4PS0xLHJlc3VsdD1BcnJheShtYXAuc2l6ZSk7bWFwLmZvckVhY2goZnVuY3Rpb24odmFsdWUsa2V5KXtyZXN1bHRbKytpbmRleF0gPSBba2V5LHZhbHVlXTt9KTtyZXR1cm4gcmVzdWx0O31mdW5jdGlvbiByZXBsYWNlSG9sZGVycyhhcnJheSxwbGFjZWhvbGRlcil7dmFyIGluZGV4PS0xLGxlbmd0aD1hcnJheS5sZW5ndGgscmVzSW5kZXg9LTEscmVzdWx0PVtdO3doaWxlKCsraW5kZXggPCBsZW5ndGgpIHtpZihhcnJheVtpbmRleF0gPT09IHBsYWNlaG9sZGVyKXthcnJheVtpbmRleF0gPSBQTEFDRUhPTERFUjtyZXN1bHRbKytyZXNJbmRleF0gPSBpbmRleDt9fXJldHVybiByZXN1bHQ7fWZ1bmN0aW9uIHNldFRvQXJyYXkoc2V0KXt2YXIgaW5kZXg9LTEscmVzdWx0PUFycmF5KHNldC5zaXplKTtzZXQuZm9yRWFjaChmdW5jdGlvbih2YWx1ZSl7cmVzdWx0WysraW5kZXhdID0gdmFsdWU7fSk7cmV0dXJuIHJlc3VsdDt9ZnVuY3Rpb24gc3RyaW5nU2l6ZShzdHJpbmcpe2lmKCEoc3RyaW5nICYmIHJlSGFzQ29tcGxleFN5bWJvbC50ZXN0KHN0cmluZykpKXtyZXR1cm4gc3RyaW5nLmxlbmd0aDt9dmFyIHJlc3VsdD1yZUNvbXBsZXhTeW1ib2wubGFzdEluZGV4ID0gMDt3aGlsZShyZUNvbXBsZXhTeW1ib2wudGVzdChzdHJpbmcpKSB7cmVzdWx0Kys7fXJldHVybiByZXN1bHQ7fWZ1bmN0aW9uIHN0cmluZ1RvQXJyYXkoc3RyaW5nKXtyZXR1cm4gc3RyaW5nLm1hdGNoKHJlQ29tcGxleFN5bWJvbCk7fWZ1bmN0aW9uIHVuZXNjYXBlSHRtbENoYXIoY2hyKXtyZXR1cm4gaHRtbFVuZXNjYXBlc1tjaHJdO31mdW5jdGlvbiBydW5JbkNvbnRleHQoY29udGV4dCl7Y29udGV4dCA9IGNvbnRleHQ/Xy5kZWZhdWx0cyh7fSxjb250ZXh0LF8ucGljayhyb290LGNvbnRleHRQcm9wcykpOnJvb3Q7dmFyIERhdGU9Y29udGV4dC5EYXRlLEVycm9yPWNvbnRleHQuRXJyb3IsTWF0aD1jb250ZXh0Lk1hdGgsUmVnRXhwPWNvbnRleHQuUmVnRXhwLFR5cGVFcnJvcj1jb250ZXh0LlR5cGVFcnJvcjt2YXIgYXJyYXlQcm90bz1jb250ZXh0LkFycmF5LnByb3RvdHlwZSxvYmplY3RQcm90bz1jb250ZXh0Lk9iamVjdC5wcm90b3R5cGU7dmFyIGZ1bmNUb1N0cmluZz1jb250ZXh0LkZ1bmN0aW9uLnByb3RvdHlwZS50b1N0cmluZzt2YXIgaGFzT3duUHJvcGVydHk9b2JqZWN0UHJvdG8uaGFzT3duUHJvcGVydHk7dmFyIGlkQ291bnRlcj0wO3ZhciBvYmplY3RDdG9yU3RyaW5nPWZ1bmNUb1N0cmluZy5jYWxsKE9iamVjdCk7dmFyIG9iamVjdFRvU3RyaW5nPW9iamVjdFByb3RvLnRvU3RyaW5nO3ZhciBvbGREYXNoPXJvb3QuXzt2YXIgcmVJc05hdGl2ZT1SZWdFeHAoXCJeXCIgKyBmdW5jVG9TdHJpbmcuY2FsbChoYXNPd25Qcm9wZXJ0eSkucmVwbGFjZShyZVJlZ0V4cENoYXIsXCJcXFxcJCZcIikucmVwbGFjZSgvaGFzT3duUHJvcGVydHl8KGZ1bmN0aW9uKS4qPyg/PVxcXFxcXCgpfCBmb3IgLis/KD89XFxcXFxcXSkvZyxcIiQxLio/XCIpICsgXCIkXCIpO3ZhciBSZWZsZWN0PWNvbnRleHQuUmVmbGVjdCxTeW1ib2w9Y29udGV4dC5TeW1ib2wsVWludDhBcnJheT1jb250ZXh0LlVpbnQ4QXJyYXksY2xlYXJUaW1lb3V0PWNvbnRleHQuY2xlYXJUaW1lb3V0LGVudW1lcmF0ZT1SZWZsZWN0P1JlZmxlY3QuZW51bWVyYXRlOnVuZGVmaW5lZCxnZXRQcm90b3R5cGVPZj1PYmplY3QuZ2V0UHJvdG90eXBlT2YsZ2V0T3duUHJvcGVydHlTeW1ib2xzPU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMsaXRlcmF0b3JTeW1ib2w9dHlwZW9mIChpdGVyYXRvclN5bWJvbCA9IFN5bWJvbCAmJiBTeW1ib2wuaXRlcmF0b3IpID09IFwic3ltYm9sXCI/aXRlcmF0b3JTeW1ib2w6dW5kZWZpbmVkLHByb3BlcnR5SXNFbnVtZXJhYmxlPW9iamVjdFByb3RvLnByb3BlcnR5SXNFbnVtZXJhYmxlLHNldFRpbWVvdXQ9Y29udGV4dC5zZXRUaW1lb3V0LHNwbGljZT1hcnJheVByb3RvLnNwbGljZTt2YXIgbmF0aXZlQ2VpbD1NYXRoLmNlaWwsbmF0aXZlRmxvb3I9TWF0aC5mbG9vcixuYXRpdmVJc0Zpbml0ZT1jb250ZXh0LmlzRmluaXRlLG5hdGl2ZUpvaW49YXJyYXlQcm90by5qb2luLG5hdGl2ZUtleXM9T2JqZWN0LmtleXMsbmF0aXZlTWF4PU1hdGgubWF4LG5hdGl2ZU1pbj1NYXRoLm1pbixuYXRpdmVQYXJzZUludD1jb250ZXh0LnBhcnNlSW50LG5hdGl2ZVJhbmRvbT1NYXRoLnJhbmRvbSxuYXRpdmVSZXZlcnNlPWFycmF5UHJvdG8ucmV2ZXJzZTt2YXIgTWFwPWdldE5hdGl2ZShjb250ZXh0LFwiTWFwXCIpLFNldD1nZXROYXRpdmUoY29udGV4dCxcIlNldFwiKSxXZWFrTWFwPWdldE5hdGl2ZShjb250ZXh0LFwiV2Vha01hcFwiKSxuYXRpdmVDcmVhdGU9Z2V0TmF0aXZlKE9iamVjdCxcImNyZWF0ZVwiKTt2YXIgbWV0YU1hcD1XZWFrTWFwICYmIG5ldyBXZWFrTWFwKCk7dmFyIG1hcEN0b3JTdHJpbmc9TWFwP2Z1bmNUb1N0cmluZy5jYWxsKE1hcCk6XCJcIixzZXRDdG9yU3RyaW5nPVNldD9mdW5jVG9TdHJpbmcuY2FsbChTZXQpOlwiXCI7dmFyIHN5bWJvbFByb3RvPVN5bWJvbD9TeW1ib2wucHJvdG90eXBlOnVuZGVmaW5lZCxzeW1ib2xWYWx1ZU9mPVN5bWJvbD9zeW1ib2xQcm90by52YWx1ZU9mOnVuZGVmaW5lZCxzeW1ib2xUb1N0cmluZz1TeW1ib2w/c3ltYm9sUHJvdG8udG9TdHJpbmc6dW5kZWZpbmVkO3ZhciByZWFsTmFtZXM9e307ZnVuY3Rpb24gbG9kYXNoKHZhbHVlKXtpZihpc09iamVjdExpa2UodmFsdWUpICYmICFpc0FycmF5KHZhbHVlKSAmJiAhKHZhbHVlIGluc3RhbmNlb2YgTGF6eVdyYXBwZXIpKXtpZih2YWx1ZSBpbnN0YW5jZW9mIExvZGFzaFdyYXBwZXIpe3JldHVybiB2YWx1ZTt9aWYoaGFzT3duUHJvcGVydHkuY2FsbCh2YWx1ZSxcIl9fd3JhcHBlZF9fXCIpKXtyZXR1cm4gd3JhcHBlckNsb25lKHZhbHVlKTt9fXJldHVybiBuZXcgTG9kYXNoV3JhcHBlcih2YWx1ZSk7fWZ1bmN0aW9uIGJhc2VMb2Rhc2goKXt9ZnVuY3Rpb24gTG9kYXNoV3JhcHBlcih2YWx1ZSxjaGFpbkFsbCl7dGhpcy5fX3dyYXBwZWRfXyA9IHZhbHVlO3RoaXMuX19hY3Rpb25zX18gPSBbXTt0aGlzLl9fY2hhaW5fXyA9ICEhY2hhaW5BbGw7dGhpcy5fX2luZGV4X18gPSAwO3RoaXMuX192YWx1ZXNfXyA9IHVuZGVmaW5lZDt9bG9kYXNoLnRlbXBsYXRlU2V0dGluZ3MgPSB7ZXNjYXBlOnJlRXNjYXBlLGV2YWx1YXRlOnJlRXZhbHVhdGUsaW50ZXJwb2xhdGU6cmVJbnRlcnBvbGF0ZSx2YXJpYWJsZTpcIlwiLGltcG9ydHM6e186bG9kYXNofX07ZnVuY3Rpb24gTGF6eVdyYXBwZXIodmFsdWUpe3RoaXMuX193cmFwcGVkX18gPSB2YWx1ZTt0aGlzLl9fYWN0aW9uc19fID0gW107dGhpcy5fX2Rpcl9fID0gMTt0aGlzLl9fZmlsdGVyZWRfXyA9IGZhbHNlO3RoaXMuX19pdGVyYXRlZXNfXyA9IFtdO3RoaXMuX190YWtlQ291bnRfXyA9IE1BWF9BUlJBWV9MRU5HVEg7dGhpcy5fX3ZpZXdzX18gPSBbXTt9ZnVuY3Rpb24gbGF6eUNsb25lKCl7dmFyIHJlc3VsdD1uZXcgTGF6eVdyYXBwZXIodGhpcy5fX3dyYXBwZWRfXyk7cmVzdWx0Ll9fYWN0aW9uc19fID0gY29weUFycmF5KHRoaXMuX19hY3Rpb25zX18pO3Jlc3VsdC5fX2Rpcl9fID0gdGhpcy5fX2Rpcl9fO3Jlc3VsdC5fX2ZpbHRlcmVkX18gPSB0aGlzLl9fZmlsdGVyZWRfXztyZXN1bHQuX19pdGVyYXRlZXNfXyA9IGNvcHlBcnJheSh0aGlzLl9faXRlcmF0ZWVzX18pO3Jlc3VsdC5fX3Rha2VDb3VudF9fID0gdGhpcy5fX3Rha2VDb3VudF9fO3Jlc3VsdC5fX3ZpZXdzX18gPSBjb3B5QXJyYXkodGhpcy5fX3ZpZXdzX18pO3JldHVybiByZXN1bHQ7fWZ1bmN0aW9uIGxhenlSZXZlcnNlKCl7aWYodGhpcy5fX2ZpbHRlcmVkX18pe3ZhciByZXN1bHQ9bmV3IExhenlXcmFwcGVyKHRoaXMpO3Jlc3VsdC5fX2Rpcl9fID0gLTE7cmVzdWx0Ll9fZmlsdGVyZWRfXyA9IHRydWU7fWVsc2Uge3Jlc3VsdCA9IHRoaXMuY2xvbmUoKTtyZXN1bHQuX19kaXJfXyAqPSAtMTt9cmV0dXJuIHJlc3VsdDt9ZnVuY3Rpb24gbGF6eVZhbHVlKCl7dmFyIGFycmF5PXRoaXMuX193cmFwcGVkX18udmFsdWUoKSxkaXI9dGhpcy5fX2Rpcl9fLGlzQXJyPWlzQXJyYXkoYXJyYXkpLGlzUmlnaHQ9ZGlyIDwgMCxhcnJMZW5ndGg9aXNBcnI/YXJyYXkubGVuZ3RoOjAsdmlldz1nZXRWaWV3KDAsYXJyTGVuZ3RoLHRoaXMuX192aWV3c19fKSxzdGFydD12aWV3LnN0YXJ0LGVuZD12aWV3LmVuZCxsZW5ndGg9ZW5kIC0gc3RhcnQsaW5kZXg9aXNSaWdodD9lbmQ6c3RhcnQgLSAxLGl0ZXJhdGVlcz10aGlzLl9faXRlcmF0ZWVzX18saXRlckxlbmd0aD1pdGVyYXRlZXMubGVuZ3RoLHJlc0luZGV4PTAsdGFrZUNvdW50PW5hdGl2ZU1pbihsZW5ndGgsdGhpcy5fX3Rha2VDb3VudF9fKTtpZighaXNBcnIgfHwgYXJyTGVuZ3RoIDwgTEFSR0VfQVJSQVlfU0laRSB8fCBhcnJMZW5ndGggPT0gbGVuZ3RoICYmIHRha2VDb3VudCA9PSBsZW5ndGgpe3JldHVybiBiYXNlV3JhcHBlclZhbHVlKGFycmF5LHRoaXMuX19hY3Rpb25zX18pO312YXIgcmVzdWx0PVtdO291dGVyOiB3aGlsZShsZW5ndGgtLSAmJiByZXNJbmRleCA8IHRha2VDb3VudCkge2luZGV4ICs9IGRpcjt2YXIgaXRlckluZGV4PS0xLHZhbHVlPWFycmF5W2luZGV4XTt3aGlsZSgrK2l0ZXJJbmRleCA8IGl0ZXJMZW5ndGgpIHt2YXIgZGF0YT1pdGVyYXRlZXNbaXRlckluZGV4XSxpdGVyYXRlZT1kYXRhLml0ZXJhdGVlLHR5cGU9ZGF0YS50eXBlLGNvbXB1dGVkPWl0ZXJhdGVlKHZhbHVlKTtpZih0eXBlID09IExBWllfTUFQX0ZMQUcpe3ZhbHVlID0gY29tcHV0ZWQ7fWVsc2UgaWYoIWNvbXB1dGVkKXtpZih0eXBlID09IExBWllfRklMVEVSX0ZMQUcpe2NvbnRpbnVlIG91dGVyO31lbHNlIHticmVhayBvdXRlcjt9fX1yZXN1bHRbcmVzSW5kZXgrK10gPSB2YWx1ZTt9cmV0dXJuIHJlc3VsdDt9ZnVuY3Rpb24gSGFzaCgpe31mdW5jdGlvbiBoYXNoRGVsZXRlKGhhc2gsa2V5KXtyZXR1cm4gaGFzaEhhcyhoYXNoLGtleSkgJiYgZGVsZXRlIGhhc2hba2V5XTt9ZnVuY3Rpb24gaGFzaEdldChoYXNoLGtleSl7aWYobmF0aXZlQ3JlYXRlKXt2YXIgcmVzdWx0PWhhc2hba2V5XTtyZXR1cm4gcmVzdWx0ID09PSBIQVNIX1VOREVGSU5FRD91bmRlZmluZWQ6cmVzdWx0O31yZXR1cm4gaGFzT3duUHJvcGVydHkuY2FsbChoYXNoLGtleSk/aGFzaFtrZXldOnVuZGVmaW5lZDt9ZnVuY3Rpb24gaGFzaEhhcyhoYXNoLGtleSl7cmV0dXJuIG5hdGl2ZUNyZWF0ZT9oYXNoW2tleV0gIT09IHVuZGVmaW5lZDpoYXNPd25Qcm9wZXJ0eS5jYWxsKGhhc2gsa2V5KTt9ZnVuY3Rpb24gaGFzaFNldChoYXNoLGtleSx2YWx1ZSl7aGFzaFtrZXldID0gbmF0aXZlQ3JlYXRlICYmIHZhbHVlID09PSB1bmRlZmluZWQ/SEFTSF9VTkRFRklORUQ6dmFsdWU7fWZ1bmN0aW9uIE1hcENhY2hlKHZhbHVlcyl7dmFyIGluZGV4PS0xLGxlbmd0aD12YWx1ZXM/dmFsdWVzLmxlbmd0aDowO3RoaXMuY2xlYXIoKTt3aGlsZSgrK2luZGV4IDwgbGVuZ3RoKSB7dmFyIGVudHJ5PXZhbHVlc1tpbmRleF07dGhpcy5zZXQoZW50cnlbMF0sZW50cnlbMV0pO319ZnVuY3Rpb24gbWFwQ2xlYXIoKXt0aGlzLl9fZGF0YV9fID0ge2hhc2g6bmV3IEhhc2goKSxtYXA6TWFwP25ldyBNYXAoKTpbXSxzdHJpbmc6bmV3IEhhc2goKX07fWZ1bmN0aW9uIG1hcERlbGV0ZShrZXkpe3ZhciBkYXRhPXRoaXMuX19kYXRhX187aWYoaXNLZXlhYmxlKGtleSkpe3JldHVybiBoYXNoRGVsZXRlKHR5cGVvZiBrZXkgPT0gXCJzdHJpbmdcIj9kYXRhLnN0cmluZzpkYXRhLmhhc2gsa2V5KTt9cmV0dXJuIE1hcD9kYXRhLm1hcFtcImRlbGV0ZVwiXShrZXkpOmFzc29jRGVsZXRlKGRhdGEubWFwLGtleSk7fWZ1bmN0aW9uIG1hcEdldChrZXkpe3ZhciBkYXRhPXRoaXMuX19kYXRhX187aWYoaXNLZXlhYmxlKGtleSkpe3JldHVybiBoYXNoR2V0KHR5cGVvZiBrZXkgPT0gXCJzdHJpbmdcIj9kYXRhLnN0cmluZzpkYXRhLmhhc2gsa2V5KTt9cmV0dXJuIE1hcD9kYXRhLm1hcC5nZXQoa2V5KTphc3NvY0dldChkYXRhLm1hcCxrZXkpO31mdW5jdGlvbiBtYXBIYXMoa2V5KXt2YXIgZGF0YT10aGlzLl9fZGF0YV9fO2lmKGlzS2V5YWJsZShrZXkpKXtyZXR1cm4gaGFzaEhhcyh0eXBlb2Yga2V5ID09IFwic3RyaW5nXCI/ZGF0YS5zdHJpbmc6ZGF0YS5oYXNoLGtleSk7fXJldHVybiBNYXA/ZGF0YS5tYXAuaGFzKGtleSk6YXNzb2NIYXMoZGF0YS5tYXAsa2V5KTt9ZnVuY3Rpb24gbWFwU2V0KGtleSx2YWx1ZSl7dmFyIGRhdGE9dGhpcy5fX2RhdGFfXztpZihpc0tleWFibGUoa2V5KSl7aGFzaFNldCh0eXBlb2Yga2V5ID09IFwic3RyaW5nXCI/ZGF0YS5zdHJpbmc6ZGF0YS5oYXNoLGtleSx2YWx1ZSk7fWVsc2UgaWYoTWFwKXtkYXRhLm1hcC5zZXQoa2V5LHZhbHVlKTt9ZWxzZSB7YXNzb2NTZXQoZGF0YS5tYXAsa2V5LHZhbHVlKTt9cmV0dXJuIHRoaXM7fWZ1bmN0aW9uIFNldENhY2hlKHZhbHVlcyl7dmFyIGluZGV4PS0xLGxlbmd0aD12YWx1ZXM/dmFsdWVzLmxlbmd0aDowO3RoaXMuX19kYXRhX18gPSBuZXcgTWFwQ2FjaGUoKTt3aGlsZSgrK2luZGV4IDwgbGVuZ3RoKSB7dGhpcy5wdXNoKHZhbHVlc1tpbmRleF0pO319ZnVuY3Rpb24gY2FjaGVIYXMoY2FjaGUsdmFsdWUpe3ZhciBtYXA9Y2FjaGUuX19kYXRhX187aWYoaXNLZXlhYmxlKHZhbHVlKSl7dmFyIGRhdGE9bWFwLl9fZGF0YV9fLGhhc2g9dHlwZW9mIHZhbHVlID09IFwic3RyaW5nXCI/ZGF0YS5zdHJpbmc6ZGF0YS5oYXNoO3JldHVybiBoYXNoW3ZhbHVlXSA9PT0gSEFTSF9VTkRFRklORUQ7fXJldHVybiBtYXAuaGFzKHZhbHVlKTt9ZnVuY3Rpb24gY2FjaGVQdXNoKHZhbHVlKXt2YXIgbWFwPXRoaXMuX19kYXRhX187aWYoaXNLZXlhYmxlKHZhbHVlKSl7dmFyIGRhdGE9bWFwLl9fZGF0YV9fLGhhc2g9dHlwZW9mIHZhbHVlID09IFwic3RyaW5nXCI/ZGF0YS5zdHJpbmc6ZGF0YS5oYXNoO2hhc2hbdmFsdWVdID0gSEFTSF9VTkRFRklORUQ7fWVsc2Uge21hcC5zZXQodmFsdWUsSEFTSF9VTkRFRklORUQpO319ZnVuY3Rpb24gU3RhY2sodmFsdWVzKXt2YXIgaW5kZXg9LTEsbGVuZ3RoPXZhbHVlcz92YWx1ZXMubGVuZ3RoOjA7dGhpcy5jbGVhcigpO3doaWxlKCsraW5kZXggPCBsZW5ndGgpIHt2YXIgZW50cnk9dmFsdWVzW2luZGV4XTt0aGlzLnNldChlbnRyeVswXSxlbnRyeVsxXSk7fX1mdW5jdGlvbiBzdGFja0NsZWFyKCl7dGhpcy5fX2RhdGFfXyA9IHthcnJheTpbXSxtYXA6bnVsbH07fWZ1bmN0aW9uIHN0YWNrRGVsZXRlKGtleSl7dmFyIGRhdGE9dGhpcy5fX2RhdGFfXyxhcnJheT1kYXRhLmFycmF5O3JldHVybiBhcnJheT9hc3NvY0RlbGV0ZShhcnJheSxrZXkpOmRhdGEubWFwW1wiZGVsZXRlXCJdKGtleSk7fWZ1bmN0aW9uIHN0YWNrR2V0KGtleSl7dmFyIGRhdGE9dGhpcy5fX2RhdGFfXyxhcnJheT1kYXRhLmFycmF5O3JldHVybiBhcnJheT9hc3NvY0dldChhcnJheSxrZXkpOmRhdGEubWFwLmdldChrZXkpO31mdW5jdGlvbiBzdGFja0hhcyhrZXkpe3ZhciBkYXRhPXRoaXMuX19kYXRhX18sYXJyYXk9ZGF0YS5hcnJheTtyZXR1cm4gYXJyYXk/YXNzb2NIYXMoYXJyYXksa2V5KTpkYXRhLm1hcC5oYXMoa2V5KTt9ZnVuY3Rpb24gc3RhY2tTZXQoa2V5LHZhbHVlKXt2YXIgZGF0YT10aGlzLl9fZGF0YV9fLGFycmF5PWRhdGEuYXJyYXk7aWYoYXJyYXkpe2lmKGFycmF5Lmxlbmd0aCA8IExBUkdFX0FSUkFZX1NJWkUgLSAxKXthc3NvY1NldChhcnJheSxrZXksdmFsdWUpO31lbHNlIHtkYXRhLmFycmF5ID0gbnVsbDtkYXRhLm1hcCA9IG5ldyBNYXBDYWNoZShhcnJheSk7fX12YXIgbWFwPWRhdGEubWFwO2lmKG1hcCl7bWFwLnNldChrZXksdmFsdWUpO31yZXR1cm4gdGhpczt9ZnVuY3Rpb24gYXNzb2NEZWxldGUoYXJyYXksa2V5KXt2YXIgaW5kZXg9YXNzb2NJbmRleE9mKGFycmF5LGtleSk7aWYoaW5kZXggPCAwKXtyZXR1cm4gZmFsc2U7fXZhciBsYXN0SW5kZXg9YXJyYXkubGVuZ3RoIC0gMTtpZihpbmRleCA9PSBsYXN0SW5kZXgpe2FycmF5LnBvcCgpO31lbHNlIHtzcGxpY2UuY2FsbChhcnJheSxpbmRleCwxKTt9cmV0dXJuIHRydWU7fWZ1bmN0aW9uIGFzc29jR2V0KGFycmF5LGtleSl7dmFyIGluZGV4PWFzc29jSW5kZXhPZihhcnJheSxrZXkpO3JldHVybiBpbmRleCA8IDA/dW5kZWZpbmVkOmFycmF5W2luZGV4XVsxXTt9ZnVuY3Rpb24gYXNzb2NIYXMoYXJyYXksa2V5KXtyZXR1cm4gYXNzb2NJbmRleE9mKGFycmF5LGtleSkgPiAtMTt9ZnVuY3Rpb24gYXNzb2NJbmRleE9mKGFycmF5LGtleSl7dmFyIGxlbmd0aD1hcnJheS5sZW5ndGg7d2hpbGUobGVuZ3RoLS0pIHtpZihlcShhcnJheVtsZW5ndGhdWzBdLGtleSkpe3JldHVybiBsZW5ndGg7fX1yZXR1cm4gLTE7fWZ1bmN0aW9uIGFzc29jU2V0KGFycmF5LGtleSx2YWx1ZSl7dmFyIGluZGV4PWFzc29jSW5kZXhPZihhcnJheSxrZXkpO2lmKGluZGV4IDwgMCl7YXJyYXkucHVzaChba2V5LHZhbHVlXSk7fWVsc2Uge2FycmF5W2luZGV4XVsxXSA9IHZhbHVlO319ZnVuY3Rpb24gYXNzaWduSW5EZWZhdWx0cyhvYmpWYWx1ZSxzcmNWYWx1ZSxrZXksb2JqZWN0KXtpZihvYmpWYWx1ZSA9PT0gdW5kZWZpbmVkIHx8IGVxKG9ialZhbHVlLG9iamVjdFByb3RvW2tleV0pICYmICFoYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCxrZXkpKXtyZXR1cm4gc3JjVmFsdWU7fXJldHVybiBvYmpWYWx1ZTt9ZnVuY3Rpb24gYXNzaWduTWVyZ2VWYWx1ZShvYmplY3Qsa2V5LHZhbHVlKXtpZih2YWx1ZSAhPT0gdW5kZWZpbmVkICYmICFlcShvYmplY3Rba2V5XSx2YWx1ZSkgfHwgdHlwZW9mIGtleSA9PSBcIm51bWJlclwiICYmIHZhbHVlID09PSB1bmRlZmluZWQgJiYgIShrZXkgaW4gb2JqZWN0KSl7b2JqZWN0W2tleV0gPSB2YWx1ZTt9fWZ1bmN0aW9uIGFzc2lnblZhbHVlKG9iamVjdCxrZXksdmFsdWUpe3ZhciBvYmpWYWx1ZT1vYmplY3Rba2V5XTtpZighZXEob2JqVmFsdWUsdmFsdWUpIHx8IGVxKG9ialZhbHVlLG9iamVjdFByb3RvW2tleV0pICYmICFoYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCxrZXkpIHx8IHZhbHVlID09PSB1bmRlZmluZWQgJiYgIShrZXkgaW4gb2JqZWN0KSl7b2JqZWN0W2tleV0gPSB2YWx1ZTt9fWZ1bmN0aW9uIGJhc2VBZ2dyZWdhdG9yKGNvbGxlY3Rpb24sc2V0dGVyLGl0ZXJhdGVlLGFjY3VtdWxhdG9yKXtiYXNlRWFjaChjb2xsZWN0aW9uLGZ1bmN0aW9uKHZhbHVlLGtleSxjb2xsZWN0aW9uKXtzZXR0ZXIoYWNjdW11bGF0b3IsdmFsdWUsaXRlcmF0ZWUodmFsdWUpLGNvbGxlY3Rpb24pO30pO3JldHVybiBhY2N1bXVsYXRvcjt9ZnVuY3Rpb24gYmFzZUFzc2lnbihvYmplY3Qsc291cmNlKXtyZXR1cm4gb2JqZWN0ICYmIGNvcHlPYmplY3Qoc291cmNlLGtleXMoc291cmNlKSxvYmplY3QpO31mdW5jdGlvbiBiYXNlQXQob2JqZWN0LHBhdGhzKXt2YXIgaW5kZXg9LTEsaXNOaWw9b2JqZWN0ID09IG51bGwsbGVuZ3RoPXBhdGhzLmxlbmd0aCxyZXN1bHQ9QXJyYXkobGVuZ3RoKTt3aGlsZSgrK2luZGV4IDwgbGVuZ3RoKSB7cmVzdWx0W2luZGV4XSA9IGlzTmlsP3VuZGVmaW5lZDpnZXQob2JqZWN0LHBhdGhzW2luZGV4XSk7fXJldHVybiByZXN1bHQ7fWZ1bmN0aW9uIGJhc2VDbGFtcChudW1iZXIsbG93ZXIsdXBwZXIpe2lmKG51bWJlciA9PT0gbnVtYmVyKXtpZih1cHBlciAhPT0gdW5kZWZpbmVkKXtudW1iZXIgPSBudW1iZXIgPD0gdXBwZXI/bnVtYmVyOnVwcGVyO31pZihsb3dlciAhPT0gdW5kZWZpbmVkKXtudW1iZXIgPSBudW1iZXIgPj0gbG93ZXI/bnVtYmVyOmxvd2VyO319cmV0dXJuIG51bWJlcjt9ZnVuY3Rpb24gYmFzZUNsb25lKHZhbHVlLGlzRGVlcCxjdXN0b21pemVyLGtleSxvYmplY3Qsc3RhY2spe3ZhciByZXN1bHQ7aWYoY3VzdG9taXplcil7cmVzdWx0ID0gb2JqZWN0P2N1c3RvbWl6ZXIodmFsdWUsa2V5LG9iamVjdCxzdGFjayk6Y3VzdG9taXplcih2YWx1ZSk7fWlmKHJlc3VsdCAhPT0gdW5kZWZpbmVkKXtyZXR1cm4gcmVzdWx0O31pZighaXNPYmplY3QodmFsdWUpKXtyZXR1cm4gdmFsdWU7fXZhciBpc0Fycj1pc0FycmF5KHZhbHVlKTtpZihpc0Fycil7cmVzdWx0ID0gaW5pdENsb25lQXJyYXkodmFsdWUpO2lmKCFpc0RlZXApe3JldHVybiBjb3B5QXJyYXkodmFsdWUscmVzdWx0KTt9fWVsc2Uge3ZhciB0YWc9Z2V0VGFnKHZhbHVlKSxpc0Z1bmM9dGFnID09IGZ1bmNUYWcgfHwgdGFnID09IGdlblRhZztpZih0YWcgPT0gb2JqZWN0VGFnIHx8IHRhZyA9PSBhcmdzVGFnIHx8IGlzRnVuYyAmJiAhb2JqZWN0KXtpZihpc0hvc3RPYmplY3QodmFsdWUpKXtyZXR1cm4gb2JqZWN0P3ZhbHVlOnt9O31yZXN1bHQgPSBpbml0Q2xvbmVPYmplY3QoaXNGdW5jP3t9OnZhbHVlKTtpZighaXNEZWVwKXtyZXR1cm4gY29weVN5bWJvbHModmFsdWUsYmFzZUFzc2lnbihyZXN1bHQsdmFsdWUpKTt9fWVsc2Uge3JldHVybiBjbG9uZWFibGVUYWdzW3RhZ10/aW5pdENsb25lQnlUYWcodmFsdWUsdGFnLGlzRGVlcCk6b2JqZWN0P3ZhbHVlOnt9O319c3RhY2sgfHwgKHN0YWNrID0gbmV3IFN0YWNrKCkpO3ZhciBzdGFja2VkPXN0YWNrLmdldCh2YWx1ZSk7aWYoc3RhY2tlZCl7cmV0dXJuIHN0YWNrZWQ7fXN0YWNrLnNldCh2YWx1ZSxyZXN1bHQpOyhpc0Fycj9hcnJheUVhY2g6YmFzZUZvck93bikodmFsdWUsZnVuY3Rpb24oc3ViVmFsdWUsa2V5KXthc3NpZ25WYWx1ZShyZXN1bHQsa2V5LGJhc2VDbG9uZShzdWJWYWx1ZSxpc0RlZXAsY3VzdG9taXplcixrZXksdmFsdWUsc3RhY2spKTt9KTtyZXR1cm4gaXNBcnI/cmVzdWx0OmNvcHlTeW1ib2xzKHZhbHVlLHJlc3VsdCk7fWZ1bmN0aW9uIGJhc2VDb25mb3Jtcyhzb3VyY2Upe3ZhciBwcm9wcz1rZXlzKHNvdXJjZSksbGVuZ3RoPXByb3BzLmxlbmd0aDtyZXR1cm4gZnVuY3Rpb24ob2JqZWN0KXtpZihvYmplY3QgPT0gbnVsbCl7cmV0dXJuICFsZW5ndGg7fXZhciBpbmRleD1sZW5ndGg7d2hpbGUoaW5kZXgtLSkge3ZhciBrZXk9cHJvcHNbaW5kZXhdLHByZWRpY2F0ZT1zb3VyY2Vba2V5XSx2YWx1ZT1vYmplY3Rba2V5XTtpZih2YWx1ZSA9PT0gdW5kZWZpbmVkICYmICEoa2V5IGluIE9iamVjdChvYmplY3QpKSB8fCAhcHJlZGljYXRlKHZhbHVlKSl7cmV0dXJuIGZhbHNlO319cmV0dXJuIHRydWU7fTt9dmFyIGJhc2VDcmVhdGU9KGZ1bmN0aW9uKCl7ZnVuY3Rpb24gb2JqZWN0KCl7fXJldHVybiBmdW5jdGlvbihwcm90b3R5cGUpe2lmKGlzT2JqZWN0KHByb3RvdHlwZSkpe29iamVjdC5wcm90b3R5cGUgPSBwcm90b3R5cGU7dmFyIHJlc3VsdD1uZXcgb2JqZWN0KCk7b2JqZWN0LnByb3RvdHlwZSA9IHVuZGVmaW5lZDt9cmV0dXJuIHJlc3VsdCB8fCB7fTt9O30pKCk7ZnVuY3Rpb24gYmFzZURlbGF5KGZ1bmMsd2FpdCxhcmdzKXtpZih0eXBlb2YgZnVuYyAhPSBcImZ1bmN0aW9uXCIpe3Rocm93IG5ldyBUeXBlRXJyb3IoRlVOQ19FUlJPUl9URVhUKTt9cmV0dXJuIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtmdW5jLmFwcGx5KHVuZGVmaW5lZCxhcmdzKTt9LHdhaXQpO31mdW5jdGlvbiBiYXNlRGlmZmVyZW5jZShhcnJheSx2YWx1ZXMsaXRlcmF0ZWUsY29tcGFyYXRvcil7dmFyIGluZGV4PS0xLGluY2x1ZGVzPWFycmF5SW5jbHVkZXMsaXNDb21tb249dHJ1ZSxsZW5ndGg9YXJyYXkubGVuZ3RoLHJlc3VsdD1bXSx2YWx1ZXNMZW5ndGg9dmFsdWVzLmxlbmd0aDtpZighbGVuZ3RoKXtyZXR1cm4gcmVzdWx0O31pZihpdGVyYXRlZSl7dmFsdWVzID0gYXJyYXlNYXAodmFsdWVzLGJhc2VVbmFyeShpdGVyYXRlZSkpO31pZihjb21wYXJhdG9yKXtpbmNsdWRlcyA9IGFycmF5SW5jbHVkZXNXaXRoO2lzQ29tbW9uID0gZmFsc2U7fWVsc2UgaWYodmFsdWVzLmxlbmd0aCA+PSBMQVJHRV9BUlJBWV9TSVpFKXtpbmNsdWRlcyA9IGNhY2hlSGFzO2lzQ29tbW9uID0gZmFsc2U7dmFsdWVzID0gbmV3IFNldENhY2hlKHZhbHVlcyk7fW91dGVyOiB3aGlsZSgrK2luZGV4IDwgbGVuZ3RoKSB7dmFyIHZhbHVlPWFycmF5W2luZGV4XSxjb21wdXRlZD1pdGVyYXRlZT9pdGVyYXRlZSh2YWx1ZSk6dmFsdWU7aWYoaXNDb21tb24gJiYgY29tcHV0ZWQgPT09IGNvbXB1dGVkKXt2YXIgdmFsdWVzSW5kZXg9dmFsdWVzTGVuZ3RoO3doaWxlKHZhbHVlc0luZGV4LS0pIHtpZih2YWx1ZXNbdmFsdWVzSW5kZXhdID09PSBjb21wdXRlZCl7Y29udGludWUgb3V0ZXI7fX1yZXN1bHQucHVzaCh2YWx1ZSk7fWVsc2UgaWYoIWluY2x1ZGVzKHZhbHVlcyxjb21wdXRlZCxjb21wYXJhdG9yKSl7cmVzdWx0LnB1c2godmFsdWUpO319cmV0dXJuIHJlc3VsdDt9dmFyIGJhc2VFYWNoPWNyZWF0ZUJhc2VFYWNoKGJhc2VGb3JPd24pO3ZhciBiYXNlRWFjaFJpZ2h0PWNyZWF0ZUJhc2VFYWNoKGJhc2VGb3JPd25SaWdodCx0cnVlKTtmdW5jdGlvbiBiYXNlRXZlcnkoY29sbGVjdGlvbixwcmVkaWNhdGUpe3ZhciByZXN1bHQ9dHJ1ZTtiYXNlRWFjaChjb2xsZWN0aW9uLGZ1bmN0aW9uKHZhbHVlLGluZGV4LGNvbGxlY3Rpb24pe3Jlc3VsdCA9ICEhcHJlZGljYXRlKHZhbHVlLGluZGV4LGNvbGxlY3Rpb24pO3JldHVybiByZXN1bHQ7fSk7cmV0dXJuIHJlc3VsdDt9ZnVuY3Rpb24gYmFzZUZpbGwoYXJyYXksdmFsdWUsc3RhcnQsZW5kKXt2YXIgbGVuZ3RoPWFycmF5Lmxlbmd0aDtzdGFydCA9IHRvSW50ZWdlcihzdGFydCk7aWYoc3RhcnQgPCAwKXtzdGFydCA9IC1zdGFydCA+IGxlbmd0aD8wOmxlbmd0aCArIHN0YXJ0O31lbmQgPSBlbmQgPT09IHVuZGVmaW5lZCB8fCBlbmQgPiBsZW5ndGg/bGVuZ3RoOnRvSW50ZWdlcihlbmQpO2lmKGVuZCA8IDApe2VuZCArPSBsZW5ndGg7fWVuZCA9IHN0YXJ0ID4gZW5kPzA6dG9MZW5ndGgoZW5kKTt3aGlsZShzdGFydCA8IGVuZCkge2FycmF5W3N0YXJ0KytdID0gdmFsdWU7fXJldHVybiBhcnJheTt9ZnVuY3Rpb24gYmFzZUZpbHRlcihjb2xsZWN0aW9uLHByZWRpY2F0ZSl7dmFyIHJlc3VsdD1bXTtiYXNlRWFjaChjb2xsZWN0aW9uLGZ1bmN0aW9uKHZhbHVlLGluZGV4LGNvbGxlY3Rpb24pe2lmKHByZWRpY2F0ZSh2YWx1ZSxpbmRleCxjb2xsZWN0aW9uKSl7cmVzdWx0LnB1c2godmFsdWUpO319KTtyZXR1cm4gcmVzdWx0O31mdW5jdGlvbiBiYXNlRmxhdHRlbihhcnJheSxpc0RlZXAsaXNTdHJpY3QscmVzdWx0KXtyZXN1bHQgfHwgKHJlc3VsdCA9IFtdKTt2YXIgaW5kZXg9LTEsbGVuZ3RoPWFycmF5Lmxlbmd0aDt3aGlsZSgrK2luZGV4IDwgbGVuZ3RoKSB7dmFyIHZhbHVlPWFycmF5W2luZGV4XTtpZihpc0FycmF5TGlrZU9iamVjdCh2YWx1ZSkgJiYgKGlzU3RyaWN0IHx8IGlzQXJyYXkodmFsdWUpIHx8IGlzQXJndW1lbnRzKHZhbHVlKSkpe2lmKGlzRGVlcCl7YmFzZUZsYXR0ZW4odmFsdWUsaXNEZWVwLGlzU3RyaWN0LHJlc3VsdCk7fWVsc2Uge2FycmF5UHVzaChyZXN1bHQsdmFsdWUpO319ZWxzZSBpZighaXNTdHJpY3Qpe3Jlc3VsdFtyZXN1bHQubGVuZ3RoXSA9IHZhbHVlO319cmV0dXJuIHJlc3VsdDt9dmFyIGJhc2VGb3I9Y3JlYXRlQmFzZUZvcigpO3ZhciBiYXNlRm9yUmlnaHQ9Y3JlYXRlQmFzZUZvcih0cnVlKTtmdW5jdGlvbiBiYXNlRm9ySW4ob2JqZWN0LGl0ZXJhdGVlKXtyZXR1cm4gb2JqZWN0ID09IG51bGw/b2JqZWN0OmJhc2VGb3Iob2JqZWN0LGl0ZXJhdGVlLGtleXNJbik7fWZ1bmN0aW9uIGJhc2VGb3JPd24ob2JqZWN0LGl0ZXJhdGVlKXtyZXR1cm4gb2JqZWN0ICYmIGJhc2VGb3Iob2JqZWN0LGl0ZXJhdGVlLGtleXMpO31mdW5jdGlvbiBiYXNlRm9yT3duUmlnaHQob2JqZWN0LGl0ZXJhdGVlKXtyZXR1cm4gb2JqZWN0ICYmIGJhc2VGb3JSaWdodChvYmplY3QsaXRlcmF0ZWUsa2V5cyk7fWZ1bmN0aW9uIGJhc2VGdW5jdGlvbnMob2JqZWN0LHByb3BzKXtyZXR1cm4gYXJyYXlGaWx0ZXIocHJvcHMsZnVuY3Rpb24oa2V5KXtyZXR1cm4gaXNGdW5jdGlvbihvYmplY3Rba2V5XSk7fSk7fWZ1bmN0aW9uIGJhc2VHZXQob2JqZWN0LHBhdGgpe3BhdGggPSBpc0tleShwYXRoLG9iamVjdCk/W3BhdGggKyBcIlwiXTpiYXNlVG9QYXRoKHBhdGgpO3ZhciBpbmRleD0wLGxlbmd0aD1wYXRoLmxlbmd0aDt3aGlsZShvYmplY3QgIT0gbnVsbCAmJiBpbmRleCA8IGxlbmd0aCkge29iamVjdCA9IG9iamVjdFtwYXRoW2luZGV4KytdXTt9cmV0dXJuIGluZGV4ICYmIGluZGV4ID09IGxlbmd0aD9vYmplY3Q6dW5kZWZpbmVkO31mdW5jdGlvbiBiYXNlSGFzKG9iamVjdCxrZXkpe3JldHVybiBoYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCxrZXkpIHx8IHR5cGVvZiBvYmplY3QgPT0gXCJvYmplY3RcIiAmJiBrZXkgaW4gb2JqZWN0ICYmIGdldFByb3RvdHlwZU9mKG9iamVjdCkgPT09IG51bGw7fWZ1bmN0aW9uIGJhc2VIYXNJbihvYmplY3Qsa2V5KXtyZXR1cm4ga2V5IGluIE9iamVjdChvYmplY3QpO31mdW5jdGlvbiBiYXNlSW5SYW5nZShudW1iZXIsc3RhcnQsZW5kKXtyZXR1cm4gbnVtYmVyID49IG5hdGl2ZU1pbihzdGFydCxlbmQpICYmIG51bWJlciA8IG5hdGl2ZU1heChzdGFydCxlbmQpO31mdW5jdGlvbiBiYXNlSW50ZXJzZWN0aW9uKGFycmF5cyxpdGVyYXRlZSxjb21wYXJhdG9yKXt2YXIgaW5jbHVkZXM9Y29tcGFyYXRvcj9hcnJheUluY2x1ZGVzV2l0aDphcnJheUluY2x1ZGVzLG90aExlbmd0aD1hcnJheXMubGVuZ3RoLG90aEluZGV4PW90aExlbmd0aCxjYWNoZXM9QXJyYXkob3RoTGVuZ3RoKSxyZXN1bHQ9W107d2hpbGUob3RoSW5kZXgtLSkge3ZhciBhcnJheT1hcnJheXNbb3RoSW5kZXhdO2lmKG90aEluZGV4ICYmIGl0ZXJhdGVlKXthcnJheSA9IGFycmF5TWFwKGFycmF5LGJhc2VVbmFyeShpdGVyYXRlZSkpO31jYWNoZXNbb3RoSW5kZXhdID0gIWNvbXBhcmF0b3IgJiYgKGl0ZXJhdGVlIHx8IGFycmF5Lmxlbmd0aCA+PSAxMjApP25ldyBTZXRDYWNoZShvdGhJbmRleCAmJiBhcnJheSk6dW5kZWZpbmVkO31hcnJheSA9IGFycmF5c1swXTt2YXIgaW5kZXg9LTEsbGVuZ3RoPWFycmF5Lmxlbmd0aCxzZWVuPWNhY2hlc1swXTtvdXRlcjogd2hpbGUoKytpbmRleCA8IGxlbmd0aCkge3ZhciB2YWx1ZT1hcnJheVtpbmRleF0sY29tcHV0ZWQ9aXRlcmF0ZWU/aXRlcmF0ZWUodmFsdWUpOnZhbHVlO2lmKCEoc2Vlbj9jYWNoZUhhcyhzZWVuLGNvbXB1dGVkKTppbmNsdWRlcyhyZXN1bHQsY29tcHV0ZWQsY29tcGFyYXRvcikpKXt2YXIgb3RoSW5kZXg9b3RoTGVuZ3RoO3doaWxlKC0tb3RoSW5kZXgpIHt2YXIgY2FjaGU9Y2FjaGVzW290aEluZGV4XTtpZighKGNhY2hlP2NhY2hlSGFzKGNhY2hlLGNvbXB1dGVkKTppbmNsdWRlcyhhcnJheXNbb3RoSW5kZXhdLGNvbXB1dGVkLGNvbXBhcmF0b3IpKSl7Y29udGludWUgb3V0ZXI7fX1pZihzZWVuKXtzZWVuLnB1c2goY29tcHV0ZWQpO31yZXN1bHQucHVzaCh2YWx1ZSk7fX1yZXR1cm4gcmVzdWx0O31mdW5jdGlvbiBiYXNlSW52ZXJ0ZXIob2JqZWN0LHNldHRlcixpdGVyYXRlZSxhY2N1bXVsYXRvcil7YmFzZUZvck93bihvYmplY3QsZnVuY3Rpb24odmFsdWUsa2V5LG9iamVjdCl7c2V0dGVyKGFjY3VtdWxhdG9yLGl0ZXJhdGVlKHZhbHVlKSxrZXksb2JqZWN0KTt9KTtyZXR1cm4gYWNjdW11bGF0b3I7fWZ1bmN0aW9uIGJhc2VJbnZva2Uob2JqZWN0LHBhdGgsYXJncyl7aWYoIWlzS2V5KHBhdGgsb2JqZWN0KSl7cGF0aCA9IGJhc2VUb1BhdGgocGF0aCk7b2JqZWN0ID0gcGFyZW50KG9iamVjdCxwYXRoKTtwYXRoID0gbGFzdChwYXRoKTt9dmFyIGZ1bmM9b2JqZWN0ID09IG51bGw/b2JqZWN0Om9iamVjdFtwYXRoXTtyZXR1cm4gZnVuYyA9PSBudWxsP3VuZGVmaW5lZDphcHBseShmdW5jLG9iamVjdCxhcmdzKTt9ZnVuY3Rpb24gYmFzZUlzRXF1YWwodmFsdWUsb3RoZXIsY3VzdG9taXplcixiaXRtYXNrLHN0YWNrKXtpZih2YWx1ZSA9PT0gb3RoZXIpe3JldHVybiB0cnVlO31pZih2YWx1ZSA9PSBudWxsIHx8IG90aGVyID09IG51bGwgfHwgIWlzT2JqZWN0KHZhbHVlKSAmJiAhaXNPYmplY3RMaWtlKG90aGVyKSl7cmV0dXJuIHZhbHVlICE9PSB2YWx1ZSAmJiBvdGhlciAhPT0gb3RoZXI7fXJldHVybiBiYXNlSXNFcXVhbERlZXAodmFsdWUsb3RoZXIsYmFzZUlzRXF1YWwsY3VzdG9taXplcixiaXRtYXNrLHN0YWNrKTt9ZnVuY3Rpb24gYmFzZUlzRXF1YWxEZWVwKG9iamVjdCxvdGhlcixlcXVhbEZ1bmMsY3VzdG9taXplcixiaXRtYXNrLHN0YWNrKXt2YXIgb2JqSXNBcnI9aXNBcnJheShvYmplY3QpLG90aElzQXJyPWlzQXJyYXkob3RoZXIpLG9ialRhZz1hcnJheVRhZyxvdGhUYWc9YXJyYXlUYWc7aWYoIW9iaklzQXJyKXtvYmpUYWcgPSBnZXRUYWcob2JqZWN0KTtpZihvYmpUYWcgPT0gYXJnc1RhZyl7b2JqVGFnID0gb2JqZWN0VGFnO31lbHNlIGlmKG9ialRhZyAhPSBvYmplY3RUYWcpe29iaklzQXJyID0gaXNUeXBlZEFycmF5KG9iamVjdCk7fX1pZighb3RoSXNBcnIpe290aFRhZyA9IGdldFRhZyhvdGhlcik7aWYob3RoVGFnID09IGFyZ3NUYWcpe290aFRhZyA9IG9iamVjdFRhZzt9ZWxzZSBpZihvdGhUYWcgIT0gb2JqZWN0VGFnKXtvdGhJc0FyciA9IGlzVHlwZWRBcnJheShvdGhlcik7fX12YXIgb2JqSXNPYmo9b2JqVGFnID09IG9iamVjdFRhZyAmJiAhaXNIb3N0T2JqZWN0KG9iamVjdCksb3RoSXNPYmo9b3RoVGFnID09IG9iamVjdFRhZyAmJiAhaXNIb3N0T2JqZWN0KG90aGVyKSxpc1NhbWVUYWc9b2JqVGFnID09IG90aFRhZztpZihpc1NhbWVUYWcgJiYgIShvYmpJc0FyciB8fCBvYmpJc09iaikpe3JldHVybiBlcXVhbEJ5VGFnKG9iamVjdCxvdGhlcixvYmpUYWcsZXF1YWxGdW5jLGN1c3RvbWl6ZXIsYml0bWFzayk7fXZhciBpc1BhcnRpYWw9Yml0bWFzayAmIFBBUlRJQUxfQ09NUEFSRV9GTEFHO2lmKCFpc1BhcnRpYWwpe3ZhciBvYmpJc1dyYXBwZWQ9b2JqSXNPYmogJiYgaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsXCJfX3dyYXBwZWRfX1wiKSxvdGhJc1dyYXBwZWQ9b3RoSXNPYmogJiYgaGFzT3duUHJvcGVydHkuY2FsbChvdGhlcixcIl9fd3JhcHBlZF9fXCIpO2lmKG9iaklzV3JhcHBlZCB8fCBvdGhJc1dyYXBwZWQpe3JldHVybiBlcXVhbEZ1bmMob2JqSXNXcmFwcGVkP29iamVjdC52YWx1ZSgpOm9iamVjdCxvdGhJc1dyYXBwZWQ/b3RoZXIudmFsdWUoKTpvdGhlcixjdXN0b21pemVyLGJpdG1hc2ssc3RhY2spO319aWYoIWlzU2FtZVRhZyl7cmV0dXJuIGZhbHNlO31zdGFjayB8fCAoc3RhY2sgPSBuZXcgU3RhY2soKSk7cmV0dXJuIChvYmpJc0Fycj9lcXVhbEFycmF5czplcXVhbE9iamVjdHMpKG9iamVjdCxvdGhlcixlcXVhbEZ1bmMsY3VzdG9taXplcixiaXRtYXNrLHN0YWNrKTt9ZnVuY3Rpb24gYmFzZUlzTWF0Y2gob2JqZWN0LHNvdXJjZSxtYXRjaERhdGEsY3VzdG9taXplcil7dmFyIGluZGV4PW1hdGNoRGF0YS5sZW5ndGgsbGVuZ3RoPWluZGV4LG5vQ3VzdG9taXplcj0hY3VzdG9taXplcjtpZihvYmplY3QgPT0gbnVsbCl7cmV0dXJuICFsZW5ndGg7fW9iamVjdCA9IE9iamVjdChvYmplY3QpO3doaWxlKGluZGV4LS0pIHt2YXIgZGF0YT1tYXRjaERhdGFbaW5kZXhdO2lmKG5vQ3VzdG9taXplciAmJiBkYXRhWzJdP2RhdGFbMV0gIT09IG9iamVjdFtkYXRhWzBdXTohKGRhdGFbMF0gaW4gb2JqZWN0KSl7cmV0dXJuIGZhbHNlO319d2hpbGUoKytpbmRleCA8IGxlbmd0aCkge2RhdGEgPSBtYXRjaERhdGFbaW5kZXhdO3ZhciBrZXk9ZGF0YVswXSxvYmpWYWx1ZT1vYmplY3Rba2V5XSxzcmNWYWx1ZT1kYXRhWzFdO2lmKG5vQ3VzdG9taXplciAmJiBkYXRhWzJdKXtpZihvYmpWYWx1ZSA9PT0gdW5kZWZpbmVkICYmICEoa2V5IGluIG9iamVjdCkpe3JldHVybiBmYWxzZTt9fWVsc2Uge3ZhciBzdGFjaz1uZXcgU3RhY2soKSxyZXN1bHQ9Y3VzdG9taXplcj9jdXN0b21pemVyKG9ialZhbHVlLHNyY1ZhbHVlLGtleSxvYmplY3Qsc291cmNlLHN0YWNrKTp1bmRlZmluZWQ7aWYoIShyZXN1bHQgPT09IHVuZGVmaW5lZD9iYXNlSXNFcXVhbChzcmNWYWx1ZSxvYmpWYWx1ZSxjdXN0b21pemVyLFVOT1JERVJFRF9DT01QQVJFX0ZMQUcgfCBQQVJUSUFMX0NPTVBBUkVfRkxBRyxzdGFjayk6cmVzdWx0KSl7cmV0dXJuIGZhbHNlO319fXJldHVybiB0cnVlO31mdW5jdGlvbiBiYXNlSXRlcmF0ZWUodmFsdWUpe3ZhciB0eXBlPXR5cGVvZiB2YWx1ZTtpZih0eXBlID09IFwiZnVuY3Rpb25cIil7cmV0dXJuIHZhbHVlO31pZih2YWx1ZSA9PSBudWxsKXtyZXR1cm4gaWRlbnRpdHk7fWlmKHR5cGUgPT0gXCJvYmplY3RcIil7cmV0dXJuIGlzQXJyYXkodmFsdWUpP2Jhc2VNYXRjaGVzUHJvcGVydHkodmFsdWVbMF0sdmFsdWVbMV0pOmJhc2VNYXRjaGVzKHZhbHVlKTt9cmV0dXJuIHByb3BlcnR5KHZhbHVlKTt9ZnVuY3Rpb24gYmFzZUtleXMob2JqZWN0KXtyZXR1cm4gbmF0aXZlS2V5cyhPYmplY3Qob2JqZWN0KSk7fWZ1bmN0aW9uIGJhc2VLZXlzSW4ob2JqZWN0KXtvYmplY3QgPSBvYmplY3QgPT0gbnVsbD9vYmplY3Q6T2JqZWN0KG9iamVjdCk7dmFyIHJlc3VsdD1bXTtmb3IodmFyIGtleSBpbiBvYmplY3QpIHtyZXN1bHQucHVzaChrZXkpO31yZXR1cm4gcmVzdWx0O31pZihlbnVtZXJhdGUgJiYgIXByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwoe3ZhbHVlT2Y6MX0sXCJ2YWx1ZU9mXCIpKXtiYXNlS2V5c0luID0gZnVuY3Rpb24ob2JqZWN0KXtyZXR1cm4gaXRlcmF0b3JUb0FycmF5KGVudW1lcmF0ZShvYmplY3QpKTt9O31mdW5jdGlvbiBiYXNlTWFwKGNvbGxlY3Rpb24saXRlcmF0ZWUpe3ZhciBpbmRleD0tMSxyZXN1bHQ9aXNBcnJheUxpa2UoY29sbGVjdGlvbik/QXJyYXkoY29sbGVjdGlvbi5sZW5ndGgpOltdO2Jhc2VFYWNoKGNvbGxlY3Rpb24sZnVuY3Rpb24odmFsdWUsa2V5LGNvbGxlY3Rpb24pe3Jlc3VsdFsrK2luZGV4XSA9IGl0ZXJhdGVlKHZhbHVlLGtleSxjb2xsZWN0aW9uKTt9KTtyZXR1cm4gcmVzdWx0O31mdW5jdGlvbiBiYXNlTWF0Y2hlcyhzb3VyY2Upe3ZhciBtYXRjaERhdGE9Z2V0TWF0Y2hEYXRhKHNvdXJjZSk7aWYobWF0Y2hEYXRhLmxlbmd0aCA9PSAxICYmIG1hdGNoRGF0YVswXVsyXSl7dmFyIGtleT1tYXRjaERhdGFbMF1bMF0sdmFsdWU9bWF0Y2hEYXRhWzBdWzFdO3JldHVybiBmdW5jdGlvbihvYmplY3Qpe2lmKG9iamVjdCA9PSBudWxsKXtyZXR1cm4gZmFsc2U7fXJldHVybiBvYmplY3Rba2V5XSA9PT0gdmFsdWUgJiYgKHZhbHVlICE9PSB1bmRlZmluZWQgfHwga2V5IGluIE9iamVjdChvYmplY3QpKTt9O31yZXR1cm4gZnVuY3Rpb24ob2JqZWN0KXtyZXR1cm4gb2JqZWN0ID09PSBzb3VyY2UgfHwgYmFzZUlzTWF0Y2gob2JqZWN0LHNvdXJjZSxtYXRjaERhdGEpO307fWZ1bmN0aW9uIGJhc2VNYXRjaGVzUHJvcGVydHkocGF0aCxzcmNWYWx1ZSl7cmV0dXJuIGZ1bmN0aW9uKG9iamVjdCl7dmFyIG9ialZhbHVlPWdldChvYmplY3QscGF0aCk7cmV0dXJuIG9ialZhbHVlID09PSB1bmRlZmluZWQgJiYgb2JqVmFsdWUgPT09IHNyY1ZhbHVlP2hhc0luKG9iamVjdCxwYXRoKTpiYXNlSXNFcXVhbChzcmNWYWx1ZSxvYmpWYWx1ZSx1bmRlZmluZWQsVU5PUkRFUkVEX0NPTVBBUkVfRkxBRyB8IFBBUlRJQUxfQ09NUEFSRV9GTEFHKTt9O31mdW5jdGlvbiBiYXNlTWVyZ2Uob2JqZWN0LHNvdXJjZSxzcmNJbmRleCxjdXN0b21pemVyLHN0YWNrKXtpZihvYmplY3QgPT09IHNvdXJjZSl7cmV0dXJuO312YXIgcHJvcHM9aXNBcnJheShzb3VyY2UpIHx8IGlzVHlwZWRBcnJheShzb3VyY2UpP3VuZGVmaW5lZDprZXlzSW4oc291cmNlKTthcnJheUVhY2gocHJvcHMgfHwgc291cmNlLGZ1bmN0aW9uKHNyY1ZhbHVlLGtleSl7aWYocHJvcHMpe2tleSA9IHNyY1ZhbHVlO3NyY1ZhbHVlID0gc291cmNlW2tleV07fWlmKGlzT2JqZWN0KHNyY1ZhbHVlKSl7c3RhY2sgfHwgKHN0YWNrID0gbmV3IFN0YWNrKCkpO2Jhc2VNZXJnZURlZXAob2JqZWN0LHNvdXJjZSxrZXksc3JjSW5kZXgsYmFzZU1lcmdlLGN1c3RvbWl6ZXIsc3RhY2spO31lbHNlIHt2YXIgbmV3VmFsdWU9Y3VzdG9taXplcj9jdXN0b21pemVyKG9iamVjdFtrZXldLHNyY1ZhbHVlLGtleSArIFwiXCIsb2JqZWN0LHNvdXJjZSxzdGFjayk6dW5kZWZpbmVkO2lmKG5ld1ZhbHVlID09PSB1bmRlZmluZWQpe25ld1ZhbHVlID0gc3JjVmFsdWU7fWFzc2lnbk1lcmdlVmFsdWUob2JqZWN0LGtleSxuZXdWYWx1ZSk7fX0pO31mdW5jdGlvbiBiYXNlTWVyZ2VEZWVwKG9iamVjdCxzb3VyY2Usa2V5LHNyY0luZGV4LG1lcmdlRnVuYyxjdXN0b21pemVyLHN0YWNrKXt2YXIgb2JqVmFsdWU9b2JqZWN0W2tleV0sc3JjVmFsdWU9c291cmNlW2tleV0sc3RhY2tlZD1zdGFjay5nZXQoc3JjVmFsdWUpO2lmKHN0YWNrZWQpe2Fzc2lnbk1lcmdlVmFsdWUob2JqZWN0LGtleSxzdGFja2VkKTtyZXR1cm47fXZhciBuZXdWYWx1ZT1jdXN0b21pemVyP2N1c3RvbWl6ZXIob2JqVmFsdWUsc3JjVmFsdWUsa2V5ICsgXCJcIixvYmplY3Qsc291cmNlLHN0YWNrKTp1bmRlZmluZWQsaXNDb21tb249bmV3VmFsdWUgPT09IHVuZGVmaW5lZDtpZihpc0NvbW1vbil7bmV3VmFsdWUgPSBzcmNWYWx1ZTtpZihpc0FycmF5KHNyY1ZhbHVlKSB8fCBpc1R5cGVkQXJyYXkoc3JjVmFsdWUpKXtpZihpc0FycmF5KG9ialZhbHVlKSl7bmV3VmFsdWUgPSBzcmNJbmRleD9jb3B5QXJyYXkob2JqVmFsdWUpOm9ialZhbHVlO31lbHNlIGlmKGlzQXJyYXlMaWtlT2JqZWN0KG9ialZhbHVlKSl7bmV3VmFsdWUgPSBjb3B5QXJyYXkob2JqVmFsdWUpO31lbHNlIHtpc0NvbW1vbiA9IGZhbHNlO25ld1ZhbHVlID0gYmFzZUNsb25lKHNyY1ZhbHVlKTt9fWVsc2UgaWYoaXNQbGFpbk9iamVjdChzcmNWYWx1ZSkgfHwgaXNBcmd1bWVudHMoc3JjVmFsdWUpKXtpZihpc0FyZ3VtZW50cyhvYmpWYWx1ZSkpe25ld1ZhbHVlID0gdG9QbGFpbk9iamVjdChvYmpWYWx1ZSk7fWVsc2UgaWYoIWlzT2JqZWN0KG9ialZhbHVlKSB8fCBzcmNJbmRleCAmJiBpc0Z1bmN0aW9uKG9ialZhbHVlKSl7aXNDb21tb24gPSBmYWxzZTtuZXdWYWx1ZSA9IGJhc2VDbG9uZShzcmNWYWx1ZSk7fWVsc2Uge25ld1ZhbHVlID0gc3JjSW5kZXg/YmFzZUNsb25lKG9ialZhbHVlKTpvYmpWYWx1ZTt9fWVsc2Uge2lzQ29tbW9uID0gZmFsc2U7fX1zdGFjay5zZXQoc3JjVmFsdWUsbmV3VmFsdWUpO2lmKGlzQ29tbW9uKXttZXJnZUZ1bmMobmV3VmFsdWUsc3JjVmFsdWUsc3JjSW5kZXgsY3VzdG9taXplcixzdGFjayk7fWFzc2lnbk1lcmdlVmFsdWUob2JqZWN0LGtleSxuZXdWYWx1ZSk7fWZ1bmN0aW9uIGJhc2VPcmRlckJ5KGNvbGxlY3Rpb24saXRlcmF0ZWVzLG9yZGVycyl7dmFyIGluZGV4PS0xLHRvSXRlcmF0ZWU9Z2V0SXRlcmF0ZWUoKTtpdGVyYXRlZXMgPSBhcnJheU1hcChpdGVyYXRlZXMubGVuZ3RoP2l0ZXJhdGVlczpBcnJheSgxKSxmdW5jdGlvbihpdGVyYXRlZSl7cmV0dXJuIHRvSXRlcmF0ZWUoaXRlcmF0ZWUpO30pO3ZhciByZXN1bHQ9YmFzZU1hcChjb2xsZWN0aW9uLGZ1bmN0aW9uKHZhbHVlLGtleSxjb2xsZWN0aW9uKXt2YXIgY3JpdGVyaWE9YXJyYXlNYXAoaXRlcmF0ZWVzLGZ1bmN0aW9uKGl0ZXJhdGVlKXtyZXR1cm4gaXRlcmF0ZWUodmFsdWUpO30pO3JldHVybiB7Y3JpdGVyaWE6Y3JpdGVyaWEsaW5kZXg6KytpbmRleCx2YWx1ZTp2YWx1ZX07fSk7cmV0dXJuIGJhc2VTb3J0QnkocmVzdWx0LGZ1bmN0aW9uKG9iamVjdCxvdGhlcil7cmV0dXJuIGNvbXBhcmVNdWx0aXBsZShvYmplY3Qsb3RoZXIsb3JkZXJzKTt9KTt9ZnVuY3Rpb24gYmFzZVBpY2sob2JqZWN0LHByb3BzKXtvYmplY3QgPSBPYmplY3Qob2JqZWN0KTtyZXR1cm4gYXJyYXlSZWR1Y2UocHJvcHMsZnVuY3Rpb24ocmVzdWx0LGtleSl7aWYoa2V5IGluIG9iamVjdCl7cmVzdWx0W2tleV0gPSBvYmplY3Rba2V5XTt9cmV0dXJuIHJlc3VsdDt9LHt9KTt9ZnVuY3Rpb24gYmFzZVBpY2tCeShvYmplY3QscHJlZGljYXRlKXt2YXIgcmVzdWx0PXt9O2Jhc2VGb3JJbihvYmplY3QsZnVuY3Rpb24odmFsdWUsa2V5KXtpZihwcmVkaWNhdGUodmFsdWUsa2V5KSl7cmVzdWx0W2tleV0gPSB2YWx1ZTt9fSk7cmV0dXJuIHJlc3VsdDt9ZnVuY3Rpb24gYmFzZVByb3BlcnR5KGtleSl7cmV0dXJuIGZ1bmN0aW9uKG9iamVjdCl7cmV0dXJuIG9iamVjdCA9PSBudWxsP3VuZGVmaW5lZDpvYmplY3Rba2V5XTt9O31mdW5jdGlvbiBiYXNlUHJvcGVydHlEZWVwKHBhdGgpe3JldHVybiBmdW5jdGlvbihvYmplY3Qpe3JldHVybiBiYXNlR2V0KG9iamVjdCxwYXRoKTt9O31mdW5jdGlvbiBiYXNlUHVsbEFsbChhcnJheSx2YWx1ZXMpe3JldHVybiBiYXNlUHVsbEFsbEJ5KGFycmF5LHZhbHVlcyk7fWZ1bmN0aW9uIGJhc2VQdWxsQWxsQnkoYXJyYXksdmFsdWVzLGl0ZXJhdGVlKXt2YXIgaW5kZXg9LTEsbGVuZ3RoPXZhbHVlcy5sZW5ndGgsc2Vlbj1hcnJheTtpZihpdGVyYXRlZSl7c2VlbiA9IGFycmF5TWFwKGFycmF5LGZ1bmN0aW9uKHZhbHVlKXtyZXR1cm4gaXRlcmF0ZWUodmFsdWUpO30pO313aGlsZSgrK2luZGV4IDwgbGVuZ3RoKSB7dmFyIGZyb21JbmRleD0wLHZhbHVlPXZhbHVlc1tpbmRleF0sY29tcHV0ZWQ9aXRlcmF0ZWU/aXRlcmF0ZWUodmFsdWUpOnZhbHVlO3doaWxlKChmcm9tSW5kZXggPSBiYXNlSW5kZXhPZihzZWVuLGNvbXB1dGVkLGZyb21JbmRleCkpID4gLTEpIHtpZihzZWVuICE9PSBhcnJheSl7c3BsaWNlLmNhbGwoc2Vlbixmcm9tSW5kZXgsMSk7fXNwbGljZS5jYWxsKGFycmF5LGZyb21JbmRleCwxKTt9fXJldHVybiBhcnJheTt9ZnVuY3Rpb24gYmFzZVB1bGxBdChhcnJheSxpbmRleGVzKXt2YXIgbGVuZ3RoPWFycmF5P2luZGV4ZXMubGVuZ3RoOjAsbGFzdEluZGV4PWxlbmd0aCAtIDE7d2hpbGUobGVuZ3RoLS0pIHt2YXIgaW5kZXg9aW5kZXhlc1tsZW5ndGhdO2lmKGxhc3RJbmRleCA9PSBsZW5ndGggfHwgaW5kZXggIT0gcHJldmlvdXMpe3ZhciBwcmV2aW91cz1pbmRleDtpZihpc0luZGV4KGluZGV4KSl7c3BsaWNlLmNhbGwoYXJyYXksaW5kZXgsMSk7fWVsc2UgaWYoIWlzS2V5KGluZGV4LGFycmF5KSl7dmFyIHBhdGg9YmFzZVRvUGF0aChpbmRleCksb2JqZWN0PXBhcmVudChhcnJheSxwYXRoKTtpZihvYmplY3QgIT0gbnVsbCl7ZGVsZXRlIG9iamVjdFtsYXN0KHBhdGgpXTt9fWVsc2Uge2RlbGV0ZSBhcnJheVtpbmRleF07fX19cmV0dXJuIGFycmF5O31mdW5jdGlvbiBiYXNlUmFuZG9tKGxvd2VyLHVwcGVyKXtyZXR1cm4gbG93ZXIgKyBuYXRpdmVGbG9vcihuYXRpdmVSYW5kb20oKSAqICh1cHBlciAtIGxvd2VyICsgMSkpO31mdW5jdGlvbiBiYXNlUmFuZ2Uoc3RhcnQsZW5kLHN0ZXAsZnJvbVJpZ2h0KXt2YXIgaW5kZXg9LTEsbGVuZ3RoPW5hdGl2ZU1heChuYXRpdmVDZWlsKChlbmQgLSBzdGFydCkgLyAoc3RlcCB8fCAxKSksMCkscmVzdWx0PUFycmF5KGxlbmd0aCk7d2hpbGUobGVuZ3RoLS0pIHtyZXN1bHRbZnJvbVJpZ2h0P2xlbmd0aDorK2luZGV4XSA9IHN0YXJ0O3N0YXJ0ICs9IHN0ZXA7fXJldHVybiByZXN1bHQ7fWZ1bmN0aW9uIGJhc2VTZXQob2JqZWN0LHBhdGgsdmFsdWUsY3VzdG9taXplcil7cGF0aCA9IGlzS2V5KHBhdGgsb2JqZWN0KT9bcGF0aCArIFwiXCJdOmJhc2VUb1BhdGgocGF0aCk7dmFyIGluZGV4PS0xLGxlbmd0aD1wYXRoLmxlbmd0aCxsYXN0SW5kZXg9bGVuZ3RoIC0gMSxuZXN0ZWQ9b2JqZWN0O3doaWxlKG5lc3RlZCAhPSBudWxsICYmICsraW5kZXggPCBsZW5ndGgpIHt2YXIga2V5PXBhdGhbaW5kZXhdO2lmKGlzT2JqZWN0KG5lc3RlZCkpe3ZhciBuZXdWYWx1ZT12YWx1ZTtpZihpbmRleCAhPSBsYXN0SW5kZXgpe3ZhciBvYmpWYWx1ZT1uZXN0ZWRba2V5XTtuZXdWYWx1ZSA9IGN1c3RvbWl6ZXI/Y3VzdG9taXplcihvYmpWYWx1ZSxrZXksbmVzdGVkKTp1bmRlZmluZWQ7aWYobmV3VmFsdWUgPT09IHVuZGVmaW5lZCl7bmV3VmFsdWUgPSBvYmpWYWx1ZSA9PSBudWxsP2lzSW5kZXgocGF0aFtpbmRleCArIDFdKT9bXTp7fTpvYmpWYWx1ZTt9fWFzc2lnblZhbHVlKG5lc3RlZCxrZXksbmV3VmFsdWUpO31uZXN0ZWQgPSBuZXN0ZWRba2V5XTt9cmV0dXJuIG9iamVjdDt9dmFyIGJhc2VTZXREYXRhPSFtZXRhTWFwP2lkZW50aXR5OmZ1bmN0aW9uKGZ1bmMsZGF0YSl7bWV0YU1hcC5zZXQoZnVuYyxkYXRhKTtyZXR1cm4gZnVuYzt9O2Z1bmN0aW9uIGJhc2VTbGljZShhcnJheSxzdGFydCxlbmQpe3ZhciBpbmRleD0tMSxsZW5ndGg9YXJyYXkubGVuZ3RoO2lmKHN0YXJ0IDwgMCl7c3RhcnQgPSAtc3RhcnQgPiBsZW5ndGg/MDpsZW5ndGggKyBzdGFydDt9ZW5kID0gZW5kID4gbGVuZ3RoP2xlbmd0aDplbmQ7aWYoZW5kIDwgMCl7ZW5kICs9IGxlbmd0aDt9bGVuZ3RoID0gc3RhcnQgPiBlbmQ/MDplbmQgLSBzdGFydCA+Pj4gMDtzdGFydCA+Pj49IDA7dmFyIHJlc3VsdD1BcnJheShsZW5ndGgpO3doaWxlKCsraW5kZXggPCBsZW5ndGgpIHtyZXN1bHRbaW5kZXhdID0gYXJyYXlbaW5kZXggKyBzdGFydF07fXJldHVybiByZXN1bHQ7fWZ1bmN0aW9uIGJhc2VTb21lKGNvbGxlY3Rpb24scHJlZGljYXRlKXt2YXIgcmVzdWx0O2Jhc2VFYWNoKGNvbGxlY3Rpb24sZnVuY3Rpb24odmFsdWUsaW5kZXgsY29sbGVjdGlvbil7cmVzdWx0ID0gcHJlZGljYXRlKHZhbHVlLGluZGV4LGNvbGxlY3Rpb24pO3JldHVybiAhcmVzdWx0O30pO3JldHVybiAhIXJlc3VsdDt9ZnVuY3Rpb24gYmFzZVNvcnRlZEluZGV4KGFycmF5LHZhbHVlLHJldEhpZ2hlc3Qpe3ZhciBsb3c9MCxoaWdoPWFycmF5P2FycmF5Lmxlbmd0aDpsb3c7aWYodHlwZW9mIHZhbHVlID09IFwibnVtYmVyXCIgJiYgdmFsdWUgPT09IHZhbHVlICYmIGhpZ2ggPD0gSEFMRl9NQVhfQVJSQVlfTEVOR1RIKXt3aGlsZShsb3cgPCBoaWdoKSB7dmFyIG1pZD1sb3cgKyBoaWdoID4+PiAxLGNvbXB1dGVkPWFycmF5W21pZF07aWYoKHJldEhpZ2hlc3Q/Y29tcHV0ZWQgPD0gdmFsdWU6Y29tcHV0ZWQgPCB2YWx1ZSkgJiYgY29tcHV0ZWQgIT09IG51bGwpe2xvdyA9IG1pZCArIDE7fWVsc2Uge2hpZ2ggPSBtaWQ7fX1yZXR1cm4gaGlnaDt9cmV0dXJuIGJhc2VTb3J0ZWRJbmRleEJ5KGFycmF5LHZhbHVlLGlkZW50aXR5LHJldEhpZ2hlc3QpO31mdW5jdGlvbiBiYXNlU29ydGVkSW5kZXhCeShhcnJheSx2YWx1ZSxpdGVyYXRlZSxyZXRIaWdoZXN0KXt2YWx1ZSA9IGl0ZXJhdGVlKHZhbHVlKTt2YXIgbG93PTAsaGlnaD1hcnJheT9hcnJheS5sZW5ndGg6MCx2YWxJc05hTj12YWx1ZSAhPT0gdmFsdWUsdmFsSXNOdWxsPXZhbHVlID09PSBudWxsLHZhbElzVW5kZWY9dmFsdWUgPT09IHVuZGVmaW5lZDt3aGlsZShsb3cgPCBoaWdoKSB7dmFyIG1pZD1uYXRpdmVGbG9vcigobG93ICsgaGlnaCkgLyAyKSxjb21wdXRlZD1pdGVyYXRlZShhcnJheVttaWRdKSxpc0RlZj1jb21wdXRlZCAhPT0gdW5kZWZpbmVkLGlzUmVmbGV4aXZlPWNvbXB1dGVkID09PSBjb21wdXRlZDtpZih2YWxJc05hTil7dmFyIHNldExvdz1pc1JlZmxleGl2ZSB8fCByZXRIaWdoZXN0O31lbHNlIGlmKHZhbElzTnVsbCl7c2V0TG93ID0gaXNSZWZsZXhpdmUgJiYgaXNEZWYgJiYgKHJldEhpZ2hlc3QgfHwgY29tcHV0ZWQgIT0gbnVsbCk7fWVsc2UgaWYodmFsSXNVbmRlZil7c2V0TG93ID0gaXNSZWZsZXhpdmUgJiYgKHJldEhpZ2hlc3QgfHwgaXNEZWYpO31lbHNlIGlmKGNvbXB1dGVkID09IG51bGwpe3NldExvdyA9IGZhbHNlO31lbHNlIHtzZXRMb3cgPSByZXRIaWdoZXN0P2NvbXB1dGVkIDw9IHZhbHVlOmNvbXB1dGVkIDwgdmFsdWU7fWlmKHNldExvdyl7bG93ID0gbWlkICsgMTt9ZWxzZSB7aGlnaCA9IG1pZDt9fXJldHVybiBuYXRpdmVNaW4oaGlnaCxNQVhfQVJSQVlfSU5ERVgpO31mdW5jdGlvbiBiYXNlU29ydGVkVW5pcShhcnJheSl7cmV0dXJuIGJhc2VTb3J0ZWRVbmlxQnkoYXJyYXkpO31mdW5jdGlvbiBiYXNlU29ydGVkVW5pcUJ5KGFycmF5LGl0ZXJhdGVlKXt2YXIgaW5kZXg9MCxsZW5ndGg9YXJyYXkubGVuZ3RoLHZhbHVlPWFycmF5WzBdLGNvbXB1dGVkPWl0ZXJhdGVlP2l0ZXJhdGVlKHZhbHVlKTp2YWx1ZSxzZWVuPWNvbXB1dGVkLHJlc0luZGV4PTAscmVzdWx0PVt2YWx1ZV07d2hpbGUoKytpbmRleCA8IGxlbmd0aCkge3ZhbHVlID0gYXJyYXlbaW5kZXhdLGNvbXB1dGVkID0gaXRlcmF0ZWU/aXRlcmF0ZWUodmFsdWUpOnZhbHVlO2lmKCFlcShjb21wdXRlZCxzZWVuKSl7c2VlbiA9IGNvbXB1dGVkO3Jlc3VsdFsrK3Jlc0luZGV4XSA9IHZhbHVlO319cmV0dXJuIHJlc3VsdDt9ZnVuY3Rpb24gYmFzZVRvUGF0aCh2YWx1ZSl7cmV0dXJuIGlzQXJyYXkodmFsdWUpP3ZhbHVlOnN0cmluZ1RvUGF0aCh2YWx1ZSk7fWZ1bmN0aW9uIGJhc2VVbmlxKGFycmF5LGl0ZXJhdGVlLGNvbXBhcmF0b3Ipe3ZhciBpbmRleD0tMSxpbmNsdWRlcz1hcnJheUluY2x1ZGVzLGxlbmd0aD1hcnJheS5sZW5ndGgsaXNDb21tb249dHJ1ZSxyZXN1bHQ9W10sc2Vlbj1yZXN1bHQ7aWYoY29tcGFyYXRvcil7aXNDb21tb24gPSBmYWxzZTtpbmNsdWRlcyA9IGFycmF5SW5jbHVkZXNXaXRoO31lbHNlIGlmKGxlbmd0aCA+PSBMQVJHRV9BUlJBWV9TSVpFKXt2YXIgc2V0PWl0ZXJhdGVlP251bGw6Y3JlYXRlU2V0KGFycmF5KTtpZihzZXQpe3JldHVybiBzZXRUb0FycmF5KHNldCk7fWlzQ29tbW9uID0gZmFsc2U7aW5jbHVkZXMgPSBjYWNoZUhhcztzZWVuID0gbmV3IFNldENhY2hlKCk7fWVsc2Uge3NlZW4gPSBpdGVyYXRlZT9bXTpyZXN1bHQ7fW91dGVyOiB3aGlsZSgrK2luZGV4IDwgbGVuZ3RoKSB7dmFyIHZhbHVlPWFycmF5W2luZGV4XSxjb21wdXRlZD1pdGVyYXRlZT9pdGVyYXRlZSh2YWx1ZSk6dmFsdWU7aWYoaXNDb21tb24gJiYgY29tcHV0ZWQgPT09IGNvbXB1dGVkKXt2YXIgc2VlbkluZGV4PXNlZW4ubGVuZ3RoO3doaWxlKHNlZW5JbmRleC0tKSB7aWYoc2VlbltzZWVuSW5kZXhdID09PSBjb21wdXRlZCl7Y29udGludWUgb3V0ZXI7fX1pZihpdGVyYXRlZSl7c2Vlbi5wdXNoKGNvbXB1dGVkKTt9cmVzdWx0LnB1c2godmFsdWUpO31lbHNlIGlmKCFpbmNsdWRlcyhzZWVuLGNvbXB1dGVkLGNvbXBhcmF0b3IpKXtpZihzZWVuICE9PSByZXN1bHQpe3NlZW4ucHVzaChjb21wdXRlZCk7fXJlc3VsdC5wdXNoKHZhbHVlKTt9fXJldHVybiByZXN1bHQ7fWZ1bmN0aW9uIGJhc2VVbnNldChvYmplY3QscGF0aCl7cGF0aCA9IGlzS2V5KHBhdGgsb2JqZWN0KT9bcGF0aCArIFwiXCJdOmJhc2VUb1BhdGgocGF0aCk7b2JqZWN0ID0gcGFyZW50KG9iamVjdCxwYXRoKTt2YXIga2V5PWxhc3QocGF0aCk7cmV0dXJuIG9iamVjdCAhPSBudWxsICYmIGhhcyhvYmplY3Qsa2V5KT9kZWxldGUgb2JqZWN0W2tleV06dHJ1ZTt9ZnVuY3Rpb24gYmFzZVdoaWxlKGFycmF5LHByZWRpY2F0ZSxpc0Ryb3AsZnJvbVJpZ2h0KXt2YXIgbGVuZ3RoPWFycmF5Lmxlbmd0aCxpbmRleD1mcm9tUmlnaHQ/bGVuZ3RoOi0xO3doaWxlKChmcm9tUmlnaHQ/aW5kZXgtLTorK2luZGV4IDwgbGVuZ3RoKSAmJiBwcmVkaWNhdGUoYXJyYXlbaW5kZXhdLGluZGV4LGFycmF5KSkge31yZXR1cm4gaXNEcm9wP2Jhc2VTbGljZShhcnJheSxmcm9tUmlnaHQ/MDppbmRleCxmcm9tUmlnaHQ/aW5kZXggKyAxOmxlbmd0aCk6YmFzZVNsaWNlKGFycmF5LGZyb21SaWdodD9pbmRleCArIDE6MCxmcm9tUmlnaHQ/bGVuZ3RoOmluZGV4KTt9ZnVuY3Rpb24gYmFzZVdyYXBwZXJWYWx1ZSh2YWx1ZSxhY3Rpb25zKXt2YXIgcmVzdWx0PXZhbHVlO2lmKHJlc3VsdCBpbnN0YW5jZW9mIExhenlXcmFwcGVyKXtyZXN1bHQgPSByZXN1bHQudmFsdWUoKTt9cmV0dXJuIGFycmF5UmVkdWNlKGFjdGlvbnMsZnVuY3Rpb24ocmVzdWx0LGFjdGlvbil7cmV0dXJuIGFjdGlvbi5mdW5jLmFwcGx5KGFjdGlvbi50aGlzQXJnLGFycmF5UHVzaChbcmVzdWx0XSxhY3Rpb24uYXJncykpO30scmVzdWx0KTt9ZnVuY3Rpb24gYmFzZVhvcihhcnJheXMsaXRlcmF0ZWUsY29tcGFyYXRvcil7dmFyIGluZGV4PS0xLGxlbmd0aD1hcnJheXMubGVuZ3RoO3doaWxlKCsraW5kZXggPCBsZW5ndGgpIHt2YXIgcmVzdWx0PXJlc3VsdD9hcnJheVB1c2goYmFzZURpZmZlcmVuY2UocmVzdWx0LGFycmF5c1tpbmRleF0saXRlcmF0ZWUsY29tcGFyYXRvciksYmFzZURpZmZlcmVuY2UoYXJyYXlzW2luZGV4XSxyZXN1bHQsaXRlcmF0ZWUsY29tcGFyYXRvcikpOmFycmF5c1tpbmRleF07fXJldHVybiByZXN1bHQgJiYgcmVzdWx0Lmxlbmd0aD9iYXNlVW5pcShyZXN1bHQsaXRlcmF0ZWUsY29tcGFyYXRvcik6W107fWZ1bmN0aW9uIGJhc2VaaXBPYmplY3QocHJvcHMsdmFsdWVzLGFzc2lnbkZ1bmMpe3ZhciBpbmRleD0tMSxsZW5ndGg9cHJvcHMubGVuZ3RoLHZhbHNMZW5ndGg9dmFsdWVzLmxlbmd0aCxyZXN1bHQ9e307d2hpbGUoKytpbmRleCA8IGxlbmd0aCkge2Fzc2lnbkZ1bmMocmVzdWx0LHByb3BzW2luZGV4XSxpbmRleCA8IHZhbHNMZW5ndGg/dmFsdWVzW2luZGV4XTp1bmRlZmluZWQpO31yZXR1cm4gcmVzdWx0O31mdW5jdGlvbiBjbG9uZUJ1ZmZlcihidWZmZXIpe3ZhciBDdG9yPWJ1ZmZlci5jb25zdHJ1Y3RvcixyZXN1bHQ9bmV3IEN0b3IoYnVmZmVyLmJ5dGVMZW5ndGgpLHZpZXc9bmV3IFVpbnQ4QXJyYXkocmVzdWx0KTt2aWV3LnNldChuZXcgVWludDhBcnJheShidWZmZXIpKTtyZXR1cm4gcmVzdWx0O31mdW5jdGlvbiBjbG9uZU1hcChtYXApe3ZhciBDdG9yPW1hcC5jb25zdHJ1Y3RvcjtyZXR1cm4gYXJyYXlSZWR1Y2UobWFwVG9BcnJheShtYXApLGFkZE1hcEVudHJ5LG5ldyBDdG9yKCkpO31mdW5jdGlvbiBjbG9uZVJlZ0V4cChyZWdleHApe3ZhciBDdG9yPXJlZ2V4cC5jb25zdHJ1Y3RvcixyZXN1bHQ9bmV3IEN0b3IocmVnZXhwLnNvdXJjZSxyZUZsYWdzLmV4ZWMocmVnZXhwKSk7cmVzdWx0Lmxhc3RJbmRleCA9IHJlZ2V4cC5sYXN0SW5kZXg7cmV0dXJuIHJlc3VsdDt9ZnVuY3Rpb24gY2xvbmVTZXQoc2V0KXt2YXIgQ3Rvcj1zZXQuY29uc3RydWN0b3I7cmV0dXJuIGFycmF5UmVkdWNlKHNldFRvQXJyYXkoc2V0KSxhZGRTZXRFbnRyeSxuZXcgQ3RvcigpKTt9ZnVuY3Rpb24gY2xvbmVTeW1ib2woc3ltYm9sKXtyZXR1cm4gU3ltYm9sP09iamVjdChzeW1ib2xWYWx1ZU9mLmNhbGwoc3ltYm9sKSk6e307fWZ1bmN0aW9uIGNsb25lVHlwZWRBcnJheSh0eXBlZEFycmF5LGlzRGVlcCl7dmFyIGJ1ZmZlcj10eXBlZEFycmF5LmJ1ZmZlcixDdG9yPXR5cGVkQXJyYXkuY29uc3RydWN0b3I7cmV0dXJuIG5ldyBDdG9yKGlzRGVlcD9jbG9uZUJ1ZmZlcihidWZmZXIpOmJ1ZmZlcix0eXBlZEFycmF5LmJ5dGVPZmZzZXQsdHlwZWRBcnJheS5sZW5ndGgpO31mdW5jdGlvbiBjb21wb3NlQXJncyhhcmdzLHBhcnRpYWxzLGhvbGRlcnMpe3ZhciBob2xkZXJzTGVuZ3RoPWhvbGRlcnMubGVuZ3RoLGFyZ3NJbmRleD0tMSxhcmdzTGVuZ3RoPW5hdGl2ZU1heChhcmdzLmxlbmd0aCAtIGhvbGRlcnNMZW5ndGgsMCksbGVmdEluZGV4PS0xLGxlZnRMZW5ndGg9cGFydGlhbHMubGVuZ3RoLHJlc3VsdD1BcnJheShsZWZ0TGVuZ3RoICsgYXJnc0xlbmd0aCk7d2hpbGUoKytsZWZ0SW5kZXggPCBsZWZ0TGVuZ3RoKSB7cmVzdWx0W2xlZnRJbmRleF0gPSBwYXJ0aWFsc1tsZWZ0SW5kZXhdO313aGlsZSgrK2FyZ3NJbmRleCA8IGhvbGRlcnNMZW5ndGgpIHtyZXN1bHRbaG9sZGVyc1thcmdzSW5kZXhdXSA9IGFyZ3NbYXJnc0luZGV4XTt9d2hpbGUoYXJnc0xlbmd0aC0tKSB7cmVzdWx0W2xlZnRJbmRleCsrXSA9IGFyZ3NbYXJnc0luZGV4KytdO31yZXR1cm4gcmVzdWx0O31mdW5jdGlvbiBjb21wb3NlQXJnc1JpZ2h0KGFyZ3MscGFydGlhbHMsaG9sZGVycyl7dmFyIGhvbGRlcnNJbmRleD0tMSxob2xkZXJzTGVuZ3RoPWhvbGRlcnMubGVuZ3RoLGFyZ3NJbmRleD0tMSxhcmdzTGVuZ3RoPW5hdGl2ZU1heChhcmdzLmxlbmd0aCAtIGhvbGRlcnNMZW5ndGgsMCkscmlnaHRJbmRleD0tMSxyaWdodExlbmd0aD1wYXJ0aWFscy5sZW5ndGgscmVzdWx0PUFycmF5KGFyZ3NMZW5ndGggKyByaWdodExlbmd0aCk7d2hpbGUoKythcmdzSW5kZXggPCBhcmdzTGVuZ3RoKSB7cmVzdWx0W2FyZ3NJbmRleF0gPSBhcmdzW2FyZ3NJbmRleF07fXZhciBvZmZzZXQ9YXJnc0luZGV4O3doaWxlKCsrcmlnaHRJbmRleCA8IHJpZ2h0TGVuZ3RoKSB7cmVzdWx0W29mZnNldCArIHJpZ2h0SW5kZXhdID0gcGFydGlhbHNbcmlnaHRJbmRleF07fXdoaWxlKCsraG9sZGVyc0luZGV4IDwgaG9sZGVyc0xlbmd0aCkge3Jlc3VsdFtvZmZzZXQgKyBob2xkZXJzW2hvbGRlcnNJbmRleF1dID0gYXJnc1thcmdzSW5kZXgrK107fXJldHVybiByZXN1bHQ7fWZ1bmN0aW9uIGNvcHlBcnJheShzb3VyY2UsYXJyYXkpe3ZhciBpbmRleD0tMSxsZW5ndGg9c291cmNlLmxlbmd0aDthcnJheSB8fCAoYXJyYXkgPSBBcnJheShsZW5ndGgpKTt3aGlsZSgrK2luZGV4IDwgbGVuZ3RoKSB7YXJyYXlbaW5kZXhdID0gc291cmNlW2luZGV4XTt9cmV0dXJuIGFycmF5O31mdW5jdGlvbiBjb3B5T2JqZWN0KHNvdXJjZSxwcm9wcyxvYmplY3Qpe3JldHVybiBjb3B5T2JqZWN0V2l0aChzb3VyY2UscHJvcHMsb2JqZWN0KTt9ZnVuY3Rpb24gY29weU9iamVjdFdpdGgoc291cmNlLHByb3BzLG9iamVjdCxjdXN0b21pemVyKXtvYmplY3QgfHwgKG9iamVjdCA9IHt9KTt2YXIgaW5kZXg9LTEsbGVuZ3RoPXByb3BzLmxlbmd0aDt3aGlsZSgrK2luZGV4IDwgbGVuZ3RoKSB7dmFyIGtleT1wcm9wc1tpbmRleF0sbmV3VmFsdWU9Y3VzdG9taXplcj9jdXN0b21pemVyKG9iamVjdFtrZXldLHNvdXJjZVtrZXldLGtleSxvYmplY3Qsc291cmNlKTpzb3VyY2Vba2V5XTthc3NpZ25WYWx1ZShvYmplY3Qsa2V5LG5ld1ZhbHVlKTt9cmV0dXJuIG9iamVjdDt9ZnVuY3Rpb24gY29weVN5bWJvbHMoc291cmNlLG9iamVjdCl7cmV0dXJuIGNvcHlPYmplY3Qoc291cmNlLGdldFN5bWJvbHMoc291cmNlKSxvYmplY3QpO31mdW5jdGlvbiBjcmVhdGVBZ2dyZWdhdG9yKHNldHRlcixpbml0aWFsaXplcil7cmV0dXJuIGZ1bmN0aW9uKGNvbGxlY3Rpb24saXRlcmF0ZWUpe3ZhciBmdW5jPWlzQXJyYXkoY29sbGVjdGlvbik/YXJyYXlBZ2dyZWdhdG9yOmJhc2VBZ2dyZWdhdG9yLGFjY3VtdWxhdG9yPWluaXRpYWxpemVyP2luaXRpYWxpemVyKCk6e307cmV0dXJuIGZ1bmMoY29sbGVjdGlvbixzZXR0ZXIsZ2V0SXRlcmF0ZWUoaXRlcmF0ZWUpLGFjY3VtdWxhdG9yKTt9O31mdW5jdGlvbiBjcmVhdGVBc3NpZ25lcihhc3NpZ25lcil7cmV0dXJuIHJlc3QoZnVuY3Rpb24ob2JqZWN0LHNvdXJjZXMpe3ZhciBpbmRleD0tMSxsZW5ndGg9c291cmNlcy5sZW5ndGgsY3VzdG9taXplcj1sZW5ndGggPiAxP3NvdXJjZXNbbGVuZ3RoIC0gMV06dW5kZWZpbmVkLGd1YXJkPWxlbmd0aCA+IDI/c291cmNlc1syXTp1bmRlZmluZWQ7Y3VzdG9taXplciA9IHR5cGVvZiBjdXN0b21pemVyID09IFwiZnVuY3Rpb25cIj8obGVuZ3RoLS0sY3VzdG9taXplcik6dW5kZWZpbmVkO2lmKGd1YXJkICYmIGlzSXRlcmF0ZWVDYWxsKHNvdXJjZXNbMF0sc291cmNlc1sxXSxndWFyZCkpe2N1c3RvbWl6ZXIgPSBsZW5ndGggPCAzP3VuZGVmaW5lZDpjdXN0b21pemVyO2xlbmd0aCA9IDE7fW9iamVjdCA9IE9iamVjdChvYmplY3QpO3doaWxlKCsraW5kZXggPCBsZW5ndGgpIHt2YXIgc291cmNlPXNvdXJjZXNbaW5kZXhdO2lmKHNvdXJjZSl7YXNzaWduZXIob2JqZWN0LHNvdXJjZSxpbmRleCxjdXN0b21pemVyKTt9fXJldHVybiBvYmplY3Q7fSk7fWZ1bmN0aW9uIGNyZWF0ZUJhc2VFYWNoKGVhY2hGdW5jLGZyb21SaWdodCl7cmV0dXJuIGZ1bmN0aW9uKGNvbGxlY3Rpb24saXRlcmF0ZWUpe2lmKGNvbGxlY3Rpb24gPT0gbnVsbCl7cmV0dXJuIGNvbGxlY3Rpb247fWlmKCFpc0FycmF5TGlrZShjb2xsZWN0aW9uKSl7cmV0dXJuIGVhY2hGdW5jKGNvbGxlY3Rpb24saXRlcmF0ZWUpO312YXIgbGVuZ3RoPWNvbGxlY3Rpb24ubGVuZ3RoLGluZGV4PWZyb21SaWdodD9sZW5ndGg6LTEsaXRlcmFibGU9T2JqZWN0KGNvbGxlY3Rpb24pO3doaWxlKGZyb21SaWdodD9pbmRleC0tOisraW5kZXggPCBsZW5ndGgpIHtpZihpdGVyYXRlZShpdGVyYWJsZVtpbmRleF0saW5kZXgsaXRlcmFibGUpID09PSBmYWxzZSl7YnJlYWs7fX1yZXR1cm4gY29sbGVjdGlvbjt9O31mdW5jdGlvbiBjcmVhdGVCYXNlRm9yKGZyb21SaWdodCl7cmV0dXJuIGZ1bmN0aW9uKG9iamVjdCxpdGVyYXRlZSxrZXlzRnVuYyl7dmFyIGluZGV4PS0xLGl0ZXJhYmxlPU9iamVjdChvYmplY3QpLHByb3BzPWtleXNGdW5jKG9iamVjdCksbGVuZ3RoPXByb3BzLmxlbmd0aDt3aGlsZShsZW5ndGgtLSkge3ZhciBrZXk9cHJvcHNbZnJvbVJpZ2h0P2xlbmd0aDorK2luZGV4XTtpZihpdGVyYXRlZShpdGVyYWJsZVtrZXldLGtleSxpdGVyYWJsZSkgPT09IGZhbHNlKXticmVhazt9fXJldHVybiBvYmplY3Q7fTt9ZnVuY3Rpb24gY3JlYXRlQmFzZVdyYXBwZXIoZnVuYyxiaXRtYXNrLHRoaXNBcmcpe3ZhciBpc0JpbmQ9Yml0bWFzayAmIEJJTkRfRkxBRyxDdG9yPWNyZWF0ZUN0b3JXcmFwcGVyKGZ1bmMpO2Z1bmN0aW9uIHdyYXBwZXIoKXt2YXIgZm49dGhpcyAmJiB0aGlzICE9PSByb290ICYmIHRoaXMgaW5zdGFuY2VvZiB3cmFwcGVyP0N0b3I6ZnVuYztyZXR1cm4gZm4uYXBwbHkoaXNCaW5kP3RoaXNBcmc6dGhpcyxhcmd1bWVudHMpO31yZXR1cm4gd3JhcHBlcjt9ZnVuY3Rpb24gY3JlYXRlQ2FzZUZpcnN0KG1ldGhvZE5hbWUpe3JldHVybiBmdW5jdGlvbihzdHJpbmcpe3N0cmluZyA9IHRvU3RyaW5nKHN0cmluZyk7dmFyIHN0clN5bWJvbHM9cmVIYXNDb21wbGV4U3ltYm9sLnRlc3Qoc3RyaW5nKT9zdHJpbmdUb0FycmF5KHN0cmluZyk6dW5kZWZpbmVkLGNocj1zdHJTeW1ib2xzP3N0clN5bWJvbHNbMF06c3RyaW5nLmNoYXJBdCgwKSx0cmFpbGluZz1zdHJTeW1ib2xzP3N0clN5bWJvbHMuc2xpY2UoMSkuam9pbihcIlwiKTpzdHJpbmcuc2xpY2UoMSk7cmV0dXJuIGNoclttZXRob2ROYW1lXSgpICsgdHJhaWxpbmc7fTt9ZnVuY3Rpb24gY3JlYXRlQ29tcG91bmRlcihjYWxsYmFjayl7cmV0dXJuIGZ1bmN0aW9uKHN0cmluZyl7cmV0dXJuIGFycmF5UmVkdWNlKHdvcmRzKGRlYnVycihzdHJpbmcpKSxjYWxsYmFjayxcIlwiKTt9O31mdW5jdGlvbiBjcmVhdGVDdG9yV3JhcHBlcihDdG9yKXtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgYXJncz1hcmd1bWVudHM7c3dpdGNoKGFyZ3MubGVuZ3RoKXtjYXNlIDA6cmV0dXJuIG5ldyBDdG9yKCk7Y2FzZSAxOnJldHVybiBuZXcgQ3RvcihhcmdzWzBdKTtjYXNlIDI6cmV0dXJuIG5ldyBDdG9yKGFyZ3NbMF0sYXJnc1sxXSk7Y2FzZSAzOnJldHVybiBuZXcgQ3RvcihhcmdzWzBdLGFyZ3NbMV0sYXJnc1syXSk7Y2FzZSA0OnJldHVybiBuZXcgQ3RvcihhcmdzWzBdLGFyZ3NbMV0sYXJnc1syXSxhcmdzWzNdKTtjYXNlIDU6cmV0dXJuIG5ldyBDdG9yKGFyZ3NbMF0sYXJnc1sxXSxhcmdzWzJdLGFyZ3NbM10sYXJnc1s0XSk7Y2FzZSA2OnJldHVybiBuZXcgQ3RvcihhcmdzWzBdLGFyZ3NbMV0sYXJnc1syXSxhcmdzWzNdLGFyZ3NbNF0sYXJnc1s1XSk7Y2FzZSA3OnJldHVybiBuZXcgQ3RvcihhcmdzWzBdLGFyZ3NbMV0sYXJnc1syXSxhcmdzWzNdLGFyZ3NbNF0sYXJnc1s1XSxhcmdzWzZdKTt9dmFyIHRoaXNCaW5kaW5nPWJhc2VDcmVhdGUoQ3Rvci5wcm90b3R5cGUpLHJlc3VsdD1DdG9yLmFwcGx5KHRoaXNCaW5kaW5nLGFyZ3MpO3JldHVybiBpc09iamVjdChyZXN1bHQpP3Jlc3VsdDp0aGlzQmluZGluZzt9O31mdW5jdGlvbiBjcmVhdGVDdXJyeVdyYXBwZXIoZnVuYyxiaXRtYXNrLGFyaXR5KXt2YXIgQ3Rvcj1jcmVhdGVDdG9yV3JhcHBlcihmdW5jKTtmdW5jdGlvbiB3cmFwcGVyKCl7dmFyIGxlbmd0aD1hcmd1bWVudHMubGVuZ3RoLGluZGV4PWxlbmd0aCxhcmdzPUFycmF5KGxlbmd0aCksZm49dGhpcyAmJiB0aGlzICE9PSByb290ICYmIHRoaXMgaW5zdGFuY2VvZiB3cmFwcGVyP0N0b3I6ZnVuYyxwbGFjZWhvbGRlcj13cmFwcGVyLnBsYWNlaG9sZGVyO3doaWxlKGluZGV4LS0pIHthcmdzW2luZGV4XSA9IGFyZ3VtZW50c1tpbmRleF07fXZhciBob2xkZXJzPWxlbmd0aCA8IDMgJiYgYXJnc1swXSAhPT0gcGxhY2Vob2xkZXIgJiYgYXJnc1tsZW5ndGggLSAxXSAhPT0gcGxhY2Vob2xkZXI/W106cmVwbGFjZUhvbGRlcnMoYXJncyxwbGFjZWhvbGRlcik7bGVuZ3RoIC09IGhvbGRlcnMubGVuZ3RoO3JldHVybiBsZW5ndGggPCBhcml0eT9jcmVhdGVSZWN1cnJ5V3JhcHBlcihmdW5jLGJpdG1hc2ssY3JlYXRlSHlicmlkV3JhcHBlcixwbGFjZWhvbGRlcix1bmRlZmluZWQsYXJncyxob2xkZXJzLHVuZGVmaW5lZCx1bmRlZmluZWQsYXJpdHkgLSBsZW5ndGgpOmFwcGx5KGZuLHRoaXMsYXJncyk7fXJldHVybiB3cmFwcGVyO31mdW5jdGlvbiBjcmVhdGVGbG93KGZyb21SaWdodCl7cmV0dXJuIHJlc3QoZnVuY3Rpb24oZnVuY3Mpe2Z1bmNzID0gYmFzZUZsYXR0ZW4oZnVuY3MpO3ZhciBsZW5ndGg9ZnVuY3MubGVuZ3RoLGluZGV4PWxlbmd0aCxwcmVyZXE9TG9kYXNoV3JhcHBlci5wcm90b3R5cGUudGhydTtpZihmcm9tUmlnaHQpe2Z1bmNzLnJldmVyc2UoKTt9d2hpbGUoaW5kZXgtLSkge3ZhciBmdW5jPWZ1bmNzW2luZGV4XTtpZih0eXBlb2YgZnVuYyAhPSBcImZ1bmN0aW9uXCIpe3Rocm93IG5ldyBUeXBlRXJyb3IoRlVOQ19FUlJPUl9URVhUKTt9aWYocHJlcmVxICYmICF3cmFwcGVyICYmIGdldEZ1bmNOYW1lKGZ1bmMpID09IFwid3JhcHBlclwiKXt2YXIgd3JhcHBlcj1uZXcgTG9kYXNoV3JhcHBlcihbXSx0cnVlKTt9fWluZGV4ID0gd3JhcHBlcj9pbmRleDpsZW5ndGg7d2hpbGUoKytpbmRleCA8IGxlbmd0aCkge2Z1bmMgPSBmdW5jc1tpbmRleF07dmFyIGZ1bmNOYW1lPWdldEZ1bmNOYW1lKGZ1bmMpLGRhdGE9ZnVuY05hbWUgPT0gXCJ3cmFwcGVyXCI/Z2V0RGF0YShmdW5jKTp1bmRlZmluZWQ7aWYoZGF0YSAmJiBpc0xhemlhYmxlKGRhdGFbMF0pICYmIGRhdGFbMV0gPT0gKEFSWV9GTEFHIHwgQ1VSUllfRkxBRyB8IFBBUlRJQUxfRkxBRyB8IFJFQVJHX0ZMQUcpICYmICFkYXRhWzRdLmxlbmd0aCAmJiBkYXRhWzldID09IDEpe3dyYXBwZXIgPSB3cmFwcGVyW2dldEZ1bmNOYW1lKGRhdGFbMF0pXS5hcHBseSh3cmFwcGVyLGRhdGFbM10pO31lbHNlIHt3cmFwcGVyID0gZnVuYy5sZW5ndGggPT0gMSAmJiBpc0xhemlhYmxlKGZ1bmMpP3dyYXBwZXJbZnVuY05hbWVdKCk6d3JhcHBlci50aHJ1KGZ1bmMpO319cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGFyZ3M9YXJndW1lbnRzLHZhbHVlPWFyZ3NbMF07aWYod3JhcHBlciAmJiBhcmdzLmxlbmd0aCA9PSAxICYmIGlzQXJyYXkodmFsdWUpICYmIHZhbHVlLmxlbmd0aCA+PSBMQVJHRV9BUlJBWV9TSVpFKXtyZXR1cm4gd3JhcHBlci5wbGFudCh2YWx1ZSkudmFsdWUoKTt9dmFyIGluZGV4PTAscmVzdWx0PWxlbmd0aD9mdW5jc1tpbmRleF0uYXBwbHkodGhpcyxhcmdzKTp2YWx1ZTt3aGlsZSgrK2luZGV4IDwgbGVuZ3RoKSB7cmVzdWx0ID0gZnVuY3NbaW5kZXhdLmNhbGwodGhpcyxyZXN1bHQpO31yZXR1cm4gcmVzdWx0O307fSk7fWZ1bmN0aW9uIGNyZWF0ZUh5YnJpZFdyYXBwZXIoZnVuYyxiaXRtYXNrLHRoaXNBcmcscGFydGlhbHMsaG9sZGVycyxwYXJ0aWFsc1JpZ2h0LGhvbGRlcnNSaWdodCxhcmdQb3MsYXJ5LGFyaXR5KXt2YXIgaXNBcnk9Yml0bWFzayAmIEFSWV9GTEFHLGlzQmluZD1iaXRtYXNrICYgQklORF9GTEFHLGlzQmluZEtleT1iaXRtYXNrICYgQklORF9LRVlfRkxBRyxpc0N1cnJ5PWJpdG1hc2sgJiBDVVJSWV9GTEFHLGlzQ3VycnlSaWdodD1iaXRtYXNrICYgQ1VSUllfUklHSFRfRkxBRyxpc0ZsaXA9Yml0bWFzayAmIEZMSVBfRkxBRyxDdG9yPWlzQmluZEtleT91bmRlZmluZWQ6Y3JlYXRlQ3RvcldyYXBwZXIoZnVuYyk7ZnVuY3Rpb24gd3JhcHBlcigpe3ZhciBsZW5ndGg9YXJndW1lbnRzLmxlbmd0aCxpbmRleD1sZW5ndGgsYXJncz1BcnJheShsZW5ndGgpO3doaWxlKGluZGV4LS0pIHthcmdzW2luZGV4XSA9IGFyZ3VtZW50c1tpbmRleF07fWlmKHBhcnRpYWxzKXthcmdzID0gY29tcG9zZUFyZ3MoYXJncyxwYXJ0aWFscyxob2xkZXJzKTt9aWYocGFydGlhbHNSaWdodCl7YXJncyA9IGNvbXBvc2VBcmdzUmlnaHQoYXJncyxwYXJ0aWFsc1JpZ2h0LGhvbGRlcnNSaWdodCk7fWlmKGlzQ3VycnkgfHwgaXNDdXJyeVJpZ2h0KXt2YXIgcGxhY2Vob2xkZXI9d3JhcHBlci5wbGFjZWhvbGRlcixhcmdzSG9sZGVycz1yZXBsYWNlSG9sZGVycyhhcmdzLHBsYWNlaG9sZGVyKTtsZW5ndGggLT0gYXJnc0hvbGRlcnMubGVuZ3RoO2lmKGxlbmd0aCA8IGFyaXR5KXtyZXR1cm4gY3JlYXRlUmVjdXJyeVdyYXBwZXIoZnVuYyxiaXRtYXNrLGNyZWF0ZUh5YnJpZFdyYXBwZXIscGxhY2Vob2xkZXIsdGhpc0FyZyxhcmdzLGFyZ3NIb2xkZXJzLGFyZ1BvcyxhcnksYXJpdHkgLSBsZW5ndGgpO319dmFyIHRoaXNCaW5kaW5nPWlzQmluZD90aGlzQXJnOnRoaXMsZm49aXNCaW5kS2V5P3RoaXNCaW5kaW5nW2Z1bmNdOmZ1bmM7aWYoYXJnUG9zKXthcmdzID0gcmVvcmRlcihhcmdzLGFyZ1Bvcyk7fWVsc2UgaWYoaXNGbGlwICYmIGFyZ3MubGVuZ3RoID4gMSl7YXJncy5yZXZlcnNlKCk7fWlmKGlzQXJ5ICYmIGFyeSA8IGFyZ3MubGVuZ3RoKXthcmdzLmxlbmd0aCA9IGFyeTt9aWYodGhpcyAmJiB0aGlzICE9PSByb290ICYmIHRoaXMgaW5zdGFuY2VvZiB3cmFwcGVyKXtmbiA9IEN0b3IgfHwgY3JlYXRlQ3RvcldyYXBwZXIoZm4pO31yZXR1cm4gZm4uYXBwbHkodGhpc0JpbmRpbmcsYXJncyk7fXJldHVybiB3cmFwcGVyO31mdW5jdGlvbiBjcmVhdGVJbnZlcnRlcihzZXR0ZXIsdG9JdGVyYXRlZSl7cmV0dXJuIGZ1bmN0aW9uKG9iamVjdCxpdGVyYXRlZSl7cmV0dXJuIGJhc2VJbnZlcnRlcihvYmplY3Qsc2V0dGVyLHRvSXRlcmF0ZWUoaXRlcmF0ZWUpLHt9KTt9O31mdW5jdGlvbiBjcmVhdGVPdmVyKGFycmF5RnVuYyl7cmV0dXJuIHJlc3QoZnVuY3Rpb24oaXRlcmF0ZWVzKXtpdGVyYXRlZXMgPSBhcnJheU1hcChiYXNlRmxhdHRlbihpdGVyYXRlZXMpLGdldEl0ZXJhdGVlKCkpO3JldHVybiByZXN0KGZ1bmN0aW9uKGFyZ3Mpe3ZhciB0aGlzQXJnPXRoaXM7cmV0dXJuIGFycmF5RnVuYyhpdGVyYXRlZXMsZnVuY3Rpb24oaXRlcmF0ZWUpe3JldHVybiBhcHBseShpdGVyYXRlZSx0aGlzQXJnLGFyZ3MpO30pO30pO30pO31mdW5jdGlvbiBjcmVhdGVQYWRkaW5nKHN0cmluZyxsZW5ndGgsY2hhcnMpe2xlbmd0aCA9IHRvSW50ZWdlcihsZW5ndGgpO3ZhciBzdHJMZW5ndGg9c3RyaW5nU2l6ZShzdHJpbmcpO2lmKCFsZW5ndGggfHwgc3RyTGVuZ3RoID49IGxlbmd0aCl7cmV0dXJuIFwiXCI7fXZhciBwYWRMZW5ndGg9bGVuZ3RoIC0gc3RyTGVuZ3RoO2NoYXJzID0gY2hhcnMgPT09IHVuZGVmaW5lZD9cIiBcIjpjaGFycyArIFwiXCI7dmFyIHJlc3VsdD1yZXBlYXQoY2hhcnMsbmF0aXZlQ2VpbChwYWRMZW5ndGggLyBzdHJpbmdTaXplKGNoYXJzKSkpO3JldHVybiByZUhhc0NvbXBsZXhTeW1ib2wudGVzdChjaGFycyk/c3RyaW5nVG9BcnJheShyZXN1bHQpLnNsaWNlKDAscGFkTGVuZ3RoKS5qb2luKFwiXCIpOnJlc3VsdC5zbGljZSgwLHBhZExlbmd0aCk7fWZ1bmN0aW9uIGNyZWF0ZVBhcnRpYWxXcmFwcGVyKGZ1bmMsYml0bWFzayx0aGlzQXJnLHBhcnRpYWxzKXt2YXIgaXNCaW5kPWJpdG1hc2sgJiBCSU5EX0ZMQUcsQ3Rvcj1jcmVhdGVDdG9yV3JhcHBlcihmdW5jKTtmdW5jdGlvbiB3cmFwcGVyKCl7dmFyIGFyZ3NJbmRleD0tMSxhcmdzTGVuZ3RoPWFyZ3VtZW50cy5sZW5ndGgsbGVmdEluZGV4PS0xLGxlZnRMZW5ndGg9cGFydGlhbHMubGVuZ3RoLGFyZ3M9QXJyYXkobGVmdExlbmd0aCArIGFyZ3NMZW5ndGgpLGZuPXRoaXMgJiYgdGhpcyAhPT0gcm9vdCAmJiB0aGlzIGluc3RhbmNlb2Ygd3JhcHBlcj9DdG9yOmZ1bmM7d2hpbGUoKytsZWZ0SW5kZXggPCBsZWZ0TGVuZ3RoKSB7YXJnc1tsZWZ0SW5kZXhdID0gcGFydGlhbHNbbGVmdEluZGV4XTt9d2hpbGUoYXJnc0xlbmd0aC0tKSB7YXJnc1tsZWZ0SW5kZXgrK10gPSBhcmd1bWVudHNbKythcmdzSW5kZXhdO31yZXR1cm4gYXBwbHkoZm4saXNCaW5kP3RoaXNBcmc6dGhpcyxhcmdzKTt9cmV0dXJuIHdyYXBwZXI7fWZ1bmN0aW9uIGNyZWF0ZVJhbmdlKGZyb21SaWdodCl7cmV0dXJuIGZ1bmN0aW9uKHN0YXJ0LGVuZCxzdGVwKXtpZihzdGVwICYmIHR5cGVvZiBzdGVwICE9IFwibnVtYmVyXCIgJiYgaXNJdGVyYXRlZUNhbGwoc3RhcnQsZW5kLHN0ZXApKXtlbmQgPSBzdGVwID0gdW5kZWZpbmVkO31zdGFydCA9IHRvTnVtYmVyKHN0YXJ0KTtzdGFydCA9IHN0YXJ0ID09PSBzdGFydD9zdGFydDowO2lmKGVuZCA9PT0gdW5kZWZpbmVkKXtlbmQgPSBzdGFydDtzdGFydCA9IDA7fWVsc2Uge2VuZCA9IHRvTnVtYmVyKGVuZCkgfHwgMDt9c3RlcCA9IHN0ZXAgPT09IHVuZGVmaW5lZD9zdGFydCA8IGVuZD8xOi0xOnRvTnVtYmVyKHN0ZXApIHx8IDA7cmV0dXJuIGJhc2VSYW5nZShzdGFydCxlbmQsc3RlcCxmcm9tUmlnaHQpO307fWZ1bmN0aW9uIGNyZWF0ZVJlY3VycnlXcmFwcGVyKGZ1bmMsYml0bWFzayx3cmFwRnVuYyxwbGFjZWhvbGRlcix0aGlzQXJnLHBhcnRpYWxzLGhvbGRlcnMsYXJnUG9zLGFyeSxhcml0eSl7dmFyIGlzQ3Vycnk9Yml0bWFzayAmIENVUlJZX0ZMQUcsbmV3QXJnUG9zPWFyZ1Bvcz9jb3B5QXJyYXkoYXJnUG9zKTp1bmRlZmluZWQsbmV3c0hvbGRlcnM9aXNDdXJyeT9ob2xkZXJzOnVuZGVmaW5lZCxuZXdIb2xkZXJzUmlnaHQ9aXNDdXJyeT91bmRlZmluZWQ6aG9sZGVycyxuZXdQYXJ0aWFscz1pc0N1cnJ5P3BhcnRpYWxzOnVuZGVmaW5lZCxuZXdQYXJ0aWFsc1JpZ2h0PWlzQ3Vycnk/dW5kZWZpbmVkOnBhcnRpYWxzO2JpdG1hc2sgfD0gaXNDdXJyeT9QQVJUSUFMX0ZMQUc6UEFSVElBTF9SSUdIVF9GTEFHO2JpdG1hc2sgJj0gfihpc0N1cnJ5P1BBUlRJQUxfUklHSFRfRkxBRzpQQVJUSUFMX0ZMQUcpO2lmKCEoYml0bWFzayAmIENVUlJZX0JPVU5EX0ZMQUcpKXtiaXRtYXNrICY9IH4oQklORF9GTEFHIHwgQklORF9LRVlfRkxBRyk7fXZhciBuZXdEYXRhPVtmdW5jLGJpdG1hc2ssdGhpc0FyZyxuZXdQYXJ0aWFscyxuZXdzSG9sZGVycyxuZXdQYXJ0aWFsc1JpZ2h0LG5ld0hvbGRlcnNSaWdodCxuZXdBcmdQb3MsYXJ5LGFyaXR5XSxyZXN1bHQ9d3JhcEZ1bmMuYXBwbHkodW5kZWZpbmVkLG5ld0RhdGEpO2lmKGlzTGF6aWFibGUoZnVuYykpe3NldERhdGEocmVzdWx0LG5ld0RhdGEpO31yZXN1bHQucGxhY2Vob2xkZXIgPSBwbGFjZWhvbGRlcjtyZXR1cm4gcmVzdWx0O31mdW5jdGlvbiBjcmVhdGVSb3VuZChtZXRob2ROYW1lKXt2YXIgZnVuYz1NYXRoW21ldGhvZE5hbWVdO3JldHVybiBmdW5jdGlvbihudW1iZXIscHJlY2lzaW9uKXtudW1iZXIgPSB0b051bWJlcihudW1iZXIpO3ByZWNpc2lvbiA9IHRvSW50ZWdlcihwcmVjaXNpb24pO2lmKHByZWNpc2lvbil7dmFyIHBhaXI9KHRvU3RyaW5nKG51bWJlcikgKyBcImVcIikuc3BsaXQoXCJlXCIpLHZhbHVlPWZ1bmMocGFpclswXSArIFwiZVwiICsgKCtwYWlyWzFdICsgcHJlY2lzaW9uKSk7cGFpciA9ICh0b1N0cmluZyh2YWx1ZSkgKyBcImVcIikuc3BsaXQoXCJlXCIpO3JldHVybiArKHBhaXJbMF0gKyBcImVcIiArICgrcGFpclsxXSAtIHByZWNpc2lvbikpO31yZXR1cm4gZnVuYyhudW1iZXIpO307fXZhciBjcmVhdGVTZXQ9IShTZXQgJiYgbmV3IFNldChbMSwyXSkuc2l6ZSA9PT0gMik/bm9vcDpmdW5jdGlvbih2YWx1ZXMpe3JldHVybiBuZXcgU2V0KHZhbHVlcyk7fTtmdW5jdGlvbiBjcmVhdGVXcmFwcGVyKGZ1bmMsYml0bWFzayx0aGlzQXJnLHBhcnRpYWxzLGhvbGRlcnMsYXJnUG9zLGFyeSxhcml0eSl7dmFyIGlzQmluZEtleT1iaXRtYXNrICYgQklORF9LRVlfRkxBRztpZighaXNCaW5kS2V5ICYmIHR5cGVvZiBmdW5jICE9IFwiZnVuY3Rpb25cIil7dGhyb3cgbmV3IFR5cGVFcnJvcihGVU5DX0VSUk9SX1RFWFQpO312YXIgbGVuZ3RoPXBhcnRpYWxzP3BhcnRpYWxzLmxlbmd0aDowO2lmKCFsZW5ndGgpe2JpdG1hc2sgJj0gfihQQVJUSUFMX0ZMQUcgfCBQQVJUSUFMX1JJR0hUX0ZMQUcpO3BhcnRpYWxzID0gaG9sZGVycyA9IHVuZGVmaW5lZDt9YXJ5ID0gYXJ5ID09PSB1bmRlZmluZWQ/YXJ5Om5hdGl2ZU1heCh0b0ludGVnZXIoYXJ5KSwwKTthcml0eSA9IGFyaXR5ID09PSB1bmRlZmluZWQ/YXJpdHk6dG9JbnRlZ2VyKGFyaXR5KTtsZW5ndGggLT0gaG9sZGVycz9ob2xkZXJzLmxlbmd0aDowO2lmKGJpdG1hc2sgJiBQQVJUSUFMX1JJR0hUX0ZMQUcpe3ZhciBwYXJ0aWFsc1JpZ2h0PXBhcnRpYWxzLGhvbGRlcnNSaWdodD1ob2xkZXJzO3BhcnRpYWxzID0gaG9sZGVycyA9IHVuZGVmaW5lZDt9dmFyIGRhdGE9aXNCaW5kS2V5P3VuZGVmaW5lZDpnZXREYXRhKGZ1bmMpLG5ld0RhdGE9W2Z1bmMsYml0bWFzayx0aGlzQXJnLHBhcnRpYWxzLGhvbGRlcnMscGFydGlhbHNSaWdodCxob2xkZXJzUmlnaHQsYXJnUG9zLGFyeSxhcml0eV07aWYoZGF0YSl7bWVyZ2VEYXRhKG5ld0RhdGEsZGF0YSk7fWZ1bmMgPSBuZXdEYXRhWzBdO2JpdG1hc2sgPSBuZXdEYXRhWzFdO3RoaXNBcmcgPSBuZXdEYXRhWzJdO3BhcnRpYWxzID0gbmV3RGF0YVszXTtob2xkZXJzID0gbmV3RGF0YVs0XTthcml0eSA9IG5ld0RhdGFbOV0gPSBuZXdEYXRhWzldID09IG51bGw/aXNCaW5kS2V5PzA6ZnVuYy5sZW5ndGg6bmF0aXZlTWF4KG5ld0RhdGFbOV0gLSBsZW5ndGgsMCk7aWYoIWFyaXR5ICYmIGJpdG1hc2sgJiAoQ1VSUllfRkxBRyB8IENVUlJZX1JJR0hUX0ZMQUcpKXtiaXRtYXNrICY9IH4oQ1VSUllfRkxBRyB8IENVUlJZX1JJR0hUX0ZMQUcpO31pZighYml0bWFzayB8fCBiaXRtYXNrID09IEJJTkRfRkxBRyl7dmFyIHJlc3VsdD1jcmVhdGVCYXNlV3JhcHBlcihmdW5jLGJpdG1hc2ssdGhpc0FyZyk7fWVsc2UgaWYoYml0bWFzayA9PSBDVVJSWV9GTEFHIHx8IGJpdG1hc2sgPT0gQ1VSUllfUklHSFRfRkxBRyl7cmVzdWx0ID0gY3JlYXRlQ3VycnlXcmFwcGVyKGZ1bmMsYml0bWFzayxhcml0eSk7fWVsc2UgaWYoKGJpdG1hc2sgPT0gUEFSVElBTF9GTEFHIHx8IGJpdG1hc2sgPT0gKEJJTkRfRkxBRyB8IFBBUlRJQUxfRkxBRykpICYmICFob2xkZXJzLmxlbmd0aCl7cmVzdWx0ID0gY3JlYXRlUGFydGlhbFdyYXBwZXIoZnVuYyxiaXRtYXNrLHRoaXNBcmcscGFydGlhbHMpO31lbHNlIHtyZXN1bHQgPSBjcmVhdGVIeWJyaWRXcmFwcGVyLmFwcGx5KHVuZGVmaW5lZCxuZXdEYXRhKTt9dmFyIHNldHRlcj1kYXRhP2Jhc2VTZXREYXRhOnNldERhdGE7cmV0dXJuIHNldHRlcihyZXN1bHQsbmV3RGF0YSk7fWZ1bmN0aW9uIGVxdWFsQXJyYXlzKGFycmF5LG90aGVyLGVxdWFsRnVuYyxjdXN0b21pemVyLGJpdG1hc2ssc3RhY2spe3ZhciBpbmRleD0tMSxpc1BhcnRpYWw9Yml0bWFzayAmIFBBUlRJQUxfQ09NUEFSRV9GTEFHLGlzVW5vcmRlcmVkPWJpdG1hc2sgJiBVTk9SREVSRURfQ09NUEFSRV9GTEFHLGFyckxlbmd0aD1hcnJheS5sZW5ndGgsb3RoTGVuZ3RoPW90aGVyLmxlbmd0aDtpZihhcnJMZW5ndGggIT0gb3RoTGVuZ3RoICYmICEoaXNQYXJ0aWFsICYmIG90aExlbmd0aCA+IGFyckxlbmd0aCkpe3JldHVybiBmYWxzZTt9dmFyIHN0YWNrZWQ9c3RhY2suZ2V0KGFycmF5KTtpZihzdGFja2VkKXtyZXR1cm4gc3RhY2tlZCA9PSBvdGhlcjt9dmFyIHJlc3VsdD10cnVlO3N0YWNrLnNldChhcnJheSxvdGhlcik7d2hpbGUoKytpbmRleCA8IGFyckxlbmd0aCkge3ZhciBhcnJWYWx1ZT1hcnJheVtpbmRleF0sb3RoVmFsdWU9b3RoZXJbaW5kZXhdO2lmKGN1c3RvbWl6ZXIpe3ZhciBjb21wYXJlZD1pc1BhcnRpYWw/Y3VzdG9taXplcihvdGhWYWx1ZSxhcnJWYWx1ZSxpbmRleCxvdGhlcixhcnJheSxzdGFjayk6Y3VzdG9taXplcihhcnJWYWx1ZSxvdGhWYWx1ZSxpbmRleCxhcnJheSxvdGhlcixzdGFjayk7fWlmKGNvbXBhcmVkICE9PSB1bmRlZmluZWQpe2lmKGNvbXBhcmVkKXtjb250aW51ZTt9cmVzdWx0ID0gZmFsc2U7YnJlYWs7fWlmKGlzVW5vcmRlcmVkKXtpZighYXJyYXlTb21lKG90aGVyLGZ1bmN0aW9uKG90aFZhbHVlKXtyZXR1cm4gYXJyVmFsdWUgPT09IG90aFZhbHVlIHx8IGVxdWFsRnVuYyhhcnJWYWx1ZSxvdGhWYWx1ZSxjdXN0b21pemVyLGJpdG1hc2ssc3RhY2spO30pKXtyZXN1bHQgPSBmYWxzZTticmVhazt9fWVsc2UgaWYoIShhcnJWYWx1ZSA9PT0gb3RoVmFsdWUgfHwgZXF1YWxGdW5jKGFyclZhbHVlLG90aFZhbHVlLGN1c3RvbWl6ZXIsYml0bWFzayxzdGFjaykpKXtyZXN1bHQgPSBmYWxzZTticmVhazt9fXN0YWNrW1wiZGVsZXRlXCJdKGFycmF5KTtyZXR1cm4gcmVzdWx0O31mdW5jdGlvbiBlcXVhbEJ5VGFnKG9iamVjdCxvdGhlcix0YWcsZXF1YWxGdW5jLGN1c3RvbWl6ZXIsYml0bWFzayl7c3dpdGNoKHRhZyl7Y2FzZSBhcnJheUJ1ZmZlclRhZzppZihvYmplY3QuYnl0ZUxlbmd0aCAhPSBvdGhlci5ieXRlTGVuZ3RoIHx8ICFlcXVhbEZ1bmMobmV3IFVpbnQ4QXJyYXkob2JqZWN0KSxuZXcgVWludDhBcnJheShvdGhlcikpKXtyZXR1cm4gZmFsc2U7fXJldHVybiB0cnVlO2Nhc2UgYm9vbFRhZzpjYXNlIGRhdGVUYWc6cmV0dXJuICtvYmplY3QgPT0gK290aGVyO2Nhc2UgZXJyb3JUYWc6cmV0dXJuIG9iamVjdC5uYW1lID09IG90aGVyLm5hbWUgJiYgb2JqZWN0Lm1lc3NhZ2UgPT0gb3RoZXIubWVzc2FnZTtjYXNlIG51bWJlclRhZzpyZXR1cm4gb2JqZWN0ICE9ICtvYmplY3Q/b3RoZXIgIT0gK290aGVyOm9iamVjdCA9PSArb3RoZXI7Y2FzZSByZWdleHBUYWc6Y2FzZSBzdHJpbmdUYWc6cmV0dXJuIG9iamVjdCA9PSBvdGhlciArIFwiXCI7Y2FzZSBtYXBUYWc6dmFyIGNvbnZlcnQ9bWFwVG9BcnJheTtjYXNlIHNldFRhZzp2YXIgaXNQYXJ0aWFsPWJpdG1hc2sgJiBQQVJUSUFMX0NPTVBBUkVfRkxBRztjb252ZXJ0IHx8IChjb252ZXJ0ID0gc2V0VG9BcnJheSk7cmV0dXJuIChpc1BhcnRpYWwgfHwgb2JqZWN0LnNpemUgPT0gb3RoZXIuc2l6ZSkgJiYgZXF1YWxGdW5jKGNvbnZlcnQob2JqZWN0KSxjb252ZXJ0KG90aGVyKSxjdXN0b21pemVyLGJpdG1hc2sgfCBVTk9SREVSRURfQ09NUEFSRV9GTEFHKTtjYXNlIHN5bWJvbFRhZzpyZXR1cm4gISFTeW1ib2wgJiYgc3ltYm9sVmFsdWVPZi5jYWxsKG9iamVjdCkgPT0gc3ltYm9sVmFsdWVPZi5jYWxsKG90aGVyKTt9cmV0dXJuIGZhbHNlO31mdW5jdGlvbiBlcXVhbE9iamVjdHMob2JqZWN0LG90aGVyLGVxdWFsRnVuYyxjdXN0b21pemVyLGJpdG1hc2ssc3RhY2spe3ZhciBpc1BhcnRpYWw9Yml0bWFzayAmIFBBUlRJQUxfQ09NUEFSRV9GTEFHLG9ialByb3BzPWtleXMob2JqZWN0KSxvYmpMZW5ndGg9b2JqUHJvcHMubGVuZ3RoLG90aFByb3BzPWtleXMob3RoZXIpLG90aExlbmd0aD1vdGhQcm9wcy5sZW5ndGg7aWYob2JqTGVuZ3RoICE9IG90aExlbmd0aCAmJiAhaXNQYXJ0aWFsKXtyZXR1cm4gZmFsc2U7fXZhciBpbmRleD1vYmpMZW5ndGg7d2hpbGUoaW5kZXgtLSkge3ZhciBrZXk9b2JqUHJvcHNbaW5kZXhdO2lmKCEoaXNQYXJ0aWFsP2tleSBpbiBvdGhlcjpiYXNlSGFzKG90aGVyLGtleSkpKXtyZXR1cm4gZmFsc2U7fX12YXIgc3RhY2tlZD1zdGFjay5nZXQob2JqZWN0KTtpZihzdGFja2VkKXtyZXR1cm4gc3RhY2tlZCA9PSBvdGhlcjt9dmFyIHJlc3VsdD10cnVlO3N0YWNrLnNldChvYmplY3Qsb3RoZXIpO3ZhciBza2lwQ3Rvcj1pc1BhcnRpYWw7d2hpbGUoKytpbmRleCA8IG9iakxlbmd0aCkge2tleSA9IG9ialByb3BzW2luZGV4XTt2YXIgb2JqVmFsdWU9b2JqZWN0W2tleV0sb3RoVmFsdWU9b3RoZXJba2V5XTtpZihjdXN0b21pemVyKXt2YXIgY29tcGFyZWQ9aXNQYXJ0aWFsP2N1c3RvbWl6ZXIob3RoVmFsdWUsb2JqVmFsdWUsa2V5LG90aGVyLG9iamVjdCxzdGFjayk6Y3VzdG9taXplcihvYmpWYWx1ZSxvdGhWYWx1ZSxrZXksb2JqZWN0LG90aGVyLHN0YWNrKTt9aWYoIShjb21wYXJlZCA9PT0gdW5kZWZpbmVkP29ialZhbHVlID09PSBvdGhWYWx1ZSB8fCBlcXVhbEZ1bmMob2JqVmFsdWUsb3RoVmFsdWUsY3VzdG9taXplcixiaXRtYXNrLHN0YWNrKTpjb21wYXJlZCkpe3Jlc3VsdCA9IGZhbHNlO2JyZWFrO31za2lwQ3RvciB8fCAoc2tpcEN0b3IgPSBrZXkgPT0gXCJjb25zdHJ1Y3RvclwiKTt9aWYocmVzdWx0ICYmICFza2lwQ3Rvcil7dmFyIG9iakN0b3I9b2JqZWN0LmNvbnN0cnVjdG9yLG90aEN0b3I9b3RoZXIuY29uc3RydWN0b3I7aWYob2JqQ3RvciAhPSBvdGhDdG9yICYmIFwiY29uc3RydWN0b3JcIiBpbiBvYmplY3QgJiYgXCJjb25zdHJ1Y3RvclwiIGluIG90aGVyICYmICEodHlwZW9mIG9iakN0b3IgPT0gXCJmdW5jdGlvblwiICYmIG9iakN0b3IgaW5zdGFuY2VvZiBvYmpDdG9yICYmIHR5cGVvZiBvdGhDdG9yID09IFwiZnVuY3Rpb25cIiAmJiBvdGhDdG9yIGluc3RhbmNlb2Ygb3RoQ3Rvcikpe3Jlc3VsdCA9IGZhbHNlO319c3RhY2tbXCJkZWxldGVcIl0ob2JqZWN0KTtyZXR1cm4gcmVzdWx0O312YXIgZ2V0RGF0YT0hbWV0YU1hcD9ub29wOmZ1bmN0aW9uKGZ1bmMpe3JldHVybiBtZXRhTWFwLmdldChmdW5jKTt9O2Z1bmN0aW9uIGdldEZ1bmNOYW1lKGZ1bmMpe3ZhciByZXN1bHQ9ZnVuYy5uYW1lICsgXCJcIixhcnJheT1yZWFsTmFtZXNbcmVzdWx0XSxsZW5ndGg9aGFzT3duUHJvcGVydHkuY2FsbChyZWFsTmFtZXMscmVzdWx0KT9hcnJheS5sZW5ndGg6MDt3aGlsZShsZW5ndGgtLSkge3ZhciBkYXRhPWFycmF5W2xlbmd0aF0sb3RoZXJGdW5jPWRhdGEuZnVuYztpZihvdGhlckZ1bmMgPT0gbnVsbCB8fCBvdGhlckZ1bmMgPT0gZnVuYyl7cmV0dXJuIGRhdGEubmFtZTt9fXJldHVybiByZXN1bHQ7fWZ1bmN0aW9uIGdldEl0ZXJhdGVlKCl7dmFyIHJlc3VsdD1sb2Rhc2guaXRlcmF0ZWUgfHwgaXRlcmF0ZWU7cmVzdWx0ID0gcmVzdWx0ID09PSBpdGVyYXRlZT9iYXNlSXRlcmF0ZWU6cmVzdWx0O3JldHVybiBhcmd1bWVudHMubGVuZ3RoP3Jlc3VsdChhcmd1bWVudHNbMF0sYXJndW1lbnRzWzFdKTpyZXN1bHQ7fXZhciBnZXRMZW5ndGg9YmFzZVByb3BlcnR5KFwibGVuZ3RoXCIpO2Z1bmN0aW9uIGdldE1hdGNoRGF0YShvYmplY3Qpe3ZhciByZXN1bHQ9dG9QYWlycyhvYmplY3QpLGxlbmd0aD1yZXN1bHQubGVuZ3RoO3doaWxlKGxlbmd0aC0tKSB7cmVzdWx0W2xlbmd0aF1bMl0gPSBpc1N0cmljdENvbXBhcmFibGUocmVzdWx0W2xlbmd0aF1bMV0pO31yZXR1cm4gcmVzdWx0O31mdW5jdGlvbiBnZXROYXRpdmUob2JqZWN0LGtleSl7dmFyIHZhbHVlPW9iamVjdCA9PSBudWxsP3VuZGVmaW5lZDpvYmplY3Rba2V5XTtyZXR1cm4gaXNOYXRpdmUodmFsdWUpP3ZhbHVlOnVuZGVmaW5lZDt9dmFyIGdldFN5bWJvbHM9Z2V0T3duUHJvcGVydHlTeW1ib2xzIHx8IGZ1bmN0aW9uKCl7cmV0dXJuIFtdO307ZnVuY3Rpb24gZ2V0VGFnKHZhbHVlKXtyZXR1cm4gb2JqZWN0VG9TdHJpbmcuY2FsbCh2YWx1ZSk7fWlmKE1hcCAmJiBnZXRUYWcobmV3IE1hcCgpKSAhPSBtYXBUYWcgfHwgU2V0ICYmIGdldFRhZyhuZXcgU2V0KCkpICE9IHNldFRhZyl7Z2V0VGFnID0gZnVuY3Rpb24odmFsdWUpe3ZhciByZXN1bHQ9b2JqZWN0VG9TdHJpbmcuY2FsbCh2YWx1ZSksQ3Rvcj1yZXN1bHQgPT0gb2JqZWN0VGFnP3ZhbHVlLmNvbnN0cnVjdG9yOm51bGwsY3RvclN0cmluZz10eXBlb2YgQ3RvciA9PSBcImZ1bmN0aW9uXCI/ZnVuY1RvU3RyaW5nLmNhbGwoQ3Rvcik6XCJcIjtpZihjdG9yU3RyaW5nKXtpZihjdG9yU3RyaW5nID09IG1hcEN0b3JTdHJpbmcpe3JldHVybiBtYXBUYWc7fWlmKGN0b3JTdHJpbmcgPT0gc2V0Q3RvclN0cmluZyl7cmV0dXJuIHNldFRhZzt9fXJldHVybiByZXN1bHQ7fTt9ZnVuY3Rpb24gZ2V0VmlldyhzdGFydCxlbmQsdHJhbnNmb3Jtcyl7dmFyIGluZGV4PS0xLGxlbmd0aD10cmFuc2Zvcm1zLmxlbmd0aDt3aGlsZSgrK2luZGV4IDwgbGVuZ3RoKSB7dmFyIGRhdGE9dHJhbnNmb3Jtc1tpbmRleF0sc2l6ZT1kYXRhLnNpemU7c3dpdGNoKGRhdGEudHlwZSl7Y2FzZSBcImRyb3BcIjpzdGFydCArPSBzaXplO2JyZWFrO2Nhc2UgXCJkcm9wUmlnaHRcIjplbmQgLT0gc2l6ZTticmVhaztjYXNlIFwidGFrZVwiOmVuZCA9IG5hdGl2ZU1pbihlbmQsc3RhcnQgKyBzaXplKTticmVhaztjYXNlIFwidGFrZVJpZ2h0XCI6c3RhcnQgPSBuYXRpdmVNYXgoc3RhcnQsZW5kIC0gc2l6ZSk7YnJlYWs7fX1yZXR1cm4ge3N0YXJ0OnN0YXJ0LGVuZDplbmR9O31mdW5jdGlvbiBoYXNQYXRoKG9iamVjdCxwYXRoLGhhc0Z1bmMpe2lmKG9iamVjdCA9PSBudWxsKXtyZXR1cm4gZmFsc2U7fXZhciByZXN1bHQ9aGFzRnVuYyhvYmplY3QscGF0aCk7aWYoIXJlc3VsdCAmJiAhaXNLZXkocGF0aCkpe3BhdGggPSBiYXNlVG9QYXRoKHBhdGgpO29iamVjdCA9IHBhcmVudChvYmplY3QscGF0aCk7aWYob2JqZWN0ICE9IG51bGwpe3BhdGggPSBsYXN0KHBhdGgpO3Jlc3VsdCA9IGhhc0Z1bmMob2JqZWN0LHBhdGgpO319dmFyIGxlbmd0aD1vYmplY3Q/b2JqZWN0Lmxlbmd0aDp1bmRlZmluZWQ7cmV0dXJuIHJlc3VsdCB8fCAhIWxlbmd0aCAmJiBpc0xlbmd0aChsZW5ndGgpICYmIGlzSW5kZXgocGF0aCxsZW5ndGgpICYmIChpc0FycmF5KG9iamVjdCkgfHwgaXNTdHJpbmcob2JqZWN0KSB8fCBpc0FyZ3VtZW50cyhvYmplY3QpKTt9ZnVuY3Rpb24gaW5pdENsb25lQXJyYXkoYXJyYXkpe3ZhciBsZW5ndGg9YXJyYXkubGVuZ3RoLHJlc3VsdD1hcnJheS5jb25zdHJ1Y3RvcihsZW5ndGgpO2lmKGxlbmd0aCAmJiB0eXBlb2YgYXJyYXlbMF0gPT0gXCJzdHJpbmdcIiAmJiBoYXNPd25Qcm9wZXJ0eS5jYWxsKGFycmF5LFwiaW5kZXhcIikpe3Jlc3VsdC5pbmRleCA9IGFycmF5LmluZGV4O3Jlc3VsdC5pbnB1dCA9IGFycmF5LmlucHV0O31yZXR1cm4gcmVzdWx0O31mdW5jdGlvbiBpbml0Q2xvbmVPYmplY3Qob2JqZWN0KXtpZihpc1Byb3RvdHlwZShvYmplY3QpKXtyZXR1cm4ge307fXZhciBDdG9yPW9iamVjdC5jb25zdHJ1Y3RvcjtyZXR1cm4gYmFzZUNyZWF0ZShpc0Z1bmN0aW9uKEN0b3IpP0N0b3IucHJvdG90eXBlOnVuZGVmaW5lZCk7fWZ1bmN0aW9uIGluaXRDbG9uZUJ5VGFnKG9iamVjdCx0YWcsaXNEZWVwKXt2YXIgQ3Rvcj1vYmplY3QuY29uc3RydWN0b3I7c3dpdGNoKHRhZyl7Y2FzZSBhcnJheUJ1ZmZlclRhZzpyZXR1cm4gY2xvbmVCdWZmZXIob2JqZWN0KTtjYXNlIGJvb2xUYWc6Y2FzZSBkYXRlVGFnOnJldHVybiBuZXcgQ3Rvcigrb2JqZWN0KTtjYXNlIGZsb2F0MzJUYWc6Y2FzZSBmbG9hdDY0VGFnOmNhc2UgaW50OFRhZzpjYXNlIGludDE2VGFnOmNhc2UgaW50MzJUYWc6Y2FzZSB1aW50OFRhZzpjYXNlIHVpbnQ4Q2xhbXBlZFRhZzpjYXNlIHVpbnQxNlRhZzpjYXNlIHVpbnQzMlRhZzpyZXR1cm4gY2xvbmVUeXBlZEFycmF5KG9iamVjdCxpc0RlZXApO2Nhc2UgbWFwVGFnOnJldHVybiBjbG9uZU1hcChvYmplY3QpO2Nhc2UgbnVtYmVyVGFnOmNhc2Ugc3RyaW5nVGFnOnJldHVybiBuZXcgQ3RvcihvYmplY3QpO2Nhc2UgcmVnZXhwVGFnOnJldHVybiBjbG9uZVJlZ0V4cChvYmplY3QpO2Nhc2Ugc2V0VGFnOnJldHVybiBjbG9uZVNldChvYmplY3QpO2Nhc2Ugc3ltYm9sVGFnOnJldHVybiBjbG9uZVN5bWJvbChvYmplY3QpO319ZnVuY3Rpb24gaW5kZXhLZXlzKG9iamVjdCl7dmFyIGxlbmd0aD1vYmplY3Q/b2JqZWN0Lmxlbmd0aDp1bmRlZmluZWQ7aWYoaXNMZW5ndGgobGVuZ3RoKSAmJiAoaXNBcnJheShvYmplY3QpIHx8IGlzU3RyaW5nKG9iamVjdCkgfHwgaXNBcmd1bWVudHMob2JqZWN0KSkpe3JldHVybiBiYXNlVGltZXMobGVuZ3RoLFN0cmluZyk7fXJldHVybiBudWxsO31mdW5jdGlvbiBpc0l0ZXJhdGVlQ2FsbCh2YWx1ZSxpbmRleCxvYmplY3Qpe2lmKCFpc09iamVjdChvYmplY3QpKXtyZXR1cm4gZmFsc2U7fXZhciB0eXBlPXR5cGVvZiBpbmRleDtpZih0eXBlID09IFwibnVtYmVyXCI/aXNBcnJheUxpa2Uob2JqZWN0KSAmJiBpc0luZGV4KGluZGV4LG9iamVjdC5sZW5ndGgpOnR5cGUgPT0gXCJzdHJpbmdcIiAmJiBpbmRleCBpbiBvYmplY3Qpe3JldHVybiBlcShvYmplY3RbaW5kZXhdLHZhbHVlKTt9cmV0dXJuIGZhbHNlO31mdW5jdGlvbiBpc0tleSh2YWx1ZSxvYmplY3Qpe2lmKHR5cGVvZiB2YWx1ZSA9PSBcIm51bWJlclwiKXtyZXR1cm4gdHJ1ZTt9cmV0dXJuICFpc0FycmF5KHZhbHVlKSAmJiAocmVJc1BsYWluUHJvcC50ZXN0KHZhbHVlKSB8fCAhcmVJc0RlZXBQcm9wLnRlc3QodmFsdWUpIHx8IG9iamVjdCAhPSBudWxsICYmIHZhbHVlIGluIE9iamVjdChvYmplY3QpKTt9ZnVuY3Rpb24gaXNLZXlhYmxlKHZhbHVlKXt2YXIgdHlwZT10eXBlb2YgdmFsdWU7cmV0dXJuIHR5cGUgPT0gXCJudW1iZXJcIiB8fCB0eXBlID09IFwiYm9vbGVhblwiIHx8IHR5cGUgPT0gXCJzdHJpbmdcIiAmJiB2YWx1ZSAhPT0gXCJfX3Byb3RvX19cIiB8fCB2YWx1ZSA9PSBudWxsO31mdW5jdGlvbiBpc0xhemlhYmxlKGZ1bmMpe3ZhciBmdW5jTmFtZT1nZXRGdW5jTmFtZShmdW5jKSxvdGhlcj1sb2Rhc2hbZnVuY05hbWVdO2lmKHR5cGVvZiBvdGhlciAhPSBcImZ1bmN0aW9uXCIgfHwgIShmdW5jTmFtZSBpbiBMYXp5V3JhcHBlci5wcm90b3R5cGUpKXtyZXR1cm4gZmFsc2U7fWlmKGZ1bmMgPT09IG90aGVyKXtyZXR1cm4gdHJ1ZTt9dmFyIGRhdGE9Z2V0RGF0YShvdGhlcik7cmV0dXJuICEhZGF0YSAmJiBmdW5jID09PSBkYXRhWzBdO31mdW5jdGlvbiBpc1Byb3RvdHlwZSh2YWx1ZSl7dmFyIEN0b3I9dmFsdWUgJiYgdmFsdWUuY29uc3RydWN0b3IscHJvdG89dHlwZW9mIEN0b3IgPT0gXCJmdW5jdGlvblwiICYmIEN0b3IucHJvdG90eXBlIHx8IG9iamVjdFByb3RvO3JldHVybiB2YWx1ZSA9PT0gcHJvdG87fWZ1bmN0aW9uIGlzU3RyaWN0Q29tcGFyYWJsZSh2YWx1ZSl7cmV0dXJuIHZhbHVlID09PSB2YWx1ZSAmJiAhaXNPYmplY3QodmFsdWUpO31mdW5jdGlvbiBtZXJnZURhdGEoZGF0YSxzb3VyY2Upe3ZhciBiaXRtYXNrPWRhdGFbMV0sc3JjQml0bWFzaz1zb3VyY2VbMV0sbmV3Qml0bWFzaz1iaXRtYXNrIHwgc3JjQml0bWFzayxpc0NvbW1vbj1uZXdCaXRtYXNrIDwgKEJJTkRfRkxBRyB8IEJJTkRfS0VZX0ZMQUcgfCBBUllfRkxBRyk7dmFyIGlzQ29tYm89c3JjQml0bWFzayA9PSBBUllfRkxBRyAmJiBiaXRtYXNrID09IENVUlJZX0ZMQUcgfHwgc3JjQml0bWFzayA9PSBBUllfRkxBRyAmJiBiaXRtYXNrID09IFJFQVJHX0ZMQUcgJiYgZGF0YVs3XS5sZW5ndGggPD0gc291cmNlWzhdIHx8IHNyY0JpdG1hc2sgPT0gKEFSWV9GTEFHIHwgUkVBUkdfRkxBRykgJiYgc291cmNlWzddLmxlbmd0aCA8PSBzb3VyY2VbOF0gJiYgYml0bWFzayA9PSBDVVJSWV9GTEFHO2lmKCEoaXNDb21tb24gfHwgaXNDb21ibykpe3JldHVybiBkYXRhO31pZihzcmNCaXRtYXNrICYgQklORF9GTEFHKXtkYXRhWzJdID0gc291cmNlWzJdO25ld0JpdG1hc2sgfD0gYml0bWFzayAmIEJJTkRfRkxBRz8wOkNVUlJZX0JPVU5EX0ZMQUc7fXZhciB2YWx1ZT1zb3VyY2VbM107aWYodmFsdWUpe3ZhciBwYXJ0aWFscz1kYXRhWzNdO2RhdGFbM10gPSBwYXJ0aWFscz9jb21wb3NlQXJncyhwYXJ0aWFscyx2YWx1ZSxzb3VyY2VbNF0pOmNvcHlBcnJheSh2YWx1ZSk7ZGF0YVs0XSA9IHBhcnRpYWxzP3JlcGxhY2VIb2xkZXJzKGRhdGFbM10sUExBQ0VIT0xERVIpOmNvcHlBcnJheShzb3VyY2VbNF0pO312YWx1ZSA9IHNvdXJjZVs1XTtpZih2YWx1ZSl7cGFydGlhbHMgPSBkYXRhWzVdO2RhdGFbNV0gPSBwYXJ0aWFscz9jb21wb3NlQXJnc1JpZ2h0KHBhcnRpYWxzLHZhbHVlLHNvdXJjZVs2XSk6Y29weUFycmF5KHZhbHVlKTtkYXRhWzZdID0gcGFydGlhbHM/cmVwbGFjZUhvbGRlcnMoZGF0YVs1XSxQTEFDRUhPTERFUik6Y29weUFycmF5KHNvdXJjZVs2XSk7fXZhbHVlID0gc291cmNlWzddO2lmKHZhbHVlKXtkYXRhWzddID0gY29weUFycmF5KHZhbHVlKTt9aWYoc3JjQml0bWFzayAmIEFSWV9GTEFHKXtkYXRhWzhdID0gZGF0YVs4XSA9PSBudWxsP3NvdXJjZVs4XTpuYXRpdmVNaW4oZGF0YVs4XSxzb3VyY2VbOF0pO31pZihkYXRhWzldID09IG51bGwpe2RhdGFbOV0gPSBzb3VyY2VbOV07fWRhdGFbMF0gPSBzb3VyY2VbMF07ZGF0YVsxXSA9IG5ld0JpdG1hc2s7cmV0dXJuIGRhdGE7fWZ1bmN0aW9uIG1lcmdlRGVmYXVsdHMob2JqVmFsdWUsc3JjVmFsdWUsa2V5LG9iamVjdCxzb3VyY2Usc3RhY2spe2lmKGlzT2JqZWN0KG9ialZhbHVlKSAmJiBpc09iamVjdChzcmNWYWx1ZSkpe3N0YWNrLnNldChzcmNWYWx1ZSxvYmpWYWx1ZSk7YmFzZU1lcmdlKG9ialZhbHVlLHNyY1ZhbHVlLHVuZGVmaW5lZCxtZXJnZURlZmF1bHRzLHN0YWNrKTt9cmV0dXJuIG9ialZhbHVlO31mdW5jdGlvbiBwYXJlbnQob2JqZWN0LHBhdGgpe3JldHVybiBwYXRoLmxlbmd0aCA9PSAxP29iamVjdDpnZXQob2JqZWN0LGJhc2VTbGljZShwYXRoLDAsLTEpKTt9ZnVuY3Rpb24gcmVvcmRlcihhcnJheSxpbmRleGVzKXt2YXIgYXJyTGVuZ3RoPWFycmF5Lmxlbmd0aCxsZW5ndGg9bmF0aXZlTWluKGluZGV4ZXMubGVuZ3RoLGFyckxlbmd0aCksb2xkQXJyYXk9Y29weUFycmF5KGFycmF5KTt3aGlsZShsZW5ndGgtLSkge3ZhciBpbmRleD1pbmRleGVzW2xlbmd0aF07YXJyYXlbbGVuZ3RoXSA9IGlzSW5kZXgoaW5kZXgsYXJyTGVuZ3RoKT9vbGRBcnJheVtpbmRleF06dW5kZWZpbmVkO31yZXR1cm4gYXJyYXk7fXZhciBzZXREYXRhPShmdW5jdGlvbigpe3ZhciBjb3VudD0wLGxhc3RDYWxsZWQ9MDtyZXR1cm4gZnVuY3Rpb24oa2V5LHZhbHVlKXt2YXIgc3RhbXA9bm93KCkscmVtYWluaW5nPUhPVF9TUEFOIC0gKHN0YW1wIC0gbGFzdENhbGxlZCk7bGFzdENhbGxlZCA9IHN0YW1wO2lmKHJlbWFpbmluZyA+IDApe2lmKCsrY291bnQgPj0gSE9UX0NPVU5UKXtyZXR1cm4ga2V5O319ZWxzZSB7Y291bnQgPSAwO31yZXR1cm4gYmFzZVNldERhdGEoa2V5LHZhbHVlKTt9O30pKCk7ZnVuY3Rpb24gc3RyaW5nVG9QYXRoKHN0cmluZyl7dmFyIHJlc3VsdD1bXTt0b1N0cmluZyhzdHJpbmcpLnJlcGxhY2UocmVQcm9wTmFtZSxmdW5jdGlvbihtYXRjaCxudW1iZXIscXVvdGUsc3RyaW5nKXtyZXN1bHQucHVzaChxdW90ZT9zdHJpbmcucmVwbGFjZShyZUVzY2FwZUNoYXIsXCIkMVwiKTpudW1iZXIgfHwgbWF0Y2gpO30pO3JldHVybiByZXN1bHQ7fWZ1bmN0aW9uIHRvQXJyYXlMaWtlT2JqZWN0KHZhbHVlKXtyZXR1cm4gaXNBcnJheUxpa2VPYmplY3QodmFsdWUpP3ZhbHVlOltdO31mdW5jdGlvbiB0b0Z1bmN0aW9uKHZhbHVlKXtyZXR1cm4gdHlwZW9mIHZhbHVlID09IFwiZnVuY3Rpb25cIj92YWx1ZTppZGVudGl0eTt9ZnVuY3Rpb24gd3JhcHBlckNsb25lKHdyYXBwZXIpe2lmKHdyYXBwZXIgaW5zdGFuY2VvZiBMYXp5V3JhcHBlcil7cmV0dXJuIHdyYXBwZXIuY2xvbmUoKTt9dmFyIHJlc3VsdD1uZXcgTG9kYXNoV3JhcHBlcih3cmFwcGVyLl9fd3JhcHBlZF9fLHdyYXBwZXIuX19jaGFpbl9fKTtyZXN1bHQuX19hY3Rpb25zX18gPSBjb3B5QXJyYXkod3JhcHBlci5fX2FjdGlvbnNfXyk7cmVzdWx0Ll9faW5kZXhfXyA9IHdyYXBwZXIuX19pbmRleF9fO3Jlc3VsdC5fX3ZhbHVlc19fID0gd3JhcHBlci5fX3ZhbHVlc19fO3JldHVybiByZXN1bHQ7fWZ1bmN0aW9uIGNodW5rKGFycmF5LHNpemUpe3NpemUgPSBuYXRpdmVNYXgodG9JbnRlZ2VyKHNpemUpLDApO3ZhciBsZW5ndGg9YXJyYXk/YXJyYXkubGVuZ3RoOjA7aWYoIWxlbmd0aCB8fCBzaXplIDwgMSl7cmV0dXJuIFtdO312YXIgaW5kZXg9MCxyZXNJbmRleD0tMSxyZXN1bHQ9QXJyYXkobmF0aXZlQ2VpbChsZW5ndGggLyBzaXplKSk7d2hpbGUoaW5kZXggPCBsZW5ndGgpIHtyZXN1bHRbKytyZXNJbmRleF0gPSBiYXNlU2xpY2UoYXJyYXksaW5kZXgsaW5kZXggKz0gc2l6ZSk7fXJldHVybiByZXN1bHQ7fWZ1bmN0aW9uIGNvbXBhY3QoYXJyYXkpe3ZhciBpbmRleD0tMSxsZW5ndGg9YXJyYXk/YXJyYXkubGVuZ3RoOjAscmVzSW5kZXg9LTEscmVzdWx0PVtdO3doaWxlKCsraW5kZXggPCBsZW5ndGgpIHt2YXIgdmFsdWU9YXJyYXlbaW5kZXhdO2lmKHZhbHVlKXtyZXN1bHRbKytyZXNJbmRleF0gPSB2YWx1ZTt9fXJldHVybiByZXN1bHQ7fXZhciBjb25jYXQ9cmVzdChmdW5jdGlvbihhcnJheSx2YWx1ZXMpe2lmKCFpc0FycmF5KGFycmF5KSl7YXJyYXkgPSBhcnJheSA9PSBudWxsP1tdOltPYmplY3QoYXJyYXkpXTt9dmFsdWVzID0gYmFzZUZsYXR0ZW4odmFsdWVzKTtyZXR1cm4gYXJyYXlDb25jYXQoYXJyYXksdmFsdWVzKTt9KTt2YXIgZGlmZmVyZW5jZT1yZXN0KGZ1bmN0aW9uKGFycmF5LHZhbHVlcyl7cmV0dXJuIGlzQXJyYXlMaWtlT2JqZWN0KGFycmF5KT9iYXNlRGlmZmVyZW5jZShhcnJheSxiYXNlRmxhdHRlbih2YWx1ZXMsZmFsc2UsdHJ1ZSkpOltdO30pO3ZhciBkaWZmZXJlbmNlQnk9cmVzdChmdW5jdGlvbihhcnJheSx2YWx1ZXMpe3ZhciBpdGVyYXRlZT1sYXN0KHZhbHVlcyk7aWYoaXNBcnJheUxpa2VPYmplY3QoaXRlcmF0ZWUpKXtpdGVyYXRlZSA9IHVuZGVmaW5lZDt9cmV0dXJuIGlzQXJyYXlMaWtlT2JqZWN0KGFycmF5KT9iYXNlRGlmZmVyZW5jZShhcnJheSxiYXNlRmxhdHRlbih2YWx1ZXMsZmFsc2UsdHJ1ZSksZ2V0SXRlcmF0ZWUoaXRlcmF0ZWUpKTpbXTt9KTt2YXIgZGlmZmVyZW5jZVdpdGg9cmVzdChmdW5jdGlvbihhcnJheSx2YWx1ZXMpe3ZhciBjb21wYXJhdG9yPWxhc3QodmFsdWVzKTtpZihpc0FycmF5TGlrZU9iamVjdChjb21wYXJhdG9yKSl7Y29tcGFyYXRvciA9IHVuZGVmaW5lZDt9cmV0dXJuIGlzQXJyYXlMaWtlT2JqZWN0KGFycmF5KT9iYXNlRGlmZmVyZW5jZShhcnJheSxiYXNlRmxhdHRlbih2YWx1ZXMsZmFsc2UsdHJ1ZSksdW5kZWZpbmVkLGNvbXBhcmF0b3IpOltdO30pO2Z1bmN0aW9uIGRyb3AoYXJyYXksbixndWFyZCl7dmFyIGxlbmd0aD1hcnJheT9hcnJheS5sZW5ndGg6MDtpZighbGVuZ3RoKXtyZXR1cm4gW107fW4gPSBndWFyZCB8fCBuID09PSB1bmRlZmluZWQ/MTp0b0ludGVnZXIobik7cmV0dXJuIGJhc2VTbGljZShhcnJheSxuIDwgMD8wOm4sbGVuZ3RoKTt9ZnVuY3Rpb24gZHJvcFJpZ2h0KGFycmF5LG4sZ3VhcmQpe3ZhciBsZW5ndGg9YXJyYXk/YXJyYXkubGVuZ3RoOjA7aWYoIWxlbmd0aCl7cmV0dXJuIFtdO31uID0gZ3VhcmQgfHwgbiA9PT0gdW5kZWZpbmVkPzE6dG9JbnRlZ2VyKG4pO24gPSBsZW5ndGggLSBuO3JldHVybiBiYXNlU2xpY2UoYXJyYXksMCxuIDwgMD8wOm4pO31mdW5jdGlvbiBkcm9wUmlnaHRXaGlsZShhcnJheSxwcmVkaWNhdGUpe3JldHVybiBhcnJheSAmJiBhcnJheS5sZW5ndGg/YmFzZVdoaWxlKGFycmF5LGdldEl0ZXJhdGVlKHByZWRpY2F0ZSwzKSx0cnVlLHRydWUpOltdO31mdW5jdGlvbiBkcm9wV2hpbGUoYXJyYXkscHJlZGljYXRlKXtyZXR1cm4gYXJyYXkgJiYgYXJyYXkubGVuZ3RoP2Jhc2VXaGlsZShhcnJheSxnZXRJdGVyYXRlZShwcmVkaWNhdGUsMyksdHJ1ZSk6W107fWZ1bmN0aW9uIGZpbGwoYXJyYXksdmFsdWUsc3RhcnQsZW5kKXt2YXIgbGVuZ3RoPWFycmF5P2FycmF5Lmxlbmd0aDowO2lmKCFsZW5ndGgpe3JldHVybiBbXTt9aWYoc3RhcnQgJiYgdHlwZW9mIHN0YXJ0ICE9IFwibnVtYmVyXCIgJiYgaXNJdGVyYXRlZUNhbGwoYXJyYXksdmFsdWUsc3RhcnQpKXtzdGFydCA9IDA7ZW5kID0gbGVuZ3RoO31yZXR1cm4gYmFzZUZpbGwoYXJyYXksdmFsdWUsc3RhcnQsZW5kKTt9ZnVuY3Rpb24gZmluZEluZGV4KGFycmF5LHByZWRpY2F0ZSl7cmV0dXJuIGFycmF5ICYmIGFycmF5Lmxlbmd0aD9iYXNlRmluZEluZGV4KGFycmF5LGdldEl0ZXJhdGVlKHByZWRpY2F0ZSwzKSk6LTE7fWZ1bmN0aW9uIGZpbmRMYXN0SW5kZXgoYXJyYXkscHJlZGljYXRlKXtyZXR1cm4gYXJyYXkgJiYgYXJyYXkubGVuZ3RoP2Jhc2VGaW5kSW5kZXgoYXJyYXksZ2V0SXRlcmF0ZWUocHJlZGljYXRlLDMpLHRydWUpOi0xO31mdW5jdGlvbiBmbGF0dGVuKGFycmF5KXt2YXIgbGVuZ3RoPWFycmF5P2FycmF5Lmxlbmd0aDowO3JldHVybiBsZW5ndGg/YmFzZUZsYXR0ZW4oYXJyYXkpOltdO31mdW5jdGlvbiBmbGF0dGVuRGVlcChhcnJheSl7dmFyIGxlbmd0aD1hcnJheT9hcnJheS5sZW5ndGg6MDtyZXR1cm4gbGVuZ3RoP2Jhc2VGbGF0dGVuKGFycmF5LHRydWUpOltdO31mdW5jdGlvbiBmcm9tUGFpcnMocGFpcnMpe3ZhciBpbmRleD0tMSxsZW5ndGg9cGFpcnM/cGFpcnMubGVuZ3RoOjAscmVzdWx0PXt9O3doaWxlKCsraW5kZXggPCBsZW5ndGgpIHt2YXIgcGFpcj1wYWlyc1tpbmRleF07cmVzdWx0W3BhaXJbMF1dID0gcGFpclsxXTt9cmV0dXJuIHJlc3VsdDt9ZnVuY3Rpb24gaGVhZChhcnJheSl7cmV0dXJuIGFycmF5P2FycmF5WzBdOnVuZGVmaW5lZDt9ZnVuY3Rpb24gaW5kZXhPZihhcnJheSx2YWx1ZSxmcm9tSW5kZXgpe3ZhciBsZW5ndGg9YXJyYXk/YXJyYXkubGVuZ3RoOjA7aWYoIWxlbmd0aCl7cmV0dXJuIC0xO31mcm9tSW5kZXggPSB0b0ludGVnZXIoZnJvbUluZGV4KTtpZihmcm9tSW5kZXggPCAwKXtmcm9tSW5kZXggPSBuYXRpdmVNYXgobGVuZ3RoICsgZnJvbUluZGV4LDApO31yZXR1cm4gYmFzZUluZGV4T2YoYXJyYXksdmFsdWUsZnJvbUluZGV4KTt9ZnVuY3Rpb24gaW5pdGlhbChhcnJheSl7cmV0dXJuIGRyb3BSaWdodChhcnJheSwxKTt9dmFyIGludGVyc2VjdGlvbj1yZXN0KGZ1bmN0aW9uKGFycmF5cyl7dmFyIG1hcHBlZD1hcnJheU1hcChhcnJheXMsdG9BcnJheUxpa2VPYmplY3QpO3JldHVybiBtYXBwZWQubGVuZ3RoICYmIG1hcHBlZFswXSA9PT0gYXJyYXlzWzBdP2Jhc2VJbnRlcnNlY3Rpb24obWFwcGVkKTpbXTt9KTt2YXIgaW50ZXJzZWN0aW9uQnk9cmVzdChmdW5jdGlvbihhcnJheXMpe3ZhciBpdGVyYXRlZT1sYXN0KGFycmF5cyksbWFwcGVkPWFycmF5TWFwKGFycmF5cyx0b0FycmF5TGlrZU9iamVjdCk7aWYoaXRlcmF0ZWUgPT09IGxhc3QobWFwcGVkKSl7aXRlcmF0ZWUgPSB1bmRlZmluZWQ7fWVsc2Uge21hcHBlZC5wb3AoKTt9cmV0dXJuIG1hcHBlZC5sZW5ndGggJiYgbWFwcGVkWzBdID09PSBhcnJheXNbMF0/YmFzZUludGVyc2VjdGlvbihtYXBwZWQsZ2V0SXRlcmF0ZWUoaXRlcmF0ZWUpKTpbXTt9KTt2YXIgaW50ZXJzZWN0aW9uV2l0aD1yZXN0KGZ1bmN0aW9uKGFycmF5cyl7dmFyIGNvbXBhcmF0b3I9bGFzdChhcnJheXMpLG1hcHBlZD1hcnJheU1hcChhcnJheXMsdG9BcnJheUxpa2VPYmplY3QpO2lmKGNvbXBhcmF0b3IgPT09IGxhc3QobWFwcGVkKSl7Y29tcGFyYXRvciA9IHVuZGVmaW5lZDt9ZWxzZSB7bWFwcGVkLnBvcCgpO31yZXR1cm4gbWFwcGVkLmxlbmd0aCAmJiBtYXBwZWRbMF0gPT09IGFycmF5c1swXT9iYXNlSW50ZXJzZWN0aW9uKG1hcHBlZCx1bmRlZmluZWQsY29tcGFyYXRvcik6W107fSk7ZnVuY3Rpb24gam9pbihhcnJheSxzZXBhcmF0b3Ipe3JldHVybiBhcnJheT9uYXRpdmVKb2luLmNhbGwoYXJyYXksc2VwYXJhdG9yKTpcIlwiO31mdW5jdGlvbiBsYXN0KGFycmF5KXt2YXIgbGVuZ3RoPWFycmF5P2FycmF5Lmxlbmd0aDowO3JldHVybiBsZW5ndGg/YXJyYXlbbGVuZ3RoIC0gMV06dW5kZWZpbmVkO31mdW5jdGlvbiBsYXN0SW5kZXhPZihhcnJheSx2YWx1ZSxmcm9tSW5kZXgpe3ZhciBsZW5ndGg9YXJyYXk/YXJyYXkubGVuZ3RoOjA7aWYoIWxlbmd0aCl7cmV0dXJuIC0xO312YXIgaW5kZXg9bGVuZ3RoO2lmKGZyb21JbmRleCAhPT0gdW5kZWZpbmVkKXtpbmRleCA9IHRvSW50ZWdlcihmcm9tSW5kZXgpO2luZGV4ID0gKGluZGV4IDwgMD9uYXRpdmVNYXgobGVuZ3RoICsgaW5kZXgsMCk6bmF0aXZlTWluKGluZGV4LGxlbmd0aCAtIDEpKSArIDE7fWlmKHZhbHVlICE9PSB2YWx1ZSl7cmV0dXJuIGluZGV4T2ZOYU4oYXJyYXksaW5kZXgsdHJ1ZSk7fXdoaWxlKGluZGV4LS0pIHtpZihhcnJheVtpbmRleF0gPT09IHZhbHVlKXtyZXR1cm4gaW5kZXg7fX1yZXR1cm4gLTE7fXZhciBwdWxsPXJlc3QocHVsbEFsbCk7ZnVuY3Rpb24gcHVsbEFsbChhcnJheSx2YWx1ZXMpe3JldHVybiBhcnJheSAmJiBhcnJheS5sZW5ndGggJiYgdmFsdWVzICYmIHZhbHVlcy5sZW5ndGg/YmFzZVB1bGxBbGwoYXJyYXksdmFsdWVzKTphcnJheTt9ZnVuY3Rpb24gcHVsbEFsbEJ5KGFycmF5LHZhbHVlcyxpdGVyYXRlZSl7cmV0dXJuIGFycmF5ICYmIGFycmF5Lmxlbmd0aCAmJiB2YWx1ZXMgJiYgdmFsdWVzLmxlbmd0aD9iYXNlUHVsbEFsbEJ5KGFycmF5LHZhbHVlcyxnZXRJdGVyYXRlZShpdGVyYXRlZSkpOmFycmF5O312YXIgcHVsbEF0PXJlc3QoZnVuY3Rpb24oYXJyYXksaW5kZXhlcyl7aW5kZXhlcyA9IGFycmF5TWFwKGJhc2VGbGF0dGVuKGluZGV4ZXMpLFN0cmluZyk7dmFyIHJlc3VsdD1iYXNlQXQoYXJyYXksaW5kZXhlcyk7YmFzZVB1bGxBdChhcnJheSxpbmRleGVzLnNvcnQoY29tcGFyZUFzY2VuZGluZykpO3JldHVybiByZXN1bHQ7fSk7ZnVuY3Rpb24gcmVtb3ZlKGFycmF5LHByZWRpY2F0ZSl7dmFyIHJlc3VsdD1bXTtpZighKGFycmF5ICYmIGFycmF5Lmxlbmd0aCkpe3JldHVybiByZXN1bHQ7fXZhciBpbmRleD0tMSxpbmRleGVzPVtdLGxlbmd0aD1hcnJheS5sZW5ndGg7cHJlZGljYXRlID0gZ2V0SXRlcmF0ZWUocHJlZGljYXRlLDMpO3doaWxlKCsraW5kZXggPCBsZW5ndGgpIHt2YXIgdmFsdWU9YXJyYXlbaW5kZXhdO2lmKHByZWRpY2F0ZSh2YWx1ZSxpbmRleCxhcnJheSkpe3Jlc3VsdC5wdXNoKHZhbHVlKTtpbmRleGVzLnB1c2goaW5kZXgpO319YmFzZVB1bGxBdChhcnJheSxpbmRleGVzKTtyZXR1cm4gcmVzdWx0O31mdW5jdGlvbiByZXZlcnNlKGFycmF5KXtyZXR1cm4gYXJyYXk/bmF0aXZlUmV2ZXJzZS5jYWxsKGFycmF5KTphcnJheTt9ZnVuY3Rpb24gc2xpY2UoYXJyYXksc3RhcnQsZW5kKXt2YXIgbGVuZ3RoPWFycmF5P2FycmF5Lmxlbmd0aDowO2lmKCFsZW5ndGgpe3JldHVybiBbXTt9aWYoZW5kICYmIHR5cGVvZiBlbmQgIT0gXCJudW1iZXJcIiAmJiBpc0l0ZXJhdGVlQ2FsbChhcnJheSxzdGFydCxlbmQpKXtzdGFydCA9IDA7ZW5kID0gbGVuZ3RoO31lbHNlIHtzdGFydCA9IHN0YXJ0ID09IG51bGw/MDp0b0ludGVnZXIoc3RhcnQpO2VuZCA9IGVuZCA9PT0gdW5kZWZpbmVkP2xlbmd0aDp0b0ludGVnZXIoZW5kKTt9cmV0dXJuIGJhc2VTbGljZShhcnJheSxzdGFydCxlbmQpO31mdW5jdGlvbiBzb3J0ZWRJbmRleChhcnJheSx2YWx1ZSl7cmV0dXJuIGJhc2VTb3J0ZWRJbmRleChhcnJheSx2YWx1ZSk7fWZ1bmN0aW9uIHNvcnRlZEluZGV4QnkoYXJyYXksdmFsdWUsaXRlcmF0ZWUpe3JldHVybiBiYXNlU29ydGVkSW5kZXhCeShhcnJheSx2YWx1ZSxnZXRJdGVyYXRlZShpdGVyYXRlZSkpO31mdW5jdGlvbiBzb3J0ZWRJbmRleE9mKGFycmF5LHZhbHVlKXt2YXIgbGVuZ3RoPWFycmF5P2FycmF5Lmxlbmd0aDowO2lmKGxlbmd0aCl7dmFyIGluZGV4PWJhc2VTb3J0ZWRJbmRleChhcnJheSx2YWx1ZSk7aWYoaW5kZXggPCBsZW5ndGggJiYgZXEoYXJyYXlbaW5kZXhdLHZhbHVlKSl7cmV0dXJuIGluZGV4O319cmV0dXJuIC0xO31mdW5jdGlvbiBzb3J0ZWRMYXN0SW5kZXgoYXJyYXksdmFsdWUpe3JldHVybiBiYXNlU29ydGVkSW5kZXgoYXJyYXksdmFsdWUsdHJ1ZSk7fWZ1bmN0aW9uIHNvcnRlZExhc3RJbmRleEJ5KGFycmF5LHZhbHVlLGl0ZXJhdGVlKXtyZXR1cm4gYmFzZVNvcnRlZEluZGV4QnkoYXJyYXksdmFsdWUsZ2V0SXRlcmF0ZWUoaXRlcmF0ZWUpLHRydWUpO31mdW5jdGlvbiBzb3J0ZWRMYXN0SW5kZXhPZihhcnJheSx2YWx1ZSl7dmFyIGxlbmd0aD1hcnJheT9hcnJheS5sZW5ndGg6MDtpZihsZW5ndGgpe3ZhciBpbmRleD1iYXNlU29ydGVkSW5kZXgoYXJyYXksdmFsdWUsdHJ1ZSkgLSAxO2lmKGVxKGFycmF5W2luZGV4XSx2YWx1ZSkpe3JldHVybiBpbmRleDt9fXJldHVybiAtMTt9ZnVuY3Rpb24gc29ydGVkVW5pcShhcnJheSl7cmV0dXJuIGFycmF5ICYmIGFycmF5Lmxlbmd0aD9iYXNlU29ydGVkVW5pcShhcnJheSk6W107fWZ1bmN0aW9uIHNvcnRlZFVuaXFCeShhcnJheSxpdGVyYXRlZSl7cmV0dXJuIGFycmF5ICYmIGFycmF5Lmxlbmd0aD9iYXNlU29ydGVkVW5pcUJ5KGFycmF5LGdldEl0ZXJhdGVlKGl0ZXJhdGVlKSk6W107fWZ1bmN0aW9uIHRhaWwoYXJyYXkpe3JldHVybiBkcm9wKGFycmF5LDEpO31mdW5jdGlvbiB0YWtlKGFycmF5LG4sZ3VhcmQpe2lmKCEoYXJyYXkgJiYgYXJyYXkubGVuZ3RoKSl7cmV0dXJuIFtdO31uID0gZ3VhcmQgfHwgbiA9PT0gdW5kZWZpbmVkPzE6dG9JbnRlZ2VyKG4pO3JldHVybiBiYXNlU2xpY2UoYXJyYXksMCxuIDwgMD8wOm4pO31mdW5jdGlvbiB0YWtlUmlnaHQoYXJyYXksbixndWFyZCl7dmFyIGxlbmd0aD1hcnJheT9hcnJheS5sZW5ndGg6MDtpZighbGVuZ3RoKXtyZXR1cm4gW107fW4gPSBndWFyZCB8fCBuID09PSB1bmRlZmluZWQ/MTp0b0ludGVnZXIobik7biA9IGxlbmd0aCAtIG47cmV0dXJuIGJhc2VTbGljZShhcnJheSxuIDwgMD8wOm4sbGVuZ3RoKTt9ZnVuY3Rpb24gdGFrZVJpZ2h0V2hpbGUoYXJyYXkscHJlZGljYXRlKXtyZXR1cm4gYXJyYXkgJiYgYXJyYXkubGVuZ3RoP2Jhc2VXaGlsZShhcnJheSxnZXRJdGVyYXRlZShwcmVkaWNhdGUsMyksZmFsc2UsdHJ1ZSk6W107fWZ1bmN0aW9uIHRha2VXaGlsZShhcnJheSxwcmVkaWNhdGUpe3JldHVybiBhcnJheSAmJiBhcnJheS5sZW5ndGg/YmFzZVdoaWxlKGFycmF5LGdldEl0ZXJhdGVlKHByZWRpY2F0ZSwzKSk6W107fXZhciB1bmlvbj1yZXN0KGZ1bmN0aW9uKGFycmF5cyl7cmV0dXJuIGJhc2VVbmlxKGJhc2VGbGF0dGVuKGFycmF5cyxmYWxzZSx0cnVlKSk7fSk7dmFyIHVuaW9uQnk9cmVzdChmdW5jdGlvbihhcnJheXMpe3ZhciBpdGVyYXRlZT1sYXN0KGFycmF5cyk7aWYoaXNBcnJheUxpa2VPYmplY3QoaXRlcmF0ZWUpKXtpdGVyYXRlZSA9IHVuZGVmaW5lZDt9cmV0dXJuIGJhc2VVbmlxKGJhc2VGbGF0dGVuKGFycmF5cyxmYWxzZSx0cnVlKSxnZXRJdGVyYXRlZShpdGVyYXRlZSkpO30pO3ZhciB1bmlvbldpdGg9cmVzdChmdW5jdGlvbihhcnJheXMpe3ZhciBjb21wYXJhdG9yPWxhc3QoYXJyYXlzKTtpZihpc0FycmF5TGlrZU9iamVjdChjb21wYXJhdG9yKSl7Y29tcGFyYXRvciA9IHVuZGVmaW5lZDt9cmV0dXJuIGJhc2VVbmlxKGJhc2VGbGF0dGVuKGFycmF5cyxmYWxzZSx0cnVlKSx1bmRlZmluZWQsY29tcGFyYXRvcik7fSk7ZnVuY3Rpb24gdW5pcShhcnJheSl7cmV0dXJuIGFycmF5ICYmIGFycmF5Lmxlbmd0aD9iYXNlVW5pcShhcnJheSk6W107fWZ1bmN0aW9uIHVuaXFCeShhcnJheSxpdGVyYXRlZSl7cmV0dXJuIGFycmF5ICYmIGFycmF5Lmxlbmd0aD9iYXNlVW5pcShhcnJheSxnZXRJdGVyYXRlZShpdGVyYXRlZSkpOltdO31mdW5jdGlvbiB1bmlxV2l0aChhcnJheSxjb21wYXJhdG9yKXtyZXR1cm4gYXJyYXkgJiYgYXJyYXkubGVuZ3RoP2Jhc2VVbmlxKGFycmF5LHVuZGVmaW5lZCxjb21wYXJhdG9yKTpbXTt9ZnVuY3Rpb24gdW56aXAoYXJyYXkpe2lmKCEoYXJyYXkgJiYgYXJyYXkubGVuZ3RoKSl7cmV0dXJuIFtdO312YXIgbGVuZ3RoPTA7YXJyYXkgPSBhcnJheUZpbHRlcihhcnJheSxmdW5jdGlvbihncm91cCl7aWYoaXNBcnJheUxpa2VPYmplY3QoZ3JvdXApKXtsZW5ndGggPSBuYXRpdmVNYXgoZ3JvdXAubGVuZ3RoLGxlbmd0aCk7cmV0dXJuIHRydWU7fX0pO3JldHVybiBiYXNlVGltZXMobGVuZ3RoLGZ1bmN0aW9uKGluZGV4KXtyZXR1cm4gYXJyYXlNYXAoYXJyYXksYmFzZVByb3BlcnR5KGluZGV4KSk7fSk7fWZ1bmN0aW9uIHVuemlwV2l0aChhcnJheSxpdGVyYXRlZSl7aWYoIShhcnJheSAmJiBhcnJheS5sZW5ndGgpKXtyZXR1cm4gW107fXZhciByZXN1bHQ9dW56aXAoYXJyYXkpO2lmKGl0ZXJhdGVlID09IG51bGwpe3JldHVybiByZXN1bHQ7fXJldHVybiBhcnJheU1hcChyZXN1bHQsZnVuY3Rpb24oZ3JvdXApe3JldHVybiBhcHBseShpdGVyYXRlZSx1bmRlZmluZWQsZ3JvdXApO30pO312YXIgd2l0aG91dD1yZXN0KGZ1bmN0aW9uKGFycmF5LHZhbHVlcyl7cmV0dXJuIGlzQXJyYXlMaWtlT2JqZWN0KGFycmF5KT9iYXNlRGlmZmVyZW5jZShhcnJheSx2YWx1ZXMpOltdO30pO3ZhciB4b3I9cmVzdChmdW5jdGlvbihhcnJheXMpe3JldHVybiBiYXNlWG9yKGFycmF5RmlsdGVyKGFycmF5cyxpc0FycmF5TGlrZU9iamVjdCkpO30pO3ZhciB4b3JCeT1yZXN0KGZ1bmN0aW9uKGFycmF5cyl7dmFyIGl0ZXJhdGVlPWxhc3QoYXJyYXlzKTtpZihpc0FycmF5TGlrZU9iamVjdChpdGVyYXRlZSkpe2l0ZXJhdGVlID0gdW5kZWZpbmVkO31yZXR1cm4gYmFzZVhvcihhcnJheUZpbHRlcihhcnJheXMsaXNBcnJheUxpa2VPYmplY3QpLGdldEl0ZXJhdGVlKGl0ZXJhdGVlKSk7fSk7dmFyIHhvcldpdGg9cmVzdChmdW5jdGlvbihhcnJheXMpe3ZhciBjb21wYXJhdG9yPWxhc3QoYXJyYXlzKTtpZihpc0FycmF5TGlrZU9iamVjdChjb21wYXJhdG9yKSl7Y29tcGFyYXRvciA9IHVuZGVmaW5lZDt9cmV0dXJuIGJhc2VYb3IoYXJyYXlGaWx0ZXIoYXJyYXlzLGlzQXJyYXlMaWtlT2JqZWN0KSx1bmRlZmluZWQsY29tcGFyYXRvcik7fSk7dmFyIHppcD1yZXN0KHVuemlwKTtmdW5jdGlvbiB6aXBPYmplY3QocHJvcHMsdmFsdWVzKXtyZXR1cm4gYmFzZVppcE9iamVjdChwcm9wcyB8fCBbXSx2YWx1ZXMgfHwgW10sYXNzaWduVmFsdWUpO31mdW5jdGlvbiB6aXBPYmplY3REZWVwKHByb3BzLHZhbHVlcyl7cmV0dXJuIGJhc2VaaXBPYmplY3QocHJvcHMgfHwgW10sdmFsdWVzIHx8IFtdLGJhc2VTZXQpO312YXIgemlwV2l0aD1yZXN0KGZ1bmN0aW9uKGFycmF5cyl7dmFyIGxlbmd0aD1hcnJheXMubGVuZ3RoLGl0ZXJhdGVlPWxlbmd0aCA+IDE/YXJyYXlzW2xlbmd0aCAtIDFdOnVuZGVmaW5lZDtpdGVyYXRlZSA9IHR5cGVvZiBpdGVyYXRlZSA9PSBcImZ1bmN0aW9uXCI/KGFycmF5cy5wb3AoKSxpdGVyYXRlZSk6dW5kZWZpbmVkO3JldHVybiB1bnppcFdpdGgoYXJyYXlzLGl0ZXJhdGVlKTt9KTtmdW5jdGlvbiBjaGFpbih2YWx1ZSl7dmFyIHJlc3VsdD1sb2Rhc2godmFsdWUpO3Jlc3VsdC5fX2NoYWluX18gPSB0cnVlO3JldHVybiByZXN1bHQ7fWZ1bmN0aW9uIHRhcCh2YWx1ZSxpbnRlcmNlcHRvcil7aW50ZXJjZXB0b3IodmFsdWUpO3JldHVybiB2YWx1ZTt9ZnVuY3Rpb24gdGhydSh2YWx1ZSxpbnRlcmNlcHRvcil7cmV0dXJuIGludGVyY2VwdG9yKHZhbHVlKTt9dmFyIHdyYXBwZXJBdD1yZXN0KGZ1bmN0aW9uKHBhdGhzKXtwYXRocyA9IGJhc2VGbGF0dGVuKHBhdGhzKTt2YXIgbGVuZ3RoPXBhdGhzLmxlbmd0aCxzdGFydD1sZW5ndGg/cGF0aHNbMF06MCx2YWx1ZT10aGlzLl9fd3JhcHBlZF9fLGludGVyY2VwdG9yPWZ1bmN0aW9uIGludGVyY2VwdG9yKG9iamVjdCl7cmV0dXJuIGJhc2VBdChvYmplY3QscGF0aHMpO307aWYobGVuZ3RoID4gMSB8fCB0aGlzLl9fYWN0aW9uc19fLmxlbmd0aCB8fCAhKHZhbHVlIGluc3RhbmNlb2YgTGF6eVdyYXBwZXIpIHx8ICFpc0luZGV4KHN0YXJ0KSl7cmV0dXJuIHRoaXMudGhydShpbnRlcmNlcHRvcik7fXZhbHVlID0gdmFsdWUuc2xpY2Uoc3RhcnQsK3N0YXJ0ICsgKGxlbmd0aD8xOjApKTt2YWx1ZS5fX2FjdGlvbnNfXy5wdXNoKHtmdW5jOnRocnUsYXJnczpbaW50ZXJjZXB0b3JdLHRoaXNBcmc6dW5kZWZpbmVkfSk7cmV0dXJuIG5ldyBMb2Rhc2hXcmFwcGVyKHZhbHVlLHRoaXMuX19jaGFpbl9fKS50aHJ1KGZ1bmN0aW9uKGFycmF5KXtpZihsZW5ndGggJiYgIWFycmF5Lmxlbmd0aCl7YXJyYXkucHVzaCh1bmRlZmluZWQpO31yZXR1cm4gYXJyYXk7fSk7fSk7ZnVuY3Rpb24gd3JhcHBlckNoYWluKCl7cmV0dXJuIGNoYWluKHRoaXMpO31mdW5jdGlvbiB3cmFwcGVyQ29tbWl0KCl7cmV0dXJuIG5ldyBMb2Rhc2hXcmFwcGVyKHRoaXMudmFsdWUoKSx0aGlzLl9fY2hhaW5fXyk7fWZ1bmN0aW9uIHdyYXBwZXJGbGF0TWFwKGl0ZXJhdGVlKXtyZXR1cm4gdGhpcy5tYXAoaXRlcmF0ZWUpLmZsYXR0ZW4oKTt9ZnVuY3Rpb24gd3JhcHBlck5leHQoKXtpZih0aGlzLl9fdmFsdWVzX18gPT09IHVuZGVmaW5lZCl7dGhpcy5fX3ZhbHVlc19fID0gdG9BcnJheSh0aGlzLnZhbHVlKCkpO312YXIgZG9uZT10aGlzLl9faW5kZXhfXyA+PSB0aGlzLl9fdmFsdWVzX18ubGVuZ3RoLHZhbHVlPWRvbmU/dW5kZWZpbmVkOnRoaXMuX192YWx1ZXNfX1t0aGlzLl9faW5kZXhfXysrXTtyZXR1cm4ge2RvbmU6ZG9uZSx2YWx1ZTp2YWx1ZX07fWZ1bmN0aW9uIHdyYXBwZXJUb0l0ZXJhdG9yKCl7cmV0dXJuIHRoaXM7fWZ1bmN0aW9uIHdyYXBwZXJQbGFudCh2YWx1ZSl7dmFyIHJlc3VsdCxwYXJlbnQ9dGhpczt3aGlsZShwYXJlbnQgaW5zdGFuY2VvZiBiYXNlTG9kYXNoKSB7dmFyIGNsb25lPXdyYXBwZXJDbG9uZShwYXJlbnQpO2Nsb25lLl9faW5kZXhfXyA9IDA7Y2xvbmUuX192YWx1ZXNfXyA9IHVuZGVmaW5lZDtpZihyZXN1bHQpe3ByZXZpb3VzLl9fd3JhcHBlZF9fID0gY2xvbmU7fWVsc2Uge3Jlc3VsdCA9IGNsb25lO312YXIgcHJldmlvdXM9Y2xvbmU7cGFyZW50ID0gcGFyZW50Ll9fd3JhcHBlZF9fO31wcmV2aW91cy5fX3dyYXBwZWRfXyA9IHZhbHVlO3JldHVybiByZXN1bHQ7fWZ1bmN0aW9uIHdyYXBwZXJSZXZlcnNlKCl7dmFyIHZhbHVlPXRoaXMuX193cmFwcGVkX187aWYodmFsdWUgaW5zdGFuY2VvZiBMYXp5V3JhcHBlcil7dmFyIHdyYXBwZWQ9dmFsdWU7aWYodGhpcy5fX2FjdGlvbnNfXy5sZW5ndGgpe3dyYXBwZWQgPSBuZXcgTGF6eVdyYXBwZXIodGhpcyk7fXdyYXBwZWQgPSB3cmFwcGVkLnJldmVyc2UoKTt3cmFwcGVkLl9fYWN0aW9uc19fLnB1c2goe2Z1bmM6dGhydSxhcmdzOltyZXZlcnNlXSx0aGlzQXJnOnVuZGVmaW5lZH0pO3JldHVybiBuZXcgTG9kYXNoV3JhcHBlcih3cmFwcGVkLHRoaXMuX19jaGFpbl9fKTt9cmV0dXJuIHRoaXMudGhydShyZXZlcnNlKTt9ZnVuY3Rpb24gd3JhcHBlclZhbHVlKCl7cmV0dXJuIGJhc2VXcmFwcGVyVmFsdWUodGhpcy5fX3dyYXBwZWRfXyx0aGlzLl9fYWN0aW9uc19fKTt9dmFyIGNvdW50Qnk9Y3JlYXRlQWdncmVnYXRvcihmdW5jdGlvbihyZXN1bHQsdmFsdWUsa2V5KXtoYXNPd25Qcm9wZXJ0eS5jYWxsKHJlc3VsdCxrZXkpPysrcmVzdWx0W2tleV06cmVzdWx0W2tleV0gPSAxO30pO2Z1bmN0aW9uIGV2ZXJ5KGNvbGxlY3Rpb24scHJlZGljYXRlLGd1YXJkKXt2YXIgZnVuYz1pc0FycmF5KGNvbGxlY3Rpb24pP2FycmF5RXZlcnk6YmFzZUV2ZXJ5O2lmKGd1YXJkICYmIGlzSXRlcmF0ZWVDYWxsKGNvbGxlY3Rpb24scHJlZGljYXRlLGd1YXJkKSl7cHJlZGljYXRlID0gdW5kZWZpbmVkO31yZXR1cm4gZnVuYyhjb2xsZWN0aW9uLGdldEl0ZXJhdGVlKHByZWRpY2F0ZSwzKSk7fWZ1bmN0aW9uIGZpbHRlcihjb2xsZWN0aW9uLHByZWRpY2F0ZSl7dmFyIGZ1bmM9aXNBcnJheShjb2xsZWN0aW9uKT9hcnJheUZpbHRlcjpiYXNlRmlsdGVyO3JldHVybiBmdW5jKGNvbGxlY3Rpb24sZ2V0SXRlcmF0ZWUocHJlZGljYXRlLDMpKTt9ZnVuY3Rpb24gZmluZChjb2xsZWN0aW9uLHByZWRpY2F0ZSl7cHJlZGljYXRlID0gZ2V0SXRlcmF0ZWUocHJlZGljYXRlLDMpO2lmKGlzQXJyYXkoY29sbGVjdGlvbikpe3ZhciBpbmRleD1iYXNlRmluZEluZGV4KGNvbGxlY3Rpb24scHJlZGljYXRlKTtyZXR1cm4gaW5kZXggPiAtMT9jb2xsZWN0aW9uW2luZGV4XTp1bmRlZmluZWQ7fXJldHVybiBiYXNlRmluZChjb2xsZWN0aW9uLHByZWRpY2F0ZSxiYXNlRWFjaCk7fWZ1bmN0aW9uIGZpbmRMYXN0KGNvbGxlY3Rpb24scHJlZGljYXRlKXtwcmVkaWNhdGUgPSBnZXRJdGVyYXRlZShwcmVkaWNhdGUsMyk7aWYoaXNBcnJheShjb2xsZWN0aW9uKSl7dmFyIGluZGV4PWJhc2VGaW5kSW5kZXgoY29sbGVjdGlvbixwcmVkaWNhdGUsdHJ1ZSk7cmV0dXJuIGluZGV4ID4gLTE/Y29sbGVjdGlvbltpbmRleF06dW5kZWZpbmVkO31yZXR1cm4gYmFzZUZpbmQoY29sbGVjdGlvbixwcmVkaWNhdGUsYmFzZUVhY2hSaWdodCk7fWZ1bmN0aW9uIGZsYXRNYXAoY29sbGVjdGlvbixpdGVyYXRlZSl7cmV0dXJuIGJhc2VGbGF0dGVuKG1hcChjb2xsZWN0aW9uLGl0ZXJhdGVlKSk7fWZ1bmN0aW9uIGZvckVhY2goY29sbGVjdGlvbixpdGVyYXRlZSl7cmV0dXJuIHR5cGVvZiBpdGVyYXRlZSA9PSBcImZ1bmN0aW9uXCIgJiYgaXNBcnJheShjb2xsZWN0aW9uKT9hcnJheUVhY2goY29sbGVjdGlvbixpdGVyYXRlZSk6YmFzZUVhY2goY29sbGVjdGlvbix0b0Z1bmN0aW9uKGl0ZXJhdGVlKSk7fWZ1bmN0aW9uIGZvckVhY2hSaWdodChjb2xsZWN0aW9uLGl0ZXJhdGVlKXtyZXR1cm4gdHlwZW9mIGl0ZXJhdGVlID09IFwiZnVuY3Rpb25cIiAmJiBpc0FycmF5KGNvbGxlY3Rpb24pP2FycmF5RWFjaFJpZ2h0KGNvbGxlY3Rpb24saXRlcmF0ZWUpOmJhc2VFYWNoUmlnaHQoY29sbGVjdGlvbix0b0Z1bmN0aW9uKGl0ZXJhdGVlKSk7fXZhciBncm91cEJ5PWNyZWF0ZUFnZ3JlZ2F0b3IoZnVuY3Rpb24ocmVzdWx0LHZhbHVlLGtleSl7aWYoaGFzT3duUHJvcGVydHkuY2FsbChyZXN1bHQsa2V5KSl7cmVzdWx0W2tleV0ucHVzaCh2YWx1ZSk7fWVsc2Uge3Jlc3VsdFtrZXldID0gW3ZhbHVlXTt9fSk7ZnVuY3Rpb24gaW5jbHVkZXMoY29sbGVjdGlvbix2YWx1ZSxmcm9tSW5kZXgsZ3VhcmQpe2NvbGxlY3Rpb24gPSBpc0FycmF5TGlrZShjb2xsZWN0aW9uKT9jb2xsZWN0aW9uOnZhbHVlcyhjb2xsZWN0aW9uKTtmcm9tSW5kZXggPSBmcm9tSW5kZXggJiYgIWd1YXJkP3RvSW50ZWdlcihmcm9tSW5kZXgpOjA7dmFyIGxlbmd0aD1jb2xsZWN0aW9uLmxlbmd0aDtpZihmcm9tSW5kZXggPCAwKXtmcm9tSW5kZXggPSBuYXRpdmVNYXgobGVuZ3RoICsgZnJvbUluZGV4LDApO31yZXR1cm4gaXNTdHJpbmcoY29sbGVjdGlvbik/ZnJvbUluZGV4IDw9IGxlbmd0aCAmJiBjb2xsZWN0aW9uLmluZGV4T2YodmFsdWUsZnJvbUluZGV4KSA+IC0xOiEhbGVuZ3RoICYmIGJhc2VJbmRleE9mKGNvbGxlY3Rpb24sdmFsdWUsZnJvbUluZGV4KSA+IC0xO312YXIgaW52b2tlTWFwPXJlc3QoZnVuY3Rpb24oY29sbGVjdGlvbixwYXRoLGFyZ3Mpe3ZhciBpbmRleD0tMSxpc0Z1bmM9dHlwZW9mIHBhdGggPT0gXCJmdW5jdGlvblwiLGlzUHJvcD1pc0tleShwYXRoKSxyZXN1bHQ9aXNBcnJheUxpa2UoY29sbGVjdGlvbik/QXJyYXkoY29sbGVjdGlvbi5sZW5ndGgpOltdO2Jhc2VFYWNoKGNvbGxlY3Rpb24sZnVuY3Rpb24odmFsdWUpe3ZhciBmdW5jPWlzRnVuYz9wYXRoOmlzUHJvcCAmJiB2YWx1ZSAhPSBudWxsP3ZhbHVlW3BhdGhdOnVuZGVmaW5lZDtyZXN1bHRbKytpbmRleF0gPSBmdW5jP2FwcGx5KGZ1bmMsdmFsdWUsYXJncyk6YmFzZUludm9rZSh2YWx1ZSxwYXRoLGFyZ3MpO30pO3JldHVybiByZXN1bHQ7fSk7dmFyIGtleUJ5PWNyZWF0ZUFnZ3JlZ2F0b3IoZnVuY3Rpb24ocmVzdWx0LHZhbHVlLGtleSl7cmVzdWx0W2tleV0gPSB2YWx1ZTt9KTtmdW5jdGlvbiBtYXAoY29sbGVjdGlvbixpdGVyYXRlZSl7dmFyIGZ1bmM9aXNBcnJheShjb2xsZWN0aW9uKT9hcnJheU1hcDpiYXNlTWFwO3JldHVybiBmdW5jKGNvbGxlY3Rpb24sZ2V0SXRlcmF0ZWUoaXRlcmF0ZWUsMykpO31mdW5jdGlvbiBvcmRlckJ5KGNvbGxlY3Rpb24saXRlcmF0ZWVzLG9yZGVycyxndWFyZCl7aWYoY29sbGVjdGlvbiA9PSBudWxsKXtyZXR1cm4gW107fWlmKCFpc0FycmF5KGl0ZXJhdGVlcykpe2l0ZXJhdGVlcyA9IGl0ZXJhdGVlcyA9PSBudWxsP1tdOltpdGVyYXRlZXNdO31vcmRlcnMgPSBndWFyZD91bmRlZmluZWQ6b3JkZXJzO2lmKCFpc0FycmF5KG9yZGVycykpe29yZGVycyA9IG9yZGVycyA9PSBudWxsP1tdOltvcmRlcnNdO31yZXR1cm4gYmFzZU9yZGVyQnkoY29sbGVjdGlvbixpdGVyYXRlZXMsb3JkZXJzKTt9dmFyIHBhcnRpdGlvbj1jcmVhdGVBZ2dyZWdhdG9yKGZ1bmN0aW9uKHJlc3VsdCx2YWx1ZSxrZXkpe3Jlc3VsdFtrZXk/MDoxXS5wdXNoKHZhbHVlKTt9LGZ1bmN0aW9uKCl7cmV0dXJuIFtbXSxbXV07fSk7ZnVuY3Rpb24gcmVkdWNlKGNvbGxlY3Rpb24saXRlcmF0ZWUsYWNjdW11bGF0b3Ipe3ZhciBmdW5jPWlzQXJyYXkoY29sbGVjdGlvbik/YXJyYXlSZWR1Y2U6YmFzZVJlZHVjZSxpbml0QWNjdW09YXJndW1lbnRzLmxlbmd0aCA8IDM7cmV0dXJuIGZ1bmMoY29sbGVjdGlvbixnZXRJdGVyYXRlZShpdGVyYXRlZSw0KSxhY2N1bXVsYXRvcixpbml0QWNjdW0sYmFzZUVhY2gpO31mdW5jdGlvbiByZWR1Y2VSaWdodChjb2xsZWN0aW9uLGl0ZXJhdGVlLGFjY3VtdWxhdG9yKXt2YXIgZnVuYz1pc0FycmF5KGNvbGxlY3Rpb24pP2FycmF5UmVkdWNlUmlnaHQ6YmFzZVJlZHVjZSxpbml0QWNjdW09YXJndW1lbnRzLmxlbmd0aCA8IDM7cmV0dXJuIGZ1bmMoY29sbGVjdGlvbixnZXRJdGVyYXRlZShpdGVyYXRlZSw0KSxhY2N1bXVsYXRvcixpbml0QWNjdW0sYmFzZUVhY2hSaWdodCk7fWZ1bmN0aW9uIHJlamVjdChjb2xsZWN0aW9uLHByZWRpY2F0ZSl7dmFyIGZ1bmM9aXNBcnJheShjb2xsZWN0aW9uKT9hcnJheUZpbHRlcjpiYXNlRmlsdGVyO3ByZWRpY2F0ZSA9IGdldEl0ZXJhdGVlKHByZWRpY2F0ZSwzKTtyZXR1cm4gZnVuYyhjb2xsZWN0aW9uLGZ1bmN0aW9uKHZhbHVlLGluZGV4LGNvbGxlY3Rpb24pe3JldHVybiAhcHJlZGljYXRlKHZhbHVlLGluZGV4LGNvbGxlY3Rpb24pO30pO31mdW5jdGlvbiBzYW1wbGUoY29sbGVjdGlvbil7dmFyIGFycmF5PWlzQXJyYXlMaWtlKGNvbGxlY3Rpb24pP2NvbGxlY3Rpb246dmFsdWVzKGNvbGxlY3Rpb24pLGxlbmd0aD1hcnJheS5sZW5ndGg7cmV0dXJuIGxlbmd0aCA+IDA/YXJyYXlbYmFzZVJhbmRvbSgwLGxlbmd0aCAtIDEpXTp1bmRlZmluZWQ7fWZ1bmN0aW9uIHNhbXBsZVNpemUoY29sbGVjdGlvbixuKXt2YXIgaW5kZXg9LTEscmVzdWx0PXRvQXJyYXkoY29sbGVjdGlvbiksbGVuZ3RoPXJlc3VsdC5sZW5ndGgsbGFzdEluZGV4PWxlbmd0aCAtIDE7biA9IGJhc2VDbGFtcCh0b0ludGVnZXIobiksMCxsZW5ndGgpO3doaWxlKCsraW5kZXggPCBuKSB7dmFyIHJhbmQ9YmFzZVJhbmRvbShpbmRleCxsYXN0SW5kZXgpLHZhbHVlPXJlc3VsdFtyYW5kXTtyZXN1bHRbcmFuZF0gPSByZXN1bHRbaW5kZXhdO3Jlc3VsdFtpbmRleF0gPSB2YWx1ZTt9cmVzdWx0Lmxlbmd0aCA9IG47cmV0dXJuIHJlc3VsdDt9ZnVuY3Rpb24gc2h1ZmZsZShjb2xsZWN0aW9uKXtyZXR1cm4gc2FtcGxlU2l6ZShjb2xsZWN0aW9uLE1BWF9BUlJBWV9MRU5HVEgpO31mdW5jdGlvbiBzaXplKGNvbGxlY3Rpb24pe2lmKGNvbGxlY3Rpb24gPT0gbnVsbCl7cmV0dXJuIDA7fWlmKGlzQXJyYXlMaWtlKGNvbGxlY3Rpb24pKXt2YXIgcmVzdWx0PWNvbGxlY3Rpb24ubGVuZ3RoO3JldHVybiByZXN1bHQgJiYgaXNTdHJpbmcoY29sbGVjdGlvbik/c3RyaW5nU2l6ZShjb2xsZWN0aW9uKTpyZXN1bHQ7fXJldHVybiBrZXlzKGNvbGxlY3Rpb24pLmxlbmd0aDt9ZnVuY3Rpb24gc29tZShjb2xsZWN0aW9uLHByZWRpY2F0ZSxndWFyZCl7dmFyIGZ1bmM9aXNBcnJheShjb2xsZWN0aW9uKT9hcnJheVNvbWU6YmFzZVNvbWU7aWYoZ3VhcmQgJiYgaXNJdGVyYXRlZUNhbGwoY29sbGVjdGlvbixwcmVkaWNhdGUsZ3VhcmQpKXtwcmVkaWNhdGUgPSB1bmRlZmluZWQ7fXJldHVybiBmdW5jKGNvbGxlY3Rpb24sZ2V0SXRlcmF0ZWUocHJlZGljYXRlLDMpKTt9dmFyIHNvcnRCeT1yZXN0KGZ1bmN0aW9uKGNvbGxlY3Rpb24saXRlcmF0ZWVzKXtpZihjb2xsZWN0aW9uID09IG51bGwpe3JldHVybiBbXTt9dmFyIGxlbmd0aD1pdGVyYXRlZXMubGVuZ3RoO2lmKGxlbmd0aCA+IDEgJiYgaXNJdGVyYXRlZUNhbGwoY29sbGVjdGlvbixpdGVyYXRlZXNbMF0saXRlcmF0ZWVzWzFdKSl7aXRlcmF0ZWVzID0gW107fWVsc2UgaWYobGVuZ3RoID4gMiAmJiBpc0l0ZXJhdGVlQ2FsbChpdGVyYXRlZXNbMF0saXRlcmF0ZWVzWzFdLGl0ZXJhdGVlc1syXSkpe2l0ZXJhdGVlcy5sZW5ndGggPSAxO31yZXR1cm4gYmFzZU9yZGVyQnkoY29sbGVjdGlvbixiYXNlRmxhdHRlbihpdGVyYXRlZXMpLFtdKTt9KTt2YXIgbm93PURhdGUubm93O2Z1bmN0aW9uIGFmdGVyKG4sZnVuYyl7aWYodHlwZW9mIGZ1bmMgIT0gXCJmdW5jdGlvblwiKXt0aHJvdyBuZXcgVHlwZUVycm9yKEZVTkNfRVJST1JfVEVYVCk7fW4gPSB0b0ludGVnZXIobik7cmV0dXJuIGZ1bmN0aW9uKCl7aWYoLS1uIDwgMSl7cmV0dXJuIGZ1bmMuYXBwbHkodGhpcyxhcmd1bWVudHMpO319O31mdW5jdGlvbiBhcnkoZnVuYyxuLGd1YXJkKXtuID0gZ3VhcmQ/dW5kZWZpbmVkOm47biA9IGZ1bmMgJiYgbiA9PSBudWxsP2Z1bmMubGVuZ3RoOm47cmV0dXJuIGNyZWF0ZVdyYXBwZXIoZnVuYyxBUllfRkxBRyx1bmRlZmluZWQsdW5kZWZpbmVkLHVuZGVmaW5lZCx1bmRlZmluZWQsbik7fWZ1bmN0aW9uIGJlZm9yZShuLGZ1bmMpe3ZhciByZXN1bHQ7aWYodHlwZW9mIGZ1bmMgIT0gXCJmdW5jdGlvblwiKXt0aHJvdyBuZXcgVHlwZUVycm9yKEZVTkNfRVJST1JfVEVYVCk7fW4gPSB0b0ludGVnZXIobik7cmV0dXJuIGZ1bmN0aW9uKCl7aWYoLS1uID4gMCl7cmVzdWx0ID0gZnVuYy5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fWlmKG4gPD0gMSl7ZnVuYyA9IHVuZGVmaW5lZDt9cmV0dXJuIHJlc3VsdDt9O312YXIgYmluZD1yZXN0KGZ1bmN0aW9uKGZ1bmMsdGhpc0FyZyxwYXJ0aWFscyl7dmFyIGJpdG1hc2s9QklORF9GTEFHO2lmKHBhcnRpYWxzLmxlbmd0aCl7dmFyIGhvbGRlcnM9cmVwbGFjZUhvbGRlcnMocGFydGlhbHMsYmluZC5wbGFjZWhvbGRlcik7Yml0bWFzayB8PSBQQVJUSUFMX0ZMQUc7fXJldHVybiBjcmVhdGVXcmFwcGVyKGZ1bmMsYml0bWFzayx0aGlzQXJnLHBhcnRpYWxzLGhvbGRlcnMpO30pO3ZhciBiaW5kS2V5PXJlc3QoZnVuY3Rpb24ob2JqZWN0LGtleSxwYXJ0aWFscyl7dmFyIGJpdG1hc2s9QklORF9GTEFHIHwgQklORF9LRVlfRkxBRztpZihwYXJ0aWFscy5sZW5ndGgpe3ZhciBob2xkZXJzPXJlcGxhY2VIb2xkZXJzKHBhcnRpYWxzLGJpbmRLZXkucGxhY2Vob2xkZXIpO2JpdG1hc2sgfD0gUEFSVElBTF9GTEFHO31yZXR1cm4gY3JlYXRlV3JhcHBlcihrZXksYml0bWFzayxvYmplY3QscGFydGlhbHMsaG9sZGVycyk7fSk7ZnVuY3Rpb24gY3VycnkoZnVuYyxhcml0eSxndWFyZCl7YXJpdHkgPSBndWFyZD91bmRlZmluZWQ6YXJpdHk7dmFyIHJlc3VsdD1jcmVhdGVXcmFwcGVyKGZ1bmMsQ1VSUllfRkxBRyx1bmRlZmluZWQsdW5kZWZpbmVkLHVuZGVmaW5lZCx1bmRlZmluZWQsdW5kZWZpbmVkLGFyaXR5KTtyZXN1bHQucGxhY2Vob2xkZXIgPSBjdXJyeS5wbGFjZWhvbGRlcjtyZXR1cm4gcmVzdWx0O31mdW5jdGlvbiBjdXJyeVJpZ2h0KGZ1bmMsYXJpdHksZ3VhcmQpe2FyaXR5ID0gZ3VhcmQ/dW5kZWZpbmVkOmFyaXR5O3ZhciByZXN1bHQ9Y3JlYXRlV3JhcHBlcihmdW5jLENVUlJZX1JJR0hUX0ZMQUcsdW5kZWZpbmVkLHVuZGVmaW5lZCx1bmRlZmluZWQsdW5kZWZpbmVkLHVuZGVmaW5lZCxhcml0eSk7cmVzdWx0LnBsYWNlaG9sZGVyID0gY3VycnlSaWdodC5wbGFjZWhvbGRlcjtyZXR1cm4gcmVzdWx0O31mdW5jdGlvbiBkZWJvdW5jZShmdW5jLHdhaXQsb3B0aW9ucyl7dmFyIGFyZ3MsbWF4VGltZW91dElkLHJlc3VsdCxzdGFtcCx0aGlzQXJnLHRpbWVvdXRJZCx0cmFpbGluZ0NhbGwsbGFzdENhbGxlZD0wLGxlYWRpbmc9ZmFsc2UsbWF4V2FpdD1mYWxzZSx0cmFpbGluZz10cnVlO2lmKHR5cGVvZiBmdW5jICE9IFwiZnVuY3Rpb25cIil7dGhyb3cgbmV3IFR5cGVFcnJvcihGVU5DX0VSUk9SX1RFWFQpO313YWl0ID0gdG9OdW1iZXIod2FpdCkgfHwgMDtpZihpc09iamVjdChvcHRpb25zKSl7bGVhZGluZyA9ICEhb3B0aW9ucy5sZWFkaW5nO21heFdhaXQgPSBcIm1heFdhaXRcIiBpbiBvcHRpb25zICYmIG5hdGl2ZU1heCh0b051bWJlcihvcHRpb25zLm1heFdhaXQpIHx8IDAsd2FpdCk7dHJhaWxpbmcgPSBcInRyYWlsaW5nXCIgaW4gb3B0aW9ucz8hIW9wdGlvbnMudHJhaWxpbmc6dHJhaWxpbmc7fWZ1bmN0aW9uIGNhbmNlbCgpe2lmKHRpbWVvdXRJZCl7Y2xlYXJUaW1lb3V0KHRpbWVvdXRJZCk7fWlmKG1heFRpbWVvdXRJZCl7Y2xlYXJUaW1lb3V0KG1heFRpbWVvdXRJZCk7fWxhc3RDYWxsZWQgPSAwO2FyZ3MgPSBtYXhUaW1lb3V0SWQgPSB0aGlzQXJnID0gdGltZW91dElkID0gdHJhaWxpbmdDYWxsID0gdW5kZWZpbmVkO31mdW5jdGlvbiBjb21wbGV0ZShpc0NhbGxlZCxpZCl7aWYoaWQpe2NsZWFyVGltZW91dChpZCk7fW1heFRpbWVvdXRJZCA9IHRpbWVvdXRJZCA9IHRyYWlsaW5nQ2FsbCA9IHVuZGVmaW5lZDtpZihpc0NhbGxlZCl7bGFzdENhbGxlZCA9IG5vdygpO3Jlc3VsdCA9IGZ1bmMuYXBwbHkodGhpc0FyZyxhcmdzKTtpZighdGltZW91dElkICYmICFtYXhUaW1lb3V0SWQpe2FyZ3MgPSB0aGlzQXJnID0gdW5kZWZpbmVkO319fWZ1bmN0aW9uIGRlbGF5ZWQoKXt2YXIgcmVtYWluaW5nPXdhaXQgLSAobm93KCkgLSBzdGFtcCk7aWYocmVtYWluaW5nIDw9IDAgfHwgcmVtYWluaW5nID4gd2FpdCl7Y29tcGxldGUodHJhaWxpbmdDYWxsLG1heFRpbWVvdXRJZCk7fWVsc2Uge3RpbWVvdXRJZCA9IHNldFRpbWVvdXQoZGVsYXllZCxyZW1haW5pbmcpO319ZnVuY3Rpb24gZmx1c2goKXtpZih0aW1lb3V0SWQgJiYgdHJhaWxpbmdDYWxsIHx8IG1heFRpbWVvdXRJZCAmJiB0cmFpbGluZyl7cmVzdWx0ID0gZnVuYy5hcHBseSh0aGlzQXJnLGFyZ3MpO31jYW5jZWwoKTtyZXR1cm4gcmVzdWx0O31mdW5jdGlvbiBtYXhEZWxheWVkKCl7Y29tcGxldGUodHJhaWxpbmcsdGltZW91dElkKTt9ZnVuY3Rpb24gZGVib3VuY2VkKCl7YXJncyA9IGFyZ3VtZW50cztzdGFtcCA9IG5vdygpO3RoaXNBcmcgPSB0aGlzO3RyYWlsaW5nQ2FsbCA9IHRyYWlsaW5nICYmICh0aW1lb3V0SWQgfHwgIWxlYWRpbmcpO2lmKG1heFdhaXQgPT09IGZhbHNlKXt2YXIgbGVhZGluZ0NhbGw9bGVhZGluZyAmJiAhdGltZW91dElkO31lbHNlIHtpZighbWF4VGltZW91dElkICYmICFsZWFkaW5nKXtsYXN0Q2FsbGVkID0gc3RhbXA7fXZhciByZW1haW5pbmc9bWF4V2FpdCAtIChzdGFtcCAtIGxhc3RDYWxsZWQpLGlzQ2FsbGVkPXJlbWFpbmluZyA8PSAwIHx8IHJlbWFpbmluZyA+IG1heFdhaXQ7aWYoaXNDYWxsZWQpe2lmKG1heFRpbWVvdXRJZCl7bWF4VGltZW91dElkID0gY2xlYXJUaW1lb3V0KG1heFRpbWVvdXRJZCk7fWxhc3RDYWxsZWQgPSBzdGFtcDtyZXN1bHQgPSBmdW5jLmFwcGx5KHRoaXNBcmcsYXJncyk7fWVsc2UgaWYoIW1heFRpbWVvdXRJZCl7bWF4VGltZW91dElkID0gc2V0VGltZW91dChtYXhEZWxheWVkLHJlbWFpbmluZyk7fX1pZihpc0NhbGxlZCAmJiB0aW1lb3V0SWQpe3RpbWVvdXRJZCA9IGNsZWFyVGltZW91dCh0aW1lb3V0SWQpO31lbHNlIGlmKCF0aW1lb3V0SWQgJiYgd2FpdCAhPT0gbWF4V2FpdCl7dGltZW91dElkID0gc2V0VGltZW91dChkZWxheWVkLHdhaXQpO31pZihsZWFkaW5nQ2FsbCl7aXNDYWxsZWQgPSB0cnVlO3Jlc3VsdCA9IGZ1bmMuYXBwbHkodGhpc0FyZyxhcmdzKTt9aWYoaXNDYWxsZWQgJiYgIXRpbWVvdXRJZCAmJiAhbWF4VGltZW91dElkKXthcmdzID0gdGhpc0FyZyA9IHVuZGVmaW5lZDt9cmV0dXJuIHJlc3VsdDt9ZGVib3VuY2VkLmNhbmNlbCA9IGNhbmNlbDtkZWJvdW5jZWQuZmx1c2ggPSBmbHVzaDtyZXR1cm4gZGVib3VuY2VkO312YXIgZGVmZXI9cmVzdChmdW5jdGlvbihmdW5jLGFyZ3Mpe3JldHVybiBiYXNlRGVsYXkoZnVuYywxLGFyZ3MpO30pO3ZhciBkZWxheT1yZXN0KGZ1bmN0aW9uKGZ1bmMsd2FpdCxhcmdzKXtyZXR1cm4gYmFzZURlbGF5KGZ1bmMsdG9OdW1iZXIod2FpdCkgfHwgMCxhcmdzKTt9KTtmdW5jdGlvbiBmbGlwKGZ1bmMpe3JldHVybiBjcmVhdGVXcmFwcGVyKGZ1bmMsRkxJUF9GTEFHKTt9ZnVuY3Rpb24gbWVtb2l6ZShmdW5jLHJlc29sdmVyKXtpZih0eXBlb2YgZnVuYyAhPSBcImZ1bmN0aW9uXCIgfHwgcmVzb2x2ZXIgJiYgdHlwZW9mIHJlc29sdmVyICE9IFwiZnVuY3Rpb25cIil7dGhyb3cgbmV3IFR5cGVFcnJvcihGVU5DX0VSUk9SX1RFWFQpO312YXIgbWVtb2l6ZWQ9ZnVuY3Rpb24gbWVtb2l6ZWQoKXt2YXIgYXJncz1hcmd1bWVudHMsa2V5PXJlc29sdmVyP3Jlc29sdmVyLmFwcGx5KHRoaXMsYXJncyk6YXJnc1swXSxjYWNoZT1tZW1vaXplZC5jYWNoZTtpZihjYWNoZS5oYXMoa2V5KSl7cmV0dXJuIGNhY2hlLmdldChrZXkpO312YXIgcmVzdWx0PWZ1bmMuYXBwbHkodGhpcyxhcmdzKTttZW1vaXplZC5jYWNoZSA9IGNhY2hlLnNldChrZXkscmVzdWx0KTtyZXR1cm4gcmVzdWx0O307bWVtb2l6ZWQuY2FjaGUgPSBuZXcgbWVtb2l6ZS5DYWNoZSgpO3JldHVybiBtZW1vaXplZDt9ZnVuY3Rpb24gbmVnYXRlKHByZWRpY2F0ZSl7aWYodHlwZW9mIHByZWRpY2F0ZSAhPSBcImZ1bmN0aW9uXCIpe3Rocm93IG5ldyBUeXBlRXJyb3IoRlVOQ19FUlJPUl9URVhUKTt9cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuICFwcmVkaWNhdGUuYXBwbHkodGhpcyxhcmd1bWVudHMpO307fWZ1bmN0aW9uIG9uY2UoZnVuYyl7cmV0dXJuIGJlZm9yZSgyLGZ1bmMpO312YXIgb3ZlckFyZ3M9cmVzdChmdW5jdGlvbihmdW5jLHRyYW5zZm9ybXMpe3RyYW5zZm9ybXMgPSBhcnJheU1hcChiYXNlRmxhdHRlbih0cmFuc2Zvcm1zKSxnZXRJdGVyYXRlZSgpKTt2YXIgZnVuY3NMZW5ndGg9dHJhbnNmb3Jtcy5sZW5ndGg7cmV0dXJuIHJlc3QoZnVuY3Rpb24oYXJncyl7dmFyIGluZGV4PS0xLGxlbmd0aD1uYXRpdmVNaW4oYXJncy5sZW5ndGgsZnVuY3NMZW5ndGgpO3doaWxlKCsraW5kZXggPCBsZW5ndGgpIHthcmdzW2luZGV4XSA9IHRyYW5zZm9ybXNbaW5kZXhdLmNhbGwodGhpcyxhcmdzW2luZGV4XSk7fXJldHVybiBhcHBseShmdW5jLHRoaXMsYXJncyk7fSk7fSk7dmFyIHBhcnRpYWw9cmVzdChmdW5jdGlvbihmdW5jLHBhcnRpYWxzKXt2YXIgaG9sZGVycz1yZXBsYWNlSG9sZGVycyhwYXJ0aWFscyxwYXJ0aWFsLnBsYWNlaG9sZGVyKTtyZXR1cm4gY3JlYXRlV3JhcHBlcihmdW5jLFBBUlRJQUxfRkxBRyx1bmRlZmluZWQscGFydGlhbHMsaG9sZGVycyk7fSk7dmFyIHBhcnRpYWxSaWdodD1yZXN0KGZ1bmN0aW9uKGZ1bmMscGFydGlhbHMpe3ZhciBob2xkZXJzPXJlcGxhY2VIb2xkZXJzKHBhcnRpYWxzLHBhcnRpYWxSaWdodC5wbGFjZWhvbGRlcik7cmV0dXJuIGNyZWF0ZVdyYXBwZXIoZnVuYyxQQVJUSUFMX1JJR0hUX0ZMQUcsdW5kZWZpbmVkLHBhcnRpYWxzLGhvbGRlcnMpO30pO3ZhciByZWFyZz1yZXN0KGZ1bmN0aW9uKGZ1bmMsaW5kZXhlcyl7cmV0dXJuIGNyZWF0ZVdyYXBwZXIoZnVuYyxSRUFSR19GTEFHLHVuZGVmaW5lZCx1bmRlZmluZWQsdW5kZWZpbmVkLGJhc2VGbGF0dGVuKGluZGV4ZXMpKTt9KTtmdW5jdGlvbiByZXN0KGZ1bmMsc3RhcnQpe2lmKHR5cGVvZiBmdW5jICE9IFwiZnVuY3Rpb25cIil7dGhyb3cgbmV3IFR5cGVFcnJvcihGVU5DX0VSUk9SX1RFWFQpO31zdGFydCA9IG5hdGl2ZU1heChzdGFydCA9PT0gdW5kZWZpbmVkP2Z1bmMubGVuZ3RoIC0gMTp0b0ludGVnZXIoc3RhcnQpLDApO3JldHVybiBmdW5jdGlvbigpe3ZhciBhcmdzPWFyZ3VtZW50cyxpbmRleD0tMSxsZW5ndGg9bmF0aXZlTWF4KGFyZ3MubGVuZ3RoIC0gc3RhcnQsMCksYXJyYXk9QXJyYXkobGVuZ3RoKTt3aGlsZSgrK2luZGV4IDwgbGVuZ3RoKSB7YXJyYXlbaW5kZXhdID0gYXJnc1tzdGFydCArIGluZGV4XTt9c3dpdGNoKHN0YXJ0KXtjYXNlIDA6cmV0dXJuIGZ1bmMuY2FsbCh0aGlzLGFycmF5KTtjYXNlIDE6cmV0dXJuIGZ1bmMuY2FsbCh0aGlzLGFyZ3NbMF0sYXJyYXkpO2Nhc2UgMjpyZXR1cm4gZnVuYy5jYWxsKHRoaXMsYXJnc1swXSxhcmdzWzFdLGFycmF5KTt9dmFyIG90aGVyQXJncz1BcnJheShzdGFydCArIDEpO2luZGV4ID0gLTE7d2hpbGUoKytpbmRleCA8IHN0YXJ0KSB7b3RoZXJBcmdzW2luZGV4XSA9IGFyZ3NbaW5kZXhdO31vdGhlckFyZ3Nbc3RhcnRdID0gYXJyYXk7cmV0dXJuIGFwcGx5KGZ1bmMsdGhpcyxvdGhlckFyZ3MpO307fWZ1bmN0aW9uIHNwcmVhZChmdW5jLHN0YXJ0KXtpZih0eXBlb2YgZnVuYyAhPSBcImZ1bmN0aW9uXCIpe3Rocm93IG5ldyBUeXBlRXJyb3IoRlVOQ19FUlJPUl9URVhUKTt9c3RhcnQgPSBzdGFydCA9PT0gdW5kZWZpbmVkPzA6bmF0aXZlTWF4KHRvSW50ZWdlcihzdGFydCksMCk7cmV0dXJuIHJlc3QoZnVuY3Rpb24oYXJncyl7dmFyIGFycmF5PWFyZ3Nbc3RhcnRdLG90aGVyQXJncz1hcmdzLnNsaWNlKDAsc3RhcnQpO2lmKGFycmF5KXthcnJheVB1c2gob3RoZXJBcmdzLGFycmF5KTt9cmV0dXJuIGFwcGx5KGZ1bmMsdGhpcyxvdGhlckFyZ3MpO30pO31mdW5jdGlvbiB0aHJvdHRsZShmdW5jLHdhaXQsb3B0aW9ucyl7dmFyIGxlYWRpbmc9dHJ1ZSx0cmFpbGluZz10cnVlO2lmKHR5cGVvZiBmdW5jICE9IFwiZnVuY3Rpb25cIil7dGhyb3cgbmV3IFR5cGVFcnJvcihGVU5DX0VSUk9SX1RFWFQpO31pZihpc09iamVjdChvcHRpb25zKSl7bGVhZGluZyA9IFwibGVhZGluZ1wiIGluIG9wdGlvbnM/ISFvcHRpb25zLmxlYWRpbmc6bGVhZGluZzt0cmFpbGluZyA9IFwidHJhaWxpbmdcIiBpbiBvcHRpb25zPyEhb3B0aW9ucy50cmFpbGluZzp0cmFpbGluZzt9cmV0dXJuIGRlYm91bmNlKGZ1bmMsd2FpdCx7bGVhZGluZzpsZWFkaW5nLG1heFdhaXQ6d2FpdCx0cmFpbGluZzp0cmFpbGluZ30pO31mdW5jdGlvbiB1bmFyeShmdW5jKXtyZXR1cm4gYXJ5KGZ1bmMsMSk7fWZ1bmN0aW9uIHdyYXAodmFsdWUsd3JhcHBlcil7d3JhcHBlciA9IHdyYXBwZXIgPT0gbnVsbD9pZGVudGl0eTp3cmFwcGVyO3JldHVybiBwYXJ0aWFsKHdyYXBwZXIsdmFsdWUpO31mdW5jdGlvbiBjbG9uZSh2YWx1ZSl7cmV0dXJuIGJhc2VDbG9uZSh2YWx1ZSk7fWZ1bmN0aW9uIGNsb25lV2l0aCh2YWx1ZSxjdXN0b21pemVyKXtyZXR1cm4gYmFzZUNsb25lKHZhbHVlLGZhbHNlLGN1c3RvbWl6ZXIpO31mdW5jdGlvbiBjbG9uZURlZXAodmFsdWUpe3JldHVybiBiYXNlQ2xvbmUodmFsdWUsdHJ1ZSk7fWZ1bmN0aW9uIGNsb25lRGVlcFdpdGgodmFsdWUsY3VzdG9taXplcil7cmV0dXJuIGJhc2VDbG9uZSh2YWx1ZSx0cnVlLGN1c3RvbWl6ZXIpO31mdW5jdGlvbiBlcSh2YWx1ZSxvdGhlcil7cmV0dXJuIHZhbHVlID09PSBvdGhlciB8fCB2YWx1ZSAhPT0gdmFsdWUgJiYgb3RoZXIgIT09IG90aGVyO31mdW5jdGlvbiBndCh2YWx1ZSxvdGhlcil7cmV0dXJuIHZhbHVlID4gb3RoZXI7fWZ1bmN0aW9uIGd0ZSh2YWx1ZSxvdGhlcil7cmV0dXJuIHZhbHVlID49IG90aGVyO31mdW5jdGlvbiBpc0FyZ3VtZW50cyh2YWx1ZSl7cmV0dXJuIGlzQXJyYXlMaWtlT2JqZWN0KHZhbHVlKSAmJiBoYXNPd25Qcm9wZXJ0eS5jYWxsKHZhbHVlLFwiY2FsbGVlXCIpICYmICghcHJvcGVydHlJc0VudW1lcmFibGUuY2FsbCh2YWx1ZSxcImNhbGxlZVwiKSB8fCBvYmplY3RUb1N0cmluZy5jYWxsKHZhbHVlKSA9PSBhcmdzVGFnKTt9dmFyIGlzQXJyYXk9QXJyYXkuaXNBcnJheTtmdW5jdGlvbiBpc0FycmF5TGlrZSh2YWx1ZSl7cmV0dXJuIHZhbHVlICE9IG51bGwgJiYgISh0eXBlb2YgdmFsdWUgPT0gXCJmdW5jdGlvblwiICYmIGlzRnVuY3Rpb24odmFsdWUpKSAmJiBpc0xlbmd0aChnZXRMZW5ndGgodmFsdWUpKTt9ZnVuY3Rpb24gaXNBcnJheUxpa2VPYmplY3QodmFsdWUpe3JldHVybiBpc09iamVjdExpa2UodmFsdWUpICYmIGlzQXJyYXlMaWtlKHZhbHVlKTt9ZnVuY3Rpb24gaXNCb29sZWFuKHZhbHVlKXtyZXR1cm4gdmFsdWUgPT09IHRydWUgfHwgdmFsdWUgPT09IGZhbHNlIHx8IGlzT2JqZWN0TGlrZSh2YWx1ZSkgJiYgb2JqZWN0VG9TdHJpbmcuY2FsbCh2YWx1ZSkgPT0gYm9vbFRhZzt9ZnVuY3Rpb24gaXNEYXRlKHZhbHVlKXtyZXR1cm4gaXNPYmplY3RMaWtlKHZhbHVlKSAmJiBvYmplY3RUb1N0cmluZy5jYWxsKHZhbHVlKSA9PSBkYXRlVGFnO31mdW5jdGlvbiBpc0VsZW1lbnQodmFsdWUpe3JldHVybiAhIXZhbHVlICYmIHZhbHVlLm5vZGVUeXBlID09PSAxICYmIGlzT2JqZWN0TGlrZSh2YWx1ZSkgJiYgIWlzUGxhaW5PYmplY3QodmFsdWUpO31mdW5jdGlvbiBpc0VtcHR5KHZhbHVlKXtpZihpc0FycmF5TGlrZSh2YWx1ZSkgJiYgKGlzQXJyYXkodmFsdWUpIHx8IGlzU3RyaW5nKHZhbHVlKSB8fCBpc0Z1bmN0aW9uKHZhbHVlLnNwbGljZSkgfHwgaXNBcmd1bWVudHModmFsdWUpKSl7cmV0dXJuICF2YWx1ZS5sZW5ndGg7fWZvcih2YXIga2V5IGluIHZhbHVlKSB7aWYoaGFzT3duUHJvcGVydHkuY2FsbCh2YWx1ZSxrZXkpKXtyZXR1cm4gZmFsc2U7fX1yZXR1cm4gdHJ1ZTt9ZnVuY3Rpb24gaXNFcXVhbCh2YWx1ZSxvdGhlcil7cmV0dXJuIGJhc2VJc0VxdWFsKHZhbHVlLG90aGVyKTt9ZnVuY3Rpb24gaXNFcXVhbFdpdGgodmFsdWUsb3RoZXIsY3VzdG9taXplcil7Y3VzdG9taXplciA9IHR5cGVvZiBjdXN0b21pemVyID09IFwiZnVuY3Rpb25cIj9jdXN0b21pemVyOnVuZGVmaW5lZDt2YXIgcmVzdWx0PWN1c3RvbWl6ZXI/Y3VzdG9taXplcih2YWx1ZSxvdGhlcik6dW5kZWZpbmVkO3JldHVybiByZXN1bHQgPT09IHVuZGVmaW5lZD9iYXNlSXNFcXVhbCh2YWx1ZSxvdGhlcixjdXN0b21pemVyKTohIXJlc3VsdDt9ZnVuY3Rpb24gaXNFcnJvcih2YWx1ZSl7cmV0dXJuIGlzT2JqZWN0TGlrZSh2YWx1ZSkgJiYgdHlwZW9mIHZhbHVlLm1lc3NhZ2UgPT0gXCJzdHJpbmdcIiAmJiBvYmplY3RUb1N0cmluZy5jYWxsKHZhbHVlKSA9PSBlcnJvclRhZzt9ZnVuY3Rpb24gaXNGaW5pdGUodmFsdWUpe3JldHVybiB0eXBlb2YgdmFsdWUgPT0gXCJudW1iZXJcIiAmJiBuYXRpdmVJc0Zpbml0ZSh2YWx1ZSk7fWZ1bmN0aW9uIGlzRnVuY3Rpb24odmFsdWUpe3ZhciB0YWc9aXNPYmplY3QodmFsdWUpP29iamVjdFRvU3RyaW5nLmNhbGwodmFsdWUpOlwiXCI7cmV0dXJuIHRhZyA9PSBmdW5jVGFnIHx8IHRhZyA9PSBnZW5UYWc7fWZ1bmN0aW9uIGlzSW50ZWdlcih2YWx1ZSl7cmV0dXJuIHR5cGVvZiB2YWx1ZSA9PSBcIm51bWJlclwiICYmIHZhbHVlID09IHRvSW50ZWdlcih2YWx1ZSk7fWZ1bmN0aW9uIGlzTGVuZ3RoKHZhbHVlKXtyZXR1cm4gdHlwZW9mIHZhbHVlID09IFwibnVtYmVyXCIgJiYgdmFsdWUgPiAtMSAmJiB2YWx1ZSAlIDEgPT0gMCAmJiB2YWx1ZSA8PSBNQVhfU0FGRV9JTlRFR0VSO31mdW5jdGlvbiBpc09iamVjdCh2YWx1ZSl7dmFyIHR5cGU9dHlwZW9mIHZhbHVlO3JldHVybiAhIXZhbHVlICYmICh0eXBlID09IFwib2JqZWN0XCIgfHwgdHlwZSA9PSBcImZ1bmN0aW9uXCIpO31mdW5jdGlvbiBpc09iamVjdExpa2UodmFsdWUpe3JldHVybiAhIXZhbHVlICYmIHR5cGVvZiB2YWx1ZSA9PSBcIm9iamVjdFwiO31mdW5jdGlvbiBpc01hdGNoKG9iamVjdCxzb3VyY2Upe3JldHVybiBvYmplY3QgPT09IHNvdXJjZSB8fCBiYXNlSXNNYXRjaChvYmplY3Qsc291cmNlLGdldE1hdGNoRGF0YShzb3VyY2UpKTt9ZnVuY3Rpb24gaXNNYXRjaFdpdGgob2JqZWN0LHNvdXJjZSxjdXN0b21pemVyKXtjdXN0b21pemVyID0gdHlwZW9mIGN1c3RvbWl6ZXIgPT0gXCJmdW5jdGlvblwiP2N1c3RvbWl6ZXI6dW5kZWZpbmVkO3JldHVybiBiYXNlSXNNYXRjaChvYmplY3Qsc291cmNlLGdldE1hdGNoRGF0YShzb3VyY2UpLGN1c3RvbWl6ZXIpO31mdW5jdGlvbiBpc05hTih2YWx1ZSl7cmV0dXJuIGlzTnVtYmVyKHZhbHVlKSAmJiB2YWx1ZSAhPSArdmFsdWU7fWZ1bmN0aW9uIGlzTmF0aXZlKHZhbHVlKXtpZih2YWx1ZSA9PSBudWxsKXtyZXR1cm4gZmFsc2U7fWlmKGlzRnVuY3Rpb24odmFsdWUpKXtyZXR1cm4gcmVJc05hdGl2ZS50ZXN0KGZ1bmNUb1N0cmluZy5jYWxsKHZhbHVlKSk7fXJldHVybiBpc09iamVjdExpa2UodmFsdWUpICYmIChpc0hvc3RPYmplY3QodmFsdWUpP3JlSXNOYXRpdmU6cmVJc0hvc3RDdG9yKS50ZXN0KHZhbHVlKTt9ZnVuY3Rpb24gaXNOdWxsKHZhbHVlKXtyZXR1cm4gdmFsdWUgPT09IG51bGw7fWZ1bmN0aW9uIGlzTmlsKHZhbHVlKXtyZXR1cm4gdmFsdWUgPT0gbnVsbDt9ZnVuY3Rpb24gaXNOdW1iZXIodmFsdWUpe3JldHVybiB0eXBlb2YgdmFsdWUgPT0gXCJudW1iZXJcIiB8fCBpc09iamVjdExpa2UodmFsdWUpICYmIG9iamVjdFRvU3RyaW5nLmNhbGwodmFsdWUpID09IG51bWJlclRhZzt9ZnVuY3Rpb24gaXNQbGFpbk9iamVjdCh2YWx1ZSl7aWYoIWlzT2JqZWN0TGlrZSh2YWx1ZSkgfHwgb2JqZWN0VG9TdHJpbmcuY2FsbCh2YWx1ZSkgIT0gb2JqZWN0VGFnIHx8IGlzSG9zdE9iamVjdCh2YWx1ZSkpe3JldHVybiBmYWxzZTt9dmFyIHByb3RvPW9iamVjdFByb3RvO2lmKHR5cGVvZiB2YWx1ZS5jb25zdHJ1Y3RvciA9PSBcImZ1bmN0aW9uXCIpe3Byb3RvID0gZ2V0UHJvdG90eXBlT2YodmFsdWUpO31pZihwcm90byA9PT0gbnVsbCl7cmV0dXJuIHRydWU7fXZhciBDdG9yPXByb3RvLmNvbnN0cnVjdG9yO3JldHVybiB0eXBlb2YgQ3RvciA9PSBcImZ1bmN0aW9uXCIgJiYgQ3RvciBpbnN0YW5jZW9mIEN0b3IgJiYgZnVuY1RvU3RyaW5nLmNhbGwoQ3RvcikgPT0gb2JqZWN0Q3RvclN0cmluZzt9ZnVuY3Rpb24gaXNSZWdFeHAodmFsdWUpe3JldHVybiBpc09iamVjdCh2YWx1ZSkgJiYgb2JqZWN0VG9TdHJpbmcuY2FsbCh2YWx1ZSkgPT0gcmVnZXhwVGFnO31mdW5jdGlvbiBpc1NhZmVJbnRlZ2VyKHZhbHVlKXtyZXR1cm4gaXNJbnRlZ2VyKHZhbHVlKSAmJiB2YWx1ZSA+PSAtTUFYX1NBRkVfSU5URUdFUiAmJiB2YWx1ZSA8PSBNQVhfU0FGRV9JTlRFR0VSO31mdW5jdGlvbiBpc1N0cmluZyh2YWx1ZSl7cmV0dXJuIHR5cGVvZiB2YWx1ZSA9PSBcInN0cmluZ1wiIHx8ICFpc0FycmF5KHZhbHVlKSAmJiBpc09iamVjdExpa2UodmFsdWUpICYmIG9iamVjdFRvU3RyaW5nLmNhbGwodmFsdWUpID09IHN0cmluZ1RhZzt9ZnVuY3Rpb24gaXNTeW1ib2wodmFsdWUpe3JldHVybiB0eXBlb2YgdmFsdWUgPT0gXCJzeW1ib2xcIiB8fCBpc09iamVjdExpa2UodmFsdWUpICYmIG9iamVjdFRvU3RyaW5nLmNhbGwodmFsdWUpID09IHN5bWJvbFRhZzt9ZnVuY3Rpb24gaXNUeXBlZEFycmF5KHZhbHVlKXtyZXR1cm4gaXNPYmplY3RMaWtlKHZhbHVlKSAmJiBpc0xlbmd0aCh2YWx1ZS5sZW5ndGgpICYmICEhdHlwZWRBcnJheVRhZ3Nbb2JqZWN0VG9TdHJpbmcuY2FsbCh2YWx1ZSldO31mdW5jdGlvbiBpc1VuZGVmaW5lZCh2YWx1ZSl7cmV0dXJuIHZhbHVlID09PSB1bmRlZmluZWQ7fWZ1bmN0aW9uIGx0KHZhbHVlLG90aGVyKXtyZXR1cm4gdmFsdWUgPCBvdGhlcjt9ZnVuY3Rpb24gbHRlKHZhbHVlLG90aGVyKXtyZXR1cm4gdmFsdWUgPD0gb3RoZXI7fWZ1bmN0aW9uIHRvQXJyYXkodmFsdWUpe2lmKCF2YWx1ZSl7cmV0dXJuIFtdO31pZihpc0FycmF5TGlrZSh2YWx1ZSkpe3JldHVybiBpc1N0cmluZyh2YWx1ZSk/c3RyaW5nVG9BcnJheSh2YWx1ZSk6Y29weUFycmF5KHZhbHVlKTt9aWYoaXRlcmF0b3JTeW1ib2wgJiYgdmFsdWVbaXRlcmF0b3JTeW1ib2xdKXtyZXR1cm4gaXRlcmF0b3JUb0FycmF5KHZhbHVlW2l0ZXJhdG9yU3ltYm9sXSgpKTt9dmFyIHRhZz1nZXRUYWcodmFsdWUpLGZ1bmM9dGFnID09IG1hcFRhZz9tYXBUb0FycmF5OnRhZyA9PSBzZXRUYWc/c2V0VG9BcnJheTp2YWx1ZXM7cmV0dXJuIGZ1bmModmFsdWUpO31mdW5jdGlvbiB0b0ludGVnZXIodmFsdWUpe2lmKCF2YWx1ZSl7cmV0dXJuIHZhbHVlID09PSAwP3ZhbHVlOjA7fXZhbHVlID0gdG9OdW1iZXIodmFsdWUpO2lmKHZhbHVlID09PSBJTkZJTklUWSB8fCB2YWx1ZSA9PT0gLUlORklOSVRZKXt2YXIgc2lnbj12YWx1ZSA8IDA/LTE6MTtyZXR1cm4gc2lnbiAqIE1BWF9JTlRFR0VSO312YXIgcmVtYWluZGVyPXZhbHVlICUgMTtyZXR1cm4gdmFsdWUgPT09IHZhbHVlP3JlbWFpbmRlcj92YWx1ZSAtIHJlbWFpbmRlcjp2YWx1ZTowO31mdW5jdGlvbiB0b0xlbmd0aCh2YWx1ZSl7cmV0dXJuIHZhbHVlP2Jhc2VDbGFtcCh0b0ludGVnZXIodmFsdWUpLDAsTUFYX0FSUkFZX0xFTkdUSCk6MDt9ZnVuY3Rpb24gdG9OdW1iZXIodmFsdWUpe2lmKGlzT2JqZWN0KHZhbHVlKSl7dmFyIG90aGVyPWlzRnVuY3Rpb24odmFsdWUudmFsdWVPZik/dmFsdWUudmFsdWVPZigpOnZhbHVlO3ZhbHVlID0gaXNPYmplY3Qob3RoZXIpP290aGVyICsgXCJcIjpvdGhlcjt9aWYodHlwZW9mIHZhbHVlICE9IFwic3RyaW5nXCIpe3JldHVybiB2YWx1ZSA9PT0gMD92YWx1ZTordmFsdWU7fXZhbHVlID0gdmFsdWUucmVwbGFjZShyZVRyaW0sXCJcIik7dmFyIGlzQmluYXJ5PXJlSXNCaW5hcnkudGVzdCh2YWx1ZSk7cmV0dXJuIGlzQmluYXJ5IHx8IHJlSXNPY3RhbC50ZXN0KHZhbHVlKT9mcmVlUGFyc2VJbnQodmFsdWUuc2xpY2UoMiksaXNCaW5hcnk/Mjo4KTpyZUlzQmFkSGV4LnRlc3QodmFsdWUpP05BTjordmFsdWU7fWZ1bmN0aW9uIHRvUGxhaW5PYmplY3QodmFsdWUpe3JldHVybiBjb3B5T2JqZWN0KHZhbHVlLGtleXNJbih2YWx1ZSkpO31mdW5jdGlvbiB0b1NhZmVJbnRlZ2VyKHZhbHVlKXtyZXR1cm4gYmFzZUNsYW1wKHRvSW50ZWdlcih2YWx1ZSksLU1BWF9TQUZFX0lOVEVHRVIsTUFYX1NBRkVfSU5URUdFUik7fWZ1bmN0aW9uIHRvU3RyaW5nKHZhbHVlKXtpZih0eXBlb2YgdmFsdWUgPT0gXCJzdHJpbmdcIil7cmV0dXJuIHZhbHVlO31pZih2YWx1ZSA9PSBudWxsKXtyZXR1cm4gXCJcIjt9aWYoaXNTeW1ib2wodmFsdWUpKXtyZXR1cm4gU3ltYm9sP3N5bWJvbFRvU3RyaW5nLmNhbGwodmFsdWUpOlwiXCI7fXZhciByZXN1bHQ9dmFsdWUgKyBcIlwiO3JldHVybiByZXN1bHQgPT0gXCIwXCIgJiYgMSAvIHZhbHVlID09IC1JTkZJTklUWT9cIi0wXCI6cmVzdWx0O312YXIgYXNzaWduPWNyZWF0ZUFzc2lnbmVyKGZ1bmN0aW9uKG9iamVjdCxzb3VyY2Upe2NvcHlPYmplY3Qoc291cmNlLGtleXMoc291cmNlKSxvYmplY3QpO30pO3ZhciBhc3NpZ25Jbj1jcmVhdGVBc3NpZ25lcihmdW5jdGlvbihvYmplY3Qsc291cmNlKXtjb3B5T2JqZWN0KHNvdXJjZSxrZXlzSW4oc291cmNlKSxvYmplY3QpO30pO3ZhciBhc3NpZ25JbldpdGg9Y3JlYXRlQXNzaWduZXIoZnVuY3Rpb24ob2JqZWN0LHNvdXJjZSxzcmNJbmRleCxjdXN0b21pemVyKXtjb3B5T2JqZWN0V2l0aChzb3VyY2Usa2V5c0luKHNvdXJjZSksb2JqZWN0LGN1c3RvbWl6ZXIpO30pO3ZhciBhc3NpZ25XaXRoPWNyZWF0ZUFzc2lnbmVyKGZ1bmN0aW9uKG9iamVjdCxzb3VyY2Usc3JjSW5kZXgsY3VzdG9taXplcil7Y29weU9iamVjdFdpdGgoc291cmNlLGtleXMoc291cmNlKSxvYmplY3QsY3VzdG9taXplcik7fSk7dmFyIGF0PXJlc3QoZnVuY3Rpb24ob2JqZWN0LHBhdGhzKXtyZXR1cm4gYmFzZUF0KG9iamVjdCxiYXNlRmxhdHRlbihwYXRocykpO30pO2Z1bmN0aW9uIGNyZWF0ZShwcm90b3R5cGUscHJvcGVydGllcyl7dmFyIHJlc3VsdD1iYXNlQ3JlYXRlKHByb3RvdHlwZSk7cmV0dXJuIHByb3BlcnRpZXM/YmFzZUFzc2lnbihyZXN1bHQscHJvcGVydGllcyk6cmVzdWx0O312YXIgZGVmYXVsdHM9cmVzdChmdW5jdGlvbihhcmdzKXthcmdzLnB1c2godW5kZWZpbmVkLGFzc2lnbkluRGVmYXVsdHMpO3JldHVybiBhcHBseShhc3NpZ25JbldpdGgsdW5kZWZpbmVkLGFyZ3MpO30pO3ZhciBkZWZhdWx0c0RlZXA9cmVzdChmdW5jdGlvbihhcmdzKXthcmdzLnB1c2godW5kZWZpbmVkLG1lcmdlRGVmYXVsdHMpO3JldHVybiBhcHBseShtZXJnZVdpdGgsdW5kZWZpbmVkLGFyZ3MpO30pO2Z1bmN0aW9uIGZpbmRLZXkob2JqZWN0LHByZWRpY2F0ZSl7cmV0dXJuIGJhc2VGaW5kKG9iamVjdCxnZXRJdGVyYXRlZShwcmVkaWNhdGUsMyksYmFzZUZvck93bix0cnVlKTt9ZnVuY3Rpb24gZmluZExhc3RLZXkob2JqZWN0LHByZWRpY2F0ZSl7cmV0dXJuIGJhc2VGaW5kKG9iamVjdCxnZXRJdGVyYXRlZShwcmVkaWNhdGUsMyksYmFzZUZvck93blJpZ2h0LHRydWUpO31mdW5jdGlvbiBmb3JJbihvYmplY3QsaXRlcmF0ZWUpe3JldHVybiBvYmplY3QgPT0gbnVsbD9vYmplY3Q6YmFzZUZvcihvYmplY3QsdG9GdW5jdGlvbihpdGVyYXRlZSksa2V5c0luKTt9ZnVuY3Rpb24gZm9ySW5SaWdodChvYmplY3QsaXRlcmF0ZWUpe3JldHVybiBvYmplY3QgPT0gbnVsbD9vYmplY3Q6YmFzZUZvclJpZ2h0KG9iamVjdCx0b0Z1bmN0aW9uKGl0ZXJhdGVlKSxrZXlzSW4pO31mdW5jdGlvbiBmb3JPd24ob2JqZWN0LGl0ZXJhdGVlKXtyZXR1cm4gb2JqZWN0ICYmIGJhc2VGb3JPd24ob2JqZWN0LHRvRnVuY3Rpb24oaXRlcmF0ZWUpKTt9ZnVuY3Rpb24gZm9yT3duUmlnaHQob2JqZWN0LGl0ZXJhdGVlKXtyZXR1cm4gb2JqZWN0ICYmIGJhc2VGb3JPd25SaWdodChvYmplY3QsdG9GdW5jdGlvbihpdGVyYXRlZSkpO31mdW5jdGlvbiBmdW5jdGlvbnMob2JqZWN0KXtyZXR1cm4gb2JqZWN0ID09IG51bGw/W106YmFzZUZ1bmN0aW9ucyhvYmplY3Qsa2V5cyhvYmplY3QpKTt9ZnVuY3Rpb24gZnVuY3Rpb25zSW4ob2JqZWN0KXtyZXR1cm4gb2JqZWN0ID09IG51bGw/W106YmFzZUZ1bmN0aW9ucyhvYmplY3Qsa2V5c0luKG9iamVjdCkpO31mdW5jdGlvbiBnZXQob2JqZWN0LHBhdGgsZGVmYXVsdFZhbHVlKXt2YXIgcmVzdWx0PW9iamVjdCA9PSBudWxsP3VuZGVmaW5lZDpiYXNlR2V0KG9iamVjdCxwYXRoKTtyZXR1cm4gcmVzdWx0ID09PSB1bmRlZmluZWQ/ZGVmYXVsdFZhbHVlOnJlc3VsdDt9ZnVuY3Rpb24gaGFzKG9iamVjdCxwYXRoKXtyZXR1cm4gaGFzUGF0aChvYmplY3QscGF0aCxiYXNlSGFzKTt9ZnVuY3Rpb24gaGFzSW4ob2JqZWN0LHBhdGgpe3JldHVybiBoYXNQYXRoKG9iamVjdCxwYXRoLGJhc2VIYXNJbik7fXZhciBpbnZlcnQ9Y3JlYXRlSW52ZXJ0ZXIoZnVuY3Rpb24ocmVzdWx0LHZhbHVlLGtleSl7cmVzdWx0W3ZhbHVlXSA9IGtleTt9LGNvbnN0YW50KGlkZW50aXR5KSk7dmFyIGludmVydEJ5PWNyZWF0ZUludmVydGVyKGZ1bmN0aW9uKHJlc3VsdCx2YWx1ZSxrZXkpe2lmKGhhc093blByb3BlcnR5LmNhbGwocmVzdWx0LHZhbHVlKSl7cmVzdWx0W3ZhbHVlXS5wdXNoKGtleSk7fWVsc2Uge3Jlc3VsdFt2YWx1ZV0gPSBba2V5XTt9fSxnZXRJdGVyYXRlZSk7dmFyIGludm9rZT1yZXN0KGJhc2VJbnZva2UpO2Z1bmN0aW9uIGtleXMob2JqZWN0KXt2YXIgaXNQcm90bz1pc1Byb3RvdHlwZShvYmplY3QpO2lmKCEoaXNQcm90byB8fCBpc0FycmF5TGlrZShvYmplY3QpKSl7cmV0dXJuIGJhc2VLZXlzKG9iamVjdCk7fXZhciBpbmRleGVzPWluZGV4S2V5cyhvYmplY3QpLHNraXBJbmRleGVzPSEhaW5kZXhlcyxyZXN1bHQ9aW5kZXhlcyB8fCBbXSxsZW5ndGg9cmVzdWx0Lmxlbmd0aDtmb3IodmFyIGtleSBpbiBvYmplY3QpIHtpZihiYXNlSGFzKG9iamVjdCxrZXkpICYmICEoc2tpcEluZGV4ZXMgJiYgKGtleSA9PSBcImxlbmd0aFwiIHx8IGlzSW5kZXgoa2V5LGxlbmd0aCkpKSAmJiAhKGlzUHJvdG8gJiYga2V5ID09IFwiY29uc3RydWN0b3JcIikpe3Jlc3VsdC5wdXNoKGtleSk7fX1yZXR1cm4gcmVzdWx0O31mdW5jdGlvbiBrZXlzSW4ob2JqZWN0KXt2YXIgaW5kZXg9LTEsaXNQcm90bz1pc1Byb3RvdHlwZShvYmplY3QpLHByb3BzPWJhc2VLZXlzSW4ob2JqZWN0KSxwcm9wc0xlbmd0aD1wcm9wcy5sZW5ndGgsaW5kZXhlcz1pbmRleEtleXMob2JqZWN0KSxza2lwSW5kZXhlcz0hIWluZGV4ZXMscmVzdWx0PWluZGV4ZXMgfHwgW10sbGVuZ3RoPXJlc3VsdC5sZW5ndGg7d2hpbGUoKytpbmRleCA8IHByb3BzTGVuZ3RoKSB7dmFyIGtleT1wcm9wc1tpbmRleF07aWYoIShza2lwSW5kZXhlcyAmJiAoa2V5ID09IFwibGVuZ3RoXCIgfHwgaXNJbmRleChrZXksbGVuZ3RoKSkpICYmICEoa2V5ID09IFwiY29uc3RydWN0b3JcIiAmJiAoaXNQcm90byB8fCAhaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3Qsa2V5KSkpKXtyZXN1bHQucHVzaChrZXkpO319cmV0dXJuIHJlc3VsdDt9ZnVuY3Rpb24gbWFwS2V5cyhvYmplY3QsaXRlcmF0ZWUpe3ZhciByZXN1bHQ9e307aXRlcmF0ZWUgPSBnZXRJdGVyYXRlZShpdGVyYXRlZSwzKTtiYXNlRm9yT3duKG9iamVjdCxmdW5jdGlvbih2YWx1ZSxrZXksb2JqZWN0KXtyZXN1bHRbaXRlcmF0ZWUodmFsdWUsa2V5LG9iamVjdCldID0gdmFsdWU7fSk7cmV0dXJuIHJlc3VsdDt9ZnVuY3Rpb24gbWFwVmFsdWVzKG9iamVjdCxpdGVyYXRlZSl7dmFyIHJlc3VsdD17fTtpdGVyYXRlZSA9IGdldEl0ZXJhdGVlKGl0ZXJhdGVlLDMpO2Jhc2VGb3JPd24ob2JqZWN0LGZ1bmN0aW9uKHZhbHVlLGtleSxvYmplY3Qpe3Jlc3VsdFtrZXldID0gaXRlcmF0ZWUodmFsdWUsa2V5LG9iamVjdCk7fSk7cmV0dXJuIHJlc3VsdDt9dmFyIG1lcmdlPWNyZWF0ZUFzc2lnbmVyKGZ1bmN0aW9uKG9iamVjdCxzb3VyY2Usc3JjSW5kZXgpe2Jhc2VNZXJnZShvYmplY3Qsc291cmNlLHNyY0luZGV4KTt9KTt2YXIgbWVyZ2VXaXRoPWNyZWF0ZUFzc2lnbmVyKGZ1bmN0aW9uKG9iamVjdCxzb3VyY2Usc3JjSW5kZXgsY3VzdG9taXplcil7YmFzZU1lcmdlKG9iamVjdCxzb3VyY2Usc3JjSW5kZXgsY3VzdG9taXplcik7fSk7dmFyIG9taXQ9cmVzdChmdW5jdGlvbihvYmplY3QscHJvcHMpe2lmKG9iamVjdCA9PSBudWxsKXtyZXR1cm4ge307fXByb3BzID0gYXJyYXlNYXAoYmFzZUZsYXR0ZW4ocHJvcHMpLFN0cmluZyk7cmV0dXJuIGJhc2VQaWNrKG9iamVjdCxiYXNlRGlmZmVyZW5jZShrZXlzSW4ob2JqZWN0KSxwcm9wcykpO30pO2Z1bmN0aW9uIG9taXRCeShvYmplY3QscHJlZGljYXRlKXtwcmVkaWNhdGUgPSBnZXRJdGVyYXRlZShwcmVkaWNhdGUsMik7cmV0dXJuIGJhc2VQaWNrQnkob2JqZWN0LGZ1bmN0aW9uKHZhbHVlLGtleSl7cmV0dXJuICFwcmVkaWNhdGUodmFsdWUsa2V5KTt9KTt9dmFyIHBpY2s9cmVzdChmdW5jdGlvbihvYmplY3QscHJvcHMpe3JldHVybiBvYmplY3QgPT0gbnVsbD97fTpiYXNlUGljayhvYmplY3QsYmFzZUZsYXR0ZW4ocHJvcHMpKTt9KTtmdW5jdGlvbiBwaWNrQnkob2JqZWN0LHByZWRpY2F0ZSl7cmV0dXJuIG9iamVjdCA9PSBudWxsP3t9OmJhc2VQaWNrQnkob2JqZWN0LGdldEl0ZXJhdGVlKHByZWRpY2F0ZSwyKSk7fWZ1bmN0aW9uIHJlc3VsdChvYmplY3QscGF0aCxkZWZhdWx0VmFsdWUpe2lmKCFpc0tleShwYXRoLG9iamVjdCkpe3BhdGggPSBiYXNlVG9QYXRoKHBhdGgpO3ZhciByZXN1bHQ9Z2V0KG9iamVjdCxwYXRoKTtvYmplY3QgPSBwYXJlbnQob2JqZWN0LHBhdGgpO31lbHNlIHtyZXN1bHQgPSBvYmplY3QgPT0gbnVsbD91bmRlZmluZWQ6b2JqZWN0W3BhdGhdO31pZihyZXN1bHQgPT09IHVuZGVmaW5lZCl7cmVzdWx0ID0gZGVmYXVsdFZhbHVlO31yZXR1cm4gaXNGdW5jdGlvbihyZXN1bHQpP3Jlc3VsdC5jYWxsKG9iamVjdCk6cmVzdWx0O31mdW5jdGlvbiBzZXQob2JqZWN0LHBhdGgsdmFsdWUpe3JldHVybiBvYmplY3QgPT0gbnVsbD9vYmplY3Q6YmFzZVNldChvYmplY3QscGF0aCx2YWx1ZSk7fWZ1bmN0aW9uIHNldFdpdGgob2JqZWN0LHBhdGgsdmFsdWUsY3VzdG9taXplcil7Y3VzdG9taXplciA9IHR5cGVvZiBjdXN0b21pemVyID09IFwiZnVuY3Rpb25cIj9jdXN0b21pemVyOnVuZGVmaW5lZDtyZXR1cm4gb2JqZWN0ID09IG51bGw/b2JqZWN0OmJhc2VTZXQob2JqZWN0LHBhdGgsdmFsdWUsY3VzdG9taXplcik7fWZ1bmN0aW9uIHRvUGFpcnMob2JqZWN0KXtyZXR1cm4gYmFzZVRvUGFpcnMob2JqZWN0LGtleXMob2JqZWN0KSk7fWZ1bmN0aW9uIHRvUGFpcnNJbihvYmplY3Qpe3JldHVybiBiYXNlVG9QYWlycyhvYmplY3Qsa2V5c0luKG9iamVjdCkpO31mdW5jdGlvbiB0cmFuc2Zvcm0ob2JqZWN0LGl0ZXJhdGVlLGFjY3VtdWxhdG9yKXt2YXIgaXNBcnI9aXNBcnJheShvYmplY3QpIHx8IGlzVHlwZWRBcnJheShvYmplY3QpO2l0ZXJhdGVlID0gZ2V0SXRlcmF0ZWUoaXRlcmF0ZWUsNCk7aWYoYWNjdW11bGF0b3IgPT0gbnVsbCl7aWYoaXNBcnIgfHwgaXNPYmplY3Qob2JqZWN0KSl7dmFyIEN0b3I9b2JqZWN0LmNvbnN0cnVjdG9yO2lmKGlzQXJyKXthY2N1bXVsYXRvciA9IGlzQXJyYXkob2JqZWN0KT9uZXcgQ3RvcigpOltdO31lbHNlIHthY2N1bXVsYXRvciA9IGJhc2VDcmVhdGUoaXNGdW5jdGlvbihDdG9yKT9DdG9yLnByb3RvdHlwZTp1bmRlZmluZWQpO319ZWxzZSB7YWNjdW11bGF0b3IgPSB7fTt9fShpc0Fycj9hcnJheUVhY2g6YmFzZUZvck93bikob2JqZWN0LGZ1bmN0aW9uKHZhbHVlLGluZGV4LG9iamVjdCl7cmV0dXJuIGl0ZXJhdGVlKGFjY3VtdWxhdG9yLHZhbHVlLGluZGV4LG9iamVjdCk7fSk7cmV0dXJuIGFjY3VtdWxhdG9yO31mdW5jdGlvbiB1bnNldChvYmplY3QscGF0aCl7cmV0dXJuIG9iamVjdCA9PSBudWxsP3RydWU6YmFzZVVuc2V0KG9iamVjdCxwYXRoKTt9ZnVuY3Rpb24gdmFsdWVzKG9iamVjdCl7cmV0dXJuIG9iamVjdD9iYXNlVmFsdWVzKG9iamVjdCxrZXlzKG9iamVjdCkpOltdO31mdW5jdGlvbiB2YWx1ZXNJbihvYmplY3Qpe3JldHVybiBvYmplY3QgPT0gbnVsbD9iYXNlVmFsdWVzKG9iamVjdCxrZXlzSW4ob2JqZWN0KSk6W107fWZ1bmN0aW9uIGNsYW1wKG51bWJlcixsb3dlcix1cHBlcil7aWYodXBwZXIgPT09IHVuZGVmaW5lZCl7dXBwZXIgPSBsb3dlcjtsb3dlciA9IHVuZGVmaW5lZDt9aWYodXBwZXIgIT09IHVuZGVmaW5lZCl7dXBwZXIgPSB0b051bWJlcih1cHBlcik7dXBwZXIgPSB1cHBlciA9PT0gdXBwZXI/dXBwZXI6MDt9aWYobG93ZXIgIT09IHVuZGVmaW5lZCl7bG93ZXIgPSB0b051bWJlcihsb3dlcik7bG93ZXIgPSBsb3dlciA9PT0gbG93ZXI/bG93ZXI6MDt9cmV0dXJuIGJhc2VDbGFtcCh0b051bWJlcihudW1iZXIpLGxvd2VyLHVwcGVyKTt9ZnVuY3Rpb24gaW5SYW5nZShudW1iZXIsc3RhcnQsZW5kKXtzdGFydCA9IHRvTnVtYmVyKHN0YXJ0KSB8fCAwO2lmKGVuZCA9PT0gdW5kZWZpbmVkKXtlbmQgPSBzdGFydDtzdGFydCA9IDA7fWVsc2Uge2VuZCA9IHRvTnVtYmVyKGVuZCkgfHwgMDt9bnVtYmVyID0gdG9OdW1iZXIobnVtYmVyKTtyZXR1cm4gYmFzZUluUmFuZ2UobnVtYmVyLHN0YXJ0LGVuZCk7fWZ1bmN0aW9uIHJhbmRvbShsb3dlcix1cHBlcixmbG9hdGluZyl7aWYoZmxvYXRpbmcgJiYgdHlwZW9mIGZsb2F0aW5nICE9IFwiYm9vbGVhblwiICYmIGlzSXRlcmF0ZWVDYWxsKGxvd2VyLHVwcGVyLGZsb2F0aW5nKSl7dXBwZXIgPSBmbG9hdGluZyA9IHVuZGVmaW5lZDt9aWYoZmxvYXRpbmcgPT09IHVuZGVmaW5lZCl7aWYodHlwZW9mIHVwcGVyID09IFwiYm9vbGVhblwiKXtmbG9hdGluZyA9IHVwcGVyO3VwcGVyID0gdW5kZWZpbmVkO31lbHNlIGlmKHR5cGVvZiBsb3dlciA9PSBcImJvb2xlYW5cIil7ZmxvYXRpbmcgPSBsb3dlcjtsb3dlciA9IHVuZGVmaW5lZDt9fWlmKGxvd2VyID09PSB1bmRlZmluZWQgJiYgdXBwZXIgPT09IHVuZGVmaW5lZCl7bG93ZXIgPSAwO3VwcGVyID0gMTt9ZWxzZSB7bG93ZXIgPSB0b051bWJlcihsb3dlcikgfHwgMDtpZih1cHBlciA9PT0gdW5kZWZpbmVkKXt1cHBlciA9IGxvd2VyO2xvd2VyID0gMDt9ZWxzZSB7dXBwZXIgPSB0b051bWJlcih1cHBlcikgfHwgMDt9fWlmKGxvd2VyID4gdXBwZXIpe3ZhciB0ZW1wPWxvd2VyO2xvd2VyID0gdXBwZXI7dXBwZXIgPSB0ZW1wO31pZihmbG9hdGluZyB8fCBsb3dlciAlIDEgfHwgdXBwZXIgJSAxKXt2YXIgcmFuZD1uYXRpdmVSYW5kb20oKTtyZXR1cm4gbmF0aXZlTWluKGxvd2VyICsgcmFuZCAqICh1cHBlciAtIGxvd2VyICsgZnJlZVBhcnNlRmxvYXQoXCIxZS1cIiArICgocmFuZCArIFwiXCIpLmxlbmd0aCAtIDEpKSksdXBwZXIpO31yZXR1cm4gYmFzZVJhbmRvbShsb3dlcix1cHBlcik7fXZhciBjYW1lbENhc2U9Y3JlYXRlQ29tcG91bmRlcihmdW5jdGlvbihyZXN1bHQsd29yZCxpbmRleCl7d29yZCA9IHdvcmQudG9Mb3dlckNhc2UoKTtyZXR1cm4gcmVzdWx0ICsgKGluZGV4P2NhcGl0YWxpemUod29yZCk6d29yZCk7fSk7ZnVuY3Rpb24gY2FwaXRhbGl6ZShzdHJpbmcpe3JldHVybiB1cHBlckZpcnN0KHRvU3RyaW5nKHN0cmluZykudG9Mb3dlckNhc2UoKSk7fWZ1bmN0aW9uIGRlYnVycihzdHJpbmcpe3N0cmluZyA9IHRvU3RyaW5nKHN0cmluZyk7cmV0dXJuIHN0cmluZyAmJiBzdHJpbmcucmVwbGFjZShyZUxhdGluMSxkZWJ1cnJMZXR0ZXIpLnJlcGxhY2UocmVDb21ib01hcmssXCJcIik7fWZ1bmN0aW9uIGVuZHNXaXRoKHN0cmluZyx0YXJnZXQscG9zaXRpb24pe3N0cmluZyA9IHRvU3RyaW5nKHN0cmluZyk7dGFyZ2V0ID0gdHlwZW9mIHRhcmdldCA9PSBcInN0cmluZ1wiP3RhcmdldDp0YXJnZXQgKyBcIlwiO3ZhciBsZW5ndGg9c3RyaW5nLmxlbmd0aDtwb3NpdGlvbiA9IHBvc2l0aW9uID09PSB1bmRlZmluZWQ/bGVuZ3RoOmJhc2VDbGFtcCh0b0ludGVnZXIocG9zaXRpb24pLDAsbGVuZ3RoKTtwb3NpdGlvbiAtPSB0YXJnZXQubGVuZ3RoO3JldHVybiBwb3NpdGlvbiA+PSAwICYmIHN0cmluZy5pbmRleE9mKHRhcmdldCxwb3NpdGlvbikgPT0gcG9zaXRpb247fWZ1bmN0aW9uIGVzY2FwZShzdHJpbmcpe3N0cmluZyA9IHRvU3RyaW5nKHN0cmluZyk7cmV0dXJuIHN0cmluZyAmJiByZUhhc1VuZXNjYXBlZEh0bWwudGVzdChzdHJpbmcpP3N0cmluZy5yZXBsYWNlKHJlVW5lc2NhcGVkSHRtbCxlc2NhcGVIdG1sQ2hhcik6c3RyaW5nO31mdW5jdGlvbiBlc2NhcGVSZWdFeHAoc3RyaW5nKXtzdHJpbmcgPSB0b1N0cmluZyhzdHJpbmcpO3JldHVybiBzdHJpbmcgJiYgcmVIYXNSZWdFeHBDaGFyLnRlc3Qoc3RyaW5nKT9zdHJpbmcucmVwbGFjZShyZVJlZ0V4cENoYXIsXCJcXFxcJCZcIik6c3RyaW5nO312YXIga2ViYWJDYXNlPWNyZWF0ZUNvbXBvdW5kZXIoZnVuY3Rpb24ocmVzdWx0LHdvcmQsaW5kZXgpe3JldHVybiByZXN1bHQgKyAoaW5kZXg/XCItXCI6XCJcIikgKyB3b3JkLnRvTG93ZXJDYXNlKCk7fSk7dmFyIGxvd2VyQ2FzZT1jcmVhdGVDb21wb3VuZGVyKGZ1bmN0aW9uKHJlc3VsdCx3b3JkLGluZGV4KXtyZXR1cm4gcmVzdWx0ICsgKGluZGV4P1wiIFwiOlwiXCIpICsgd29yZC50b0xvd2VyQ2FzZSgpO30pO3ZhciBsb3dlckZpcnN0PWNyZWF0ZUNhc2VGaXJzdChcInRvTG93ZXJDYXNlXCIpO3ZhciB1cHBlckZpcnN0PWNyZWF0ZUNhc2VGaXJzdChcInRvVXBwZXJDYXNlXCIpO2Z1bmN0aW9uIHBhZChzdHJpbmcsbGVuZ3RoLGNoYXJzKXtzdHJpbmcgPSB0b1N0cmluZyhzdHJpbmcpO2xlbmd0aCA9IHRvSW50ZWdlcihsZW5ndGgpO3ZhciBzdHJMZW5ndGg9c3RyaW5nU2l6ZShzdHJpbmcpO2lmKCFsZW5ndGggfHwgc3RyTGVuZ3RoID49IGxlbmd0aCl7cmV0dXJuIHN0cmluZzt9dmFyIG1pZD0obGVuZ3RoIC0gc3RyTGVuZ3RoKSAvIDIsbGVmdExlbmd0aD1uYXRpdmVGbG9vcihtaWQpLHJpZ2h0TGVuZ3RoPW5hdGl2ZUNlaWwobWlkKTtyZXR1cm4gY3JlYXRlUGFkZGluZyhcIlwiLGxlZnRMZW5ndGgsY2hhcnMpICsgc3RyaW5nICsgY3JlYXRlUGFkZGluZyhcIlwiLHJpZ2h0TGVuZ3RoLGNoYXJzKTt9ZnVuY3Rpb24gcGFkRW5kKHN0cmluZyxsZW5ndGgsY2hhcnMpe3N0cmluZyA9IHRvU3RyaW5nKHN0cmluZyk7cmV0dXJuIHN0cmluZyArIGNyZWF0ZVBhZGRpbmcoc3RyaW5nLGxlbmd0aCxjaGFycyk7fWZ1bmN0aW9uIHBhZFN0YXJ0KHN0cmluZyxsZW5ndGgsY2hhcnMpe3N0cmluZyA9IHRvU3RyaW5nKHN0cmluZyk7cmV0dXJuIGNyZWF0ZVBhZGRpbmcoc3RyaW5nLGxlbmd0aCxjaGFycykgKyBzdHJpbmc7fWZ1bmN0aW9uIHBhcnNlSW50KHN0cmluZyxyYWRpeCxndWFyZCl7aWYoZ3VhcmQgfHwgcmFkaXggPT0gbnVsbCl7cmFkaXggPSAwO31lbHNlIGlmKHJhZGl4KXtyYWRpeCA9ICtyYWRpeDt9c3RyaW5nID0gdG9TdHJpbmcoc3RyaW5nKS5yZXBsYWNlKHJlVHJpbSxcIlwiKTtyZXR1cm4gbmF0aXZlUGFyc2VJbnQoc3RyaW5nLHJhZGl4IHx8IChyZUhhc0hleFByZWZpeC50ZXN0KHN0cmluZyk/MTY6MTApKTt9ZnVuY3Rpb24gcmVwZWF0KHN0cmluZyxuKXtzdHJpbmcgPSB0b1N0cmluZyhzdHJpbmcpO24gPSB0b0ludGVnZXIobik7dmFyIHJlc3VsdD1cIlwiO2lmKCFzdHJpbmcgfHwgbiA8IDEgfHwgbiA+IE1BWF9TQUZFX0lOVEVHRVIpe3JldHVybiByZXN1bHQ7fWRvIHtpZihuICUgMil7cmVzdWx0ICs9IHN0cmluZzt9biA9IG5hdGl2ZUZsb29yKG4gLyAyKTtzdHJpbmcgKz0gc3RyaW5nO313aGlsZShuKTtyZXR1cm4gcmVzdWx0O31mdW5jdGlvbiByZXBsYWNlKCl7dmFyIGFyZ3M9YXJndW1lbnRzLHN0cmluZz10b1N0cmluZyhhcmdzWzBdKTtyZXR1cm4gYXJncy5sZW5ndGggPCAzP3N0cmluZzpzdHJpbmcucmVwbGFjZShhcmdzWzFdLGFyZ3NbMl0pO312YXIgc25ha2VDYXNlPWNyZWF0ZUNvbXBvdW5kZXIoZnVuY3Rpb24ocmVzdWx0LHdvcmQsaW5kZXgpe3JldHVybiByZXN1bHQgKyAoaW5kZXg/XCJfXCI6XCJcIikgKyB3b3JkLnRvTG93ZXJDYXNlKCk7fSk7ZnVuY3Rpb24gc3BsaXQoc3RyaW5nLHNlcGFyYXRvcixsaW1pdCl7cmV0dXJuIHRvU3RyaW5nKHN0cmluZykuc3BsaXQoc2VwYXJhdG9yLGxpbWl0KTt9dmFyIHN0YXJ0Q2FzZT1jcmVhdGVDb21wb3VuZGVyKGZ1bmN0aW9uKHJlc3VsdCx3b3JkLGluZGV4KXtyZXR1cm4gcmVzdWx0ICsgKGluZGV4P1wiIFwiOlwiXCIpICsgY2FwaXRhbGl6ZSh3b3JkKTt9KTtmdW5jdGlvbiBzdGFydHNXaXRoKHN0cmluZyx0YXJnZXQscG9zaXRpb24pe3N0cmluZyA9IHRvU3RyaW5nKHN0cmluZyk7cG9zaXRpb24gPSBiYXNlQ2xhbXAodG9JbnRlZ2VyKHBvc2l0aW9uKSwwLHN0cmluZy5sZW5ndGgpO3JldHVybiBzdHJpbmcubGFzdEluZGV4T2YodGFyZ2V0LHBvc2l0aW9uKSA9PSBwb3NpdGlvbjt9ZnVuY3Rpb24gdGVtcGxhdGUoc3RyaW5nLG9wdGlvbnMsZ3VhcmQpe3ZhciBzZXR0aW5ncz1sb2Rhc2gudGVtcGxhdGVTZXR0aW5ncztpZihndWFyZCAmJiBpc0l0ZXJhdGVlQ2FsbChzdHJpbmcsb3B0aW9ucyxndWFyZCkpe29wdGlvbnMgPSB1bmRlZmluZWQ7fXN0cmluZyA9IHRvU3RyaW5nKHN0cmluZyk7b3B0aW9ucyA9IGFzc2lnbkluV2l0aCh7fSxvcHRpb25zLHNldHRpbmdzLGFzc2lnbkluRGVmYXVsdHMpO3ZhciBpbXBvcnRzPWFzc2lnbkluV2l0aCh7fSxvcHRpb25zLmltcG9ydHMsc2V0dGluZ3MuaW1wb3J0cyxhc3NpZ25JbkRlZmF1bHRzKSxpbXBvcnRzS2V5cz1rZXlzKGltcG9ydHMpLGltcG9ydHNWYWx1ZXM9YmFzZVZhbHVlcyhpbXBvcnRzLGltcG9ydHNLZXlzKTt2YXIgaXNFc2NhcGluZyxpc0V2YWx1YXRpbmcsaW5kZXg9MCxpbnRlcnBvbGF0ZT1vcHRpb25zLmludGVycG9sYXRlIHx8IHJlTm9NYXRjaCxzb3VyY2U9XCJfX3AgKz0gJ1wiO3ZhciByZURlbGltaXRlcnM9UmVnRXhwKChvcHRpb25zLmVzY2FwZSB8fCByZU5vTWF0Y2gpLnNvdXJjZSArIFwifFwiICsgaW50ZXJwb2xhdGUuc291cmNlICsgXCJ8XCIgKyAoaW50ZXJwb2xhdGUgPT09IHJlSW50ZXJwb2xhdGU/cmVFc1RlbXBsYXRlOnJlTm9NYXRjaCkuc291cmNlICsgXCJ8XCIgKyAob3B0aW9ucy5ldmFsdWF0ZSB8fCByZU5vTWF0Y2gpLnNvdXJjZSArIFwifCRcIixcImdcIik7dmFyIHNvdXJjZVVSTD1cIi8vIyBzb3VyY2VVUkw9XCIgKyAoXCJzb3VyY2VVUkxcIiBpbiBvcHRpb25zP29wdGlvbnMuc291cmNlVVJMOlwibG9kYXNoLnRlbXBsYXRlU291cmNlc1tcIiArICsrdGVtcGxhdGVDb3VudGVyICsgXCJdXCIpICsgXCJcXG5cIjtzdHJpbmcucmVwbGFjZShyZURlbGltaXRlcnMsZnVuY3Rpb24obWF0Y2gsZXNjYXBlVmFsdWUsaW50ZXJwb2xhdGVWYWx1ZSxlc1RlbXBsYXRlVmFsdWUsZXZhbHVhdGVWYWx1ZSxvZmZzZXQpe2ludGVycG9sYXRlVmFsdWUgfHwgKGludGVycG9sYXRlVmFsdWUgPSBlc1RlbXBsYXRlVmFsdWUpO3NvdXJjZSArPSBzdHJpbmcuc2xpY2UoaW5kZXgsb2Zmc2V0KS5yZXBsYWNlKHJlVW5lc2NhcGVkU3RyaW5nLGVzY2FwZVN0cmluZ0NoYXIpO2lmKGVzY2FwZVZhbHVlKXtpc0VzY2FwaW5nID0gdHJ1ZTtzb3VyY2UgKz0gXCInICtcXG5fX2UoXCIgKyBlc2NhcGVWYWx1ZSArIFwiKSArXFxuJ1wiO31pZihldmFsdWF0ZVZhbHVlKXtpc0V2YWx1YXRpbmcgPSB0cnVlO3NvdXJjZSArPSBcIic7XFxuXCIgKyBldmFsdWF0ZVZhbHVlICsgXCI7XFxuX19wICs9ICdcIjt9aWYoaW50ZXJwb2xhdGVWYWx1ZSl7c291cmNlICs9IFwiJyArXFxuKChfX3QgPSAoXCIgKyBpbnRlcnBvbGF0ZVZhbHVlICsgXCIpKSA9PSBudWxsID8gJycgOiBfX3QpICtcXG4nXCI7fWluZGV4ID0gb2Zmc2V0ICsgbWF0Y2gubGVuZ3RoO3JldHVybiBtYXRjaDt9KTtzb3VyY2UgKz0gXCInO1xcblwiO3ZhciB2YXJpYWJsZT1vcHRpb25zLnZhcmlhYmxlO2lmKCF2YXJpYWJsZSl7c291cmNlID0gXCJ3aXRoIChvYmopIHtcXG5cIiArIHNvdXJjZSArIFwiXFxufVxcblwiO31zb3VyY2UgPSAoaXNFdmFsdWF0aW5nP3NvdXJjZS5yZXBsYWNlKHJlRW1wdHlTdHJpbmdMZWFkaW5nLFwiXCIpOnNvdXJjZSkucmVwbGFjZShyZUVtcHR5U3RyaW5nTWlkZGxlLFwiJDFcIikucmVwbGFjZShyZUVtcHR5U3RyaW5nVHJhaWxpbmcsXCIkMTtcIik7c291cmNlID0gXCJmdW5jdGlvbihcIiArICh2YXJpYWJsZSB8fCBcIm9ialwiKSArIFwiKSB7XFxuXCIgKyAodmFyaWFibGU/XCJcIjpcIm9iaiB8fCAob2JqID0ge30pO1xcblwiKSArIFwidmFyIF9fdCwgX19wID0gJydcIiArIChpc0VzY2FwaW5nP1wiLCBfX2UgPSBfLmVzY2FwZVwiOlwiXCIpICsgKGlzRXZhbHVhdGluZz9cIiwgX19qID0gQXJyYXkucHJvdG90eXBlLmpvaW47XFxuXCIgKyBcImZ1bmN0aW9uIHByaW50KCkgeyBfX3AgKz0gX19qLmNhbGwoYXJndW1lbnRzLCAnJykgfVxcblwiOlwiO1xcblwiKSArIHNvdXJjZSArIFwicmV0dXJuIF9fcFxcbn1cIjt2YXIgcmVzdWx0PWF0dGVtcHQoZnVuY3Rpb24oKXtyZXR1cm4gRnVuY3Rpb24oaW1wb3J0c0tleXMsc291cmNlVVJMICsgXCJyZXR1cm4gXCIgKyBzb3VyY2UpLmFwcGx5KHVuZGVmaW5lZCxpbXBvcnRzVmFsdWVzKTt9KTtyZXN1bHQuc291cmNlID0gc291cmNlO2lmKGlzRXJyb3IocmVzdWx0KSl7dGhyb3cgcmVzdWx0O31yZXR1cm4gcmVzdWx0O31mdW5jdGlvbiB0b0xvd2VyKHZhbHVlKXtyZXR1cm4gdG9TdHJpbmcodmFsdWUpLnRvTG93ZXJDYXNlKCk7fWZ1bmN0aW9uIHRvVXBwZXIodmFsdWUpe3JldHVybiB0b1N0cmluZyh2YWx1ZSkudG9VcHBlckNhc2UoKTt9ZnVuY3Rpb24gdHJpbShzdHJpbmcsY2hhcnMsZ3VhcmQpe3N0cmluZyA9IHRvU3RyaW5nKHN0cmluZyk7aWYoIXN0cmluZyl7cmV0dXJuIHN0cmluZzt9aWYoZ3VhcmQgfHwgY2hhcnMgPT09IHVuZGVmaW5lZCl7cmV0dXJuIHN0cmluZy5yZXBsYWNlKHJlVHJpbSxcIlwiKTt9Y2hhcnMgPSBjaGFycyArIFwiXCI7aWYoIWNoYXJzKXtyZXR1cm4gc3RyaW5nO312YXIgc3RyU3ltYm9scz1zdHJpbmdUb0FycmF5KHN0cmluZyksY2hyU3ltYm9scz1zdHJpbmdUb0FycmF5KGNoYXJzKTtyZXR1cm4gc3RyU3ltYm9scy5zbGljZShjaGFyc1N0YXJ0SW5kZXgoc3RyU3ltYm9scyxjaHJTeW1ib2xzKSxjaGFyc0VuZEluZGV4KHN0clN5bWJvbHMsY2hyU3ltYm9scykgKyAxKS5qb2luKFwiXCIpO31mdW5jdGlvbiB0cmltRW5kKHN0cmluZyxjaGFycyxndWFyZCl7c3RyaW5nID0gdG9TdHJpbmcoc3RyaW5nKTtpZighc3RyaW5nKXtyZXR1cm4gc3RyaW5nO31pZihndWFyZCB8fCBjaGFycyA9PT0gdW5kZWZpbmVkKXtyZXR1cm4gc3RyaW5nLnJlcGxhY2UocmVUcmltRW5kLFwiXCIpO31jaGFycyA9IGNoYXJzICsgXCJcIjtpZighY2hhcnMpe3JldHVybiBzdHJpbmc7fXZhciBzdHJTeW1ib2xzPXN0cmluZ1RvQXJyYXkoc3RyaW5nKTtyZXR1cm4gc3RyU3ltYm9scy5zbGljZSgwLGNoYXJzRW5kSW5kZXgoc3RyU3ltYm9scyxzdHJpbmdUb0FycmF5KGNoYXJzKSkgKyAxKS5qb2luKFwiXCIpO31mdW5jdGlvbiB0cmltU3RhcnQoc3RyaW5nLGNoYXJzLGd1YXJkKXtzdHJpbmcgPSB0b1N0cmluZyhzdHJpbmcpO2lmKCFzdHJpbmcpe3JldHVybiBzdHJpbmc7fWlmKGd1YXJkIHx8IGNoYXJzID09PSB1bmRlZmluZWQpe3JldHVybiBzdHJpbmcucmVwbGFjZShyZVRyaW1TdGFydCxcIlwiKTt9Y2hhcnMgPSBjaGFycyArIFwiXCI7aWYoIWNoYXJzKXtyZXR1cm4gc3RyaW5nO312YXIgc3RyU3ltYm9scz1zdHJpbmdUb0FycmF5KHN0cmluZyk7cmV0dXJuIHN0clN5bWJvbHMuc2xpY2UoY2hhcnNTdGFydEluZGV4KHN0clN5bWJvbHMsc3RyaW5nVG9BcnJheShjaGFycykpKS5qb2luKFwiXCIpO31mdW5jdGlvbiB0cnVuY2F0ZShzdHJpbmcsb3B0aW9ucyl7dmFyIGxlbmd0aD1ERUZBVUxUX1RSVU5DX0xFTkdUSCxvbWlzc2lvbj1ERUZBVUxUX1RSVU5DX09NSVNTSU9OO2lmKGlzT2JqZWN0KG9wdGlvbnMpKXt2YXIgc2VwYXJhdG9yPVwic2VwYXJhdG9yXCIgaW4gb3B0aW9ucz9vcHRpb25zLnNlcGFyYXRvcjpzZXBhcmF0b3I7bGVuZ3RoID0gXCJsZW5ndGhcIiBpbiBvcHRpb25zP3RvSW50ZWdlcihvcHRpb25zLmxlbmd0aCk6bGVuZ3RoO29taXNzaW9uID0gXCJvbWlzc2lvblwiIGluIG9wdGlvbnM/dG9TdHJpbmcob3B0aW9ucy5vbWlzc2lvbik6b21pc3Npb247fXN0cmluZyA9IHRvU3RyaW5nKHN0cmluZyk7dmFyIHN0ckxlbmd0aD1zdHJpbmcubGVuZ3RoO2lmKHJlSGFzQ29tcGxleFN5bWJvbC50ZXN0KHN0cmluZykpe3ZhciBzdHJTeW1ib2xzPXN0cmluZ1RvQXJyYXkoc3RyaW5nKTtzdHJMZW5ndGggPSBzdHJTeW1ib2xzLmxlbmd0aDt9aWYobGVuZ3RoID49IHN0ckxlbmd0aCl7cmV0dXJuIHN0cmluZzt9dmFyIGVuZD1sZW5ndGggLSBzdHJpbmdTaXplKG9taXNzaW9uKTtpZihlbmQgPCAxKXtyZXR1cm4gb21pc3Npb247fXZhciByZXN1bHQ9c3RyU3ltYm9scz9zdHJTeW1ib2xzLnNsaWNlKDAsZW5kKS5qb2luKFwiXCIpOnN0cmluZy5zbGljZSgwLGVuZCk7aWYoc2VwYXJhdG9yID09PSB1bmRlZmluZWQpe3JldHVybiByZXN1bHQgKyBvbWlzc2lvbjt9aWYoc3RyU3ltYm9scyl7ZW5kICs9IHJlc3VsdC5sZW5ndGggLSBlbmQ7fWlmKGlzUmVnRXhwKHNlcGFyYXRvcikpe2lmKHN0cmluZy5zbGljZShlbmQpLnNlYXJjaChzZXBhcmF0b3IpKXt2YXIgbWF0Y2gsc3Vic3RyaW5nPXJlc3VsdDtpZighc2VwYXJhdG9yLmdsb2JhbCl7c2VwYXJhdG9yID0gUmVnRXhwKHNlcGFyYXRvci5zb3VyY2UsdG9TdHJpbmcocmVGbGFncy5leGVjKHNlcGFyYXRvcikpICsgXCJnXCIpO31zZXBhcmF0b3IubGFzdEluZGV4ID0gMDt3aGlsZShtYXRjaCA9IHNlcGFyYXRvci5leGVjKHN1YnN0cmluZykpIHt2YXIgbmV3RW5kPW1hdGNoLmluZGV4O31yZXN1bHQgPSByZXN1bHQuc2xpY2UoMCxuZXdFbmQgPT09IHVuZGVmaW5lZD9lbmQ6bmV3RW5kKTt9fWVsc2UgaWYoc3RyaW5nLmluZGV4T2Yoc2VwYXJhdG9yLGVuZCkgIT0gZW5kKXt2YXIgaW5kZXg9cmVzdWx0Lmxhc3RJbmRleE9mKHNlcGFyYXRvcik7aWYoaW5kZXggPiAtMSl7cmVzdWx0ID0gcmVzdWx0LnNsaWNlKDAsaW5kZXgpO319cmV0dXJuIHJlc3VsdCArIG9taXNzaW9uO31mdW5jdGlvbiB1bmVzY2FwZShzdHJpbmcpe3N0cmluZyA9IHRvU3RyaW5nKHN0cmluZyk7cmV0dXJuIHN0cmluZyAmJiByZUhhc0VzY2FwZWRIdG1sLnRlc3Qoc3RyaW5nKT9zdHJpbmcucmVwbGFjZShyZUVzY2FwZWRIdG1sLHVuZXNjYXBlSHRtbENoYXIpOnN0cmluZzt9dmFyIHVwcGVyQ2FzZT1jcmVhdGVDb21wb3VuZGVyKGZ1bmN0aW9uKHJlc3VsdCx3b3JkLGluZGV4KXtyZXR1cm4gcmVzdWx0ICsgKGluZGV4P1wiIFwiOlwiXCIpICsgd29yZC50b1VwcGVyQ2FzZSgpO30pO2Z1bmN0aW9uIHdvcmRzKHN0cmluZyxwYXR0ZXJuLGd1YXJkKXtzdHJpbmcgPSB0b1N0cmluZyhzdHJpbmcpO3BhdHRlcm4gPSBndWFyZD91bmRlZmluZWQ6cGF0dGVybjtpZihwYXR0ZXJuID09PSB1bmRlZmluZWQpe3BhdHRlcm4gPSByZUhhc0NvbXBsZXhXb3JkLnRlc3Qoc3RyaW5nKT9yZUNvbXBsZXhXb3JkOnJlQmFzaWNXb3JkO31yZXR1cm4gc3RyaW5nLm1hdGNoKHBhdHRlcm4pIHx8IFtdO312YXIgYXR0ZW1wdD1yZXN0KGZ1bmN0aW9uKGZ1bmMsYXJncyl7dHJ5e3JldHVybiBhcHBseShmdW5jLHVuZGVmaW5lZCxhcmdzKTt9Y2F0Y2goZSkge3JldHVybiBpc09iamVjdChlKT9lOm5ldyBFcnJvcihlKTt9fSk7dmFyIGJpbmRBbGw9cmVzdChmdW5jdGlvbihvYmplY3QsbWV0aG9kTmFtZXMpe2FycmF5RWFjaChiYXNlRmxhdHRlbihtZXRob2ROYW1lcyksZnVuY3Rpb24oa2V5KXtvYmplY3Rba2V5XSA9IGJpbmQob2JqZWN0W2tleV0sb2JqZWN0KTt9KTtyZXR1cm4gb2JqZWN0O30pO2Z1bmN0aW9uIGNvbmQocGFpcnMpe3ZhciBsZW5ndGg9cGFpcnM/cGFpcnMubGVuZ3RoOjAsdG9JdGVyYXRlZT1nZXRJdGVyYXRlZSgpO3BhaXJzID0gIWxlbmd0aD9bXTphcnJheU1hcChwYWlycyxmdW5jdGlvbihwYWlyKXtpZih0eXBlb2YgcGFpclsxXSAhPSBcImZ1bmN0aW9uXCIpe3Rocm93IG5ldyBUeXBlRXJyb3IoRlVOQ19FUlJPUl9URVhUKTt9cmV0dXJuIFt0b0l0ZXJhdGVlKHBhaXJbMF0pLHBhaXJbMV1dO30pO3JldHVybiByZXN0KGZ1bmN0aW9uKGFyZ3Mpe3ZhciBpbmRleD0tMTt3aGlsZSgrK2luZGV4IDwgbGVuZ3RoKSB7dmFyIHBhaXI9cGFpcnNbaW5kZXhdO2lmKGFwcGx5KHBhaXJbMF0sdGhpcyxhcmdzKSl7cmV0dXJuIGFwcGx5KHBhaXJbMV0sdGhpcyxhcmdzKTt9fX0pO31mdW5jdGlvbiBjb25mb3Jtcyhzb3VyY2Upe3JldHVybiBiYXNlQ29uZm9ybXMoYmFzZUNsb25lKHNvdXJjZSx0cnVlKSk7fWZ1bmN0aW9uIGNvbnN0YW50KHZhbHVlKXtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gdmFsdWU7fTt9dmFyIGZsb3c9Y3JlYXRlRmxvdygpO3ZhciBmbG93UmlnaHQ9Y3JlYXRlRmxvdyh0cnVlKTtmdW5jdGlvbiBpZGVudGl0eSh2YWx1ZSl7cmV0dXJuIHZhbHVlO31mdW5jdGlvbiBpdGVyYXRlZShmdW5jKXtyZXR1cm4gYmFzZUl0ZXJhdGVlKHR5cGVvZiBmdW5jID09IFwiZnVuY3Rpb25cIj9mdW5jOmJhc2VDbG9uZShmdW5jLHRydWUpKTt9ZnVuY3Rpb24gbWF0Y2hlcyhzb3VyY2Upe3JldHVybiBiYXNlTWF0Y2hlcyhiYXNlQ2xvbmUoc291cmNlLHRydWUpKTt9ZnVuY3Rpb24gbWF0Y2hlc1Byb3BlcnR5KHBhdGgsc3JjVmFsdWUpe3JldHVybiBiYXNlTWF0Y2hlc1Byb3BlcnR5KHBhdGgsYmFzZUNsb25lKHNyY1ZhbHVlLHRydWUpKTt9dmFyIG1ldGhvZD1yZXN0KGZ1bmN0aW9uKHBhdGgsYXJncyl7cmV0dXJuIGZ1bmN0aW9uKG9iamVjdCl7cmV0dXJuIGJhc2VJbnZva2Uob2JqZWN0LHBhdGgsYXJncyk7fTt9KTt2YXIgbWV0aG9kT2Y9cmVzdChmdW5jdGlvbihvYmplY3QsYXJncyl7cmV0dXJuIGZ1bmN0aW9uKHBhdGgpe3JldHVybiBiYXNlSW52b2tlKG9iamVjdCxwYXRoLGFyZ3MpO307fSk7ZnVuY3Rpb24gbWl4aW4ob2JqZWN0LHNvdXJjZSxvcHRpb25zKXt2YXIgcHJvcHM9a2V5cyhzb3VyY2UpLG1ldGhvZE5hbWVzPWJhc2VGdW5jdGlvbnMoc291cmNlLHByb3BzKTtpZihvcHRpb25zID09IG51bGwgJiYgIShpc09iamVjdChzb3VyY2UpICYmIChtZXRob2ROYW1lcy5sZW5ndGggfHwgIXByb3BzLmxlbmd0aCkpKXtvcHRpb25zID0gc291cmNlO3NvdXJjZSA9IG9iamVjdDtvYmplY3QgPSB0aGlzO21ldGhvZE5hbWVzID0gYmFzZUZ1bmN0aW9ucyhzb3VyY2Usa2V5cyhzb3VyY2UpKTt9dmFyIGNoYWluPWlzT2JqZWN0KG9wdGlvbnMpICYmIFwiY2hhaW5cIiBpbiBvcHRpb25zP29wdGlvbnMuY2hhaW46dHJ1ZSxpc0Z1bmM9aXNGdW5jdGlvbihvYmplY3QpO2FycmF5RWFjaChtZXRob2ROYW1lcyxmdW5jdGlvbihtZXRob2ROYW1lKXt2YXIgZnVuYz1zb3VyY2VbbWV0aG9kTmFtZV07b2JqZWN0W21ldGhvZE5hbWVdID0gZnVuYztpZihpc0Z1bmMpe29iamVjdC5wcm90b3R5cGVbbWV0aG9kTmFtZV0gPSBmdW5jdGlvbigpe3ZhciBjaGFpbkFsbD10aGlzLl9fY2hhaW5fXztpZihjaGFpbiB8fCBjaGFpbkFsbCl7dmFyIHJlc3VsdD1vYmplY3QodGhpcy5fX3dyYXBwZWRfXyksYWN0aW9ucz1yZXN1bHQuX19hY3Rpb25zX18gPSBjb3B5QXJyYXkodGhpcy5fX2FjdGlvbnNfXyk7YWN0aW9ucy5wdXNoKHtmdW5jOmZ1bmMsYXJnczphcmd1bWVudHMsdGhpc0FyZzpvYmplY3R9KTtyZXN1bHQuX19jaGFpbl9fID0gY2hhaW5BbGw7cmV0dXJuIHJlc3VsdDt9cmV0dXJuIGZ1bmMuYXBwbHkob2JqZWN0LGFycmF5UHVzaChbdGhpcy52YWx1ZSgpXSxhcmd1bWVudHMpKTt9O319KTtyZXR1cm4gb2JqZWN0O31mdW5jdGlvbiBub0NvbmZsaWN0KCl7aWYocm9vdC5fID09PSB0aGlzKXtyb290Ll8gPSBvbGREYXNoO31yZXR1cm4gdGhpczt9ZnVuY3Rpb24gbm9vcCgpe31mdW5jdGlvbiBudGhBcmcobil7biA9IHRvSW50ZWdlcihuKTtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gYXJndW1lbnRzW25dO307fXZhciBvdmVyPWNyZWF0ZU92ZXIoYXJyYXlNYXApO3ZhciBvdmVyRXZlcnk9Y3JlYXRlT3ZlcihhcnJheUV2ZXJ5KTt2YXIgb3ZlclNvbWU9Y3JlYXRlT3ZlcihhcnJheVNvbWUpO2Z1bmN0aW9uIHByb3BlcnR5KHBhdGgpe3JldHVybiBpc0tleShwYXRoKT9iYXNlUHJvcGVydHkocGF0aCk6YmFzZVByb3BlcnR5RGVlcChwYXRoKTt9ZnVuY3Rpb24gcHJvcGVydHlPZihvYmplY3Qpe3JldHVybiBmdW5jdGlvbihwYXRoKXtyZXR1cm4gb2JqZWN0ID09IG51bGw/dW5kZWZpbmVkOmJhc2VHZXQob2JqZWN0LHBhdGgpO307fXZhciByYW5nZT1jcmVhdGVSYW5nZSgpO3ZhciByYW5nZVJpZ2h0PWNyZWF0ZVJhbmdlKHRydWUpO2Z1bmN0aW9uIHRpbWVzKG4saXRlcmF0ZWUpe24gPSB0b0ludGVnZXIobik7aWYobiA8IDEgfHwgbiA+IE1BWF9TQUZFX0lOVEVHRVIpe3JldHVybiBbXTt9dmFyIGluZGV4PU1BWF9BUlJBWV9MRU5HVEgsbGVuZ3RoPW5hdGl2ZU1pbihuLE1BWF9BUlJBWV9MRU5HVEgpO2l0ZXJhdGVlID0gdG9GdW5jdGlvbihpdGVyYXRlZSk7biAtPSBNQVhfQVJSQVlfTEVOR1RIO3ZhciByZXN1bHQ9YmFzZVRpbWVzKGxlbmd0aCxpdGVyYXRlZSk7d2hpbGUoKytpbmRleCA8IG4pIHtpdGVyYXRlZShpbmRleCk7fXJldHVybiByZXN1bHQ7fWZ1bmN0aW9uIHRvUGF0aCh2YWx1ZSl7cmV0dXJuIGlzQXJyYXkodmFsdWUpP2FycmF5TWFwKHZhbHVlLFN0cmluZyk6c3RyaW5nVG9QYXRoKHZhbHVlKTt9ZnVuY3Rpb24gdW5pcXVlSWQocHJlZml4KXt2YXIgaWQ9KytpZENvdW50ZXI7cmV0dXJuIHRvU3RyaW5nKHByZWZpeCkgKyBpZDt9ZnVuY3Rpb24gYWRkKGF1Z2VuZCxhZGRlbmQpe3ZhciByZXN1bHQ7aWYoYXVnZW5kICE9PSB1bmRlZmluZWQpe3Jlc3VsdCA9IGF1Z2VuZDt9aWYoYWRkZW5kICE9PSB1bmRlZmluZWQpe3Jlc3VsdCA9IHJlc3VsdCA9PT0gdW5kZWZpbmVkP2FkZGVuZDpyZXN1bHQgKyBhZGRlbmQ7fXJldHVybiByZXN1bHQ7fXZhciBjZWlsPWNyZWF0ZVJvdW5kKFwiY2VpbFwiKTt2YXIgZmxvb3I9Y3JlYXRlUm91bmQoXCJmbG9vclwiKTtmdW5jdGlvbiBtYXgoYXJyYXkpe3JldHVybiBhcnJheSAmJiBhcnJheS5sZW5ndGg/YmFzZUV4dHJlbXVtKGFycmF5LGlkZW50aXR5LGd0KTp1bmRlZmluZWQ7fWZ1bmN0aW9uIG1heEJ5KGFycmF5LGl0ZXJhdGVlKXtyZXR1cm4gYXJyYXkgJiYgYXJyYXkubGVuZ3RoP2Jhc2VFeHRyZW11bShhcnJheSxnZXRJdGVyYXRlZShpdGVyYXRlZSksZ3QpOnVuZGVmaW5lZDt9ZnVuY3Rpb24gbWVhbihhcnJheSl7cmV0dXJuIHN1bShhcnJheSkgLyAoYXJyYXk/YXJyYXkubGVuZ3RoOjApO31mdW5jdGlvbiBtaW4oYXJyYXkpe3JldHVybiBhcnJheSAmJiBhcnJheS5sZW5ndGg/YmFzZUV4dHJlbXVtKGFycmF5LGlkZW50aXR5LGx0KTp1bmRlZmluZWQ7fWZ1bmN0aW9uIG1pbkJ5KGFycmF5LGl0ZXJhdGVlKXtyZXR1cm4gYXJyYXkgJiYgYXJyYXkubGVuZ3RoP2Jhc2VFeHRyZW11bShhcnJheSxnZXRJdGVyYXRlZShpdGVyYXRlZSksbHQpOnVuZGVmaW5lZDt9dmFyIHJvdW5kPWNyZWF0ZVJvdW5kKFwicm91bmRcIik7ZnVuY3Rpb24gc3VidHJhY3QobWludWVuZCxzdWJ0cmFoZW5kKXt2YXIgcmVzdWx0O2lmKG1pbnVlbmQgIT09IHVuZGVmaW5lZCl7cmVzdWx0ID0gbWludWVuZDt9aWYoc3VidHJhaGVuZCAhPT0gdW5kZWZpbmVkKXtyZXN1bHQgPSByZXN1bHQgPT09IHVuZGVmaW5lZD9zdWJ0cmFoZW5kOnJlc3VsdCAtIHN1YnRyYWhlbmQ7fXJldHVybiByZXN1bHQ7fWZ1bmN0aW9uIHN1bShhcnJheSl7cmV0dXJuIGFycmF5ICYmIGFycmF5Lmxlbmd0aD9iYXNlU3VtKGFycmF5LGlkZW50aXR5KTowO31mdW5jdGlvbiBzdW1CeShhcnJheSxpdGVyYXRlZSl7cmV0dXJuIGFycmF5ICYmIGFycmF5Lmxlbmd0aD9iYXNlU3VtKGFycmF5LGdldEl0ZXJhdGVlKGl0ZXJhdGVlKSk6MDt9bG9kYXNoLnByb3RvdHlwZSA9IGJhc2VMb2Rhc2gucHJvdG90eXBlO0xvZGFzaFdyYXBwZXIucHJvdG90eXBlID0gYmFzZUNyZWF0ZShiYXNlTG9kYXNoLnByb3RvdHlwZSk7TG9kYXNoV3JhcHBlci5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBMb2Rhc2hXcmFwcGVyO0xhenlXcmFwcGVyLnByb3RvdHlwZSA9IGJhc2VDcmVhdGUoYmFzZUxvZGFzaC5wcm90b3R5cGUpO0xhenlXcmFwcGVyLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IExhenlXcmFwcGVyO0hhc2gucHJvdG90eXBlID0gbmF0aXZlQ3JlYXRlP25hdGl2ZUNyZWF0ZShudWxsKTpvYmplY3RQcm90bztNYXBDYWNoZS5wcm90b3R5cGUuY2xlYXIgPSBtYXBDbGVhcjtNYXBDYWNoZS5wcm90b3R5cGVbXCJkZWxldGVcIl0gPSBtYXBEZWxldGU7TWFwQ2FjaGUucHJvdG90eXBlLmdldCA9IG1hcEdldDtNYXBDYWNoZS5wcm90b3R5cGUuaGFzID0gbWFwSGFzO01hcENhY2hlLnByb3RvdHlwZS5zZXQgPSBtYXBTZXQ7U2V0Q2FjaGUucHJvdG90eXBlLnB1c2ggPSBjYWNoZVB1c2g7U3RhY2sucHJvdG90eXBlLmNsZWFyID0gc3RhY2tDbGVhcjtTdGFjay5wcm90b3R5cGVbXCJkZWxldGVcIl0gPSBzdGFja0RlbGV0ZTtTdGFjay5wcm90b3R5cGUuZ2V0ID0gc3RhY2tHZXQ7U3RhY2sucHJvdG90eXBlLmhhcyA9IHN0YWNrSGFzO1N0YWNrLnByb3RvdHlwZS5zZXQgPSBzdGFja1NldDttZW1vaXplLkNhY2hlID0gTWFwQ2FjaGU7bG9kYXNoLmFmdGVyID0gYWZ0ZXI7bG9kYXNoLmFyeSA9IGFyeTtsb2Rhc2guYXNzaWduID0gYXNzaWduO2xvZGFzaC5hc3NpZ25JbiA9IGFzc2lnbkluO2xvZGFzaC5hc3NpZ25JbldpdGggPSBhc3NpZ25JbldpdGg7bG9kYXNoLmFzc2lnbldpdGggPSBhc3NpZ25XaXRoO2xvZGFzaC5hdCA9IGF0O2xvZGFzaC5iZWZvcmUgPSBiZWZvcmU7bG9kYXNoLmJpbmQgPSBiaW5kO2xvZGFzaC5iaW5kQWxsID0gYmluZEFsbDtsb2Rhc2guYmluZEtleSA9IGJpbmRLZXk7bG9kYXNoLmNoYWluID0gY2hhaW47bG9kYXNoLmNodW5rID0gY2h1bms7bG9kYXNoLmNvbXBhY3QgPSBjb21wYWN0O2xvZGFzaC5jb25jYXQgPSBjb25jYXQ7bG9kYXNoLmNvbmQgPSBjb25kO2xvZGFzaC5jb25mb3JtcyA9IGNvbmZvcm1zO2xvZGFzaC5jb25zdGFudCA9IGNvbnN0YW50O2xvZGFzaC5jb3VudEJ5ID0gY291bnRCeTtsb2Rhc2guY3JlYXRlID0gY3JlYXRlO2xvZGFzaC5jdXJyeSA9IGN1cnJ5O2xvZGFzaC5jdXJyeVJpZ2h0ID0gY3VycnlSaWdodDtsb2Rhc2guZGVib3VuY2UgPSBkZWJvdW5jZTtsb2Rhc2guZGVmYXVsdHMgPSBkZWZhdWx0cztsb2Rhc2guZGVmYXVsdHNEZWVwID0gZGVmYXVsdHNEZWVwO2xvZGFzaC5kZWZlciA9IGRlZmVyO2xvZGFzaC5kZWxheSA9IGRlbGF5O2xvZGFzaC5kaWZmZXJlbmNlID0gZGlmZmVyZW5jZTtsb2Rhc2guZGlmZmVyZW5jZUJ5ID0gZGlmZmVyZW5jZUJ5O2xvZGFzaC5kaWZmZXJlbmNlV2l0aCA9IGRpZmZlcmVuY2VXaXRoO2xvZGFzaC5kcm9wID0gZHJvcDtsb2Rhc2guZHJvcFJpZ2h0ID0gZHJvcFJpZ2h0O2xvZGFzaC5kcm9wUmlnaHRXaGlsZSA9IGRyb3BSaWdodFdoaWxlO2xvZGFzaC5kcm9wV2hpbGUgPSBkcm9wV2hpbGU7bG9kYXNoLmZpbGwgPSBmaWxsO2xvZGFzaC5maWx0ZXIgPSBmaWx0ZXI7bG9kYXNoLmZsYXRNYXAgPSBmbGF0TWFwO2xvZGFzaC5mbGF0dGVuID0gZmxhdHRlbjtsb2Rhc2guZmxhdHRlbkRlZXAgPSBmbGF0dGVuRGVlcDtsb2Rhc2guZmxpcCA9IGZsaXA7bG9kYXNoLmZsb3cgPSBmbG93O2xvZGFzaC5mbG93UmlnaHQgPSBmbG93UmlnaHQ7bG9kYXNoLmZyb21QYWlycyA9IGZyb21QYWlycztsb2Rhc2guZnVuY3Rpb25zID0gZnVuY3Rpb25zO2xvZGFzaC5mdW5jdGlvbnNJbiA9IGZ1bmN0aW9uc0luO2xvZGFzaC5ncm91cEJ5ID0gZ3JvdXBCeTtsb2Rhc2guaW5pdGlhbCA9IGluaXRpYWw7bG9kYXNoLmludGVyc2VjdGlvbiA9IGludGVyc2VjdGlvbjtsb2Rhc2guaW50ZXJzZWN0aW9uQnkgPSBpbnRlcnNlY3Rpb25CeTtsb2Rhc2guaW50ZXJzZWN0aW9uV2l0aCA9IGludGVyc2VjdGlvbldpdGg7bG9kYXNoLmludmVydCA9IGludmVydDtsb2Rhc2guaW52ZXJ0QnkgPSBpbnZlcnRCeTtsb2Rhc2guaW52b2tlTWFwID0gaW52b2tlTWFwO2xvZGFzaC5pdGVyYXRlZSA9IGl0ZXJhdGVlO2xvZGFzaC5rZXlCeSA9IGtleUJ5O2xvZGFzaC5rZXlzID0ga2V5cztsb2Rhc2gua2V5c0luID0ga2V5c0luO2xvZGFzaC5tYXAgPSBtYXA7bG9kYXNoLm1hcEtleXMgPSBtYXBLZXlzO2xvZGFzaC5tYXBWYWx1ZXMgPSBtYXBWYWx1ZXM7bG9kYXNoLm1hdGNoZXMgPSBtYXRjaGVzO2xvZGFzaC5tYXRjaGVzUHJvcGVydHkgPSBtYXRjaGVzUHJvcGVydHk7bG9kYXNoLm1lbW9pemUgPSBtZW1vaXplO2xvZGFzaC5tZXJnZSA9IG1lcmdlO2xvZGFzaC5tZXJnZVdpdGggPSBtZXJnZVdpdGg7bG9kYXNoLm1ldGhvZCA9IG1ldGhvZDtsb2Rhc2gubWV0aG9kT2YgPSBtZXRob2RPZjtsb2Rhc2gubWl4aW4gPSBtaXhpbjtsb2Rhc2gubmVnYXRlID0gbmVnYXRlO2xvZGFzaC5udGhBcmcgPSBudGhBcmc7bG9kYXNoLm9taXQgPSBvbWl0O2xvZGFzaC5vbWl0QnkgPSBvbWl0Qnk7bG9kYXNoLm9uY2UgPSBvbmNlO2xvZGFzaC5vcmRlckJ5ID0gb3JkZXJCeTtsb2Rhc2gub3ZlciA9IG92ZXI7bG9kYXNoLm92ZXJBcmdzID0gb3ZlckFyZ3M7bG9kYXNoLm92ZXJFdmVyeSA9IG92ZXJFdmVyeTtsb2Rhc2gub3ZlclNvbWUgPSBvdmVyU29tZTtsb2Rhc2gucGFydGlhbCA9IHBhcnRpYWw7bG9kYXNoLnBhcnRpYWxSaWdodCA9IHBhcnRpYWxSaWdodDtsb2Rhc2gucGFydGl0aW9uID0gcGFydGl0aW9uO2xvZGFzaC5waWNrID0gcGljaztsb2Rhc2gucGlja0J5ID0gcGlja0J5O2xvZGFzaC5wcm9wZXJ0eSA9IHByb3BlcnR5O2xvZGFzaC5wcm9wZXJ0eU9mID0gcHJvcGVydHlPZjtsb2Rhc2gucHVsbCA9IHB1bGw7bG9kYXNoLnB1bGxBbGwgPSBwdWxsQWxsO2xvZGFzaC5wdWxsQWxsQnkgPSBwdWxsQWxsQnk7bG9kYXNoLnB1bGxBdCA9IHB1bGxBdDtsb2Rhc2gucmFuZ2UgPSByYW5nZTtsb2Rhc2gucmFuZ2VSaWdodCA9IHJhbmdlUmlnaHQ7bG9kYXNoLnJlYXJnID0gcmVhcmc7bG9kYXNoLnJlamVjdCA9IHJlamVjdDtsb2Rhc2gucmVtb3ZlID0gcmVtb3ZlO2xvZGFzaC5yZXN0ID0gcmVzdDtsb2Rhc2gucmV2ZXJzZSA9IHJldmVyc2U7bG9kYXNoLnNhbXBsZVNpemUgPSBzYW1wbGVTaXplO2xvZGFzaC5zZXQgPSBzZXQ7bG9kYXNoLnNldFdpdGggPSBzZXRXaXRoO2xvZGFzaC5zaHVmZmxlID0gc2h1ZmZsZTtsb2Rhc2guc2xpY2UgPSBzbGljZTtsb2Rhc2guc29ydEJ5ID0gc29ydEJ5O2xvZGFzaC5zb3J0ZWRVbmlxID0gc29ydGVkVW5pcTtsb2Rhc2guc29ydGVkVW5pcUJ5ID0gc29ydGVkVW5pcUJ5O2xvZGFzaC5zcGxpdCA9IHNwbGl0O2xvZGFzaC5zcHJlYWQgPSBzcHJlYWQ7bG9kYXNoLnRhaWwgPSB0YWlsO2xvZGFzaC50YWtlID0gdGFrZTtsb2Rhc2gudGFrZVJpZ2h0ID0gdGFrZVJpZ2h0O2xvZGFzaC50YWtlUmlnaHRXaGlsZSA9IHRha2VSaWdodFdoaWxlO2xvZGFzaC50YWtlV2hpbGUgPSB0YWtlV2hpbGU7bG9kYXNoLnRhcCA9IHRhcDtsb2Rhc2gudGhyb3R0bGUgPSB0aHJvdHRsZTtsb2Rhc2gudGhydSA9IHRocnU7bG9kYXNoLnRvQXJyYXkgPSB0b0FycmF5O2xvZGFzaC50b1BhaXJzID0gdG9QYWlycztsb2Rhc2gudG9QYWlyc0luID0gdG9QYWlyc0luO2xvZGFzaC50b1BhdGggPSB0b1BhdGg7bG9kYXNoLnRvUGxhaW5PYmplY3QgPSB0b1BsYWluT2JqZWN0O2xvZGFzaC50cmFuc2Zvcm0gPSB0cmFuc2Zvcm07bG9kYXNoLnVuYXJ5ID0gdW5hcnk7bG9kYXNoLnVuaW9uID0gdW5pb247bG9kYXNoLnVuaW9uQnkgPSB1bmlvbkJ5O2xvZGFzaC51bmlvbldpdGggPSB1bmlvbldpdGg7bG9kYXNoLnVuaXEgPSB1bmlxO2xvZGFzaC51bmlxQnkgPSB1bmlxQnk7bG9kYXNoLnVuaXFXaXRoID0gdW5pcVdpdGg7bG9kYXNoLnVuc2V0ID0gdW5zZXQ7bG9kYXNoLnVuemlwID0gdW56aXA7bG9kYXNoLnVuemlwV2l0aCA9IHVuemlwV2l0aDtsb2Rhc2gudmFsdWVzID0gdmFsdWVzO2xvZGFzaC52YWx1ZXNJbiA9IHZhbHVlc0luO2xvZGFzaC53aXRob3V0ID0gd2l0aG91dDtsb2Rhc2gud29yZHMgPSB3b3Jkcztsb2Rhc2gud3JhcCA9IHdyYXA7bG9kYXNoLnhvciA9IHhvcjtsb2Rhc2gueG9yQnkgPSB4b3JCeTtsb2Rhc2gueG9yV2l0aCA9IHhvcldpdGg7bG9kYXNoLnppcCA9IHppcDtsb2Rhc2guemlwT2JqZWN0ID0gemlwT2JqZWN0O2xvZGFzaC56aXBPYmplY3REZWVwID0gemlwT2JqZWN0RGVlcDtsb2Rhc2guemlwV2l0aCA9IHppcFdpdGg7bG9kYXNoLmV4dGVuZCA9IGFzc2lnbkluO2xvZGFzaC5leHRlbmRXaXRoID0gYXNzaWduSW5XaXRoO21peGluKGxvZGFzaCxsb2Rhc2gpO2xvZGFzaC5hZGQgPSBhZGQ7bG9kYXNoLmF0dGVtcHQgPSBhdHRlbXB0O2xvZGFzaC5jYW1lbENhc2UgPSBjYW1lbENhc2U7bG9kYXNoLmNhcGl0YWxpemUgPSBjYXBpdGFsaXplO2xvZGFzaC5jZWlsID0gY2VpbDtsb2Rhc2guY2xhbXAgPSBjbGFtcDtsb2Rhc2guY2xvbmUgPSBjbG9uZTtsb2Rhc2guY2xvbmVEZWVwID0gY2xvbmVEZWVwO2xvZGFzaC5jbG9uZURlZXBXaXRoID0gY2xvbmVEZWVwV2l0aDtsb2Rhc2guY2xvbmVXaXRoID0gY2xvbmVXaXRoO2xvZGFzaC5kZWJ1cnIgPSBkZWJ1cnI7bG9kYXNoLmVuZHNXaXRoID0gZW5kc1dpdGg7bG9kYXNoLmVxID0gZXE7bG9kYXNoLmVzY2FwZSA9IGVzY2FwZTtsb2Rhc2guZXNjYXBlUmVnRXhwID0gZXNjYXBlUmVnRXhwO2xvZGFzaC5ldmVyeSA9IGV2ZXJ5O2xvZGFzaC5maW5kID0gZmluZDtsb2Rhc2guZmluZEluZGV4ID0gZmluZEluZGV4O2xvZGFzaC5maW5kS2V5ID0gZmluZEtleTtsb2Rhc2guZmluZExhc3QgPSBmaW5kTGFzdDtsb2Rhc2guZmluZExhc3RJbmRleCA9IGZpbmRMYXN0SW5kZXg7bG9kYXNoLmZpbmRMYXN0S2V5ID0gZmluZExhc3RLZXk7bG9kYXNoLmZsb29yID0gZmxvb3I7bG9kYXNoLmZvckVhY2ggPSBmb3JFYWNoO2xvZGFzaC5mb3JFYWNoUmlnaHQgPSBmb3JFYWNoUmlnaHQ7bG9kYXNoLmZvckluID0gZm9ySW47bG9kYXNoLmZvckluUmlnaHQgPSBmb3JJblJpZ2h0O2xvZGFzaC5mb3JPd24gPSBmb3JPd247bG9kYXNoLmZvck93blJpZ2h0ID0gZm9yT3duUmlnaHQ7bG9kYXNoLmdldCA9IGdldDtsb2Rhc2guZ3QgPSBndDtsb2Rhc2guZ3RlID0gZ3RlO2xvZGFzaC5oYXMgPSBoYXM7bG9kYXNoLmhhc0luID0gaGFzSW47bG9kYXNoLmhlYWQgPSBoZWFkO2xvZGFzaC5pZGVudGl0eSA9IGlkZW50aXR5O2xvZGFzaC5pbmNsdWRlcyA9IGluY2x1ZGVzO2xvZGFzaC5pbmRleE9mID0gaW5kZXhPZjtsb2Rhc2guaW5SYW5nZSA9IGluUmFuZ2U7bG9kYXNoLmludm9rZSA9IGludm9rZTtsb2Rhc2guaXNBcmd1bWVudHMgPSBpc0FyZ3VtZW50cztsb2Rhc2guaXNBcnJheSA9IGlzQXJyYXk7bG9kYXNoLmlzQXJyYXlMaWtlID0gaXNBcnJheUxpa2U7bG9kYXNoLmlzQXJyYXlMaWtlT2JqZWN0ID0gaXNBcnJheUxpa2VPYmplY3Q7bG9kYXNoLmlzQm9vbGVhbiA9IGlzQm9vbGVhbjtsb2Rhc2guaXNEYXRlID0gaXNEYXRlO2xvZGFzaC5pc0VsZW1lbnQgPSBpc0VsZW1lbnQ7bG9kYXNoLmlzRW1wdHkgPSBpc0VtcHR5O2xvZGFzaC5pc0VxdWFsID0gaXNFcXVhbDtsb2Rhc2guaXNFcXVhbFdpdGggPSBpc0VxdWFsV2l0aDtsb2Rhc2guaXNFcnJvciA9IGlzRXJyb3I7bG9kYXNoLmlzRmluaXRlID0gaXNGaW5pdGU7bG9kYXNoLmlzRnVuY3Rpb24gPSBpc0Z1bmN0aW9uO2xvZGFzaC5pc0ludGVnZXIgPSBpc0ludGVnZXI7bG9kYXNoLmlzTGVuZ3RoID0gaXNMZW5ndGg7bG9kYXNoLmlzTWF0Y2ggPSBpc01hdGNoO2xvZGFzaC5pc01hdGNoV2l0aCA9IGlzTWF0Y2hXaXRoO2xvZGFzaC5pc05hTiA9IGlzTmFOO2xvZGFzaC5pc05hdGl2ZSA9IGlzTmF0aXZlO2xvZGFzaC5pc05pbCA9IGlzTmlsO2xvZGFzaC5pc051bGwgPSBpc051bGw7bG9kYXNoLmlzTnVtYmVyID0gaXNOdW1iZXI7bG9kYXNoLmlzT2JqZWN0ID0gaXNPYmplY3Q7bG9kYXNoLmlzT2JqZWN0TGlrZSA9IGlzT2JqZWN0TGlrZTtsb2Rhc2guaXNQbGFpbk9iamVjdCA9IGlzUGxhaW5PYmplY3Q7bG9kYXNoLmlzUmVnRXhwID0gaXNSZWdFeHA7bG9kYXNoLmlzU2FmZUludGVnZXIgPSBpc1NhZmVJbnRlZ2VyO2xvZGFzaC5pc1N0cmluZyA9IGlzU3RyaW5nO2xvZGFzaC5pc1N5bWJvbCA9IGlzU3ltYm9sO2xvZGFzaC5pc1R5cGVkQXJyYXkgPSBpc1R5cGVkQXJyYXk7bG9kYXNoLmlzVW5kZWZpbmVkID0gaXNVbmRlZmluZWQ7bG9kYXNoLmpvaW4gPSBqb2luO2xvZGFzaC5rZWJhYkNhc2UgPSBrZWJhYkNhc2U7bG9kYXNoLmxhc3QgPSBsYXN0O2xvZGFzaC5sYXN0SW5kZXhPZiA9IGxhc3RJbmRleE9mO2xvZGFzaC5sb3dlckNhc2UgPSBsb3dlckNhc2U7bG9kYXNoLmxvd2VyRmlyc3QgPSBsb3dlckZpcnN0O2xvZGFzaC5sdCA9IGx0O2xvZGFzaC5sdGUgPSBsdGU7bG9kYXNoLm1heCA9IG1heDtsb2Rhc2gubWF4QnkgPSBtYXhCeTtsb2Rhc2gubWVhbiA9IG1lYW47bG9kYXNoLm1pbiA9IG1pbjtsb2Rhc2gubWluQnkgPSBtaW5CeTtsb2Rhc2gubm9Db25mbGljdCA9IG5vQ29uZmxpY3Q7bG9kYXNoLm5vb3AgPSBub29wO2xvZGFzaC5ub3cgPSBub3c7bG9kYXNoLnBhZCA9IHBhZDtsb2Rhc2gucGFkRW5kID0gcGFkRW5kO2xvZGFzaC5wYWRTdGFydCA9IHBhZFN0YXJ0O2xvZGFzaC5wYXJzZUludCA9IHBhcnNlSW50O2xvZGFzaC5yYW5kb20gPSByYW5kb207bG9kYXNoLnJlZHVjZSA9IHJlZHVjZTtsb2Rhc2gucmVkdWNlUmlnaHQgPSByZWR1Y2VSaWdodDtsb2Rhc2gucmVwZWF0ID0gcmVwZWF0O2xvZGFzaC5yZXBsYWNlID0gcmVwbGFjZTtsb2Rhc2gucmVzdWx0ID0gcmVzdWx0O2xvZGFzaC5yb3VuZCA9IHJvdW5kO2xvZGFzaC5ydW5JbkNvbnRleHQgPSBydW5JbkNvbnRleHQ7bG9kYXNoLnNhbXBsZSA9IHNhbXBsZTtsb2Rhc2guc2l6ZSA9IHNpemU7bG9kYXNoLnNuYWtlQ2FzZSA9IHNuYWtlQ2FzZTtsb2Rhc2guc29tZSA9IHNvbWU7bG9kYXNoLnNvcnRlZEluZGV4ID0gc29ydGVkSW5kZXg7bG9kYXNoLnNvcnRlZEluZGV4QnkgPSBzb3J0ZWRJbmRleEJ5O2xvZGFzaC5zb3J0ZWRJbmRleE9mID0gc29ydGVkSW5kZXhPZjtsb2Rhc2guc29ydGVkTGFzdEluZGV4ID0gc29ydGVkTGFzdEluZGV4O2xvZGFzaC5zb3J0ZWRMYXN0SW5kZXhCeSA9IHNvcnRlZExhc3RJbmRleEJ5O2xvZGFzaC5zb3J0ZWRMYXN0SW5kZXhPZiA9IHNvcnRlZExhc3RJbmRleE9mO2xvZGFzaC5zdGFydENhc2UgPSBzdGFydENhc2U7bG9kYXNoLnN0YXJ0c1dpdGggPSBzdGFydHNXaXRoO2xvZGFzaC5zdWJ0cmFjdCA9IHN1YnRyYWN0O2xvZGFzaC5zdW0gPSBzdW07bG9kYXNoLnN1bUJ5ID0gc3VtQnk7bG9kYXNoLnRlbXBsYXRlID0gdGVtcGxhdGU7bG9kYXNoLnRpbWVzID0gdGltZXM7bG9kYXNoLnRvSW50ZWdlciA9IHRvSW50ZWdlcjtsb2Rhc2gudG9MZW5ndGggPSB0b0xlbmd0aDtsb2Rhc2gudG9Mb3dlciA9IHRvTG93ZXI7bG9kYXNoLnRvTnVtYmVyID0gdG9OdW1iZXI7bG9kYXNoLnRvU2FmZUludGVnZXIgPSB0b1NhZmVJbnRlZ2VyO2xvZGFzaC50b1N0cmluZyA9IHRvU3RyaW5nO2xvZGFzaC50b1VwcGVyID0gdG9VcHBlcjtsb2Rhc2gudHJpbSA9IHRyaW07bG9kYXNoLnRyaW1FbmQgPSB0cmltRW5kO2xvZGFzaC50cmltU3RhcnQgPSB0cmltU3RhcnQ7bG9kYXNoLnRydW5jYXRlID0gdHJ1bmNhdGU7bG9kYXNoLnVuZXNjYXBlID0gdW5lc2NhcGU7bG9kYXNoLnVuaXF1ZUlkID0gdW5pcXVlSWQ7bG9kYXNoLnVwcGVyQ2FzZSA9IHVwcGVyQ2FzZTtsb2Rhc2gudXBwZXJGaXJzdCA9IHVwcGVyRmlyc3Q7bG9kYXNoLmVhY2ggPSBmb3JFYWNoO2xvZGFzaC5lYWNoUmlnaHQgPSBmb3JFYWNoUmlnaHQ7bG9kYXNoLmZpcnN0ID0gaGVhZDttaXhpbihsb2Rhc2gsKGZ1bmN0aW9uKCl7dmFyIHNvdXJjZT17fTtiYXNlRm9yT3duKGxvZGFzaCxmdW5jdGlvbihmdW5jLG1ldGhvZE5hbWUpe2lmKCFoYXNPd25Qcm9wZXJ0eS5jYWxsKGxvZGFzaC5wcm90b3R5cGUsbWV0aG9kTmFtZSkpe3NvdXJjZVttZXRob2ROYW1lXSA9IGZ1bmM7fX0pO3JldHVybiBzb3VyY2U7fSkoKSx7Y2hhaW46ZmFsc2V9KTtsb2Rhc2guVkVSU0lPTiA9IFZFUlNJT047YXJyYXlFYWNoKFtcImJpbmRcIixcImJpbmRLZXlcIixcImN1cnJ5XCIsXCJjdXJyeVJpZ2h0XCIsXCJwYXJ0aWFsXCIsXCJwYXJ0aWFsUmlnaHRcIl0sZnVuY3Rpb24obWV0aG9kTmFtZSl7bG9kYXNoW21ldGhvZE5hbWVdLnBsYWNlaG9sZGVyID0gbG9kYXNoO30pO2FycmF5RWFjaChbXCJkcm9wXCIsXCJ0YWtlXCJdLGZ1bmN0aW9uKG1ldGhvZE5hbWUsaW5kZXgpe0xhenlXcmFwcGVyLnByb3RvdHlwZVttZXRob2ROYW1lXSA9IGZ1bmN0aW9uKG4pe3ZhciBmaWx0ZXJlZD10aGlzLl9fZmlsdGVyZWRfXztpZihmaWx0ZXJlZCAmJiAhaW5kZXgpe3JldHVybiBuZXcgTGF6eVdyYXBwZXIodGhpcyk7fW4gPSBuID09PSB1bmRlZmluZWQ/MTpuYXRpdmVNYXgodG9JbnRlZ2VyKG4pLDApO3ZhciByZXN1bHQ9dGhpcy5jbG9uZSgpO2lmKGZpbHRlcmVkKXtyZXN1bHQuX190YWtlQ291bnRfXyA9IG5hdGl2ZU1pbihuLHJlc3VsdC5fX3Rha2VDb3VudF9fKTt9ZWxzZSB7cmVzdWx0Ll9fdmlld3NfXy5wdXNoKHtzaXplOm5hdGl2ZU1pbihuLE1BWF9BUlJBWV9MRU5HVEgpLHR5cGU6bWV0aG9kTmFtZSArIChyZXN1bHQuX19kaXJfXyA8IDA/XCJSaWdodFwiOlwiXCIpfSk7fXJldHVybiByZXN1bHQ7fTtMYXp5V3JhcHBlci5wcm90b3R5cGVbbWV0aG9kTmFtZSArIFwiUmlnaHRcIl0gPSBmdW5jdGlvbihuKXtyZXR1cm4gdGhpcy5yZXZlcnNlKClbbWV0aG9kTmFtZV0obikucmV2ZXJzZSgpO307fSk7YXJyYXlFYWNoKFtcImZpbHRlclwiLFwibWFwXCIsXCJ0YWtlV2hpbGVcIl0sZnVuY3Rpb24obWV0aG9kTmFtZSxpbmRleCl7dmFyIHR5cGU9aW5kZXggKyAxLGlzRmlsdGVyPXR5cGUgPT0gTEFaWV9GSUxURVJfRkxBRyB8fCB0eXBlID09IExBWllfV0hJTEVfRkxBRztMYXp5V3JhcHBlci5wcm90b3R5cGVbbWV0aG9kTmFtZV0gPSBmdW5jdGlvbihpdGVyYXRlZSl7dmFyIHJlc3VsdD10aGlzLmNsb25lKCk7cmVzdWx0Ll9faXRlcmF0ZWVzX18ucHVzaCh7aXRlcmF0ZWU6Z2V0SXRlcmF0ZWUoaXRlcmF0ZWUsMyksdHlwZTp0eXBlfSk7cmVzdWx0Ll9fZmlsdGVyZWRfXyA9IHJlc3VsdC5fX2ZpbHRlcmVkX18gfHwgaXNGaWx0ZXI7cmV0dXJuIHJlc3VsdDt9O30pO2FycmF5RWFjaChbXCJoZWFkXCIsXCJsYXN0XCJdLGZ1bmN0aW9uKG1ldGhvZE5hbWUsaW5kZXgpe3ZhciB0YWtlTmFtZT1cInRha2VcIiArIChpbmRleD9cIlJpZ2h0XCI6XCJcIik7TGF6eVdyYXBwZXIucHJvdG90eXBlW21ldGhvZE5hbWVdID0gZnVuY3Rpb24oKXtyZXR1cm4gdGhpc1t0YWtlTmFtZV0oMSkudmFsdWUoKVswXTt9O30pO2FycmF5RWFjaChbXCJpbml0aWFsXCIsXCJ0YWlsXCJdLGZ1bmN0aW9uKG1ldGhvZE5hbWUsaW5kZXgpe3ZhciBkcm9wTmFtZT1cImRyb3BcIiArIChpbmRleD9cIlwiOlwiUmlnaHRcIik7TGF6eVdyYXBwZXIucHJvdG90eXBlW21ldGhvZE5hbWVdID0gZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fX2ZpbHRlcmVkX18/bmV3IExhenlXcmFwcGVyKHRoaXMpOnRoaXNbZHJvcE5hbWVdKDEpO307fSk7TGF6eVdyYXBwZXIucHJvdG90eXBlLmNvbXBhY3QgPSBmdW5jdGlvbigpe3JldHVybiB0aGlzLmZpbHRlcihpZGVudGl0eSk7fTtMYXp5V3JhcHBlci5wcm90b3R5cGUuZmluZCA9IGZ1bmN0aW9uKHByZWRpY2F0ZSl7cmV0dXJuIHRoaXMuZmlsdGVyKHByZWRpY2F0ZSkuaGVhZCgpO307TGF6eVdyYXBwZXIucHJvdG90eXBlLmZpbmRMYXN0ID0gZnVuY3Rpb24ocHJlZGljYXRlKXtyZXR1cm4gdGhpcy5yZXZlcnNlKCkuZmluZChwcmVkaWNhdGUpO307TGF6eVdyYXBwZXIucHJvdG90eXBlLmludm9rZU1hcCA9IHJlc3QoZnVuY3Rpb24ocGF0aCxhcmdzKXtpZih0eXBlb2YgcGF0aCA9PSBcImZ1bmN0aW9uXCIpe3JldHVybiBuZXcgTGF6eVdyYXBwZXIodGhpcyk7fXJldHVybiB0aGlzLm1hcChmdW5jdGlvbih2YWx1ZSl7cmV0dXJuIGJhc2VJbnZva2UodmFsdWUscGF0aCxhcmdzKTt9KTt9KTtMYXp5V3JhcHBlci5wcm90b3R5cGUucmVqZWN0ID0gZnVuY3Rpb24ocHJlZGljYXRlKXtwcmVkaWNhdGUgPSBnZXRJdGVyYXRlZShwcmVkaWNhdGUsMyk7cmV0dXJuIHRoaXMuZmlsdGVyKGZ1bmN0aW9uKHZhbHVlKXtyZXR1cm4gIXByZWRpY2F0ZSh2YWx1ZSk7fSk7fTtMYXp5V3JhcHBlci5wcm90b3R5cGUuc2xpY2UgPSBmdW5jdGlvbihzdGFydCxlbmQpe3N0YXJ0ID0gdG9JbnRlZ2VyKHN0YXJ0KTt2YXIgcmVzdWx0PXRoaXM7aWYocmVzdWx0Ll9fZmlsdGVyZWRfXyAmJiAoc3RhcnQgPiAwIHx8IGVuZCA8IDApKXtyZXR1cm4gbmV3IExhenlXcmFwcGVyKHJlc3VsdCk7fWlmKHN0YXJ0IDwgMCl7cmVzdWx0ID0gcmVzdWx0LnRha2VSaWdodCgtc3RhcnQpO31lbHNlIGlmKHN0YXJ0KXtyZXN1bHQgPSByZXN1bHQuZHJvcChzdGFydCk7fWlmKGVuZCAhPT0gdW5kZWZpbmVkKXtlbmQgPSB0b0ludGVnZXIoZW5kKTtyZXN1bHQgPSBlbmQgPCAwP3Jlc3VsdC5kcm9wUmlnaHQoLWVuZCk6cmVzdWx0LnRha2UoZW5kIC0gc3RhcnQpO31yZXR1cm4gcmVzdWx0O307TGF6eVdyYXBwZXIucHJvdG90eXBlLnRha2VSaWdodFdoaWxlID0gZnVuY3Rpb24ocHJlZGljYXRlKXtyZXR1cm4gdGhpcy5yZXZlcnNlKCkudGFrZVdoaWxlKHByZWRpY2F0ZSkucmV2ZXJzZSgpO307TGF6eVdyYXBwZXIucHJvdG90eXBlLnRvQXJyYXkgPSBmdW5jdGlvbigpe3JldHVybiB0aGlzLnRha2UoTUFYX0FSUkFZX0xFTkdUSCk7fTtiYXNlRm9yT3duKExhenlXcmFwcGVyLnByb3RvdHlwZSxmdW5jdGlvbihmdW5jLG1ldGhvZE5hbWUpe3ZhciBjaGVja0l0ZXJhdGVlPS9eKD86ZmlsdGVyfGZpbmR8bWFwfHJlamVjdCl8V2hpbGUkLy50ZXN0KG1ldGhvZE5hbWUpLGlzVGFrZXI9L14oPzpoZWFkfGxhc3QpJC8udGVzdChtZXRob2ROYW1lKSxsb2Rhc2hGdW5jPWxvZGFzaFtpc1Rha2VyP1widGFrZVwiICsgKG1ldGhvZE5hbWUgPT0gXCJsYXN0XCI/XCJSaWdodFwiOlwiXCIpOm1ldGhvZE5hbWVdLHJldFVud3JhcHBlZD1pc1Rha2VyIHx8IC9eZmluZC8udGVzdChtZXRob2ROYW1lKTtpZighbG9kYXNoRnVuYyl7cmV0dXJuO31sb2Rhc2gucHJvdG90eXBlW21ldGhvZE5hbWVdID0gZnVuY3Rpb24oKXt2YXIgdmFsdWU9dGhpcy5fX3dyYXBwZWRfXyxhcmdzPWlzVGFrZXI/WzFdOmFyZ3VtZW50cyxpc0xhenk9dmFsdWUgaW5zdGFuY2VvZiBMYXp5V3JhcHBlcixpdGVyYXRlZT1hcmdzWzBdLHVzZUxhenk9aXNMYXp5IHx8IGlzQXJyYXkodmFsdWUpO3ZhciBpbnRlcmNlcHRvcj1mdW5jdGlvbiBpbnRlcmNlcHRvcih2YWx1ZSl7dmFyIHJlc3VsdD1sb2Rhc2hGdW5jLmFwcGx5KGxvZGFzaCxhcnJheVB1c2goW3ZhbHVlXSxhcmdzKSk7cmV0dXJuIGlzVGFrZXIgJiYgY2hhaW5BbGw/cmVzdWx0WzBdOnJlc3VsdDt9O2lmKHVzZUxhenkgJiYgY2hlY2tJdGVyYXRlZSAmJiB0eXBlb2YgaXRlcmF0ZWUgPT0gXCJmdW5jdGlvblwiICYmIGl0ZXJhdGVlLmxlbmd0aCAhPSAxKXtpc0xhenkgPSB1c2VMYXp5ID0gZmFsc2U7fXZhciBjaGFpbkFsbD10aGlzLl9fY2hhaW5fXyxpc0h5YnJpZD0hIXRoaXMuX19hY3Rpb25zX18ubGVuZ3RoLGlzVW53cmFwcGVkPXJldFVud3JhcHBlZCAmJiAhY2hhaW5BbGwsb25seUxhenk9aXNMYXp5ICYmICFpc0h5YnJpZDtpZighcmV0VW53cmFwcGVkICYmIHVzZUxhenkpe3ZhbHVlID0gb25seUxhenk/dmFsdWU6bmV3IExhenlXcmFwcGVyKHRoaXMpO3ZhciByZXN1bHQ9ZnVuYy5hcHBseSh2YWx1ZSxhcmdzKTtyZXN1bHQuX19hY3Rpb25zX18ucHVzaCh7ZnVuYzp0aHJ1LGFyZ3M6W2ludGVyY2VwdG9yXSx0aGlzQXJnOnVuZGVmaW5lZH0pO3JldHVybiBuZXcgTG9kYXNoV3JhcHBlcihyZXN1bHQsY2hhaW5BbGwpO31pZihpc1Vud3JhcHBlZCAmJiBvbmx5TGF6eSl7cmV0dXJuIGZ1bmMuYXBwbHkodGhpcyxhcmdzKTt9cmVzdWx0ID0gdGhpcy50aHJ1KGludGVyY2VwdG9yKTtyZXR1cm4gaXNVbndyYXBwZWQ/aXNUYWtlcj9yZXN1bHQudmFsdWUoKVswXTpyZXN1bHQudmFsdWUoKTpyZXN1bHQ7fTt9KTthcnJheUVhY2goW1wicG9wXCIsXCJwdXNoXCIsXCJzaGlmdFwiLFwic29ydFwiLFwic3BsaWNlXCIsXCJ1bnNoaWZ0XCJdLGZ1bmN0aW9uKG1ldGhvZE5hbWUpe3ZhciBmdW5jPWFycmF5UHJvdG9bbWV0aG9kTmFtZV0sY2hhaW5OYW1lPS9eKD86cHVzaHxzb3J0fHVuc2hpZnQpJC8udGVzdChtZXRob2ROYW1lKT9cInRhcFwiOlwidGhydVwiLHJldFVud3JhcHBlZD0vXig/OnBvcHxzaGlmdCkkLy50ZXN0KG1ldGhvZE5hbWUpO2xvZGFzaC5wcm90b3R5cGVbbWV0aG9kTmFtZV0gPSBmdW5jdGlvbigpe3ZhciBhcmdzPWFyZ3VtZW50cztpZihyZXRVbndyYXBwZWQgJiYgIXRoaXMuX19jaGFpbl9fKXtyZXR1cm4gZnVuYy5hcHBseSh0aGlzLnZhbHVlKCksYXJncyk7fXJldHVybiB0aGlzW2NoYWluTmFtZV0oZnVuY3Rpb24odmFsdWUpe3JldHVybiBmdW5jLmFwcGx5KHZhbHVlLGFyZ3MpO30pO307fSk7YmFzZUZvck93bihMYXp5V3JhcHBlci5wcm90b3R5cGUsZnVuY3Rpb24oZnVuYyxtZXRob2ROYW1lKXt2YXIgbG9kYXNoRnVuYz1sb2Rhc2hbbWV0aG9kTmFtZV07aWYobG9kYXNoRnVuYyl7dmFyIGtleT1sb2Rhc2hGdW5jLm5hbWUgKyBcIlwiLG5hbWVzPXJlYWxOYW1lc1trZXldIHx8IChyZWFsTmFtZXNba2V5XSA9IFtdKTtuYW1lcy5wdXNoKHtuYW1lOm1ldGhvZE5hbWUsZnVuYzpsb2Rhc2hGdW5jfSk7fX0pO3JlYWxOYW1lc1tjcmVhdGVIeWJyaWRXcmFwcGVyKHVuZGVmaW5lZCxCSU5EX0tFWV9GTEFHKS5uYW1lXSA9IFt7bmFtZTpcIndyYXBwZXJcIixmdW5jOnVuZGVmaW5lZH1dO0xhenlXcmFwcGVyLnByb3RvdHlwZS5jbG9uZSA9IGxhenlDbG9uZTtMYXp5V3JhcHBlci5wcm90b3R5cGUucmV2ZXJzZSA9IGxhenlSZXZlcnNlO0xhenlXcmFwcGVyLnByb3RvdHlwZS52YWx1ZSA9IGxhenlWYWx1ZTtsb2Rhc2gucHJvdG90eXBlLmF0ID0gd3JhcHBlckF0O2xvZGFzaC5wcm90b3R5cGUuY2hhaW4gPSB3cmFwcGVyQ2hhaW47bG9kYXNoLnByb3RvdHlwZS5jb21taXQgPSB3cmFwcGVyQ29tbWl0O2xvZGFzaC5wcm90b3R5cGUuZmxhdE1hcCA9IHdyYXBwZXJGbGF0TWFwO2xvZGFzaC5wcm90b3R5cGUubmV4dCA9IHdyYXBwZXJOZXh0O2xvZGFzaC5wcm90b3R5cGUucGxhbnQgPSB3cmFwcGVyUGxhbnQ7bG9kYXNoLnByb3RvdHlwZS5yZXZlcnNlID0gd3JhcHBlclJldmVyc2U7bG9kYXNoLnByb3RvdHlwZS50b0pTT04gPSBsb2Rhc2gucHJvdG90eXBlLnZhbHVlT2YgPSBsb2Rhc2gucHJvdG90eXBlLnZhbHVlID0gd3JhcHBlclZhbHVlO2lmKGl0ZXJhdG9yU3ltYm9sKXtsb2Rhc2gucHJvdG90eXBlW2l0ZXJhdG9yU3ltYm9sXSA9IHdyYXBwZXJUb0l0ZXJhdG9yO31yZXR1cm4gbG9kYXNoO312YXIgXz1ydW5JbkNvbnRleHQoKTsoZnJlZVdpbmRvdyB8fCBmcmVlU2VsZiB8fCB7fSkuXyA9IF87aWYodHlwZW9mIGRlZmluZSA9PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIGRlZmluZS5hbWQgPT0gXCJvYmplY3RcIiAmJiBkZWZpbmUuYW1kKXtkZWZpbmUoZnVuY3Rpb24oKXtyZXR1cm4gXzt9KTt9ZWxzZSBpZihmcmVlRXhwb3J0cyAmJiBmcmVlTW9kdWxlKXtpZihtb2R1bGVFeHBvcnRzKXsoZnJlZU1vZHVsZS5leHBvcnRzID0gXykuXyA9IF87fWZyZWVFeHBvcnRzLl8gPSBfO31lbHNlIHtyb290Ll8gPSBfO319KS5jYWxsKHVuZGVmaW5lZCk7XG5cbmNjLl9SRnBvcCgpOyIsImNjLl9SRnB1c2gobW9kdWxlLCAnNDc4OGVWTVNGaEwycWdDZ1ROMXJwdWonLCAnbWFpbicpO1xuLy8gYml6L21haW4vc2NyaXB0L21haW4uanNcblxuJ3VzZSBzdHJpY3QnO1xuXG52YXIgYml6U29ja2V0ID0gcmVxdWlyZSgnLi4vLi4vc29ja2V0L2Jpei1zb2NrZXQnKTtcblxuY2MuQ2xhc3Moe1xuICAgICdleHRlbmRzJzogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge30sXG5cbiAgICBlbnRlckFjdGlvbjogZnVuY3Rpb24gZW50ZXJBY3Rpb24oKSB7XG4gICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgnY29udHJvbGxlcicpO1xuICAgICAgICBiaXpTb2NrZXQuY29ubmVjdCgpO1xuICAgIH0sXG5cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uIG9uTG9hZCgpIHt9LFxuXG4gICAgdXBkYXRlOiBmdW5jdGlvbiB1cGRhdGUoZHQpIHt9XG59KTtcblxuY2MuX1JGcG9wKCk7IiwiY2MuX1JGcHVzaChtb2R1bGUsICczNDI3NTZwUGx0UHZJdGlLdWQ3enVjRCcsICdzb2NrZXQuaW8nKTtcbi8vIGxpYi9zb2NrZXQuaW8uanNcblxuXCJ1c2Ugc3RyaWN0XCI7XG5cbihmdW5jdGlvbiAoZikge1xuICBpZiAodHlwZW9mIGV4cG9ydHMgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIG1vZHVsZSAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgIG1vZHVsZS5leHBvcnRzID0gZigpO1xuICB9IGVsc2UgaWYgKHR5cGVvZiBkZWZpbmUgPT09IFwiZnVuY3Rpb25cIiAmJiBkZWZpbmUuYW1kKSB7XG4gICAgZGVmaW5lKFtdLCBmKTtcbiAgfSBlbHNlIHtcbiAgICB2YXIgZztpZiAodHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgZyA9IHdpbmRvdztcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBnbG9iYWwgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgIGcgPSBnbG9iYWw7XG4gICAgfSBlbHNlIGlmICh0eXBlb2Ygc2VsZiAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgZyA9IHNlbGY7XG4gICAgfSBlbHNlIHtcbiAgICAgIGcgPSB0aGlzO1xuICAgIH1nLmlvID0gZigpO1xuICB9XG59KShmdW5jdGlvbiAoKSB7XG4gIHZhciBkZWZpbmUsIG1vZHVsZSwgZXhwb3J0cztyZXR1cm4gKGZ1bmN0aW9uIGUodCwgbiwgcikge1xuICAgIGZ1bmN0aW9uIHMobywgdSkge1xuICAgICAgaWYgKCFuW29dKSB7XG4gICAgICAgIGlmICghdFtvXSkge1xuICAgICAgICAgIHZhciBhID0gdHlwZW9mIHJlcXVpcmUgPT0gXCJmdW5jdGlvblwiICYmIHJlcXVpcmU7aWYgKCF1ICYmIGEpIHJldHVybiBhKG8sICEwKTtpZiAoaSkgcmV0dXJuIGkobywgITApO3ZhciBmID0gbmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIiArIG8gKyBcIidcIik7dGhyb3cgKGYuY29kZSA9IFwiTU9EVUxFX05PVF9GT1VORFwiLCBmKTtcbiAgICAgICAgfXZhciBsID0gbltvXSA9IHsgZXhwb3J0czoge30gfTt0W29dWzBdLmNhbGwobC5leHBvcnRzLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgIHZhciBuID0gdFtvXVsxXVtlXTtyZXR1cm4gcyhuID8gbiA6IGUpO1xuICAgICAgICB9LCBsLCBsLmV4cG9ydHMsIGUsIHQsIG4sIHIpO1xuICAgICAgfXJldHVybiBuW29dLmV4cG9ydHM7XG4gICAgfXZhciBpID0gdHlwZW9mIHJlcXVpcmUgPT0gXCJmdW5jdGlvblwiICYmIHJlcXVpcmU7Zm9yICh2YXIgbyA9IDA7IG8gPCByLmxlbmd0aDsgbysrKSBzKHJbb10pO3JldHVybiBzO1xuICB9KSh7IDE6IFtmdW5jdGlvbiAoX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG4gICAgICBtb2R1bGUuZXhwb3J0cyA9IF9kZXJlcV8oXCIuL2xpYi9cIik7XG4gICAgfSwgeyBcIi4vbGliL1wiOiAyIH1dLCAyOiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuICAgICAgbW9kdWxlLmV4cG9ydHMgPSBfZGVyZXFfKFwiLi9zb2NrZXRcIik7bW9kdWxlLmV4cG9ydHMucGFyc2VyID0gX2RlcmVxXyhcImVuZ2luZS5pby1wYXJzZXJcIik7XG4gICAgfSwgeyBcIi4vc29ja2V0XCI6IDMsIFwiZW5naW5lLmlvLXBhcnNlclwiOiAxOSB9XSwgMzogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcbiAgICAgIChmdW5jdGlvbiAoZ2xvYmFsKSB7XG4gICAgICAgIHZhciB0cmFuc3BvcnRzID0gX2RlcmVxXyhcIi4vdHJhbnNwb3J0c1wiKTt2YXIgRW1pdHRlciA9IF9kZXJlcV8oXCJjb21wb25lbnQtZW1pdHRlclwiKTt2YXIgZGVidWcgPSBfZGVyZXFfKFwiZGVidWdcIikoXCJlbmdpbmUuaW8tY2xpZW50OnNvY2tldFwiKTt2YXIgaW5kZXggPSBfZGVyZXFfKFwiaW5kZXhvZlwiKTt2YXIgcGFyc2VyID0gX2RlcmVxXyhcImVuZ2luZS5pby1wYXJzZXJcIik7dmFyIHBhcnNldXJpID0gX2RlcmVxXyhcInBhcnNldXJpXCIpO3ZhciBwYXJzZWpzb24gPSBfZGVyZXFfKFwicGFyc2Vqc29uXCIpO3ZhciBwYXJzZXFzID0gX2RlcmVxXyhcInBhcnNlcXNcIik7bW9kdWxlLmV4cG9ydHMgPSBTb2NrZXQ7ZnVuY3Rpb24gbm9vcCgpIHt9ZnVuY3Rpb24gU29ja2V0KHVyaSwgb3B0cykge1xuICAgICAgICAgIGlmICghKHRoaXMgaW5zdGFuY2VvZiBTb2NrZXQpKSByZXR1cm4gbmV3IFNvY2tldCh1cmksIG9wdHMpO29wdHMgPSBvcHRzIHx8IHt9O2lmICh1cmkgJiYgXCJvYmplY3RcIiA9PSB0eXBlb2YgdXJpKSB7XG4gICAgICAgICAgICBvcHRzID0gdXJpO3VyaSA9IG51bGw7XG4gICAgICAgICAgfWlmICh1cmkpIHtcbiAgICAgICAgICAgIHVyaSA9IHBhcnNldXJpKHVyaSk7b3B0cy5ob3N0bmFtZSA9IHVyaS5ob3N0O29wdHMuc2VjdXJlID0gdXJpLnByb3RvY29sID09IFwiaHR0cHNcIiB8fCB1cmkucHJvdG9jb2wgPT0gXCJ3c3NcIjtvcHRzLnBvcnQgPSB1cmkucG9ydDtpZiAodXJpLnF1ZXJ5KSBvcHRzLnF1ZXJ5ID0gdXJpLnF1ZXJ5O1xuICAgICAgICAgIH0gZWxzZSBpZiAob3B0cy5ob3N0KSB7XG4gICAgICAgICAgICBvcHRzLmhvc3RuYW1lID0gcGFyc2V1cmkob3B0cy5ob3N0KS5ob3N0O1xuICAgICAgICAgIH10aGlzLnNlY3VyZSA9IG51bGwgIT0gb3B0cy5zZWN1cmUgPyBvcHRzLnNlY3VyZSA6IGdsb2JhbC5sb2NhdGlvbiAmJiBcImh0dHBzOlwiID09IGxvY2F0aW9uLnByb3RvY29sO2lmIChvcHRzLmhvc3RuYW1lICYmICFvcHRzLnBvcnQpIHtcbiAgICAgICAgICAgIG9wdHMucG9ydCA9IHRoaXMuc2VjdXJlID8gXCI0NDNcIiA6IFwiODBcIjtcbiAgICAgICAgICB9dGhpcy5hZ2VudCA9IG9wdHMuYWdlbnQgfHwgZmFsc2U7dGhpcy5ob3N0bmFtZSA9IG9wdHMuaG9zdG5hbWUgfHwgKGdsb2JhbC5sb2NhdGlvbiA/IGxvY2F0aW9uLmhvc3RuYW1lIDogXCJsb2NhbGhvc3RcIik7dGhpcy5wb3J0ID0gb3B0cy5wb3J0IHx8IChnbG9iYWwubG9jYXRpb24gJiYgbG9jYXRpb24ucG9ydCA/IGxvY2F0aW9uLnBvcnQgOiB0aGlzLnNlY3VyZSA/IDQ0MyA6IDgwKTt0aGlzLnF1ZXJ5ID0gb3B0cy5xdWVyeSB8fCB7fTtpZiAoXCJzdHJpbmdcIiA9PSB0eXBlb2YgdGhpcy5xdWVyeSkgdGhpcy5xdWVyeSA9IHBhcnNlcXMuZGVjb2RlKHRoaXMucXVlcnkpO3RoaXMudXBncmFkZSA9IGZhbHNlICE9PSBvcHRzLnVwZ3JhZGU7dGhpcy5wYXRoID0gKG9wdHMucGF0aCB8fCBcIi9lbmdpbmUuaW9cIikucmVwbGFjZSgvXFwvJC8sIFwiXCIpICsgXCIvXCI7dGhpcy5mb3JjZUpTT05QID0gISFvcHRzLmZvcmNlSlNPTlA7dGhpcy5qc29ucCA9IGZhbHNlICE9PSBvcHRzLmpzb25wO3RoaXMuZm9yY2VCYXNlNjQgPSAhIW9wdHMuZm9yY2VCYXNlNjQ7dGhpcy5lbmFibGVzWERSID0gISFvcHRzLmVuYWJsZXNYRFI7dGhpcy50aW1lc3RhbXBQYXJhbSA9IG9wdHMudGltZXN0YW1wUGFyYW0gfHwgXCJ0XCI7dGhpcy50aW1lc3RhbXBSZXF1ZXN0cyA9IG9wdHMudGltZXN0YW1wUmVxdWVzdHM7dGhpcy50cmFuc3BvcnRzID0gb3B0cy50cmFuc3BvcnRzIHx8IFtcInBvbGxpbmdcIiwgXCJ3ZWJzb2NrZXRcIl07dGhpcy5yZWFkeVN0YXRlID0gXCJcIjt0aGlzLndyaXRlQnVmZmVyID0gW107dGhpcy5wb2xpY3lQb3J0ID0gb3B0cy5wb2xpY3lQb3J0IHx8IDg0Mzt0aGlzLnJlbWVtYmVyVXBncmFkZSA9IG9wdHMucmVtZW1iZXJVcGdyYWRlIHx8IGZhbHNlO3RoaXMuYmluYXJ5VHlwZSA9IG51bGw7dGhpcy5vbmx5QmluYXJ5VXBncmFkZXMgPSBvcHRzLm9ubHlCaW5hcnlVcGdyYWRlczt0aGlzLnBlck1lc3NhZ2VEZWZsYXRlID0gZmFsc2UgIT09IG9wdHMucGVyTWVzc2FnZURlZmxhdGUgPyBvcHRzLnBlck1lc3NhZ2VEZWZsYXRlIHx8IHt9IDogZmFsc2U7aWYgKHRydWUgPT09IHRoaXMucGVyTWVzc2FnZURlZmxhdGUpIHRoaXMucGVyTWVzc2FnZURlZmxhdGUgPSB7fTtpZiAodGhpcy5wZXJNZXNzYWdlRGVmbGF0ZSAmJiBudWxsID09IHRoaXMucGVyTWVzc2FnZURlZmxhdGUudGhyZXNob2xkKSB7XG4gICAgICAgICAgICB0aGlzLnBlck1lc3NhZ2VEZWZsYXRlLnRocmVzaG9sZCA9IDEwMjQ7XG4gICAgICAgICAgfXRoaXMucGZ4ID0gb3B0cy5wZnggfHwgbnVsbDt0aGlzLmtleSA9IG9wdHMua2V5IHx8IG51bGw7dGhpcy5wYXNzcGhyYXNlID0gb3B0cy5wYXNzcGhyYXNlIHx8IG51bGw7dGhpcy5jZXJ0ID0gb3B0cy5jZXJ0IHx8IG51bGw7dGhpcy5jYSA9IG9wdHMuY2EgfHwgbnVsbDt0aGlzLmNpcGhlcnMgPSBvcHRzLmNpcGhlcnMgfHwgbnVsbDt0aGlzLnJlamVjdFVuYXV0aG9yaXplZCA9IG9wdHMucmVqZWN0VW5hdXRob3JpemVkID09PSB1bmRlZmluZWQgPyBudWxsIDogb3B0cy5yZWplY3RVbmF1dGhvcml6ZWQ7dmFyIGZyZWVHbG9iYWwgPSB0eXBlb2YgZ2xvYmFsID09IFwib2JqZWN0XCIgJiYgZ2xvYmFsO2lmIChmcmVlR2xvYmFsLmdsb2JhbCA9PT0gZnJlZUdsb2JhbCkge1xuICAgICAgICAgICAgaWYgKG9wdHMuZXh0cmFIZWFkZXJzICYmIE9iamVjdC5rZXlzKG9wdHMuZXh0cmFIZWFkZXJzKS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgIHRoaXMuZXh0cmFIZWFkZXJzID0gb3B0cy5leHRyYUhlYWRlcnM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfXRoaXMub3BlbigpO1xuICAgICAgICB9U29ja2V0LnByaW9yV2Vic29ja2V0U3VjY2VzcyA9IGZhbHNlO0VtaXR0ZXIoU29ja2V0LnByb3RvdHlwZSk7U29ja2V0LnByb3RvY29sID0gcGFyc2VyLnByb3RvY29sO1NvY2tldC5Tb2NrZXQgPSBTb2NrZXQ7U29ja2V0LlRyYW5zcG9ydCA9IF9kZXJlcV8oXCIuL3RyYW5zcG9ydFwiKTtTb2NrZXQudHJhbnNwb3J0cyA9IF9kZXJlcV8oXCIuL3RyYW5zcG9ydHNcIik7U29ja2V0LnBhcnNlciA9IF9kZXJlcV8oXCJlbmdpbmUuaW8tcGFyc2VyXCIpO1NvY2tldC5wcm90b3R5cGUuY3JlYXRlVHJhbnNwb3J0ID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgICBkZWJ1ZygnY3JlYXRpbmcgdHJhbnNwb3J0IFwiJXNcIicsIG5hbWUpO3ZhciBxdWVyeSA9IGNsb25lKHRoaXMucXVlcnkpO3F1ZXJ5LkVJTyA9IHBhcnNlci5wcm90b2NvbDtxdWVyeS50cmFuc3BvcnQgPSBuYW1lO2lmICh0aGlzLmlkKSBxdWVyeS5zaWQgPSB0aGlzLmlkO3ZhciB0cmFuc3BvcnQgPSBuZXcgdHJhbnNwb3J0c1tuYW1lXSh7IGFnZW50OiB0aGlzLmFnZW50LCBob3N0bmFtZTogdGhpcy5ob3N0bmFtZSwgcG9ydDogdGhpcy5wb3J0LCBzZWN1cmU6IHRoaXMuc2VjdXJlLCBwYXRoOiB0aGlzLnBhdGgsIHF1ZXJ5OiBxdWVyeSwgZm9yY2VKU09OUDogdGhpcy5mb3JjZUpTT05QLCBqc29ucDogdGhpcy5qc29ucCwgZm9yY2VCYXNlNjQ6IHRoaXMuZm9yY2VCYXNlNjQsIGVuYWJsZXNYRFI6IHRoaXMuZW5hYmxlc1hEUiwgdGltZXN0YW1wUmVxdWVzdHM6IHRoaXMudGltZXN0YW1wUmVxdWVzdHMsIHRpbWVzdGFtcFBhcmFtOiB0aGlzLnRpbWVzdGFtcFBhcmFtLCBwb2xpY3lQb3J0OiB0aGlzLnBvbGljeVBvcnQsIHNvY2tldDogdGhpcywgcGZ4OiB0aGlzLnBmeCwga2V5OiB0aGlzLmtleSwgcGFzc3BocmFzZTogdGhpcy5wYXNzcGhyYXNlLCBjZXJ0OiB0aGlzLmNlcnQsIGNhOiB0aGlzLmNhLCBjaXBoZXJzOiB0aGlzLmNpcGhlcnMsIHJlamVjdFVuYXV0aG9yaXplZDogdGhpcy5yZWplY3RVbmF1dGhvcml6ZWQsIHBlck1lc3NhZ2VEZWZsYXRlOiB0aGlzLnBlck1lc3NhZ2VEZWZsYXRlLCBleHRyYUhlYWRlcnM6IHRoaXMuZXh0cmFIZWFkZXJzIH0pO3JldHVybiB0cmFuc3BvcnQ7XG4gICAgICAgIH07ZnVuY3Rpb24gY2xvbmUob2JqKSB7XG4gICAgICAgICAgdmFyIG8gPSB7fTtmb3IgKHZhciBpIGluIG9iaikge1xuICAgICAgICAgICAgaWYgKG9iai5oYXNPd25Qcm9wZXJ0eShpKSkge1xuICAgICAgICAgICAgICBvW2ldID0gb2JqW2ldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1yZXR1cm4gbztcbiAgICAgICAgfVNvY2tldC5wcm90b3R5cGUub3BlbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICB2YXIgdHJhbnNwb3J0O2lmICh0aGlzLnJlbWVtYmVyVXBncmFkZSAmJiBTb2NrZXQucHJpb3JXZWJzb2NrZXRTdWNjZXNzICYmIHRoaXMudHJhbnNwb3J0cy5pbmRleE9mKFwid2Vic29ja2V0XCIpICE9IC0xKSB7XG4gICAgICAgICAgICB0cmFuc3BvcnQgPSBcIndlYnNvY2tldFwiO1xuICAgICAgICAgIH0gZWxzZSBpZiAoMCA9PT0gdGhpcy50cmFuc3BvcnRzLmxlbmd0aCkge1xuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO3NldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICBzZWxmLmVtaXQoXCJlcnJvclwiLCBcIk5vIHRyYW5zcG9ydHMgYXZhaWxhYmxlXCIpO1xuICAgICAgICAgICAgfSwgMCk7cmV0dXJuO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0cmFuc3BvcnQgPSB0aGlzLnRyYW5zcG9ydHNbMF07XG4gICAgICAgICAgfXRoaXMucmVhZHlTdGF0ZSA9IFwib3BlbmluZ1wiO3RyeSB7XG4gICAgICAgICAgICB0cmFuc3BvcnQgPSB0aGlzLmNyZWF0ZVRyYW5zcG9ydCh0cmFuc3BvcnQpO1xuICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIHRoaXMudHJhbnNwb3J0cy5zaGlmdCgpO3RoaXMub3BlbigpO3JldHVybjtcbiAgICAgICAgICB9dHJhbnNwb3J0Lm9wZW4oKTt0aGlzLnNldFRyYW5zcG9ydCh0cmFuc3BvcnQpO1xuICAgICAgICB9O1NvY2tldC5wcm90b3R5cGUuc2V0VHJhbnNwb3J0ID0gZnVuY3Rpb24gKHRyYW5zcG9ydCkge1xuICAgICAgICAgIGRlYnVnKFwic2V0dGluZyB0cmFuc3BvcnQgJXNcIiwgdHJhbnNwb3J0Lm5hbWUpO3ZhciBzZWxmID0gdGhpcztpZiAodGhpcy50cmFuc3BvcnQpIHtcbiAgICAgICAgICAgIGRlYnVnKFwiY2xlYXJpbmcgZXhpc3RpbmcgdHJhbnNwb3J0ICVzXCIsIHRoaXMudHJhbnNwb3J0Lm5hbWUpO3RoaXMudHJhbnNwb3J0LnJlbW92ZUFsbExpc3RlbmVycygpO1xuICAgICAgICAgIH10aGlzLnRyYW5zcG9ydCA9IHRyYW5zcG9ydDt0cmFuc3BvcnQub24oXCJkcmFpblwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBzZWxmLm9uRHJhaW4oKTtcbiAgICAgICAgICB9KS5vbihcInBhY2tldFwiLCBmdW5jdGlvbiAocGFja2V0KSB7XG4gICAgICAgICAgICBzZWxmLm9uUGFja2V0KHBhY2tldCk7XG4gICAgICAgICAgfSkub24oXCJlcnJvclwiLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgc2VsZi5vbkVycm9yKGUpO1xuICAgICAgICAgIH0pLm9uKFwiY2xvc2VcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgc2VsZi5vbkNsb3NlKFwidHJhbnNwb3J0IGNsb3NlXCIpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9O1NvY2tldC5wcm90b3R5cGUucHJvYmUgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICAgIGRlYnVnKCdwcm9iaW5nIHRyYW5zcG9ydCBcIiVzXCInLCBuYW1lKTt2YXIgdHJhbnNwb3J0ID0gdGhpcy5jcmVhdGVUcmFuc3BvcnQobmFtZSwgeyBwcm9iZTogMSB9KSxcbiAgICAgICAgICAgICAgZmFpbGVkID0gZmFsc2UsXG4gICAgICAgICAgICAgIHNlbGYgPSB0aGlzO1NvY2tldC5wcmlvcldlYnNvY2tldFN1Y2Nlc3MgPSBmYWxzZTtmdW5jdGlvbiBvblRyYW5zcG9ydE9wZW4oKSB7XG4gICAgICAgICAgICBpZiAoc2VsZi5vbmx5QmluYXJ5VXBncmFkZXMpIHtcbiAgICAgICAgICAgICAgdmFyIHVwZ3JhZGVMb3Nlc0JpbmFyeSA9ICF0aGlzLnN1cHBvcnRzQmluYXJ5ICYmIHNlbGYudHJhbnNwb3J0LnN1cHBvcnRzQmluYXJ5O2ZhaWxlZCA9IGZhaWxlZCB8fCB1cGdyYWRlTG9zZXNCaW5hcnk7XG4gICAgICAgICAgICB9aWYgKGZhaWxlZCkgcmV0dXJuO2RlYnVnKCdwcm9iZSB0cmFuc3BvcnQgXCIlc1wiIG9wZW5lZCcsIG5hbWUpO3RyYW5zcG9ydC5zZW5kKFt7IHR5cGU6IFwicGluZ1wiLCBkYXRhOiBcInByb2JlXCIgfV0pO3RyYW5zcG9ydC5vbmNlKFwicGFja2V0XCIsIGZ1bmN0aW9uIChtc2cpIHtcbiAgICAgICAgICAgICAgaWYgKGZhaWxlZCkgcmV0dXJuO2lmIChcInBvbmdcIiA9PSBtc2cudHlwZSAmJiBcInByb2JlXCIgPT0gbXNnLmRhdGEpIHtcbiAgICAgICAgICAgICAgICBkZWJ1ZygncHJvYmUgdHJhbnNwb3J0IFwiJXNcIiBwb25nJywgbmFtZSk7c2VsZi51cGdyYWRpbmcgPSB0cnVlO3NlbGYuZW1pdChcInVwZ3JhZGluZ1wiLCB0cmFuc3BvcnQpO2lmICghdHJhbnNwb3J0KSByZXR1cm47U29ja2V0LnByaW9yV2Vic29ja2V0U3VjY2VzcyA9IFwid2Vic29ja2V0XCIgPT0gdHJhbnNwb3J0Lm5hbWU7ZGVidWcoJ3BhdXNpbmcgY3VycmVudCB0cmFuc3BvcnQgXCIlc1wiJywgc2VsZi50cmFuc3BvcnQubmFtZSk7c2VsZi50cmFuc3BvcnQucGF1c2UoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgaWYgKGZhaWxlZCkgcmV0dXJuO2lmIChcImNsb3NlZFwiID09IHNlbGYucmVhZHlTdGF0ZSkgcmV0dXJuO2RlYnVnKFwiY2hhbmdpbmcgdHJhbnNwb3J0IGFuZCBzZW5kaW5nIHVwZ3JhZGUgcGFja2V0XCIpO2NsZWFudXAoKTtzZWxmLnNldFRyYW5zcG9ydCh0cmFuc3BvcnQpO3RyYW5zcG9ydC5zZW5kKFt7IHR5cGU6IFwidXBncmFkZVwiIH1dKTtzZWxmLmVtaXQoXCJ1cGdyYWRlXCIsIHRyYW5zcG9ydCk7dHJhbnNwb3J0ID0gbnVsbDtzZWxmLnVwZ3JhZGluZyA9IGZhbHNlO3NlbGYuZmx1c2goKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBkZWJ1ZygncHJvYmUgdHJhbnNwb3J0IFwiJXNcIiBmYWlsZWQnLCBuYW1lKTt2YXIgZXJyID0gbmV3IEVycm9yKFwicHJvYmUgZXJyb3JcIik7ZXJyLnRyYW5zcG9ydCA9IHRyYW5zcG9ydC5uYW1lO3NlbGYuZW1pdChcInVwZ3JhZGVFcnJvclwiLCBlcnIpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9ZnVuY3Rpb24gZnJlZXplVHJhbnNwb3J0KCkge1xuICAgICAgICAgICAgaWYgKGZhaWxlZCkgcmV0dXJuO2ZhaWxlZCA9IHRydWU7Y2xlYW51cCgpO3RyYW5zcG9ydC5jbG9zZSgpO3RyYW5zcG9ydCA9IG51bGw7XG4gICAgICAgICAgfWZ1bmN0aW9uIG9uZXJyb3IoZXJyKSB7XG4gICAgICAgICAgICB2YXIgZXJyb3IgPSBuZXcgRXJyb3IoXCJwcm9iZSBlcnJvcjogXCIgKyBlcnIpO2Vycm9yLnRyYW5zcG9ydCA9IHRyYW5zcG9ydC5uYW1lO2ZyZWV6ZVRyYW5zcG9ydCgpO2RlYnVnKCdwcm9iZSB0cmFuc3BvcnQgXCIlc1wiIGZhaWxlZCBiZWNhdXNlIG9mIGVycm9yOiAlcycsIG5hbWUsIGVycik7c2VsZi5lbWl0KFwidXBncmFkZUVycm9yXCIsIGVycm9yKTtcbiAgICAgICAgICB9ZnVuY3Rpb24gb25UcmFuc3BvcnRDbG9zZSgpIHtcbiAgICAgICAgICAgIG9uZXJyb3IoXCJ0cmFuc3BvcnQgY2xvc2VkXCIpO1xuICAgICAgICAgIH1mdW5jdGlvbiBvbmNsb3NlKCkge1xuICAgICAgICAgICAgb25lcnJvcihcInNvY2tldCBjbG9zZWRcIik7XG4gICAgICAgICAgfWZ1bmN0aW9uIG9udXBncmFkZSh0bykge1xuICAgICAgICAgICAgaWYgKHRyYW5zcG9ydCAmJiB0by5uYW1lICE9IHRyYW5zcG9ydC5uYW1lKSB7XG4gICAgICAgICAgICAgIGRlYnVnKCdcIiVzXCIgd29ya3MgLSBhYm9ydGluZyBcIiVzXCInLCB0by5uYW1lLCB0cmFuc3BvcnQubmFtZSk7ZnJlZXplVHJhbnNwb3J0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfWZ1bmN0aW9uIGNsZWFudXAoKSB7XG4gICAgICAgICAgICB0cmFuc3BvcnQucmVtb3ZlTGlzdGVuZXIoXCJvcGVuXCIsIG9uVHJhbnNwb3J0T3Blbik7dHJhbnNwb3J0LnJlbW92ZUxpc3RlbmVyKFwiZXJyb3JcIiwgb25lcnJvcik7dHJhbnNwb3J0LnJlbW92ZUxpc3RlbmVyKFwiY2xvc2VcIiwgb25UcmFuc3BvcnRDbG9zZSk7c2VsZi5yZW1vdmVMaXN0ZW5lcihcImNsb3NlXCIsIG9uY2xvc2UpO3NlbGYucmVtb3ZlTGlzdGVuZXIoXCJ1cGdyYWRpbmdcIiwgb251cGdyYWRlKTtcbiAgICAgICAgICB9dHJhbnNwb3J0Lm9uY2UoXCJvcGVuXCIsIG9uVHJhbnNwb3J0T3Blbik7dHJhbnNwb3J0Lm9uY2UoXCJlcnJvclwiLCBvbmVycm9yKTt0cmFuc3BvcnQub25jZShcImNsb3NlXCIsIG9uVHJhbnNwb3J0Q2xvc2UpO3RoaXMub25jZShcImNsb3NlXCIsIG9uY2xvc2UpO3RoaXMub25jZShcInVwZ3JhZGluZ1wiLCBvbnVwZ3JhZGUpO3RyYW5zcG9ydC5vcGVuKCk7XG4gICAgICAgIH07U29ja2V0LnByb3RvdHlwZS5vbk9wZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgZGVidWcoXCJzb2NrZXQgb3BlblwiKTt0aGlzLnJlYWR5U3RhdGUgPSBcIm9wZW5cIjtTb2NrZXQucHJpb3JXZWJzb2NrZXRTdWNjZXNzID0gXCJ3ZWJzb2NrZXRcIiA9PSB0aGlzLnRyYW5zcG9ydC5uYW1lO3RoaXMuZW1pdChcIm9wZW5cIik7dGhpcy5mbHVzaCgpO2lmIChcIm9wZW5cIiA9PSB0aGlzLnJlYWR5U3RhdGUgJiYgdGhpcy51cGdyYWRlICYmIHRoaXMudHJhbnNwb3J0LnBhdXNlKSB7XG4gICAgICAgICAgICBkZWJ1ZyhcInN0YXJ0aW5nIHVwZ3JhZGUgcHJvYmVzXCIpO2ZvciAodmFyIGkgPSAwLCBsID0gdGhpcy51cGdyYWRlcy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICAgICAgdGhpcy5wcm9iZSh0aGlzLnVwZ3JhZGVzW2ldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH07U29ja2V0LnByb3RvdHlwZS5vblBhY2tldCA9IGZ1bmN0aW9uIChwYWNrZXQpIHtcbiAgICAgICAgICBpZiAoXCJvcGVuaW5nXCIgPT0gdGhpcy5yZWFkeVN0YXRlIHx8IFwib3BlblwiID09IHRoaXMucmVhZHlTdGF0ZSkge1xuICAgICAgICAgICAgZGVidWcoJ3NvY2tldCByZWNlaXZlOiB0eXBlIFwiJXNcIiwgZGF0YSBcIiVzXCInLCBwYWNrZXQudHlwZSwgcGFja2V0LmRhdGEpO3RoaXMuZW1pdChcInBhY2tldFwiLCBwYWNrZXQpO3RoaXMuZW1pdChcImhlYXJ0YmVhdFwiKTtzd2l0Y2ggKHBhY2tldC50eXBlKSB7Y2FzZSBcIm9wZW5cIjpcbiAgICAgICAgICAgICAgICB0aGlzLm9uSGFuZHNoYWtlKHBhcnNlanNvbihwYWNrZXQuZGF0YSkpO2JyZWFrO2Nhc2UgXCJwb25nXCI6XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRQaW5nKCk7dGhpcy5lbWl0KFwicG9uZ1wiKTticmVhaztjYXNlIFwiZXJyb3JcIjpcbiAgICAgICAgICAgICAgICB2YXIgZXJyID0gbmV3IEVycm9yKFwic2VydmVyIGVycm9yXCIpO2Vyci5jb2RlID0gcGFja2V0LmRhdGE7dGhpcy5vbkVycm9yKGVycik7YnJlYWs7Y2FzZSBcIm1lc3NhZ2VcIjpcbiAgICAgICAgICAgICAgICB0aGlzLmVtaXQoXCJkYXRhXCIsIHBhY2tldC5kYXRhKTt0aGlzLmVtaXQoXCJtZXNzYWdlXCIsIHBhY2tldC5kYXRhKTticmVhazt9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGRlYnVnKCdwYWNrZXQgcmVjZWl2ZWQgd2l0aCBzb2NrZXQgcmVhZHlTdGF0ZSBcIiVzXCInLCB0aGlzLnJlYWR5U3RhdGUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtTb2NrZXQucHJvdG90eXBlLm9uSGFuZHNoYWtlID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICB0aGlzLmVtaXQoXCJoYW5kc2hha2VcIiwgZGF0YSk7dGhpcy5pZCA9IGRhdGEuc2lkO3RoaXMudHJhbnNwb3J0LnF1ZXJ5LnNpZCA9IGRhdGEuc2lkO3RoaXMudXBncmFkZXMgPSB0aGlzLmZpbHRlclVwZ3JhZGVzKGRhdGEudXBncmFkZXMpO3RoaXMucGluZ0ludGVydmFsID0gZGF0YS5waW5nSW50ZXJ2YWw7dGhpcy5waW5nVGltZW91dCA9IGRhdGEucGluZ1RpbWVvdXQ7dGhpcy5vbk9wZW4oKTtpZiAoXCJjbG9zZWRcIiA9PSB0aGlzLnJlYWR5U3RhdGUpIHJldHVybjt0aGlzLnNldFBpbmcoKTt0aGlzLnJlbW92ZUxpc3RlbmVyKFwiaGVhcnRiZWF0XCIsIHRoaXMub25IZWFydGJlYXQpO3RoaXMub24oXCJoZWFydGJlYXRcIiwgdGhpcy5vbkhlYXJ0YmVhdCk7XG4gICAgICAgIH07U29ja2V0LnByb3RvdHlwZS5vbkhlYXJ0YmVhdCA9IGZ1bmN0aW9uICh0aW1lb3V0KSB7XG4gICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMucGluZ1RpbWVvdXRUaW1lcik7dmFyIHNlbGYgPSB0aGlzO3NlbGYucGluZ1RpbWVvdXRUaW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKFwiY2xvc2VkXCIgPT0gc2VsZi5yZWFkeVN0YXRlKSByZXR1cm47c2VsZi5vbkNsb3NlKFwicGluZyB0aW1lb3V0XCIpO1xuICAgICAgICAgIH0sIHRpbWVvdXQgfHwgc2VsZi5waW5nSW50ZXJ2YWwgKyBzZWxmLnBpbmdUaW1lb3V0KTtcbiAgICAgICAgfTtTb2NrZXQucHJvdG90eXBlLnNldFBpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO2NsZWFyVGltZW91dChzZWxmLnBpbmdJbnRlcnZhbFRpbWVyKTtzZWxmLnBpbmdJbnRlcnZhbFRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBkZWJ1ZyhcIndyaXRpbmcgcGluZyBwYWNrZXQgLSBleHBlY3RpbmcgcG9uZyB3aXRoaW4gJXNtc1wiLCBzZWxmLnBpbmdUaW1lb3V0KTtzZWxmLnBpbmcoKTtzZWxmLm9uSGVhcnRiZWF0KHNlbGYucGluZ1RpbWVvdXQpO1xuICAgICAgICAgIH0sIHNlbGYucGluZ0ludGVydmFsKTtcbiAgICAgICAgfTtTb2NrZXQucHJvdG90eXBlLnBpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO3RoaXMuc2VuZFBhY2tldChcInBpbmdcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgc2VsZi5lbWl0KFwicGluZ1wiKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfTtTb2NrZXQucHJvdG90eXBlLm9uRHJhaW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgdGhpcy53cml0ZUJ1ZmZlci5zcGxpY2UoMCwgdGhpcy5wcmV2QnVmZmVyTGVuKTt0aGlzLnByZXZCdWZmZXJMZW4gPSAwO2lmICgwID09PSB0aGlzLndyaXRlQnVmZmVyLmxlbmd0aCkge1xuICAgICAgICAgICAgdGhpcy5lbWl0KFwiZHJhaW5cIik7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuZmx1c2goKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07U29ja2V0LnByb3RvdHlwZS5mbHVzaCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBpZiAoXCJjbG9zZWRcIiAhPSB0aGlzLnJlYWR5U3RhdGUgJiYgdGhpcy50cmFuc3BvcnQud3JpdGFibGUgJiYgIXRoaXMudXBncmFkaW5nICYmIHRoaXMud3JpdGVCdWZmZXIubGVuZ3RoKSB7XG4gICAgICAgICAgICBkZWJ1ZyhcImZsdXNoaW5nICVkIHBhY2tldHMgaW4gc29ja2V0XCIsIHRoaXMud3JpdGVCdWZmZXIubGVuZ3RoKTt0aGlzLnRyYW5zcG9ydC5zZW5kKHRoaXMud3JpdGVCdWZmZXIpO3RoaXMucHJldkJ1ZmZlckxlbiA9IHRoaXMud3JpdGVCdWZmZXIubGVuZ3RoO3RoaXMuZW1pdChcImZsdXNoXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtTb2NrZXQucHJvdG90eXBlLndyaXRlID0gU29ja2V0LnByb3RvdHlwZS5zZW5kID0gZnVuY3Rpb24gKG1zZywgb3B0aW9ucywgZm4pIHtcbiAgICAgICAgICB0aGlzLnNlbmRQYWNrZXQoXCJtZXNzYWdlXCIsIG1zZywgb3B0aW9ucywgZm4pO3JldHVybiB0aGlzO1xuICAgICAgICB9O1NvY2tldC5wcm90b3R5cGUuc2VuZFBhY2tldCA9IGZ1bmN0aW9uICh0eXBlLCBkYXRhLCBvcHRpb25zLCBmbikge1xuICAgICAgICAgIGlmIChcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIGRhdGEpIHtcbiAgICAgICAgICAgIGZuID0gZGF0YTtkYXRhID0gdW5kZWZpbmVkO1xuICAgICAgICAgIH1pZiAoXCJmdW5jdGlvblwiID09IHR5cGVvZiBvcHRpb25zKSB7XG4gICAgICAgICAgICBmbiA9IG9wdGlvbnM7b3B0aW9ucyA9IG51bGw7XG4gICAgICAgICAgfWlmIChcImNsb3NpbmdcIiA9PSB0aGlzLnJlYWR5U3RhdGUgfHwgXCJjbG9zZWRcIiA9PSB0aGlzLnJlYWR5U3RhdGUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9b3B0aW9ucyA9IG9wdGlvbnMgfHwge307b3B0aW9ucy5jb21wcmVzcyA9IGZhbHNlICE9PSBvcHRpb25zLmNvbXByZXNzO3ZhciBwYWNrZXQgPSB7IHR5cGU6IHR5cGUsIGRhdGE6IGRhdGEsIG9wdGlvbnM6IG9wdGlvbnMgfTt0aGlzLmVtaXQoXCJwYWNrZXRDcmVhdGVcIiwgcGFja2V0KTt0aGlzLndyaXRlQnVmZmVyLnB1c2gocGFja2V0KTtpZiAoZm4pIHRoaXMub25jZShcImZsdXNoXCIsIGZuKTt0aGlzLmZsdXNoKCk7XG4gICAgICAgIH07U29ja2V0LnByb3RvdHlwZS5jbG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBpZiAoXCJvcGVuaW5nXCIgPT0gdGhpcy5yZWFkeVN0YXRlIHx8IFwib3BlblwiID09IHRoaXMucmVhZHlTdGF0ZSkge1xuICAgICAgICAgICAgdGhpcy5yZWFkeVN0YXRlID0gXCJjbG9zaW5nXCI7dmFyIHNlbGYgPSB0aGlzO2lmICh0aGlzLndyaXRlQnVmZmVyLmxlbmd0aCkge1xuICAgICAgICAgICAgICB0aGlzLm9uY2UoXCJkcmFpblwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudXBncmFkaW5nKSB7XG4gICAgICAgICAgICAgICAgICB3YWl0Rm9yVXBncmFkZSgpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICBjbG9zZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMudXBncmFkaW5nKSB7XG4gICAgICAgICAgICAgIHdhaXRGb3JVcGdyYWRlKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBjbG9zZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1mdW5jdGlvbiBjbG9zZSgpIHtcbiAgICAgICAgICAgIHNlbGYub25DbG9zZShcImZvcmNlZCBjbG9zZVwiKTtkZWJ1ZyhcInNvY2tldCBjbG9zaW5nIC0gdGVsbGluZyB0cmFuc3BvcnQgdG8gY2xvc2VcIik7c2VsZi50cmFuc3BvcnQuY2xvc2UoKTtcbiAgICAgICAgICB9ZnVuY3Rpb24gY2xlYW51cEFuZENsb3NlKCkge1xuICAgICAgICAgICAgc2VsZi5yZW1vdmVMaXN0ZW5lcihcInVwZ3JhZGVcIiwgY2xlYW51cEFuZENsb3NlKTtzZWxmLnJlbW92ZUxpc3RlbmVyKFwidXBncmFkZUVycm9yXCIsIGNsZWFudXBBbmRDbG9zZSk7Y2xvc2UoKTtcbiAgICAgICAgICB9ZnVuY3Rpb24gd2FpdEZvclVwZ3JhZGUoKSB7XG4gICAgICAgICAgICBzZWxmLm9uY2UoXCJ1cGdyYWRlXCIsIGNsZWFudXBBbmRDbG9zZSk7c2VsZi5vbmNlKFwidXBncmFkZUVycm9yXCIsIGNsZWFudXBBbmRDbG9zZSk7XG4gICAgICAgICAgfXJldHVybiB0aGlzO1xuICAgICAgICB9O1NvY2tldC5wcm90b3R5cGUub25FcnJvciA9IGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICBkZWJ1ZyhcInNvY2tldCBlcnJvciAlalwiLCBlcnIpO1NvY2tldC5wcmlvcldlYnNvY2tldFN1Y2Nlc3MgPSBmYWxzZTt0aGlzLmVtaXQoXCJlcnJvclwiLCBlcnIpO3RoaXMub25DbG9zZShcInRyYW5zcG9ydCBlcnJvclwiLCBlcnIpO1xuICAgICAgICB9O1NvY2tldC5wcm90b3R5cGUub25DbG9zZSA9IGZ1bmN0aW9uIChyZWFzb24sIGRlc2MpIHtcbiAgICAgICAgICBpZiAoXCJvcGVuaW5nXCIgPT0gdGhpcy5yZWFkeVN0YXRlIHx8IFwib3BlblwiID09IHRoaXMucmVhZHlTdGF0ZSB8fCBcImNsb3NpbmdcIiA9PSB0aGlzLnJlYWR5U3RhdGUpIHtcbiAgICAgICAgICAgIGRlYnVnKCdzb2NrZXQgY2xvc2Ugd2l0aCByZWFzb246IFwiJXNcIicsIHJlYXNvbik7dmFyIHNlbGYgPSB0aGlzO2NsZWFyVGltZW91dCh0aGlzLnBpbmdJbnRlcnZhbFRpbWVyKTtjbGVhclRpbWVvdXQodGhpcy5waW5nVGltZW91dFRpbWVyKTt0aGlzLnRyYW5zcG9ydC5yZW1vdmVBbGxMaXN0ZW5lcnMoXCJjbG9zZVwiKTt0aGlzLnRyYW5zcG9ydC5jbG9zZSgpO3RoaXMudHJhbnNwb3J0LnJlbW92ZUFsbExpc3RlbmVycygpO3RoaXMucmVhZHlTdGF0ZSA9IFwiY2xvc2VkXCI7dGhpcy5pZCA9IG51bGw7dGhpcy5lbWl0KFwiY2xvc2VcIiwgcmVhc29uLCBkZXNjKTtzZWxmLndyaXRlQnVmZmVyID0gW107c2VsZi5wcmV2QnVmZmVyTGVuID0gMDtcbiAgICAgICAgICB9XG4gICAgICAgIH07U29ja2V0LnByb3RvdHlwZS5maWx0ZXJVcGdyYWRlcyA9IGZ1bmN0aW9uICh1cGdyYWRlcykge1xuICAgICAgICAgIHZhciBmaWx0ZXJlZFVwZ3JhZGVzID0gW107Zm9yICh2YXIgaSA9IDAsIGogPSB1cGdyYWRlcy5sZW5ndGg7IGkgPCBqOyBpKyspIHtcbiAgICAgICAgICAgIGlmICh+aW5kZXgodGhpcy50cmFuc3BvcnRzLCB1cGdyYWRlc1tpXSkpIGZpbHRlcmVkVXBncmFkZXMucHVzaCh1cGdyYWRlc1tpXSk7XG4gICAgICAgICAgfXJldHVybiBmaWx0ZXJlZFVwZ3JhZGVzO1xuICAgICAgICB9O1xuICAgICAgfSkuY2FsbCh0aGlzLCB0eXBlb2Ygc2VsZiAhPT0gXCJ1bmRlZmluZWRcIiA/IHNlbGYgOiB0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiID8gd2luZG93IDogdHlwZW9mIGdsb2JhbCAhPT0gXCJ1bmRlZmluZWRcIiA/IGdsb2JhbCA6IHt9KTtcbiAgICB9LCB7IFwiLi90cmFuc3BvcnRcIjogNCwgXCIuL3RyYW5zcG9ydHNcIjogNSwgXCJjb21wb25lbnQtZW1pdHRlclwiOiAxNSwgZGVidWc6IDE3LCBcImVuZ2luZS5pby1wYXJzZXJcIjogMTksIGluZGV4b2Y6IDIzLCBwYXJzZWpzb246IDI2LCBwYXJzZXFzOiAyNywgcGFyc2V1cmk6IDI4IH1dLCA0OiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuICAgICAgdmFyIHBhcnNlciA9IF9kZXJlcV8oXCJlbmdpbmUuaW8tcGFyc2VyXCIpO3ZhciBFbWl0dGVyID0gX2RlcmVxXyhcImNvbXBvbmVudC1lbWl0dGVyXCIpO21vZHVsZS5leHBvcnRzID0gVHJhbnNwb3J0O2Z1bmN0aW9uIFRyYW5zcG9ydChvcHRzKSB7XG4gICAgICAgIHRoaXMucGF0aCA9IG9wdHMucGF0aDt0aGlzLmhvc3RuYW1lID0gb3B0cy5ob3N0bmFtZTt0aGlzLnBvcnQgPSBvcHRzLnBvcnQ7dGhpcy5zZWN1cmUgPSBvcHRzLnNlY3VyZTt0aGlzLnF1ZXJ5ID0gb3B0cy5xdWVyeTt0aGlzLnRpbWVzdGFtcFBhcmFtID0gb3B0cy50aW1lc3RhbXBQYXJhbTt0aGlzLnRpbWVzdGFtcFJlcXVlc3RzID0gb3B0cy50aW1lc3RhbXBSZXF1ZXN0czt0aGlzLnJlYWR5U3RhdGUgPSBcIlwiO3RoaXMuYWdlbnQgPSBvcHRzLmFnZW50IHx8IGZhbHNlO3RoaXMuc29ja2V0ID0gb3B0cy5zb2NrZXQ7dGhpcy5lbmFibGVzWERSID0gb3B0cy5lbmFibGVzWERSO3RoaXMucGZ4ID0gb3B0cy5wZng7dGhpcy5rZXkgPSBvcHRzLmtleTt0aGlzLnBhc3NwaHJhc2UgPSBvcHRzLnBhc3NwaHJhc2U7dGhpcy5jZXJ0ID0gb3B0cy5jZXJ0O3RoaXMuY2EgPSBvcHRzLmNhO3RoaXMuY2lwaGVycyA9IG9wdHMuY2lwaGVyczt0aGlzLnJlamVjdFVuYXV0aG9yaXplZCA9IG9wdHMucmVqZWN0VW5hdXRob3JpemVkO3RoaXMuZXh0cmFIZWFkZXJzID0gb3B0cy5leHRyYUhlYWRlcnM7XG4gICAgICB9RW1pdHRlcihUcmFuc3BvcnQucHJvdG90eXBlKTtUcmFuc3BvcnQucHJvdG90eXBlLm9uRXJyb3IgPSBmdW5jdGlvbiAobXNnLCBkZXNjKSB7XG4gICAgICAgIHZhciBlcnIgPSBuZXcgRXJyb3IobXNnKTtlcnIudHlwZSA9IFwiVHJhbnNwb3J0RXJyb3JcIjtlcnIuZGVzY3JpcHRpb24gPSBkZXNjO3RoaXMuZW1pdChcImVycm9yXCIsIGVycik7cmV0dXJuIHRoaXM7XG4gICAgICB9O1RyYW5zcG9ydC5wcm90b3R5cGUub3BlbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKFwiY2xvc2VkXCIgPT0gdGhpcy5yZWFkeVN0YXRlIHx8IFwiXCIgPT0gdGhpcy5yZWFkeVN0YXRlKSB7XG4gICAgICAgICAgdGhpcy5yZWFkeVN0YXRlID0gXCJvcGVuaW5nXCI7dGhpcy5kb09wZW4oKTtcbiAgICAgICAgfXJldHVybiB0aGlzO1xuICAgICAgfTtUcmFuc3BvcnQucHJvdG90eXBlLmNsb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoXCJvcGVuaW5nXCIgPT0gdGhpcy5yZWFkeVN0YXRlIHx8IFwib3BlblwiID09IHRoaXMucmVhZHlTdGF0ZSkge1xuICAgICAgICAgIHRoaXMuZG9DbG9zZSgpO3RoaXMub25DbG9zZSgpO1xuICAgICAgICB9cmV0dXJuIHRoaXM7XG4gICAgICB9O1RyYW5zcG9ydC5wcm90b3R5cGUuc2VuZCA9IGZ1bmN0aW9uIChwYWNrZXRzKSB7XG4gICAgICAgIGlmIChcIm9wZW5cIiA9PSB0aGlzLnJlYWR5U3RhdGUpIHtcbiAgICAgICAgICB0aGlzLndyaXRlKHBhY2tldHMpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRyYW5zcG9ydCBub3Qgb3BlblwiKTtcbiAgICAgICAgfVxuICAgICAgfTtUcmFuc3BvcnQucHJvdG90eXBlLm9uT3BlbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5yZWFkeVN0YXRlID0gXCJvcGVuXCI7dGhpcy53cml0YWJsZSA9IHRydWU7dGhpcy5lbWl0KFwib3BlblwiKTtcbiAgICAgIH07VHJhbnNwb3J0LnByb3RvdHlwZS5vbkRhdGEgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICB2YXIgcGFja2V0ID0gcGFyc2VyLmRlY29kZVBhY2tldChkYXRhLCB0aGlzLnNvY2tldC5iaW5hcnlUeXBlKTt0aGlzLm9uUGFja2V0KHBhY2tldCk7XG4gICAgICB9O1RyYW5zcG9ydC5wcm90b3R5cGUub25QYWNrZXQgPSBmdW5jdGlvbiAocGFja2V0KSB7XG4gICAgICAgIHRoaXMuZW1pdChcInBhY2tldFwiLCBwYWNrZXQpO1xuICAgICAgfTtUcmFuc3BvcnQucHJvdG90eXBlLm9uQ2xvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMucmVhZHlTdGF0ZSA9IFwiY2xvc2VkXCI7dGhpcy5lbWl0KFwiY2xvc2VcIik7XG4gICAgICB9O1xuICAgIH0sIHsgXCJjb21wb25lbnQtZW1pdHRlclwiOiAxNSwgXCJlbmdpbmUuaW8tcGFyc2VyXCI6IDE5IH1dLCA1OiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuICAgICAgKGZ1bmN0aW9uIChnbG9iYWwpIHtcbiAgICAgICAgdmFyIFhNTEh0dHBSZXF1ZXN0ID0gX2RlcmVxXyhcInhtbGh0dHByZXF1ZXN0LXNzbFwiKTt2YXIgWEhSID0gX2RlcmVxXyhcIi4vcG9sbGluZy14aHJcIik7dmFyIEpTT05QID0gX2RlcmVxXyhcIi4vcG9sbGluZy1qc29ucFwiKTt2YXIgd2Vic29ja2V0ID0gX2RlcmVxXyhcIi4vd2Vic29ja2V0XCIpO2V4cG9ydHMucG9sbGluZyA9IHBvbGxpbmc7ZXhwb3J0cy53ZWJzb2NrZXQgPSB3ZWJzb2NrZXQ7ZnVuY3Rpb24gcG9sbGluZyhvcHRzKSB7XG4gICAgICAgICAgdmFyIHhocjt2YXIgeGQgPSBmYWxzZTt2YXIgeHMgPSBmYWxzZTt2YXIganNvbnAgPSBmYWxzZSAhPT0gb3B0cy5qc29ucDtpZiAoZ2xvYmFsLmxvY2F0aW9uKSB7XG4gICAgICAgICAgICB2YXIgaXNTU0wgPSBcImh0dHBzOlwiID09IGxvY2F0aW9uLnByb3RvY29sO3ZhciBwb3J0ID0gbG9jYXRpb24ucG9ydDtpZiAoIXBvcnQpIHtcbiAgICAgICAgICAgICAgcG9ydCA9IGlzU1NMID8gNDQzIDogODA7XG4gICAgICAgICAgICB9eGQgPSBvcHRzLmhvc3RuYW1lICE9IGxvY2F0aW9uLmhvc3RuYW1lIHx8IHBvcnQgIT0gb3B0cy5wb3J0O3hzID0gb3B0cy5zZWN1cmUgIT0gaXNTU0w7XG4gICAgICAgICAgfW9wdHMueGRvbWFpbiA9IHhkO29wdHMueHNjaGVtZSA9IHhzO3hociA9IG5ldyBYTUxIdHRwUmVxdWVzdChvcHRzKTtpZiAoXCJvcGVuXCIgaW4geGhyICYmICFvcHRzLmZvcmNlSlNPTlApIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgWEhSKG9wdHMpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAoIWpzb25wKSB0aHJvdyBuZXcgRXJyb3IoXCJKU09OUCBkaXNhYmxlZFwiKTtyZXR1cm4gbmV3IEpTT05QKG9wdHMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSkuY2FsbCh0aGlzLCB0eXBlb2Ygc2VsZiAhPT0gXCJ1bmRlZmluZWRcIiA/IHNlbGYgOiB0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiID8gd2luZG93IDogdHlwZW9mIGdsb2JhbCAhPT0gXCJ1bmRlZmluZWRcIiA/IGdsb2JhbCA6IHt9KTtcbiAgICB9LCB7IFwiLi9wb2xsaW5nLWpzb25wXCI6IDYsIFwiLi9wb2xsaW5nLXhoclwiOiA3LCBcIi4vd2Vic29ja2V0XCI6IDksIFwieG1saHR0cHJlcXVlc3Qtc3NsXCI6IDEwIH1dLCA2OiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuICAgICAgKGZ1bmN0aW9uIChnbG9iYWwpIHtcbiAgICAgICAgdmFyIFBvbGxpbmcgPSBfZGVyZXFfKFwiLi9wb2xsaW5nXCIpO3ZhciBpbmhlcml0ID0gX2RlcmVxXyhcImNvbXBvbmVudC1pbmhlcml0XCIpO21vZHVsZS5leHBvcnRzID0gSlNPTlBQb2xsaW5nO3ZhciByTmV3bGluZSA9IC9cXG4vZzt2YXIgckVzY2FwZWROZXdsaW5lID0gL1xcXFxuL2c7dmFyIGNhbGxiYWNrczt2YXIgaW5kZXggPSAwO2Z1bmN0aW9uIGVtcHR5KCkge31mdW5jdGlvbiBKU09OUFBvbGxpbmcob3B0cykge1xuICAgICAgICAgIFBvbGxpbmcuY2FsbCh0aGlzLCBvcHRzKTt0aGlzLnF1ZXJ5ID0gdGhpcy5xdWVyeSB8fCB7fTtpZiAoIWNhbGxiYWNrcykge1xuICAgICAgICAgICAgaWYgKCFnbG9iYWwuX19fZWlvKSBnbG9iYWwuX19fZWlvID0gW107Y2FsbGJhY2tzID0gZ2xvYmFsLl9fX2VpbztcbiAgICAgICAgICB9dGhpcy5pbmRleCA9IGNhbGxiYWNrcy5sZW5ndGg7dmFyIHNlbGYgPSB0aGlzO2NhbGxiYWNrcy5wdXNoKGZ1bmN0aW9uIChtc2cpIHtcbiAgICAgICAgICAgIHNlbGYub25EYXRhKG1zZyk7XG4gICAgICAgICAgfSk7dGhpcy5xdWVyeS5qID0gdGhpcy5pbmRleDtpZiAoZ2xvYmFsLmRvY3VtZW50ICYmIGdsb2JhbC5hZGRFdmVudExpc3RlbmVyKSB7XG4gICAgICAgICAgICBnbG9iYWwuYWRkRXZlbnRMaXN0ZW5lcihcImJlZm9yZXVubG9hZFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIGlmIChzZWxmLnNjcmlwdCkgc2VsZi5zY3JpcHQub25lcnJvciA9IGVtcHR5O1xuICAgICAgICAgICAgfSwgZmFsc2UpO1xuICAgICAgICAgIH1cbiAgICAgICAgfWluaGVyaXQoSlNPTlBQb2xsaW5nLCBQb2xsaW5nKTtKU09OUFBvbGxpbmcucHJvdG90eXBlLnN1cHBvcnRzQmluYXJ5ID0gZmFsc2U7SlNPTlBQb2xsaW5nLnByb3RvdHlwZS5kb0Nsb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGlmICh0aGlzLnNjcmlwdCkge1xuICAgICAgICAgICAgdGhpcy5zY3JpcHQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLnNjcmlwdCk7dGhpcy5zY3JpcHQgPSBudWxsO1xuICAgICAgICAgIH1pZiAodGhpcy5mb3JtKSB7XG4gICAgICAgICAgICB0aGlzLmZvcm0ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLmZvcm0pO3RoaXMuZm9ybSA9IG51bGw7dGhpcy5pZnJhbWUgPSBudWxsO1xuICAgICAgICAgIH1Qb2xsaW5nLnByb3RvdHlwZS5kb0Nsb3NlLmNhbGwodGhpcyk7XG4gICAgICAgIH07SlNPTlBQb2xsaW5nLnByb3RvdHlwZS5kb1BvbGwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO3ZhciBzY3JpcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic2NyaXB0XCIpO2lmICh0aGlzLnNjcmlwdCkge1xuICAgICAgICAgICAgdGhpcy5zY3JpcHQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLnNjcmlwdCk7dGhpcy5zY3JpcHQgPSBudWxsO1xuICAgICAgICAgIH1zY3JpcHQuYXN5bmMgPSB0cnVlO3NjcmlwdC5zcmMgPSB0aGlzLnVyaSgpO3NjcmlwdC5vbmVycm9yID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIHNlbGYub25FcnJvcihcImpzb25wIHBvbGwgZXJyb3JcIiwgZSk7XG4gICAgICAgICAgfTt2YXIgaW5zZXJ0QXQgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcInNjcmlwdFwiKVswXTtpZiAoaW5zZXJ0QXQpIHtcbiAgICAgICAgICAgIGluc2VydEF0LnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHNjcmlwdCwgaW5zZXJ0QXQpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAoZG9jdW1lbnQuaGVhZCB8fCBkb2N1bWVudC5ib2R5KS5hcHBlbmRDaGlsZChzY3JpcHQpO1xuICAgICAgICAgIH10aGlzLnNjcmlwdCA9IHNjcmlwdDt2YXIgaXNVQWdlY2tvID0gXCJ1bmRlZmluZWRcIiAhPSB0eXBlb2YgbmF2aWdhdG9yICYmIC9nZWNrby9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCk7aWYgKGlzVUFnZWNrbykge1xuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIHZhciBpZnJhbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaWZyYW1lXCIpO2RvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoaWZyYW1lKTtkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGlmcmFtZSk7XG4gICAgICAgICAgICB9LCAxMDApO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtKU09OUFBvbGxpbmcucHJvdG90eXBlLmRvV3JpdGUgPSBmdW5jdGlvbiAoZGF0YSwgZm4pIHtcbiAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7aWYgKCF0aGlzLmZvcm0pIHtcbiAgICAgICAgICAgIHZhciBmb3JtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImZvcm1cIik7dmFyIGFyZWEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwidGV4dGFyZWFcIik7dmFyIGlkID0gdGhpcy5pZnJhbWVJZCA9IFwiZWlvX2lmcmFtZV9cIiArIHRoaXMuaW5kZXg7dmFyIGlmcmFtZTtmb3JtLmNsYXNzTmFtZSA9IFwic29ja2V0aW9cIjtmb3JtLnN0eWxlLnBvc2l0aW9uID0gXCJhYnNvbHV0ZVwiO2Zvcm0uc3R5bGUudG9wID0gXCItMTAwMHB4XCI7Zm9ybS5zdHlsZS5sZWZ0ID0gXCItMTAwMHB4XCI7Zm9ybS50YXJnZXQgPSBpZDtmb3JtLm1ldGhvZCA9IFwiUE9TVFwiO2Zvcm0uc2V0QXR0cmlidXRlKFwiYWNjZXB0LWNoYXJzZXRcIiwgXCJ1dGYtOFwiKTthcmVhLm5hbWUgPSBcImRcIjtmb3JtLmFwcGVuZENoaWxkKGFyZWEpO2RvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZm9ybSk7dGhpcy5mb3JtID0gZm9ybTt0aGlzLmFyZWEgPSBhcmVhO1xuICAgICAgICAgIH10aGlzLmZvcm0uYWN0aW9uID0gdGhpcy51cmkoKTtmdW5jdGlvbiBjb21wbGV0ZSgpIHtcbiAgICAgICAgICAgIGluaXRJZnJhbWUoKTtmbigpO1xuICAgICAgICAgIH1mdW5jdGlvbiBpbml0SWZyYW1lKCkge1xuICAgICAgICAgICAgaWYgKHNlbGYuaWZyYW1lKSB7XG4gICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgc2VsZi5mb3JtLnJlbW92ZUNoaWxkKHNlbGYuaWZyYW1lKTtcbiAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIHNlbGYub25FcnJvcihcImpzb25wIHBvbGxpbmcgaWZyYW1lIHJlbW92YWwgZXJyb3JcIiwgZSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH10cnkge1xuICAgICAgICAgICAgICB2YXIgaHRtbCA9ICc8aWZyYW1lIHNyYz1cImphdmFzY3JpcHQ6MFwiIG5hbWU9XCInICsgc2VsZi5pZnJhbWVJZCArICdcIj4nO2lmcmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoaHRtbCk7XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgIGlmcmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpZnJhbWVcIik7aWZyYW1lLm5hbWUgPSBzZWxmLmlmcmFtZUlkO2lmcmFtZS5zcmMgPSBcImphdmFzY3JpcHQ6MFwiO1xuICAgICAgICAgICAgfWlmcmFtZS5pZCA9IHNlbGYuaWZyYW1lSWQ7c2VsZi5mb3JtLmFwcGVuZENoaWxkKGlmcmFtZSk7c2VsZi5pZnJhbWUgPSBpZnJhbWU7XG4gICAgICAgICAgfWluaXRJZnJhbWUoKTtkYXRhID0gZGF0YS5yZXBsYWNlKHJFc2NhcGVkTmV3bGluZSwgXCJcXFxcXFxuXCIpO3RoaXMuYXJlYS52YWx1ZSA9IGRhdGEucmVwbGFjZShyTmV3bGluZSwgXCJcXFxcblwiKTt0cnkge1xuICAgICAgICAgICAgdGhpcy5mb3JtLnN1Ym1pdCgpO1xuICAgICAgICAgIH0gY2F0Y2ggKGUpIHt9aWYgKHRoaXMuaWZyYW1lLmF0dGFjaEV2ZW50KSB7XG4gICAgICAgICAgICB0aGlzLmlmcmFtZS5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIGlmIChzZWxmLmlmcmFtZS5yZWFkeVN0YXRlID09IFwiY29tcGxldGVcIikge1xuICAgICAgICAgICAgICAgIGNvbXBsZXRlKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuaWZyYW1lLm9ubG9hZCA9IGNvbXBsZXRlO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgIH0pLmNhbGwodGhpcywgdHlwZW9mIHNlbGYgIT09IFwidW5kZWZpbmVkXCIgPyBzZWxmIDogdHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiA/IHdpbmRvdyA6IHR5cGVvZiBnbG9iYWwgIT09IFwidW5kZWZpbmVkXCIgPyBnbG9iYWwgOiB7fSk7XG4gICAgfSwgeyBcIi4vcG9sbGluZ1wiOiA4LCBcImNvbXBvbmVudC1pbmhlcml0XCI6IDE2IH1dLCA3OiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuICAgICAgKGZ1bmN0aW9uIChnbG9iYWwpIHtcbiAgICAgICAgdmFyIFhNTEh0dHBSZXF1ZXN0ID0gX2RlcmVxXyhcInhtbGh0dHByZXF1ZXN0LXNzbFwiKTt2YXIgUG9sbGluZyA9IF9kZXJlcV8oXCIuL3BvbGxpbmdcIik7dmFyIEVtaXR0ZXIgPSBfZGVyZXFfKFwiY29tcG9uZW50LWVtaXR0ZXJcIik7dmFyIGluaGVyaXQgPSBfZGVyZXFfKFwiY29tcG9uZW50LWluaGVyaXRcIik7dmFyIGRlYnVnID0gX2RlcmVxXyhcImRlYnVnXCIpKFwiZW5naW5lLmlvLWNsaWVudDpwb2xsaW5nLXhoclwiKTttb2R1bGUuZXhwb3J0cyA9IFhIUjttb2R1bGUuZXhwb3J0cy5SZXF1ZXN0ID0gUmVxdWVzdDtmdW5jdGlvbiBlbXB0eSgpIHt9ZnVuY3Rpb24gWEhSKG9wdHMpIHtcbiAgICAgICAgICBQb2xsaW5nLmNhbGwodGhpcywgb3B0cyk7aWYgKGdsb2JhbC5sb2NhdGlvbikge1xuICAgICAgICAgICAgdmFyIGlzU1NMID0gXCJodHRwczpcIiA9PSBsb2NhdGlvbi5wcm90b2NvbDt2YXIgcG9ydCA9IGxvY2F0aW9uLnBvcnQ7aWYgKCFwb3J0KSB7XG4gICAgICAgICAgICAgIHBvcnQgPSBpc1NTTCA/IDQ0MyA6IDgwO1xuICAgICAgICAgICAgfXRoaXMueGQgPSBvcHRzLmhvc3RuYW1lICE9IGdsb2JhbC5sb2NhdGlvbi5ob3N0bmFtZSB8fCBwb3J0ICE9IG9wdHMucG9ydDt0aGlzLnhzID0gb3B0cy5zZWN1cmUgIT0gaXNTU0w7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuZXh0cmFIZWFkZXJzID0gb3B0cy5leHRyYUhlYWRlcnM7XG4gICAgICAgICAgfVxuICAgICAgICB9aW5oZXJpdChYSFIsIFBvbGxpbmcpO1hIUi5wcm90b3R5cGUuc3VwcG9ydHNCaW5hcnkgPSB0cnVlO1hIUi5wcm90b3R5cGUucmVxdWVzdCA9IGZ1bmN0aW9uIChvcHRzKSB7XG4gICAgICAgICAgb3B0cyA9IG9wdHMgfHwge307b3B0cy51cmkgPSB0aGlzLnVyaSgpO29wdHMueGQgPSB0aGlzLnhkO29wdHMueHMgPSB0aGlzLnhzO29wdHMuYWdlbnQgPSB0aGlzLmFnZW50IHx8IGZhbHNlO29wdHMuc3VwcG9ydHNCaW5hcnkgPSB0aGlzLnN1cHBvcnRzQmluYXJ5O29wdHMuZW5hYmxlc1hEUiA9IHRoaXMuZW5hYmxlc1hEUjtvcHRzLnBmeCA9IHRoaXMucGZ4O29wdHMua2V5ID0gdGhpcy5rZXk7b3B0cy5wYXNzcGhyYXNlID0gdGhpcy5wYXNzcGhyYXNlO29wdHMuY2VydCA9IHRoaXMuY2VydDtvcHRzLmNhID0gdGhpcy5jYTtvcHRzLmNpcGhlcnMgPSB0aGlzLmNpcGhlcnM7b3B0cy5yZWplY3RVbmF1dGhvcml6ZWQgPSB0aGlzLnJlamVjdFVuYXV0aG9yaXplZDtvcHRzLmV4dHJhSGVhZGVycyA9IHRoaXMuZXh0cmFIZWFkZXJzO3JldHVybiBuZXcgUmVxdWVzdChvcHRzKTtcbiAgICAgICAgfTtYSFIucHJvdG90eXBlLmRvV3JpdGUgPSBmdW5jdGlvbiAoZGF0YSwgZm4pIHtcbiAgICAgICAgICB2YXIgaXNCaW5hcnkgPSB0eXBlb2YgZGF0YSAhPT0gXCJzdHJpbmdcIiAmJiBkYXRhICE9PSB1bmRlZmluZWQ7dmFyIHJlcSA9IHRoaXMucmVxdWVzdCh7IG1ldGhvZDogXCJQT1NUXCIsIGRhdGE6IGRhdGEsIGlzQmluYXJ5OiBpc0JpbmFyeSB9KTt2YXIgc2VsZiA9IHRoaXM7cmVxLm9uKFwic3VjY2Vzc1wiLCBmbik7cmVxLm9uKFwiZXJyb3JcIiwgZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgc2VsZi5vbkVycm9yKFwieGhyIHBvc3QgZXJyb3JcIiwgZXJyKTtcbiAgICAgICAgICB9KTt0aGlzLnNlbmRYaHIgPSByZXE7XG4gICAgICAgIH07WEhSLnByb3RvdHlwZS5kb1BvbGwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgZGVidWcoXCJ4aHIgcG9sbFwiKTt2YXIgcmVxID0gdGhpcy5yZXF1ZXN0KCk7dmFyIHNlbGYgPSB0aGlzO3JlcS5vbihcImRhdGFcIiwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHNlbGYub25EYXRhKGRhdGEpO1xuICAgICAgICAgIH0pO3JlcS5vbihcImVycm9yXCIsIGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgIHNlbGYub25FcnJvcihcInhociBwb2xsIGVycm9yXCIsIGVycik7XG4gICAgICAgICAgfSk7dGhpcy5wb2xsWGhyID0gcmVxO1xuICAgICAgICB9O2Z1bmN0aW9uIFJlcXVlc3Qob3B0cykge1xuICAgICAgICAgIHRoaXMubWV0aG9kID0gb3B0cy5tZXRob2QgfHwgXCJHRVRcIjt0aGlzLnVyaSA9IG9wdHMudXJpO3RoaXMueGQgPSAhIW9wdHMueGQ7dGhpcy54cyA9ICEhb3B0cy54czt0aGlzLmFzeW5jID0gZmFsc2UgIT09IG9wdHMuYXN5bmM7dGhpcy5kYXRhID0gdW5kZWZpbmVkICE9IG9wdHMuZGF0YSA/IG9wdHMuZGF0YSA6IG51bGw7dGhpcy5hZ2VudCA9IG9wdHMuYWdlbnQ7dGhpcy5pc0JpbmFyeSA9IG9wdHMuaXNCaW5hcnk7dGhpcy5zdXBwb3J0c0JpbmFyeSA9IG9wdHMuc3VwcG9ydHNCaW5hcnk7dGhpcy5lbmFibGVzWERSID0gb3B0cy5lbmFibGVzWERSO3RoaXMucGZ4ID0gb3B0cy5wZng7dGhpcy5rZXkgPSBvcHRzLmtleTt0aGlzLnBhc3NwaHJhc2UgPSBvcHRzLnBhc3NwaHJhc2U7dGhpcy5jZXJ0ID0gb3B0cy5jZXJ0O3RoaXMuY2EgPSBvcHRzLmNhO3RoaXMuY2lwaGVycyA9IG9wdHMuY2lwaGVyczt0aGlzLnJlamVjdFVuYXV0aG9yaXplZCA9IG9wdHMucmVqZWN0VW5hdXRob3JpemVkO3RoaXMuZXh0cmFIZWFkZXJzID0gb3B0cy5leHRyYUhlYWRlcnM7dGhpcy5jcmVhdGUoKTtcbiAgICAgICAgfUVtaXR0ZXIoUmVxdWVzdC5wcm90b3R5cGUpO1JlcXVlc3QucHJvdG90eXBlLmNyZWF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICB2YXIgb3B0cyA9IHsgYWdlbnQ6IHRoaXMuYWdlbnQsIHhkb21haW46IHRoaXMueGQsIHhzY2hlbWU6IHRoaXMueHMsIGVuYWJsZXNYRFI6IHRoaXMuZW5hYmxlc1hEUiB9O29wdHMucGZ4ID0gdGhpcy5wZng7b3B0cy5rZXkgPSB0aGlzLmtleTtvcHRzLnBhc3NwaHJhc2UgPSB0aGlzLnBhc3NwaHJhc2U7b3B0cy5jZXJ0ID0gdGhpcy5jZXJ0O29wdHMuY2EgPSB0aGlzLmNhO29wdHMuY2lwaGVycyA9IHRoaXMuY2lwaGVycztvcHRzLnJlamVjdFVuYXV0aG9yaXplZCA9IHRoaXMucmVqZWN0VW5hdXRob3JpemVkO3ZhciB4aHIgPSB0aGlzLnhociA9IG5ldyBYTUxIdHRwUmVxdWVzdChvcHRzKTt2YXIgc2VsZiA9IHRoaXM7dHJ5IHtcbiAgICAgICAgICAgIGRlYnVnKFwieGhyIG9wZW4gJXM6ICVzXCIsIHRoaXMubWV0aG9kLCB0aGlzLnVyaSk7eGhyLm9wZW4odGhpcy5tZXRob2QsIHRoaXMudXJpLCB0aGlzLmFzeW5jKTt0cnkge1xuICAgICAgICAgICAgICBpZiAodGhpcy5leHRyYUhlYWRlcnMpIHtcbiAgICAgICAgICAgICAgICB4aHIuc2V0RGlzYWJsZUhlYWRlckNoZWNrKHRydWUpO2ZvciAodmFyIGkgaW4gdGhpcy5leHRyYUhlYWRlcnMpIHtcbiAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmV4dHJhSGVhZGVycy5oYXNPd25Qcm9wZXJ0eShpKSkge1xuICAgICAgICAgICAgICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihpLCB0aGlzLmV4dHJhSGVhZGVyc1tpXSk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7fWlmICh0aGlzLnN1cHBvcnRzQmluYXJ5KSB7XG4gICAgICAgICAgICAgIHhoci5yZXNwb25zZVR5cGUgPSBcImFycmF5YnVmZmVyXCI7XG4gICAgICAgICAgICB9aWYgKFwiUE9TVFwiID09IHRoaXMubWV0aG9kKSB7XG4gICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNCaW5hcnkpIHtcbiAgICAgICAgICAgICAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKFwiQ29udGVudC10eXBlXCIsIFwiYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtXCIpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihcIkNvbnRlbnQtdHlwZVwiLCBcInRleHQvcGxhaW47Y2hhcnNldD1VVEYtOFwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHt9XG4gICAgICAgICAgICB9aWYgKFwid2l0aENyZWRlbnRpYWxzXCIgaW4geGhyKSB7XG4gICAgICAgICAgICAgIHhoci53aXRoQ3JlZGVudGlhbHMgPSB0cnVlO1xuICAgICAgICAgICAgfWlmICh0aGlzLmhhc1hEUigpKSB7XG4gICAgICAgICAgICAgIHhoci5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5vbkxvYWQoKTtcbiAgICAgICAgICAgICAgfTt4aHIub25lcnJvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBzZWxmLm9uRXJyb3IoeGhyLnJlc3BvbnNlVGV4dCk7XG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICB4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGlmICg0ICE9IHhoci5yZWFkeVN0YXRlKSByZXR1cm47aWYgKDIwMCA9PSB4aHIuc3RhdHVzIHx8IDEyMjMgPT0geGhyLnN0YXR1cykge1xuICAgICAgICAgICAgICAgICAgc2VsZi5vbkxvYWQoKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYub25FcnJvcih4aHIuc3RhdHVzKTtcbiAgICAgICAgICAgICAgICAgIH0sIDApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1kZWJ1ZyhcInhociBkYXRhICVzXCIsIHRoaXMuZGF0YSk7eGhyLnNlbmQodGhpcy5kYXRhKTtcbiAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgc2VsZi5vbkVycm9yKGUpO1xuICAgICAgICAgICAgfSwgMCk7cmV0dXJuO1xuICAgICAgICAgIH1pZiAoZ2xvYmFsLmRvY3VtZW50KSB7XG4gICAgICAgICAgICB0aGlzLmluZGV4ID0gUmVxdWVzdC5yZXF1ZXN0c0NvdW50Kys7UmVxdWVzdC5yZXF1ZXN0c1t0aGlzLmluZGV4XSA9IHRoaXM7XG4gICAgICAgICAgfVxuICAgICAgICB9O1JlcXVlc3QucHJvdG90eXBlLm9uU3VjY2VzcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICB0aGlzLmVtaXQoXCJzdWNjZXNzXCIpO3RoaXMuY2xlYW51cCgpO1xuICAgICAgICB9O1JlcXVlc3QucHJvdG90eXBlLm9uRGF0YSA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgdGhpcy5lbWl0KFwiZGF0YVwiLCBkYXRhKTt0aGlzLm9uU3VjY2VzcygpO1xuICAgICAgICB9O1JlcXVlc3QucHJvdG90eXBlLm9uRXJyb3IgPSBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgdGhpcy5lbWl0KFwiZXJyb3JcIiwgZXJyKTt0aGlzLmNsZWFudXAodHJ1ZSk7XG4gICAgICAgIH07UmVxdWVzdC5wcm90b3R5cGUuY2xlYW51cCA9IGZ1bmN0aW9uIChmcm9tRXJyb3IpIHtcbiAgICAgICAgICBpZiAoXCJ1bmRlZmluZWRcIiA9PSB0eXBlb2YgdGhpcy54aHIgfHwgbnVsbCA9PT0gdGhpcy54aHIpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9aWYgKHRoaXMuaGFzWERSKCkpIHtcbiAgICAgICAgICAgIHRoaXMueGhyLm9ubG9hZCA9IHRoaXMueGhyLm9uZXJyb3IgPSBlbXB0eTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy54aHIub25yZWFkeXN0YXRlY2hhbmdlID0gZW1wdHk7XG4gICAgICAgICAgfWlmIChmcm9tRXJyb3IpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIHRoaXMueGhyLmFib3J0KCk7XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7fVxuICAgICAgICAgIH1pZiAoZ2xvYmFsLmRvY3VtZW50KSB7XG4gICAgICAgICAgICBkZWxldGUgUmVxdWVzdC5yZXF1ZXN0c1t0aGlzLmluZGV4XTtcbiAgICAgICAgICB9dGhpcy54aHIgPSBudWxsO1xuICAgICAgICB9O1JlcXVlc3QucHJvdG90eXBlLm9uTG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICB2YXIgZGF0YTt0cnkge1xuICAgICAgICAgICAgdmFyIGNvbnRlbnRUeXBlO3RyeSB7XG4gICAgICAgICAgICAgIGNvbnRlbnRUeXBlID0gdGhpcy54aHIuZ2V0UmVzcG9uc2VIZWFkZXIoXCJDb250ZW50LVR5cGVcIikuc3BsaXQoXCI7XCIpWzBdO1xuICAgICAgICAgICAgfSBjYXRjaCAoZSkge31pZiAoY29udGVudFR5cGUgPT09IFwiYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtXCIpIHtcbiAgICAgICAgICAgICAgZGF0YSA9IHRoaXMueGhyLnJlc3BvbnNlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgaWYgKCF0aGlzLnN1cHBvcnRzQmluYXJ5KSB7XG4gICAgICAgICAgICAgICAgZGF0YSA9IHRoaXMueGhyLnJlc3BvbnNlVGV4dDtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgZGF0YSA9IFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCwgbmV3IFVpbnQ4QXJyYXkodGhpcy54aHIucmVzcG9uc2UpKTtcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgdWk4QXJyID0gbmV3IFVpbnQ4QXJyYXkodGhpcy54aHIucmVzcG9uc2UpO3ZhciBkYXRhQXJyYXkgPSBbXTtmb3IgKHZhciBpZHggPSAwLCBsZW5ndGggPSB1aThBcnIubGVuZ3RoOyBpZHggPCBsZW5ndGg7IGlkeCsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGRhdGFBcnJheS5wdXNoKHVpOEFycltpZHhdKTtcbiAgICAgICAgICAgICAgICAgIH1kYXRhID0gU3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShudWxsLCBkYXRhQXJyYXkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIHRoaXMub25FcnJvcihlKTtcbiAgICAgICAgICB9aWYgKG51bGwgIT0gZGF0YSkge1xuICAgICAgICAgICAgdGhpcy5vbkRhdGEoZGF0YSk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1JlcXVlc3QucHJvdG90eXBlLmhhc1hEUiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICByZXR1cm4gXCJ1bmRlZmluZWRcIiAhPT0gdHlwZW9mIGdsb2JhbC5YRG9tYWluUmVxdWVzdCAmJiAhdGhpcy54cyAmJiB0aGlzLmVuYWJsZXNYRFI7XG4gICAgICAgIH07UmVxdWVzdC5wcm90b3R5cGUuYWJvcnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgdGhpcy5jbGVhbnVwKCk7XG4gICAgICAgIH07aWYgKGdsb2JhbC5kb2N1bWVudCkge1xuICAgICAgICAgIFJlcXVlc3QucmVxdWVzdHNDb3VudCA9IDA7UmVxdWVzdC5yZXF1ZXN0cyA9IHt9O2lmIChnbG9iYWwuYXR0YWNoRXZlbnQpIHtcbiAgICAgICAgICAgIGdsb2JhbC5hdHRhY2hFdmVudChcIm9udW5sb2FkXCIsIHVubG9hZEhhbmRsZXIpO1xuICAgICAgICAgIH0gZWxzZSBpZiAoZ2xvYmFsLmFkZEV2ZW50TGlzdGVuZXIpIHtcbiAgICAgICAgICAgIGdsb2JhbC5hZGRFdmVudExpc3RlbmVyKFwiYmVmb3JldW5sb2FkXCIsIHVubG9hZEhhbmRsZXIsIGZhbHNlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1mdW5jdGlvbiB1bmxvYWRIYW5kbGVyKCkge1xuICAgICAgICAgIGZvciAodmFyIGkgaW4gUmVxdWVzdC5yZXF1ZXN0cykge1xuICAgICAgICAgICAgaWYgKFJlcXVlc3QucmVxdWVzdHMuaGFzT3duUHJvcGVydHkoaSkpIHtcbiAgICAgICAgICAgICAgUmVxdWVzdC5yZXF1ZXN0c1tpXS5hYm9ydCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSkuY2FsbCh0aGlzLCB0eXBlb2Ygc2VsZiAhPT0gXCJ1bmRlZmluZWRcIiA/IHNlbGYgOiB0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiID8gd2luZG93IDogdHlwZW9mIGdsb2JhbCAhPT0gXCJ1bmRlZmluZWRcIiA/IGdsb2JhbCA6IHt9KTtcbiAgICB9LCB7IFwiLi9wb2xsaW5nXCI6IDgsIFwiY29tcG9uZW50LWVtaXR0ZXJcIjogMTUsIFwiY29tcG9uZW50LWluaGVyaXRcIjogMTYsIGRlYnVnOiAxNywgXCJ4bWxodHRwcmVxdWVzdC1zc2xcIjogMTAgfV0sIDg6IFtmdW5jdGlvbiAoX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG4gICAgICB2YXIgVHJhbnNwb3J0ID0gX2RlcmVxXyhcIi4uL3RyYW5zcG9ydFwiKTt2YXIgcGFyc2VxcyA9IF9kZXJlcV8oXCJwYXJzZXFzXCIpO3ZhciBwYXJzZXIgPSBfZGVyZXFfKFwiZW5naW5lLmlvLXBhcnNlclwiKTt2YXIgaW5oZXJpdCA9IF9kZXJlcV8oXCJjb21wb25lbnQtaW5oZXJpdFwiKTt2YXIgeWVhc3QgPSBfZGVyZXFfKFwieWVhc3RcIik7dmFyIGRlYnVnID0gX2RlcmVxXyhcImRlYnVnXCIpKFwiZW5naW5lLmlvLWNsaWVudDpwb2xsaW5nXCIpO21vZHVsZS5leHBvcnRzID0gUG9sbGluZzt2YXIgaGFzWEhSMiA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBYTUxIdHRwUmVxdWVzdCA9IF9kZXJlcV8oXCJ4bWxodHRwcmVxdWVzdC1zc2xcIik7dmFyIHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCh7IHhkb21haW46IGZhbHNlIH0pO3JldHVybiBudWxsICE9IHhoci5yZXNwb25zZVR5cGU7XG4gICAgICB9KSgpO2Z1bmN0aW9uIFBvbGxpbmcob3B0cykge1xuICAgICAgICB2YXIgZm9yY2VCYXNlNjQgPSBvcHRzICYmIG9wdHMuZm9yY2VCYXNlNjQ7aWYgKCFoYXNYSFIyIHx8IGZvcmNlQmFzZTY0KSB7XG4gICAgICAgICAgdGhpcy5zdXBwb3J0c0JpbmFyeSA9IGZhbHNlO1xuICAgICAgICB9VHJhbnNwb3J0LmNhbGwodGhpcywgb3B0cyk7XG4gICAgICB9aW5oZXJpdChQb2xsaW5nLCBUcmFuc3BvcnQpO1BvbGxpbmcucHJvdG90eXBlLm5hbWUgPSBcInBvbGxpbmdcIjtQb2xsaW5nLnByb3RvdHlwZS5kb09wZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMucG9sbCgpO1xuICAgICAgfTtQb2xsaW5nLnByb3RvdHlwZS5wYXVzZSA9IGZ1bmN0aW9uIChvblBhdXNlKSB7XG4gICAgICAgIHZhciBwZW5kaW5nID0gMDt2YXIgc2VsZiA9IHRoaXM7dGhpcy5yZWFkeVN0YXRlID0gXCJwYXVzaW5nXCI7ZnVuY3Rpb24gcGF1c2UoKSB7XG4gICAgICAgICAgZGVidWcoXCJwYXVzZWRcIik7c2VsZi5yZWFkeVN0YXRlID0gXCJwYXVzZWRcIjtvblBhdXNlKCk7XG4gICAgICAgIH1pZiAodGhpcy5wb2xsaW5nIHx8ICF0aGlzLndyaXRhYmxlKSB7XG4gICAgICAgICAgdmFyIHRvdGFsID0gMDtpZiAodGhpcy5wb2xsaW5nKSB7XG4gICAgICAgICAgICBkZWJ1ZyhcIndlIGFyZSBjdXJyZW50bHkgcG9sbGluZyAtIHdhaXRpbmcgdG8gcGF1c2VcIik7dG90YWwrKzt0aGlzLm9uY2UoXCJwb2xsQ29tcGxldGVcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICBkZWJ1ZyhcInByZS1wYXVzZSBwb2xsaW5nIGNvbXBsZXRlXCIpOy0tdG90YWwgfHwgcGF1c2UoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1pZiAoIXRoaXMud3JpdGFibGUpIHtcbiAgICAgICAgICAgIGRlYnVnKFwid2UgYXJlIGN1cnJlbnRseSB3cml0aW5nIC0gd2FpdGluZyB0byBwYXVzZVwiKTt0b3RhbCsrO3RoaXMub25jZShcImRyYWluXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgZGVidWcoXCJwcmUtcGF1c2Ugd3JpdGluZyBjb21wbGV0ZVwiKTstLXRvdGFsIHx8IHBhdXNlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcGF1c2UoKTtcbiAgICAgICAgfVxuICAgICAgfTtQb2xsaW5nLnByb3RvdHlwZS5wb2xsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBkZWJ1ZyhcInBvbGxpbmdcIik7dGhpcy5wb2xsaW5nID0gdHJ1ZTt0aGlzLmRvUG9sbCgpO3RoaXMuZW1pdChcInBvbGxcIik7XG4gICAgICB9O1BvbGxpbmcucHJvdG90eXBlLm9uRGF0YSA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztkZWJ1ZyhcInBvbGxpbmcgZ290IGRhdGEgJXNcIiwgZGF0YSk7dmFyIGNhbGxiYWNrID0gZnVuY3Rpb24gY2FsbGJhY2socGFja2V0LCBpbmRleCwgdG90YWwpIHtcbiAgICAgICAgICBpZiAoXCJvcGVuaW5nXCIgPT0gc2VsZi5yZWFkeVN0YXRlKSB7XG4gICAgICAgICAgICBzZWxmLm9uT3BlbigpO1xuICAgICAgICAgIH1pZiAoXCJjbG9zZVwiID09IHBhY2tldC50eXBlKSB7XG4gICAgICAgICAgICBzZWxmLm9uQ2xvc2UoKTtyZXR1cm4gZmFsc2U7XG4gICAgICAgICAgfXNlbGYub25QYWNrZXQocGFja2V0KTtcbiAgICAgICAgfTtwYXJzZXIuZGVjb2RlUGF5bG9hZChkYXRhLCB0aGlzLnNvY2tldC5iaW5hcnlUeXBlLCBjYWxsYmFjayk7aWYgKFwiY2xvc2VkXCIgIT0gdGhpcy5yZWFkeVN0YXRlKSB7XG4gICAgICAgICAgdGhpcy5wb2xsaW5nID0gZmFsc2U7dGhpcy5lbWl0KFwicG9sbENvbXBsZXRlXCIpO2lmIChcIm9wZW5cIiA9PSB0aGlzLnJlYWR5U3RhdGUpIHtcbiAgICAgICAgICAgIHRoaXMucG9sbCgpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBkZWJ1ZygnaWdub3JpbmcgcG9sbCAtIHRyYW5zcG9ydCBzdGF0ZSBcIiVzXCInLCB0aGlzLnJlYWR5U3RhdGUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfTtQb2xsaW5nLnByb3RvdHlwZS5kb0Nsb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7ZnVuY3Rpb24gY2xvc2UoKSB7XG4gICAgICAgICAgZGVidWcoXCJ3cml0aW5nIGNsb3NlIHBhY2tldFwiKTtzZWxmLndyaXRlKFt7IHR5cGU6IFwiY2xvc2VcIiB9XSk7XG4gICAgICAgIH1pZiAoXCJvcGVuXCIgPT0gdGhpcy5yZWFkeVN0YXRlKSB7XG4gICAgICAgICAgZGVidWcoXCJ0cmFuc3BvcnQgb3BlbiAtIGNsb3NpbmdcIik7Y2xvc2UoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBkZWJ1ZyhcInRyYW5zcG9ydCBub3Qgb3BlbiAtIGRlZmVycmluZyBjbG9zZVwiKTt0aGlzLm9uY2UoXCJvcGVuXCIsIGNsb3NlKTtcbiAgICAgICAgfVxuICAgICAgfTtQb2xsaW5nLnByb3RvdHlwZS53cml0ZSA9IGZ1bmN0aW9uIChwYWNrZXRzKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpczt0aGlzLndyaXRhYmxlID0gZmFsc2U7dmFyIGNhbGxiYWNrZm4gPSBmdW5jdGlvbiBjYWxsYmFja2ZuKCkge1xuICAgICAgICAgIHNlbGYud3JpdGFibGUgPSB0cnVlO3NlbGYuZW1pdChcImRyYWluXCIpO1xuICAgICAgICB9O3ZhciBzZWxmID0gdGhpcztwYXJzZXIuZW5jb2RlUGF5bG9hZChwYWNrZXRzLCB0aGlzLnN1cHBvcnRzQmluYXJ5LCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgIHNlbGYuZG9Xcml0ZShkYXRhLCBjYWxsYmFja2ZuKTtcbiAgICAgICAgfSk7XG4gICAgICB9O1BvbGxpbmcucHJvdG90eXBlLnVyaSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHF1ZXJ5ID0gdGhpcy5xdWVyeSB8fCB7fTt2YXIgc2NoZW1hID0gdGhpcy5zZWN1cmUgPyBcImh0dHBzXCIgOiBcImh0dHBcIjt2YXIgcG9ydCA9IFwiXCI7aWYgKGZhbHNlICE9PSB0aGlzLnRpbWVzdGFtcFJlcXVlc3RzKSB7XG4gICAgICAgICAgcXVlcnlbdGhpcy50aW1lc3RhbXBQYXJhbV0gPSB5ZWFzdCgpO1xuICAgICAgICB9aWYgKCF0aGlzLnN1cHBvcnRzQmluYXJ5ICYmICFxdWVyeS5zaWQpIHtcbiAgICAgICAgICBxdWVyeS5iNjQgPSAxO1xuICAgICAgICB9cXVlcnkgPSBwYXJzZXFzLmVuY29kZShxdWVyeSk7aWYgKHRoaXMucG9ydCAmJiAoXCJodHRwc1wiID09IHNjaGVtYSAmJiB0aGlzLnBvcnQgIT0gNDQzIHx8IFwiaHR0cFwiID09IHNjaGVtYSAmJiB0aGlzLnBvcnQgIT0gODApKSB7XG4gICAgICAgICAgcG9ydCA9IFwiOlwiICsgdGhpcy5wb3J0O1xuICAgICAgICB9aWYgKHF1ZXJ5Lmxlbmd0aCkge1xuICAgICAgICAgIHF1ZXJ5ID0gXCI/XCIgKyBxdWVyeTtcbiAgICAgICAgfXZhciBpcHY2ID0gdGhpcy5ob3N0bmFtZS5pbmRleE9mKFwiOlwiKSAhPT0gLTE7cmV0dXJuIHNjaGVtYSArIFwiOi8vXCIgKyAoaXB2NiA/IFwiW1wiICsgdGhpcy5ob3N0bmFtZSArIFwiXVwiIDogdGhpcy5ob3N0bmFtZSkgKyBwb3J0ICsgdGhpcy5wYXRoICsgcXVlcnk7XG4gICAgICB9O1xuICAgIH0sIHsgXCIuLi90cmFuc3BvcnRcIjogNCwgXCJjb21wb25lbnQtaW5oZXJpdFwiOiAxNiwgZGVidWc6IDE3LCBcImVuZ2luZS5pby1wYXJzZXJcIjogMTksIHBhcnNlcXM6IDI3LCBcInhtbGh0dHByZXF1ZXN0LXNzbFwiOiAxMCwgeWVhc3Q6IDMwIH1dLCA5OiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuICAgICAgKGZ1bmN0aW9uIChnbG9iYWwpIHtcbiAgICAgICAgdmFyIFRyYW5zcG9ydCA9IF9kZXJlcV8oXCIuLi90cmFuc3BvcnRcIik7dmFyIHBhcnNlciA9IF9kZXJlcV8oXCJlbmdpbmUuaW8tcGFyc2VyXCIpO3ZhciBwYXJzZXFzID0gX2RlcmVxXyhcInBhcnNlcXNcIik7dmFyIGluaGVyaXQgPSBfZGVyZXFfKFwiY29tcG9uZW50LWluaGVyaXRcIik7dmFyIHllYXN0ID0gX2RlcmVxXyhcInllYXN0XCIpO3ZhciBkZWJ1ZyA9IF9kZXJlcV8oXCJkZWJ1Z1wiKShcImVuZ2luZS5pby1jbGllbnQ6d2Vic29ja2V0XCIpO3ZhciBCcm93c2VyV2ViU29ja2V0ID0gZ2xvYmFsLldlYlNvY2tldCB8fCBnbG9iYWwuTW96V2ViU29ja2V0O3ZhciBXZWJTb2NrZXQgPSBCcm93c2VyV2ViU29ja2V0O2lmICghV2ViU29ja2V0ICYmIHR5cGVvZiB3aW5kb3cgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgV2ViU29ja2V0ID0gX2RlcmVxXyhcIndzXCIpO1xuICAgICAgICAgIH0gY2F0Y2ggKGUpIHt9XG4gICAgICAgIH1tb2R1bGUuZXhwb3J0cyA9IFdTO2Z1bmN0aW9uIFdTKG9wdHMpIHtcbiAgICAgICAgICB2YXIgZm9yY2VCYXNlNjQgPSBvcHRzICYmIG9wdHMuZm9yY2VCYXNlNjQ7aWYgKGZvcmNlQmFzZTY0KSB7XG4gICAgICAgICAgICB0aGlzLnN1cHBvcnRzQmluYXJ5ID0gZmFsc2U7XG4gICAgICAgICAgfXRoaXMucGVyTWVzc2FnZURlZmxhdGUgPSBvcHRzLnBlck1lc3NhZ2VEZWZsYXRlO1RyYW5zcG9ydC5jYWxsKHRoaXMsIG9wdHMpO1xuICAgICAgICB9aW5oZXJpdChXUywgVHJhbnNwb3J0KTtXUy5wcm90b3R5cGUubmFtZSA9IFwid2Vic29ja2V0XCI7V1MucHJvdG90eXBlLnN1cHBvcnRzQmluYXJ5ID0gdHJ1ZTtXUy5wcm90b3R5cGUuZG9PcGVuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGlmICghdGhpcy5jaGVjaygpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfXZhciBzZWxmID0gdGhpczt2YXIgdXJpID0gdGhpcy51cmkoKTt2YXIgcHJvdG9jb2xzID0gdm9pZCAwO3ZhciBvcHRzID0geyBhZ2VudDogdGhpcy5hZ2VudCwgcGVyTWVzc2FnZURlZmxhdGU6IHRoaXMucGVyTWVzc2FnZURlZmxhdGUgfTtvcHRzLnBmeCA9IHRoaXMucGZ4O29wdHMua2V5ID0gdGhpcy5rZXk7b3B0cy5wYXNzcGhyYXNlID0gdGhpcy5wYXNzcGhyYXNlO29wdHMuY2VydCA9IHRoaXMuY2VydDtvcHRzLmNhID0gdGhpcy5jYTtvcHRzLmNpcGhlcnMgPSB0aGlzLmNpcGhlcnM7b3B0cy5yZWplY3RVbmF1dGhvcml6ZWQgPSB0aGlzLnJlamVjdFVuYXV0aG9yaXplZDtpZiAodGhpcy5leHRyYUhlYWRlcnMpIHtcbiAgICAgICAgICAgIG9wdHMuaGVhZGVycyA9IHRoaXMuZXh0cmFIZWFkZXJzO1xuICAgICAgICAgIH10aGlzLndzID0gQnJvd3NlcldlYlNvY2tldCA/IG5ldyBXZWJTb2NrZXQodXJpKSA6IG5ldyBXZWJTb2NrZXQodXJpLCBwcm90b2NvbHMsIG9wdHMpO2lmICh0aGlzLndzLmJpbmFyeVR5cGUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5zdXBwb3J0c0JpbmFyeSA9IGZhbHNlO1xuICAgICAgICAgIH1pZiAodGhpcy53cy5zdXBwb3J0cyAmJiB0aGlzLndzLnN1cHBvcnRzLmJpbmFyeSkge1xuICAgICAgICAgICAgdGhpcy5zdXBwb3J0c0JpbmFyeSA9IHRydWU7dGhpcy53cy5iaW5hcnlUeXBlID0gXCJidWZmZXJcIjtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy53cy5iaW5hcnlUeXBlID0gXCJhcnJheWJ1ZmZlclwiO1xuICAgICAgICAgIH10aGlzLmFkZEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgICAgIH07V1MucHJvdG90eXBlLmFkZEV2ZW50TGlzdGVuZXJzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHZhciBzZWxmID0gdGhpczt0aGlzLndzLm9ub3BlbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHNlbGYub25PcGVuKCk7XG4gICAgICAgICAgfTt0aGlzLndzLm9uY2xvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBzZWxmLm9uQ2xvc2UoKTtcbiAgICAgICAgICB9O3RoaXMud3Mub25tZXNzYWdlID0gZnVuY3Rpb24gKGV2KSB7XG4gICAgICAgICAgICBzZWxmLm9uRGF0YShldi5kYXRhKTtcbiAgICAgICAgICB9O3RoaXMud3Mub25lcnJvciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBzZWxmLm9uRXJyb3IoXCJ3ZWJzb2NrZXQgZXJyb3JcIiwgZSk7XG4gICAgICAgICAgfTtcbiAgICAgICAgfTtpZiAoXCJ1bmRlZmluZWRcIiAhPSB0eXBlb2YgbmF2aWdhdG9yICYmIC9pUGFkfGlQaG9uZXxpUG9kL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSkge1xuICAgICAgICAgIFdTLnByb3RvdHlwZS5vbkRhdGEgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO3NldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICBUcmFuc3BvcnQucHJvdG90eXBlLm9uRGF0YS5jYWxsKHNlbGYsIGRhdGEpO1xuICAgICAgICAgICAgfSwgMCk7XG4gICAgICAgICAgfTtcbiAgICAgICAgfVdTLnByb3RvdHlwZS53cml0ZSA9IGZ1bmN0aW9uIChwYWNrZXRzKSB7XG4gICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO3RoaXMud3JpdGFibGUgPSBmYWxzZTt2YXIgdG90YWwgPSBwYWNrZXRzLmxlbmd0aDtmb3IgKHZhciBpID0gMCwgbCA9IHRvdGFsOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgICAgICAoZnVuY3Rpb24gKHBhY2tldCkge1xuICAgICAgICAgICAgICBwYXJzZXIuZW5jb2RlUGFja2V0KHBhY2tldCwgc2VsZi5zdXBwb3J0c0JpbmFyeSwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBpZiAoIUJyb3dzZXJXZWJTb2NrZXQpIHtcbiAgICAgICAgICAgICAgICAgIHZhciBvcHRzID0ge307aWYgKHBhY2tldC5vcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgICAgIG9wdHMuY29tcHJlc3MgPSBwYWNrZXQub3B0aW9ucy5jb21wcmVzcztcbiAgICAgICAgICAgICAgICAgIH1pZiAoc2VsZi5wZXJNZXNzYWdlRGVmbGF0ZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbGVuID0gXCJzdHJpbmdcIiA9PSB0eXBlb2YgZGF0YSA/IGdsb2JhbC5CdWZmZXIuYnl0ZUxlbmd0aChkYXRhKSA6IGRhdGEubGVuZ3RoO2lmIChsZW4gPCBzZWxmLnBlck1lc3NhZ2VEZWZsYXRlLnRocmVzaG9sZCkge1xuICAgICAgICAgICAgICAgICAgICAgIG9wdHMuY29tcHJlc3MgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH10cnkge1xuICAgICAgICAgICAgICAgICAgaWYgKEJyb3dzZXJXZWJTb2NrZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi53cy5zZW5kKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi53cy5zZW5kKGRhdGEsIG9wdHMpO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgIGRlYnVnKFwid2Vic29ja2V0IGNsb3NlZCBiZWZvcmUgb25jbG9zZSBldmVudFwiKTtcbiAgICAgICAgICAgICAgICB9LS10b3RhbCB8fCBkb25lKCk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSkocGFja2V0c1tpXSk7XG4gICAgICAgICAgfWZ1bmN0aW9uIGRvbmUoKSB7XG4gICAgICAgICAgICBzZWxmLmVtaXQoXCJmbHVzaFwiKTtzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgc2VsZi53cml0YWJsZSA9IHRydWU7c2VsZi5lbWl0KFwiZHJhaW5cIik7XG4gICAgICAgICAgICB9LCAwKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07V1MucHJvdG90eXBlLm9uQ2xvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgVHJhbnNwb3J0LnByb3RvdHlwZS5vbkNsb3NlLmNhbGwodGhpcyk7XG4gICAgICAgIH07V1MucHJvdG90eXBlLmRvQ2xvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgaWYgKHR5cGVvZiB0aGlzLndzICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICB0aGlzLndzLmNsb3NlKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1dTLnByb3RvdHlwZS51cmkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgdmFyIHF1ZXJ5ID0gdGhpcy5xdWVyeSB8fCB7fTt2YXIgc2NoZW1hID0gdGhpcy5zZWN1cmUgPyBcIndzc1wiIDogXCJ3c1wiO3ZhciBwb3J0ID0gXCJcIjtpZiAodGhpcy5wb3J0ICYmIChcIndzc1wiID09IHNjaGVtYSAmJiB0aGlzLnBvcnQgIT0gNDQzIHx8IFwid3NcIiA9PSBzY2hlbWEgJiYgdGhpcy5wb3J0ICE9IDgwKSkge1xuICAgICAgICAgICAgcG9ydCA9IFwiOlwiICsgdGhpcy5wb3J0O1xuICAgICAgICAgIH1pZiAodGhpcy50aW1lc3RhbXBSZXF1ZXN0cykge1xuICAgICAgICAgICAgcXVlcnlbdGhpcy50aW1lc3RhbXBQYXJhbV0gPSB5ZWFzdCgpO1xuICAgICAgICAgIH1pZiAoIXRoaXMuc3VwcG9ydHNCaW5hcnkpIHtcbiAgICAgICAgICAgIHF1ZXJ5LmI2NCA9IDE7XG4gICAgICAgICAgfXF1ZXJ5ID0gcGFyc2Vxcy5lbmNvZGUocXVlcnkpO2lmIChxdWVyeS5sZW5ndGgpIHtcbiAgICAgICAgICAgIHF1ZXJ5ID0gXCI/XCIgKyBxdWVyeTtcbiAgICAgICAgICB9dmFyIGlwdjYgPSB0aGlzLmhvc3RuYW1lLmluZGV4T2YoXCI6XCIpICE9PSAtMTtyZXR1cm4gc2NoZW1hICsgXCI6Ly9cIiArIChpcHY2ID8gXCJbXCIgKyB0aGlzLmhvc3RuYW1lICsgXCJdXCIgOiB0aGlzLmhvc3RuYW1lKSArIHBvcnQgKyB0aGlzLnBhdGggKyBxdWVyeTtcbiAgICAgICAgfTtXUy5wcm90b3R5cGUuY2hlY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgcmV0dXJuICEhV2ViU29ja2V0ICYmICEoXCJfX2luaXRpYWxpemVcIiBpbiBXZWJTb2NrZXQgJiYgdGhpcy5uYW1lID09PSBXUy5wcm90b3R5cGUubmFtZSk7XG4gICAgICAgIH07XG4gICAgICB9KS5jYWxsKHRoaXMsIHR5cGVvZiBzZWxmICE9PSBcInVuZGVmaW5lZFwiID8gc2VsZiA6IHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgPyB3aW5kb3cgOiB0eXBlb2YgZ2xvYmFsICE9PSBcInVuZGVmaW5lZFwiID8gZ2xvYmFsIDoge30pO1xuICAgIH0sIHsgXCIuLi90cmFuc3BvcnRcIjogNCwgXCJjb21wb25lbnQtaW5oZXJpdFwiOiAxNiwgZGVidWc6IDE3LCBcImVuZ2luZS5pby1wYXJzZXJcIjogMTksIHBhcnNlcXM6IDI3LCB3czogdW5kZWZpbmVkLCB5ZWFzdDogMzAgfV0sIDEwOiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuICAgICAgdmFyIGhhc0NPUlMgPSBfZGVyZXFfKFwiaGFzLWNvcnNcIik7bW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAob3B0cykge1xuICAgICAgICB2YXIgeGRvbWFpbiA9IG9wdHMueGRvbWFpbjt2YXIgeHNjaGVtZSA9IG9wdHMueHNjaGVtZTt2YXIgZW5hYmxlc1hEUiA9IG9wdHMuZW5hYmxlc1hEUjt0cnkge1xuICAgICAgICAgIGlmIChcInVuZGVmaW5lZFwiICE9IHR5cGVvZiBYTUxIdHRwUmVxdWVzdCAmJiAoIXhkb21haW4gfHwgaGFzQ09SUykpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGUpIHt9dHJ5IHtcbiAgICAgICAgICBpZiAoXCJ1bmRlZmluZWRcIiAhPSB0eXBlb2YgWERvbWFpblJlcXVlc3QgJiYgIXhzY2hlbWUgJiYgZW5hYmxlc1hEUikge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBYRG9tYWluUmVxdWVzdCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZSkge31pZiAoIXhkb21haW4pIHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBBY3RpdmVYT2JqZWN0KFwiTWljcm9zb2Z0LlhNTEhUVFBcIik7XG4gICAgICAgICAgfSBjYXRjaCAoZSkge31cbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9LCB7IFwiaGFzLWNvcnNcIjogMjIgfV0sIDExOiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuICAgICAgbW9kdWxlLmV4cG9ydHMgPSBhZnRlcjtmdW5jdGlvbiBhZnRlcihjb3VudCwgY2FsbGJhY2ssIGVycl9jYikge1xuICAgICAgICB2YXIgYmFpbCA9IGZhbHNlO2Vycl9jYiA9IGVycl9jYiB8fCBub29wO3Byb3h5LmNvdW50ID0gY291bnQ7cmV0dXJuIGNvdW50ID09PSAwID8gY2FsbGJhY2soKSA6IHByb3h5O2Z1bmN0aW9uIHByb3h5KGVyciwgcmVzdWx0KSB7XG4gICAgICAgICAgaWYgKHByb3h5LmNvdW50IDw9IDApIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImFmdGVyIGNhbGxlZCB0b28gbWFueSB0aW1lc1wiKTtcbiAgICAgICAgICB9LS1wcm94eS5jb3VudDtpZiAoZXJyKSB7XG4gICAgICAgICAgICBiYWlsID0gdHJ1ZTtjYWxsYmFjayhlcnIpO2NhbGxiYWNrID0gZXJyX2NiO1xuICAgICAgICAgIH0gZWxzZSBpZiAocHJveHkuY291bnQgPT09IDAgJiYgIWJhaWwpIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKG51bGwsIHJlc3VsdCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9ZnVuY3Rpb24gbm9vcCgpIHt9XG4gICAgfSwge31dLCAxMjogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcbiAgICAgIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGFycmF5YnVmZmVyLCBzdGFydCwgZW5kKSB7XG4gICAgICAgIHZhciBieXRlcyA9IGFycmF5YnVmZmVyLmJ5dGVMZW5ndGg7c3RhcnQgPSBzdGFydCB8fCAwO2VuZCA9IGVuZCB8fCBieXRlcztpZiAoYXJyYXlidWZmZXIuc2xpY2UpIHtcbiAgICAgICAgICByZXR1cm4gYXJyYXlidWZmZXIuc2xpY2Uoc3RhcnQsIGVuZCk7XG4gICAgICAgIH1pZiAoc3RhcnQgPCAwKSB7XG4gICAgICAgICAgc3RhcnQgKz0gYnl0ZXM7XG4gICAgICAgIH1pZiAoZW5kIDwgMCkge1xuICAgICAgICAgIGVuZCArPSBieXRlcztcbiAgICAgICAgfWlmIChlbmQgPiBieXRlcykge1xuICAgICAgICAgIGVuZCA9IGJ5dGVzO1xuICAgICAgICB9aWYgKHN0YXJ0ID49IGJ5dGVzIHx8IHN0YXJ0ID49IGVuZCB8fCBieXRlcyA9PT0gMCkge1xuICAgICAgICAgIHJldHVybiBuZXcgQXJyYXlCdWZmZXIoMCk7XG4gICAgICAgIH12YXIgYWJ2ID0gbmV3IFVpbnQ4QXJyYXkoYXJyYXlidWZmZXIpO3ZhciByZXN1bHQgPSBuZXcgVWludDhBcnJheShlbmQgLSBzdGFydCk7Zm9yICh2YXIgaSA9IHN0YXJ0LCBpaSA9IDA7IGkgPCBlbmQ7IGkrKywgaWkrKykge1xuICAgICAgICAgIHJlc3VsdFtpaV0gPSBhYnZbaV07XG4gICAgICAgIH1yZXR1cm4gcmVzdWx0LmJ1ZmZlcjtcbiAgICAgIH07XG4gICAgfSwge31dLCAxMzogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcbiAgICAgIChmdW5jdGlvbiAoY2hhcnMpIHtcbiAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7ZXhwb3J0cy5lbmNvZGUgPSBmdW5jdGlvbiAoYXJyYXlidWZmZXIpIHtcbiAgICAgICAgICB2YXIgYnl0ZXMgPSBuZXcgVWludDhBcnJheShhcnJheWJ1ZmZlciksXG4gICAgICAgICAgICAgIGksXG4gICAgICAgICAgICAgIGxlbiA9IGJ5dGVzLmxlbmd0aCxcbiAgICAgICAgICAgICAgYmFzZTY0ID0gXCJcIjtmb3IgKGkgPSAwOyBpIDwgbGVuOyBpICs9IDMpIHtcbiAgICAgICAgICAgIGJhc2U2NCArPSBjaGFyc1tieXRlc1tpXSA+PiAyXTtcbiAgICAgICAgICAgIGJhc2U2NCArPSBjaGFyc1soYnl0ZXNbaV0gJiAzKSA8PCA0IHwgYnl0ZXNbaSArIDFdID4+IDRdO2Jhc2U2NCArPSBjaGFyc1soYnl0ZXNbaSArIDFdICYgMTUpIDw8IDIgfCBieXRlc1tpICsgMl0gPj4gNl07YmFzZTY0ICs9IGNoYXJzW2J5dGVzW2kgKyAyXSAmIDYzXTtcbiAgICAgICAgICB9aWYgKGxlbiAlIDMgPT09IDIpIHtcbiAgICAgICAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDEpICsgXCI9XCI7XG4gICAgICAgICAgfSBlbHNlIGlmIChsZW4gJSAzID09PSAxKSB7XG4gICAgICAgICAgICBiYXNlNjQgPSBiYXNlNjQuc3Vic3RyaW5nKDAsIGJhc2U2NC5sZW5ndGggLSAyKSArIFwiPT1cIjtcbiAgICAgICAgICB9cmV0dXJuIGJhc2U2NDtcbiAgICAgICAgfTtleHBvcnRzLmRlY29kZSA9IGZ1bmN0aW9uIChiYXNlNjQpIHtcbiAgICAgICAgICB2YXIgYnVmZmVyTGVuZ3RoID0gYmFzZTY0Lmxlbmd0aCAqIC43NSxcbiAgICAgICAgICAgICAgbGVuID0gYmFzZTY0Lmxlbmd0aCxcbiAgICAgICAgICAgICAgaSxcbiAgICAgICAgICAgICAgcCA9IDAsXG4gICAgICAgICAgICAgIGVuY29kZWQxLFxuICAgICAgICAgICAgICBlbmNvZGVkMixcbiAgICAgICAgICAgICAgZW5jb2RlZDMsXG4gICAgICAgICAgICAgIGVuY29kZWQ0O2lmIChiYXNlNjRbYmFzZTY0Lmxlbmd0aCAtIDFdID09PSBcIj1cIikge1xuICAgICAgICAgICAgYnVmZmVyTGVuZ3RoLS07aWYgKGJhc2U2NFtiYXNlNjQubGVuZ3RoIC0gMl0gPT09IFwiPVwiKSB7XG4gICAgICAgICAgICAgIGJ1ZmZlckxlbmd0aC0tO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH12YXIgYXJyYXlidWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIoYnVmZmVyTGVuZ3RoKSxcbiAgICAgICAgICAgICAgYnl0ZXMgPSBuZXcgVWludDhBcnJheShhcnJheWJ1ZmZlcik7Zm9yIChpID0gMDsgaSA8IGxlbjsgaSArPSA0KSB7XG4gICAgICAgICAgICBlbmNvZGVkMSA9IGNoYXJzLmluZGV4T2YoYmFzZTY0W2ldKTtlbmNvZGVkMiA9IGNoYXJzLmluZGV4T2YoYmFzZTY0W2kgKyAxXSk7ZW5jb2RlZDMgPSBjaGFycy5pbmRleE9mKGJhc2U2NFtpICsgMl0pO2VuY29kZWQ0ID0gY2hhcnMuaW5kZXhPZihiYXNlNjRbaSArIDNdKTtieXRlc1twKytdID0gZW5jb2RlZDEgPDwgMiB8IGVuY29kZWQyID4+IDQ7Ynl0ZXNbcCsrXSA9IChlbmNvZGVkMiAmIDE1KSA8PCA0IHwgZW5jb2RlZDMgPj4gMjtieXRlc1twKytdID0gKGVuY29kZWQzICYgMykgPDwgNiB8IGVuY29kZWQ0ICYgNjM7XG4gICAgICAgICAgfXJldHVybiBhcnJheWJ1ZmZlcjtcbiAgICAgICAgfTtcbiAgICAgIH0pKFwiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrL1wiKTtcbiAgICB9LCB7fV0sIDE0OiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuICAgICAgKGZ1bmN0aW9uIChnbG9iYWwpIHtcbiAgICAgICAgdmFyIEJsb2JCdWlsZGVyID0gZ2xvYmFsLkJsb2JCdWlsZGVyIHx8IGdsb2JhbC5XZWJLaXRCbG9iQnVpbGRlciB8fCBnbG9iYWwuTVNCbG9iQnVpbGRlciB8fCBnbG9iYWwuTW96QmxvYkJ1aWxkZXI7dmFyIGJsb2JTdXBwb3J0ZWQgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIgYSA9IG5ldyBCbG9iKFtcImhpXCJdKTtyZXR1cm4gYS5zaXplID09PSAyO1xuICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pKCk7dmFyIGJsb2JTdXBwb3J0c0FycmF5QnVmZmVyVmlldyA9IGJsb2JTdXBwb3J0ZWQgJiYgKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgdmFyIGIgPSBuZXcgQmxvYihbbmV3IFVpbnQ4QXJyYXkoWzEsIDJdKV0pO3JldHVybiBiLnNpemUgPT09IDI7XG4gICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgfSkoKTt2YXIgYmxvYkJ1aWxkZXJTdXBwb3J0ZWQgPSBCbG9iQnVpbGRlciAmJiBCbG9iQnVpbGRlci5wcm90b3R5cGUuYXBwZW5kICYmIEJsb2JCdWlsZGVyLnByb3RvdHlwZS5nZXRCbG9iO2Z1bmN0aW9uIG1hcEFycmF5QnVmZmVyVmlld3MoYXJ5KSB7XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBjaHVuayA9IGFyeVtpXTtpZiAoY2h1bmsuYnVmZmVyIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHtcbiAgICAgICAgICAgICAgdmFyIGJ1ZiA9IGNodW5rLmJ1ZmZlcjtpZiAoY2h1bmsuYnl0ZUxlbmd0aCAhPT0gYnVmLmJ5dGVMZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB2YXIgY29weSA9IG5ldyBVaW50OEFycmF5KGNodW5rLmJ5dGVMZW5ndGgpO2NvcHkuc2V0KG5ldyBVaW50OEFycmF5KGJ1ZiwgY2h1bmsuYnl0ZU9mZnNldCwgY2h1bmsuYnl0ZUxlbmd0aCkpO2J1ZiA9IGNvcHkuYnVmZmVyO1xuICAgICAgICAgICAgICB9YXJ5W2ldID0gYnVmO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfWZ1bmN0aW9uIEJsb2JCdWlsZGVyQ29uc3RydWN0b3IoYXJ5LCBvcHRpb25zKSB7XG4gICAgICAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307dmFyIGJiID0gbmV3IEJsb2JCdWlsZGVyKCk7bWFwQXJyYXlCdWZmZXJWaWV3cyhhcnkpO2ZvciAodmFyIGkgPSAwOyBpIDwgYXJ5Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBiYi5hcHBlbmQoYXJ5W2ldKTtcbiAgICAgICAgICB9cmV0dXJuIG9wdGlvbnMudHlwZSA/IGJiLmdldEJsb2Iob3B0aW9ucy50eXBlKSA6IGJiLmdldEJsb2IoKTtcbiAgICAgICAgfWZ1bmN0aW9uIEJsb2JDb25zdHJ1Y3RvcihhcnksIG9wdGlvbnMpIHtcbiAgICAgICAgICBtYXBBcnJheUJ1ZmZlclZpZXdzKGFyeSk7cmV0dXJuIG5ldyBCbG9iKGFyeSwgb3B0aW9ucyB8fCB7fSk7XG4gICAgICAgIH1tb2R1bGUuZXhwb3J0cyA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgaWYgKGJsb2JTdXBwb3J0ZWQpIHtcbiAgICAgICAgICAgIHJldHVybiBibG9iU3VwcG9ydHNBcnJheUJ1ZmZlclZpZXcgPyBnbG9iYWwuQmxvYiA6IEJsb2JDb25zdHJ1Y3RvcjtcbiAgICAgICAgICB9IGVsc2UgaWYgKGJsb2JCdWlsZGVyU3VwcG9ydGVkKSB7XG4gICAgICAgICAgICByZXR1cm4gQmxvYkJ1aWxkZXJDb25zdHJ1Y3RvcjtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgICB9XG4gICAgICAgIH0pKCk7XG4gICAgICB9KS5jYWxsKHRoaXMsIHR5cGVvZiBzZWxmICE9PSBcInVuZGVmaW5lZFwiID8gc2VsZiA6IHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgPyB3aW5kb3cgOiB0eXBlb2YgZ2xvYmFsICE9PSBcInVuZGVmaW5lZFwiID8gZ2xvYmFsIDoge30pO1xuICAgIH0sIHt9XSwgMTU6IFtmdW5jdGlvbiAoX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG4gICAgICBtb2R1bGUuZXhwb3J0cyA9IEVtaXR0ZXI7ZnVuY3Rpb24gRW1pdHRlcihvYmopIHtcbiAgICAgICAgaWYgKG9iaikgcmV0dXJuIG1peGluKG9iaik7XG4gICAgICB9ZnVuY3Rpb24gbWl4aW4ob2JqKSB7XG4gICAgICAgIGZvciAodmFyIGtleSBpbiBFbWl0dGVyLnByb3RvdHlwZSkge1xuICAgICAgICAgIG9ialtrZXldID0gRW1pdHRlci5wcm90b3R5cGVba2V5XTtcbiAgICAgICAgfXJldHVybiBvYmo7XG4gICAgICB9RW1pdHRlci5wcm90b3R5cGUub24gPSBFbWl0dGVyLnByb3RvdHlwZS5hZGRFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKGV2ZW50LCBmbikge1xuICAgICAgICB0aGlzLl9jYWxsYmFja3MgPSB0aGlzLl9jYWxsYmFja3MgfHwge307KHRoaXMuX2NhbGxiYWNrc1tldmVudF0gPSB0aGlzLl9jYWxsYmFja3NbZXZlbnRdIHx8IFtdKS5wdXNoKGZuKTtyZXR1cm4gdGhpcztcbiAgICAgIH07RW1pdHRlci5wcm90b3R5cGUub25jZSA9IGZ1bmN0aW9uIChldmVudCwgZm4pIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO3RoaXMuX2NhbGxiYWNrcyA9IHRoaXMuX2NhbGxiYWNrcyB8fCB7fTtmdW5jdGlvbiBvbigpIHtcbiAgICAgICAgICBzZWxmLm9mZihldmVudCwgb24pO2ZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgIH1vbi5mbiA9IGZuO3RoaXMub24oZXZlbnQsIG9uKTtyZXR1cm4gdGhpcztcbiAgICAgIH07RW1pdHRlci5wcm90b3R5cGUub2ZmID0gRW1pdHRlci5wcm90b3R5cGUucmVtb3ZlTGlzdGVuZXIgPSBFbWl0dGVyLnByb3RvdHlwZS5yZW1vdmVBbGxMaXN0ZW5lcnMgPSBFbWl0dGVyLnByb3RvdHlwZS5yZW1vdmVFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKGV2ZW50LCBmbikge1xuICAgICAgICB0aGlzLl9jYWxsYmFja3MgPSB0aGlzLl9jYWxsYmFja3MgfHwge307aWYgKDAgPT0gYXJndW1lbnRzLmxlbmd0aCkge1xuICAgICAgICAgIHRoaXMuX2NhbGxiYWNrcyA9IHt9O3JldHVybiB0aGlzO1xuICAgICAgICB9dmFyIGNhbGxiYWNrcyA9IHRoaXMuX2NhbGxiYWNrc1tldmVudF07aWYgKCFjYWxsYmFja3MpIHJldHVybiB0aGlzO2lmICgxID09IGFyZ3VtZW50cy5sZW5ndGgpIHtcbiAgICAgICAgICBkZWxldGUgdGhpcy5fY2FsbGJhY2tzW2V2ZW50XTtyZXR1cm4gdGhpcztcbiAgICAgICAgfXZhciBjYjtmb3IgKHZhciBpID0gMDsgaSA8IGNhbGxiYWNrcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIGNiID0gY2FsbGJhY2tzW2ldO2lmIChjYiA9PT0gZm4gfHwgY2IuZm4gPT09IGZuKSB7XG4gICAgICAgICAgICBjYWxsYmFja3Muc3BsaWNlKGksIDEpO2JyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfXJldHVybiB0aGlzO1xuICAgICAgfTtFbWl0dGVyLnByb3RvdHlwZS5lbWl0ID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIHRoaXMuX2NhbGxiYWNrcyA9IHRoaXMuX2NhbGxiYWNrcyB8fCB7fTt2YXIgYXJncyA9IFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSxcbiAgICAgICAgICAgIGNhbGxiYWNrcyA9IHRoaXMuX2NhbGxiYWNrc1tldmVudF07aWYgKGNhbGxiYWNrcykge1xuICAgICAgICAgIGNhbGxiYWNrcyA9IGNhbGxiYWNrcy5zbGljZSgwKTtmb3IgKHZhciBpID0gMCwgbGVuID0gY2FsbGJhY2tzLmxlbmd0aDsgaSA8IGxlbjsgKytpKSB7XG4gICAgICAgICAgICBjYWxsYmFja3NbaV0uYXBwbHkodGhpcywgYXJncyk7XG4gICAgICAgICAgfVxuICAgICAgICB9cmV0dXJuIHRoaXM7XG4gICAgICB9O0VtaXR0ZXIucHJvdG90eXBlLmxpc3RlbmVycyA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICB0aGlzLl9jYWxsYmFja3MgPSB0aGlzLl9jYWxsYmFja3MgfHwge307cmV0dXJuIHRoaXMuX2NhbGxiYWNrc1tldmVudF0gfHwgW107XG4gICAgICB9O0VtaXR0ZXIucHJvdG90eXBlLmhhc0xpc3RlbmVycyA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICByZXR1cm4gISF0aGlzLmxpc3RlbmVycyhldmVudCkubGVuZ3RoO1xuICAgICAgfTtcbiAgICB9LCB7fV0sIDE2OiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuICAgICAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICB2YXIgZm4gPSBmdW5jdGlvbiBmbigpIHt9O2ZuLnByb3RvdHlwZSA9IGIucHJvdG90eXBlO2EucHJvdG90eXBlID0gbmV3IGZuKCk7YS5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBhO1xuICAgICAgfTtcbiAgICB9LCB7fV0sIDE3OiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuICAgICAgZXhwb3J0cyA9IG1vZHVsZS5leHBvcnRzID0gX2RlcmVxXyhcIi4vZGVidWdcIik7ZXhwb3J0cy5sb2cgPSBsb2c7ZXhwb3J0cy5mb3JtYXRBcmdzID0gZm9ybWF0QXJncztleHBvcnRzLnNhdmUgPSBzYXZlO2V4cG9ydHMubG9hZCA9IGxvYWQ7ZXhwb3J0cy51c2VDb2xvcnMgPSB1c2VDb2xvcnM7ZXhwb3J0cy5zdG9yYWdlID0gXCJ1bmRlZmluZWRcIiAhPSB0eXBlb2YgY2hyb21lICYmIFwidW5kZWZpbmVkXCIgIT0gdHlwZW9mIGNocm9tZS5zdG9yYWdlID8gY2hyb21lLnN0b3JhZ2UubG9jYWwgOiBsb2NhbHN0b3JhZ2UoKTtleHBvcnRzLmNvbG9ycyA9IFtcImxpZ2h0c2VhZ3JlZW5cIiwgXCJmb3Jlc3RncmVlblwiLCBcImdvbGRlbnJvZFwiLCBcImRvZGdlcmJsdWVcIiwgXCJkYXJrb3JjaGlkXCIsIFwiY3JpbXNvblwiXTtmdW5jdGlvbiB1c2VDb2xvcnMoKSB7XG4gICAgICAgIHJldHVybiBcIldlYmtpdEFwcGVhcmFuY2VcIiBpbiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUgfHwgd2luZG93LmNvbnNvbGUgJiYgKGNvbnNvbGUuZmlyZWJ1ZyB8fCBjb25zb2xlLmV4Y2VwdGlvbiAmJiBjb25zb2xlLnRhYmxlKSB8fCBuYXZpZ2F0b3IudXNlckFnZW50LnRvTG93ZXJDYXNlKCkubWF0Y2goL2ZpcmVmb3hcXC8oXFxkKykvKSAmJiBwYXJzZUludChSZWdFeHAuJDEsIDEwKSA+PSAzMTtcbiAgICAgIH1leHBvcnRzLmZvcm1hdHRlcnMuaiA9IGZ1bmN0aW9uICh2KSB7XG4gICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeSh2KTtcbiAgICAgIH07ZnVuY3Rpb24gZm9ybWF0QXJncygpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSBhcmd1bWVudHM7dmFyIHVzZUNvbG9ycyA9IHRoaXMudXNlQ29sb3JzO2FyZ3NbMF0gPSAodXNlQ29sb3JzID8gXCIlY1wiIDogXCJcIikgKyB0aGlzLm5hbWVzcGFjZSArICh1c2VDb2xvcnMgPyBcIiAlY1wiIDogXCIgXCIpICsgYXJnc1swXSArICh1c2VDb2xvcnMgPyBcIiVjIFwiIDogXCIgXCIpICsgXCIrXCIgKyBleHBvcnRzLmh1bWFuaXplKHRoaXMuZGlmZik7aWYgKCF1c2VDb2xvcnMpIHJldHVybiBhcmdzO3ZhciBjID0gXCJjb2xvcjogXCIgKyB0aGlzLmNvbG9yO2FyZ3MgPSBbYXJnc1swXSwgYywgXCJjb2xvcjogaW5oZXJpdFwiXS5jb25jYXQoQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJncywgMSkpO3ZhciBpbmRleCA9IDA7dmFyIGxhc3RDID0gMDthcmdzWzBdLnJlcGxhY2UoLyVbYS16JV0vZywgZnVuY3Rpb24gKG1hdGNoKSB7XG4gICAgICAgICAgaWYgKFwiJSVcIiA9PT0gbWF0Y2gpIHJldHVybjtpbmRleCsrO2lmIChcIiVjXCIgPT09IG1hdGNoKSB7XG4gICAgICAgICAgICBsYXN0QyA9IGluZGV4O1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7YXJncy5zcGxpY2UobGFzdEMsIDAsIGMpO3JldHVybiBhcmdzO1xuICAgICAgfWZ1bmN0aW9uIGxvZygpIHtcbiAgICAgICAgcmV0dXJuIFwib2JqZWN0XCIgPT09IHR5cGVvZiBjb25zb2xlICYmIGNvbnNvbGUubG9nICYmIEZ1bmN0aW9uLnByb3RvdHlwZS5hcHBseS5jYWxsKGNvbnNvbGUubG9nLCBjb25zb2xlLCBhcmd1bWVudHMpO1xuICAgICAgfWZ1bmN0aW9uIHNhdmUobmFtZXNwYWNlcykge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGlmIChudWxsID09IG5hbWVzcGFjZXMpIHtcbiAgICAgICAgICAgIGV4cG9ydHMuc3RvcmFnZS5yZW1vdmVJdGVtKFwiZGVidWdcIik7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGV4cG9ydHMuc3RvcmFnZS5kZWJ1ZyA9IG5hbWVzcGFjZXM7XG4gICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlKSB7fVxuICAgICAgfWZ1bmN0aW9uIGxvYWQoKSB7XG4gICAgICAgIHZhciByO3RyeSB7XG4gICAgICAgICAgciA9IGV4cG9ydHMuc3RvcmFnZS5kZWJ1ZztcbiAgICAgICAgfSBjYXRjaCAoZSkge31yZXR1cm4gcjtcbiAgICAgIH1leHBvcnRzLmVuYWJsZShsb2FkKCkpO2Z1bmN0aW9uIGxvY2Fsc3RvcmFnZSgpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICByZXR1cm4gd2luZG93LmxvY2FsU3RvcmFnZTtcbiAgICAgICAgfSBjYXRjaCAoZSkge31cbiAgICAgIH1cbiAgICB9LCB7IFwiLi9kZWJ1Z1wiOiAxOCB9XSwgMTg6IFtmdW5jdGlvbiAoX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG4gICAgICBleHBvcnRzID0gbW9kdWxlLmV4cG9ydHMgPSBkZWJ1ZztleHBvcnRzLmNvZXJjZSA9IGNvZXJjZTtleHBvcnRzLmRpc2FibGUgPSBkaXNhYmxlO2V4cG9ydHMuZW5hYmxlID0gZW5hYmxlO2V4cG9ydHMuZW5hYmxlZCA9IGVuYWJsZWQ7ZXhwb3J0cy5odW1hbml6ZSA9IF9kZXJlcV8oXCJtc1wiKTtleHBvcnRzLm5hbWVzID0gW107ZXhwb3J0cy5za2lwcyA9IFtdO2V4cG9ydHMuZm9ybWF0dGVycyA9IHt9O3ZhciBwcmV2Q29sb3IgPSAwO3ZhciBwcmV2VGltZTtmdW5jdGlvbiBzZWxlY3RDb2xvcigpIHtcbiAgICAgICAgcmV0dXJuIGV4cG9ydHMuY29sb3JzW3ByZXZDb2xvcisrICUgZXhwb3J0cy5jb2xvcnMubGVuZ3RoXTtcbiAgICAgIH1mdW5jdGlvbiBkZWJ1ZyhuYW1lc3BhY2UpIHtcbiAgICAgICAgZnVuY3Rpb24gZGlzYWJsZWQoKSB7fWRpc2FibGVkLmVuYWJsZWQgPSBmYWxzZTtmdW5jdGlvbiBlbmFibGVkKCkge1xuICAgICAgICAgIHZhciBzZWxmID0gZW5hYmxlZDt2YXIgY3VyciA9ICtuZXcgRGF0ZSgpO3ZhciBtcyA9IGN1cnIgLSAocHJldlRpbWUgfHwgY3Vycik7c2VsZi5kaWZmID0gbXM7c2VsZi5wcmV2ID0gcHJldlRpbWU7c2VsZi5jdXJyID0gY3VycjtwcmV2VGltZSA9IGN1cnI7aWYgKG51bGwgPT0gc2VsZi51c2VDb2xvcnMpIHNlbGYudXNlQ29sb3JzID0gZXhwb3J0cy51c2VDb2xvcnMoKTtpZiAobnVsbCA9PSBzZWxmLmNvbG9yICYmIHNlbGYudXNlQ29sb3JzKSBzZWxmLmNvbG9yID0gc2VsZWN0Q29sb3IoKTt2YXIgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyk7YXJnc1swXSA9IGV4cG9ydHMuY29lcmNlKGFyZ3NbMF0pO2lmIChcInN0cmluZ1wiICE9PSB0eXBlb2YgYXJnc1swXSkge1xuICAgICAgICAgICAgYXJncyA9IFtcIiVvXCJdLmNvbmNhdChhcmdzKTtcbiAgICAgICAgICB9dmFyIGluZGV4ID0gMDthcmdzWzBdID0gYXJnc1swXS5yZXBsYWNlKC8lKFthLXolXSkvZywgZnVuY3Rpb24gKG1hdGNoLCBmb3JtYXQpIHtcbiAgICAgICAgICAgIGlmIChtYXRjaCA9PT0gXCIlJVwiKSByZXR1cm4gbWF0Y2g7aW5kZXgrKzt2YXIgZm9ybWF0dGVyID0gZXhwb3J0cy5mb3JtYXR0ZXJzW2Zvcm1hdF07aWYgKFwiZnVuY3Rpb25cIiA9PT0gdHlwZW9mIGZvcm1hdHRlcikge1xuICAgICAgICAgICAgICB2YXIgdmFsID0gYXJnc1tpbmRleF07bWF0Y2ggPSBmb3JtYXR0ZXIuY2FsbChzZWxmLCB2YWwpO2FyZ3Muc3BsaWNlKGluZGV4LCAxKTtpbmRleC0tO1xuICAgICAgICAgICAgfXJldHVybiBtYXRjaDtcbiAgICAgICAgICB9KTtpZiAoXCJmdW5jdGlvblwiID09PSB0eXBlb2YgZXhwb3J0cy5mb3JtYXRBcmdzKSB7XG4gICAgICAgICAgICBhcmdzID0gZXhwb3J0cy5mb3JtYXRBcmdzLmFwcGx5KHNlbGYsIGFyZ3MpO1xuICAgICAgICAgIH12YXIgbG9nRm4gPSBlbmFibGVkLmxvZyB8fCBleHBvcnRzLmxvZyB8fCBjb25zb2xlLmxvZy5iaW5kKGNvbnNvbGUpO2xvZ0ZuLmFwcGx5KHNlbGYsIGFyZ3MpO1xuICAgICAgICB9ZW5hYmxlZC5lbmFibGVkID0gdHJ1ZTt2YXIgZm4gPSBleHBvcnRzLmVuYWJsZWQobmFtZXNwYWNlKSA/IGVuYWJsZWQgOiBkaXNhYmxlZDtmbi5uYW1lc3BhY2UgPSBuYW1lc3BhY2U7cmV0dXJuIGZuO1xuICAgICAgfWZ1bmN0aW9uIGVuYWJsZShuYW1lc3BhY2VzKSB7XG4gICAgICAgIGV4cG9ydHMuc2F2ZShuYW1lc3BhY2VzKTt2YXIgc3BsaXQgPSAobmFtZXNwYWNlcyB8fCBcIlwiKS5zcGxpdCgvW1xccyxdKy8pO3ZhciBsZW4gPSBzcGxpdC5sZW5ndGg7Zm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgIGlmICghc3BsaXRbaV0pIGNvbnRpbnVlO25hbWVzcGFjZXMgPSBzcGxpdFtpXS5yZXBsYWNlKC9cXCovZywgXCIuKj9cIik7aWYgKG5hbWVzcGFjZXNbMF0gPT09IFwiLVwiKSB7XG4gICAgICAgICAgICBleHBvcnRzLnNraXBzLnB1c2gobmV3IFJlZ0V4cChcIl5cIiArIG5hbWVzcGFjZXMuc3Vic3RyKDEpICsgXCIkXCIpKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZXhwb3J0cy5uYW1lcy5wdXNoKG5ldyBSZWdFeHAoXCJeXCIgKyBuYW1lc3BhY2VzICsgXCIkXCIpKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1mdW5jdGlvbiBkaXNhYmxlKCkge1xuICAgICAgICBleHBvcnRzLmVuYWJsZShcIlwiKTtcbiAgICAgIH1mdW5jdGlvbiBlbmFibGVkKG5hbWUpIHtcbiAgICAgICAgdmFyIGksIGxlbjtmb3IgKGkgPSAwLCBsZW4gPSBleHBvcnRzLnNraXBzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgaWYgKGV4cG9ydHMuc2tpcHNbaV0udGVzdChuYW1lKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgfWZvciAoaSA9IDAsIGxlbiA9IGV4cG9ydHMubmFtZXMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICBpZiAoZXhwb3J0cy5uYW1lc1tpXS50ZXN0KG5hbWUpKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1yZXR1cm4gZmFsc2U7XG4gICAgICB9ZnVuY3Rpb24gY29lcmNlKHZhbCkge1xuICAgICAgICBpZiAodmFsIGluc3RhbmNlb2YgRXJyb3IpIHJldHVybiB2YWwuc3RhY2sgfHwgdmFsLm1lc3NhZ2U7cmV0dXJuIHZhbDtcbiAgICAgIH1cbiAgICB9LCB7IG1zOiAyNSB9XSwgMTk6IFtmdW5jdGlvbiAoX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG4gICAgICAoZnVuY3Rpb24gKGdsb2JhbCkge1xuICAgICAgICB2YXIga2V5cyA9IF9kZXJlcV8oXCIuL2tleXNcIik7dmFyIGhhc0JpbmFyeSA9IF9kZXJlcV8oXCJoYXMtYmluYXJ5XCIpO3ZhciBzbGljZUJ1ZmZlciA9IF9kZXJlcV8oXCJhcnJheWJ1ZmZlci5zbGljZVwiKTt2YXIgYmFzZTY0ZW5jb2RlciA9IF9kZXJlcV8oXCJiYXNlNjQtYXJyYXlidWZmZXJcIik7dmFyIGFmdGVyID0gX2RlcmVxXyhcImFmdGVyXCIpO3ZhciB1dGY4ID0gX2RlcmVxXyhcInV0ZjhcIik7dmFyIGlzQW5kcm9pZCA9IG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL0FuZHJvaWQvaSk7dmFyIGlzUGhhbnRvbUpTID0gL1BoYW50b21KUy9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCk7dmFyIGRvbnRTZW5kQmxvYnMgPSBpc0FuZHJvaWQgfHwgaXNQaGFudG9tSlM7ZXhwb3J0cy5wcm90b2NvbCA9IDM7dmFyIHBhY2tldHMgPSBleHBvcnRzLnBhY2tldHMgPSB7IG9wZW46IDAsIGNsb3NlOiAxLCBwaW5nOiAyLCBwb25nOiAzLCBtZXNzYWdlOiA0LCB1cGdyYWRlOiA1LCBub29wOiA2IH07dmFyIHBhY2tldHNsaXN0ID0ga2V5cyhwYWNrZXRzKTt2YXIgZXJyID0geyB0eXBlOiBcImVycm9yXCIsIGRhdGE6IFwicGFyc2VyIGVycm9yXCIgfTt2YXIgQmxvYiA9IF9kZXJlcV8oXCJibG9iXCIpO2V4cG9ydHMuZW5jb2RlUGFja2V0ID0gZnVuY3Rpb24gKHBhY2tldCwgc3VwcG9ydHNCaW5hcnksIHV0ZjhlbmNvZGUsIGNhbGxiYWNrKSB7XG4gICAgICAgICAgaWYgKFwiZnVuY3Rpb25cIiA9PSB0eXBlb2Ygc3VwcG9ydHNCaW5hcnkpIHtcbiAgICAgICAgICAgIGNhbGxiYWNrID0gc3VwcG9ydHNCaW5hcnk7c3VwcG9ydHNCaW5hcnkgPSBmYWxzZTtcbiAgICAgICAgICB9aWYgKFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgdXRmOGVuY29kZSkge1xuICAgICAgICAgICAgY2FsbGJhY2sgPSB1dGY4ZW5jb2RlO3V0ZjhlbmNvZGUgPSBudWxsO1xuICAgICAgICAgIH12YXIgZGF0YSA9IHBhY2tldC5kYXRhID09PSB1bmRlZmluZWQgPyB1bmRlZmluZWQgOiBwYWNrZXQuZGF0YS5idWZmZXIgfHwgcGFja2V0LmRhdGE7aWYgKGdsb2JhbC5BcnJheUJ1ZmZlciAmJiBkYXRhIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHtcbiAgICAgICAgICAgIHJldHVybiBlbmNvZGVBcnJheUJ1ZmZlcihwYWNrZXQsIHN1cHBvcnRzQmluYXJ5LCBjYWxsYmFjayk7XG4gICAgICAgICAgfSBlbHNlIGlmIChCbG9iICYmIGRhdGEgaW5zdGFuY2VvZiBnbG9iYWwuQmxvYikge1xuICAgICAgICAgICAgcmV0dXJuIGVuY29kZUJsb2IocGFja2V0LCBzdXBwb3J0c0JpbmFyeSwgY2FsbGJhY2spO1xuICAgICAgICAgIH1pZiAoZGF0YSAmJiBkYXRhLmJhc2U2NCkge1xuICAgICAgICAgICAgcmV0dXJuIGVuY29kZUJhc2U2NE9iamVjdChwYWNrZXQsIGNhbGxiYWNrKTtcbiAgICAgICAgICB9dmFyIGVuY29kZWQgPSBwYWNrZXRzW3BhY2tldC50eXBlXTtpZiAodW5kZWZpbmVkICE9PSBwYWNrZXQuZGF0YSkge1xuICAgICAgICAgICAgZW5jb2RlZCArPSB1dGY4ZW5jb2RlID8gdXRmOC5lbmNvZGUoU3RyaW5nKHBhY2tldC5kYXRhKSkgOiBTdHJpbmcocGFja2V0LmRhdGEpO1xuICAgICAgICAgIH1yZXR1cm4gY2FsbGJhY2soXCJcIiArIGVuY29kZWQpO1xuICAgICAgICB9O2Z1bmN0aW9uIGVuY29kZUJhc2U2NE9iamVjdChwYWNrZXQsIGNhbGxiYWNrKSB7XG4gICAgICAgICAgdmFyIG1lc3NhZ2UgPSBcImJcIiArIGV4cG9ydHMucGFja2V0c1twYWNrZXQudHlwZV0gKyBwYWNrZXQuZGF0YS5kYXRhO3JldHVybiBjYWxsYmFjayhtZXNzYWdlKTtcbiAgICAgICAgfWZ1bmN0aW9uIGVuY29kZUFycmF5QnVmZmVyKHBhY2tldCwgc3VwcG9ydHNCaW5hcnksIGNhbGxiYWNrKSB7XG4gICAgICAgICAgaWYgKCFzdXBwb3J0c0JpbmFyeSkge1xuICAgICAgICAgICAgcmV0dXJuIGV4cG9ydHMuZW5jb2RlQmFzZTY0UGFja2V0KHBhY2tldCwgY2FsbGJhY2spO1xuICAgICAgICAgIH12YXIgZGF0YSA9IHBhY2tldC5kYXRhO3ZhciBjb250ZW50QXJyYXkgPSBuZXcgVWludDhBcnJheShkYXRhKTt2YXIgcmVzdWx0QnVmZmVyID0gbmV3IFVpbnQ4QXJyYXkoMSArIGRhdGEuYnl0ZUxlbmd0aCk7cmVzdWx0QnVmZmVyWzBdID0gcGFja2V0c1twYWNrZXQudHlwZV07Zm9yICh2YXIgaSA9IDA7IGkgPCBjb250ZW50QXJyYXkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHJlc3VsdEJ1ZmZlcltpICsgMV0gPSBjb250ZW50QXJyYXlbaV07XG4gICAgICAgICAgfXJldHVybiBjYWxsYmFjayhyZXN1bHRCdWZmZXIuYnVmZmVyKTtcbiAgICAgICAgfWZ1bmN0aW9uIGVuY29kZUJsb2JBc0FycmF5QnVmZmVyKHBhY2tldCwgc3VwcG9ydHNCaW5hcnksIGNhbGxiYWNrKSB7XG4gICAgICAgICAgaWYgKCFzdXBwb3J0c0JpbmFyeSkge1xuICAgICAgICAgICAgcmV0dXJuIGV4cG9ydHMuZW5jb2RlQmFzZTY0UGFja2V0KHBhY2tldCwgY2FsbGJhY2spO1xuICAgICAgICAgIH12YXIgZnIgPSBuZXcgRmlsZVJlYWRlcigpO2ZyLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHBhY2tldC5kYXRhID0gZnIucmVzdWx0O2V4cG9ydHMuZW5jb2RlUGFja2V0KHBhY2tldCwgc3VwcG9ydHNCaW5hcnksIHRydWUsIGNhbGxiYWNrKTtcbiAgICAgICAgICB9O3JldHVybiBmci5yZWFkQXNBcnJheUJ1ZmZlcihwYWNrZXQuZGF0YSk7XG4gICAgICAgIH1mdW5jdGlvbiBlbmNvZGVCbG9iKHBhY2tldCwgc3VwcG9ydHNCaW5hcnksIGNhbGxiYWNrKSB7XG4gICAgICAgICAgaWYgKCFzdXBwb3J0c0JpbmFyeSkge1xuICAgICAgICAgICAgcmV0dXJuIGV4cG9ydHMuZW5jb2RlQmFzZTY0UGFja2V0KHBhY2tldCwgY2FsbGJhY2spO1xuICAgICAgICAgIH1pZiAoZG9udFNlbmRCbG9icykge1xuICAgICAgICAgICAgcmV0dXJuIGVuY29kZUJsb2JBc0FycmF5QnVmZmVyKHBhY2tldCwgc3VwcG9ydHNCaW5hcnksIGNhbGxiYWNrKTtcbiAgICAgICAgICB9dmFyIGxlbmd0aCA9IG5ldyBVaW50OEFycmF5KDEpO2xlbmd0aFswXSA9IHBhY2tldHNbcGFja2V0LnR5cGVdO3ZhciBibG9iID0gbmV3IEJsb2IoW2xlbmd0aC5idWZmZXIsIHBhY2tldC5kYXRhXSk7cmV0dXJuIGNhbGxiYWNrKGJsb2IpO1xuICAgICAgICB9ZXhwb3J0cy5lbmNvZGVCYXNlNjRQYWNrZXQgPSBmdW5jdGlvbiAocGFja2V0LCBjYWxsYmFjaykge1xuICAgICAgICAgIHZhciBtZXNzYWdlID0gXCJiXCIgKyBleHBvcnRzLnBhY2tldHNbcGFja2V0LnR5cGVdO2lmIChCbG9iICYmIHBhY2tldC5kYXRhIGluc3RhbmNlb2YgZ2xvYmFsLkJsb2IpIHtcbiAgICAgICAgICAgIHZhciBmciA9IG5ldyBGaWxlUmVhZGVyKCk7ZnIub25sb2FkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICB2YXIgYjY0ID0gZnIucmVzdWx0LnNwbGl0KFwiLFwiKVsxXTtjYWxsYmFjayhtZXNzYWdlICsgYjY0KTtcbiAgICAgICAgICAgIH07cmV0dXJuIGZyLnJlYWRBc0RhdGFVUkwocGFja2V0LmRhdGEpO1xuICAgICAgICAgIH12YXIgYjY0ZGF0YTt0cnkge1xuICAgICAgICAgICAgYjY0ZGF0YSA9IFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCwgbmV3IFVpbnQ4QXJyYXkocGFja2V0LmRhdGEpKTtcbiAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICB2YXIgdHlwZWQgPSBuZXcgVWludDhBcnJheShwYWNrZXQuZGF0YSk7dmFyIGJhc2ljID0gbmV3IEFycmF5KHR5cGVkLmxlbmd0aCk7Zm9yICh2YXIgaSA9IDA7IGkgPCB0eXBlZC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICBiYXNpY1tpXSA9IHR5cGVkW2ldO1xuICAgICAgICAgICAgfWI2NGRhdGEgPSBTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsIGJhc2ljKTtcbiAgICAgICAgICB9bWVzc2FnZSArPSBnbG9iYWwuYnRvYShiNjRkYXRhKTtyZXR1cm4gY2FsbGJhY2sobWVzc2FnZSk7XG4gICAgICAgIH07ZXhwb3J0cy5kZWNvZGVQYWNrZXQgPSBmdW5jdGlvbiAoZGF0YSwgYmluYXJ5VHlwZSwgdXRmOGRlY29kZSkge1xuICAgICAgICAgIGlmICh0eXBlb2YgZGF0YSA9PSBcInN0cmluZ1wiIHx8IGRhdGEgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgaWYgKGRhdGEuY2hhckF0KDApID09IFwiYlwiKSB7XG4gICAgICAgICAgICAgIHJldHVybiBleHBvcnRzLmRlY29kZUJhc2U2NFBhY2tldChkYXRhLnN1YnN0cigxKSwgYmluYXJ5VHlwZSk7XG4gICAgICAgICAgICB9aWYgKHV0ZjhkZWNvZGUpIHtcbiAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBkYXRhID0gdXRmOC5kZWNvZGUoZGF0YSk7XG4gICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZXJyO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9dmFyIHR5cGUgPSBkYXRhLmNoYXJBdCgwKTtpZiAoTnVtYmVyKHR5cGUpICE9IHR5cGUgfHwgIXBhY2tldHNsaXN0W3R5cGVdKSB7XG4gICAgICAgICAgICAgIHJldHVybiBlcnI7XG4gICAgICAgICAgICB9aWYgKGRhdGEubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgICByZXR1cm4geyB0eXBlOiBwYWNrZXRzbGlzdFt0eXBlXSwgZGF0YTogZGF0YS5zdWJzdHJpbmcoMSkgfTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHJldHVybiB7IHR5cGU6IHBhY2tldHNsaXN0W3R5cGVdIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfXZhciBhc0FycmF5ID0gbmV3IFVpbnQ4QXJyYXkoZGF0YSk7dmFyIHR5cGUgPSBhc0FycmF5WzBdO3ZhciByZXN0ID0gc2xpY2VCdWZmZXIoZGF0YSwgMSk7aWYgKEJsb2IgJiYgYmluYXJ5VHlwZSA9PT0gXCJibG9iXCIpIHtcbiAgICAgICAgICAgIHJlc3QgPSBuZXcgQmxvYihbcmVzdF0pO1xuICAgICAgICAgIH1yZXR1cm4geyB0eXBlOiBwYWNrZXRzbGlzdFt0eXBlXSwgZGF0YTogcmVzdCB9O1xuICAgICAgICB9O2V4cG9ydHMuZGVjb2RlQmFzZTY0UGFja2V0ID0gZnVuY3Rpb24gKG1zZywgYmluYXJ5VHlwZSkge1xuICAgICAgICAgIHZhciB0eXBlID0gcGFja2V0c2xpc3RbbXNnLmNoYXJBdCgwKV07aWYgKCFnbG9iYWwuQXJyYXlCdWZmZXIpIHtcbiAgICAgICAgICAgIHJldHVybiB7IHR5cGU6IHR5cGUsIGRhdGE6IHsgYmFzZTY0OiB0cnVlLCBkYXRhOiBtc2cuc3Vic3RyKDEpIH0gfTtcbiAgICAgICAgICB9dmFyIGRhdGEgPSBiYXNlNjRlbmNvZGVyLmRlY29kZShtc2cuc3Vic3RyKDEpKTtpZiAoYmluYXJ5VHlwZSA9PT0gXCJibG9iXCIgJiYgQmxvYikge1xuICAgICAgICAgICAgZGF0YSA9IG5ldyBCbG9iKFtkYXRhXSk7XG4gICAgICAgICAgfXJldHVybiB7IHR5cGU6IHR5cGUsIGRhdGE6IGRhdGEgfTtcbiAgICAgICAgfTtleHBvcnRzLmVuY29kZVBheWxvYWQgPSBmdW5jdGlvbiAocGFja2V0cywgc3VwcG9ydHNCaW5hcnksIGNhbGxiYWNrKSB7XG4gICAgICAgICAgaWYgKHR5cGVvZiBzdXBwb3J0c0JpbmFyeSA9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIGNhbGxiYWNrID0gc3VwcG9ydHNCaW5hcnk7c3VwcG9ydHNCaW5hcnkgPSBudWxsO1xuICAgICAgICAgIH12YXIgaXNCaW5hcnkgPSBoYXNCaW5hcnkocGFja2V0cyk7aWYgKHN1cHBvcnRzQmluYXJ5ICYmIGlzQmluYXJ5KSB7XG4gICAgICAgICAgICBpZiAoQmxvYiAmJiAhZG9udFNlbmRCbG9icykge1xuICAgICAgICAgICAgICByZXR1cm4gZXhwb3J0cy5lbmNvZGVQYXlsb2FkQXNCbG9iKHBhY2tldHMsIGNhbGxiYWNrKTtcbiAgICAgICAgICAgIH1yZXR1cm4gZXhwb3J0cy5lbmNvZGVQYXlsb2FkQXNBcnJheUJ1ZmZlcihwYWNrZXRzLCBjYWxsYmFjayk7XG4gICAgICAgICAgfWlmICghcGFja2V0cy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiBjYWxsYmFjayhcIjA6XCIpO1xuICAgICAgICAgIH1mdW5jdGlvbiBzZXRMZW5ndGhIZWFkZXIobWVzc2FnZSkge1xuICAgICAgICAgICAgcmV0dXJuIG1lc3NhZ2UubGVuZ3RoICsgXCI6XCIgKyBtZXNzYWdlO1xuICAgICAgICAgIH1mdW5jdGlvbiBlbmNvZGVPbmUocGFja2V0LCBkb25lQ2FsbGJhY2spIHtcbiAgICAgICAgICAgIGV4cG9ydHMuZW5jb2RlUGFja2V0KHBhY2tldCwgIWlzQmluYXJ5ID8gZmFsc2UgOiBzdXBwb3J0c0JpbmFyeSwgdHJ1ZSwgZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICAgICAgICAgICAgZG9uZUNhbGxiYWNrKG51bGwsIHNldExlbmd0aEhlYWRlcihtZXNzYWdlKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9bWFwKHBhY2tldHMsIGVuY29kZU9uZSwgZnVuY3Rpb24gKGVyciwgcmVzdWx0cykge1xuICAgICAgICAgICAgcmV0dXJuIGNhbGxiYWNrKHJlc3VsdHMuam9pbihcIlwiKSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH07ZnVuY3Rpb24gbWFwKGFyeSwgZWFjaCwgZG9uZSkge1xuICAgICAgICAgIHZhciByZXN1bHQgPSBuZXcgQXJyYXkoYXJ5Lmxlbmd0aCk7dmFyIG5leHQgPSBhZnRlcihhcnkubGVuZ3RoLCBkb25lKTt2YXIgZWFjaFdpdGhJbmRleCA9IGZ1bmN0aW9uIGVhY2hXaXRoSW5kZXgoaSwgZWwsIGNiKSB7XG4gICAgICAgICAgICBlYWNoKGVsLCBmdW5jdGlvbiAoZXJyb3IsIG1zZykge1xuICAgICAgICAgICAgICByZXN1bHRbaV0gPSBtc2c7Y2IoZXJyb3IsIHJlc3VsdCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9O2ZvciAodmFyIGkgPSAwOyBpIDwgYXJ5Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBlYWNoV2l0aEluZGV4KGksIGFyeVtpXSwgbmV4dCk7XG4gICAgICAgICAgfVxuICAgICAgICB9ZXhwb3J0cy5kZWNvZGVQYXlsb2FkID0gZnVuY3Rpb24gKGRhdGEsIGJpbmFyeVR5cGUsIGNhbGxiYWNrKSB7XG4gICAgICAgICAgaWYgKHR5cGVvZiBkYXRhICE9IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBleHBvcnRzLmRlY29kZVBheWxvYWRBc0JpbmFyeShkYXRhLCBiaW5hcnlUeXBlLCBjYWxsYmFjayk7XG4gICAgICAgICAgfWlmICh0eXBlb2YgYmluYXJ5VHlwZSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICBjYWxsYmFjayA9IGJpbmFyeVR5cGU7YmluYXJ5VHlwZSA9IG51bGw7XG4gICAgICAgICAgfXZhciBwYWNrZXQ7aWYgKGRhdGEgPT0gXCJcIikge1xuICAgICAgICAgICAgcmV0dXJuIGNhbGxiYWNrKGVyciwgMCwgMSk7XG4gICAgICAgICAgfXZhciBsZW5ndGggPSBcIlwiLFxuICAgICAgICAgICAgICBuLFxuICAgICAgICAgICAgICBtc2c7Zm9yICh2YXIgaSA9IDAsIGwgPSBkYXRhLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICAgICAgdmFyIGNociA9IGRhdGEuY2hhckF0KGkpO2lmIChcIjpcIiAhPSBjaHIpIHtcbiAgICAgICAgICAgICAgbGVuZ3RoICs9IGNocjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGlmIChcIlwiID09IGxlbmd0aCB8fCBsZW5ndGggIT0gKG4gPSBOdW1iZXIobGVuZ3RoKSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY2FsbGJhY2soZXJyLCAwLCAxKTtcbiAgICAgICAgICAgICAgfW1zZyA9IGRhdGEuc3Vic3RyKGkgKyAxLCBuKTtpZiAobGVuZ3RoICE9IG1zZy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY2FsbGJhY2soZXJyLCAwLCAxKTtcbiAgICAgICAgICAgICAgfWlmIChtc2cubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcGFja2V0ID0gZXhwb3J0cy5kZWNvZGVQYWNrZXQobXNnLCBiaW5hcnlUeXBlLCB0cnVlKTtpZiAoZXJyLnR5cGUgPT0gcGFja2V0LnR5cGUgJiYgZXJyLmRhdGEgPT0gcGFja2V0LmRhdGEpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBjYWxsYmFjayhlcnIsIDAsIDEpO1xuICAgICAgICAgICAgICAgIH12YXIgcmV0ID0gY2FsbGJhY2socGFja2V0LCBpICsgbiwgbCk7aWYgKGZhbHNlID09PSByZXQpIHJldHVybjtcbiAgICAgICAgICAgICAgfWkgKz0gbjtsZW5ndGggPSBcIlwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1pZiAobGVuZ3RoICE9IFwiXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBjYWxsYmFjayhlcnIsIDAsIDEpO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtleHBvcnRzLmVuY29kZVBheWxvYWRBc0FycmF5QnVmZmVyID0gZnVuY3Rpb24gKHBhY2tldHMsIGNhbGxiYWNrKSB7XG4gICAgICAgICAgaWYgKCFwYWNrZXRzLmxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuIGNhbGxiYWNrKG5ldyBBcnJheUJ1ZmZlcigwKSk7XG4gICAgICAgICAgfWZ1bmN0aW9uIGVuY29kZU9uZShwYWNrZXQsIGRvbmVDYWxsYmFjaykge1xuICAgICAgICAgICAgZXhwb3J0cy5lbmNvZGVQYWNrZXQocGFja2V0LCB0cnVlLCB0cnVlLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICByZXR1cm4gZG9uZUNhbGxiYWNrKG51bGwsIGRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfW1hcChwYWNrZXRzLCBlbmNvZGVPbmUsIGZ1bmN0aW9uIChlcnIsIGVuY29kZWRQYWNrZXRzKSB7XG4gICAgICAgICAgICB2YXIgdG90YWxMZW5ndGggPSBlbmNvZGVkUGFja2V0cy5yZWR1Y2UoZnVuY3Rpb24gKGFjYywgcCkge1xuICAgICAgICAgICAgICB2YXIgbGVuO2lmICh0eXBlb2YgcCA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICAgIGxlbiA9IHAubGVuZ3RoO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGxlbiA9IHAuYnl0ZUxlbmd0aDtcbiAgICAgICAgICAgICAgfXJldHVybiBhY2MgKyBsZW4udG9TdHJpbmcoKS5sZW5ndGggKyBsZW4gKyAyO1xuICAgICAgICAgICAgfSwgMCk7dmFyIHJlc3VsdEFycmF5ID0gbmV3IFVpbnQ4QXJyYXkodG90YWxMZW5ndGgpO3ZhciBidWZmZXJJbmRleCA9IDA7ZW5jb2RlZFBhY2tldHMuZm9yRWFjaChmdW5jdGlvbiAocCkge1xuICAgICAgICAgICAgICB2YXIgaXNTdHJpbmcgPSB0eXBlb2YgcCA9PT0gXCJzdHJpbmdcIjt2YXIgYWIgPSBwO2lmIChpc1N0cmluZykge1xuICAgICAgICAgICAgICAgIHZhciB2aWV3ID0gbmV3IFVpbnQ4QXJyYXkocC5sZW5ndGgpO2ZvciAodmFyIGkgPSAwOyBpIDwgcC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgdmlld1tpXSA9IHAuY2hhckNvZGVBdChpKTtcbiAgICAgICAgICAgICAgICB9YWIgPSB2aWV3LmJ1ZmZlcjtcbiAgICAgICAgICAgICAgfWlmIChpc1N0cmluZykge1xuICAgICAgICAgICAgICAgIHJlc3VsdEFycmF5W2J1ZmZlckluZGV4KytdID0gMDtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXN1bHRBcnJheVtidWZmZXJJbmRleCsrXSA9IDE7XG4gICAgICAgICAgICAgIH12YXIgbGVuU3RyID0gYWIuYnl0ZUxlbmd0aC50b1N0cmluZygpO2ZvciAodmFyIGkgPSAwOyBpIDwgbGVuU3RyLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0QXJyYXlbYnVmZmVySW5kZXgrK10gPSBwYXJzZUludChsZW5TdHJbaV0pO1xuICAgICAgICAgICAgICB9cmVzdWx0QXJyYXlbYnVmZmVySW5kZXgrK10gPSAyNTU7dmFyIHZpZXcgPSBuZXcgVWludDhBcnJheShhYik7Zm9yICh2YXIgaSA9IDA7IGkgPCB2aWV3Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0QXJyYXlbYnVmZmVySW5kZXgrK10gPSB2aWV3W2ldO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtyZXR1cm4gY2FsbGJhY2socmVzdWx0QXJyYXkuYnVmZmVyKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfTtleHBvcnRzLmVuY29kZVBheWxvYWRBc0Jsb2IgPSBmdW5jdGlvbiAocGFja2V0cywgY2FsbGJhY2spIHtcbiAgICAgICAgICBmdW5jdGlvbiBlbmNvZGVPbmUocGFja2V0LCBkb25lQ2FsbGJhY2spIHtcbiAgICAgICAgICAgIGV4cG9ydHMuZW5jb2RlUGFja2V0KHBhY2tldCwgdHJ1ZSwgdHJ1ZSwgZnVuY3Rpb24gKGVuY29kZWQpIHtcbiAgICAgICAgICAgICAgdmFyIGJpbmFyeUlkZW50aWZpZXIgPSBuZXcgVWludDhBcnJheSgxKTtiaW5hcnlJZGVudGlmaWVyWzBdID0gMTtpZiAodHlwZW9mIGVuY29kZWQgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgICB2YXIgdmlldyA9IG5ldyBVaW50OEFycmF5KGVuY29kZWQubGVuZ3RoKTtmb3IgKHZhciBpID0gMDsgaSA8IGVuY29kZWQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgIHZpZXdbaV0gPSBlbmNvZGVkLmNoYXJDb2RlQXQoaSk7XG4gICAgICAgICAgICAgICAgfWVuY29kZWQgPSB2aWV3LmJ1ZmZlcjtiaW5hcnlJZGVudGlmaWVyWzBdID0gMDtcbiAgICAgICAgICAgICAgfXZhciBsZW4gPSBlbmNvZGVkIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIgPyBlbmNvZGVkLmJ5dGVMZW5ndGggOiBlbmNvZGVkLnNpemU7dmFyIGxlblN0ciA9IGxlbi50b1N0cmluZygpO3ZhciBsZW5ndGhBcnkgPSBuZXcgVWludDhBcnJheShsZW5TdHIubGVuZ3RoICsgMSk7Zm9yICh2YXIgaSA9IDA7IGkgPCBsZW5TdHIubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBsZW5ndGhBcnlbaV0gPSBwYXJzZUludChsZW5TdHJbaV0pO1xuICAgICAgICAgICAgICB9bGVuZ3RoQXJ5W2xlblN0ci5sZW5ndGhdID0gMjU1O2lmIChCbG9iKSB7XG4gICAgICAgICAgICAgICAgdmFyIGJsb2IgPSBuZXcgQmxvYihbYmluYXJ5SWRlbnRpZmllci5idWZmZXIsIGxlbmd0aEFyeS5idWZmZXIsIGVuY29kZWRdKTtkb25lQ2FsbGJhY2sobnVsbCwgYmxvYik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1tYXAocGFja2V0cywgZW5jb2RlT25lLCBmdW5jdGlvbiAoZXJyLCByZXN1bHRzKSB7XG4gICAgICAgICAgICByZXR1cm4gY2FsbGJhY2sobmV3IEJsb2IocmVzdWx0cykpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9O2V4cG9ydHMuZGVjb2RlUGF5bG9hZEFzQmluYXJ5ID0gZnVuY3Rpb24gKGRhdGEsIGJpbmFyeVR5cGUsIGNhbGxiYWNrKSB7XG4gICAgICAgICAgaWYgKHR5cGVvZiBiaW5hcnlUeXBlID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIGNhbGxiYWNrID0gYmluYXJ5VHlwZTtiaW5hcnlUeXBlID0gbnVsbDtcbiAgICAgICAgICB9dmFyIGJ1ZmZlclRhaWwgPSBkYXRhO3ZhciBidWZmZXJzID0gW107dmFyIG51bWJlclRvb0xvbmcgPSBmYWxzZTt3aGlsZSAoYnVmZmVyVGFpbC5ieXRlTGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdmFyIHRhaWxBcnJheSA9IG5ldyBVaW50OEFycmF5KGJ1ZmZlclRhaWwpO3ZhciBpc1N0cmluZyA9IHRhaWxBcnJheVswXSA9PT0gMDt2YXIgbXNnTGVuZ3RoID0gXCJcIjtmb3IgKHZhciBpID0gMTs7IGkrKykge1xuICAgICAgICAgICAgICBpZiAodGFpbEFycmF5W2ldID09IDI1NSkgYnJlYWs7aWYgKG1zZ0xlbmd0aC5sZW5ndGggPiAzMTApIHtcbiAgICAgICAgICAgICAgICBudW1iZXJUb29Mb25nID0gdHJ1ZTticmVhaztcbiAgICAgICAgICAgICAgfW1zZ0xlbmd0aCArPSB0YWlsQXJyYXlbaV07XG4gICAgICAgICAgICB9aWYgKG51bWJlclRvb0xvbmcpIHJldHVybiBjYWxsYmFjayhlcnIsIDAsIDEpO2J1ZmZlclRhaWwgPSBzbGljZUJ1ZmZlcihidWZmZXJUYWlsLCAyICsgbXNnTGVuZ3RoLmxlbmd0aCk7bXNnTGVuZ3RoID0gcGFyc2VJbnQobXNnTGVuZ3RoKTt2YXIgbXNnID0gc2xpY2VCdWZmZXIoYnVmZmVyVGFpbCwgMCwgbXNnTGVuZ3RoKTtpZiAoaXNTdHJpbmcpIHtcbiAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBtc2cgPSBTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsIG5ldyBVaW50OEFycmF5KG1zZykpO1xuICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHR5cGVkID0gbmV3IFVpbnQ4QXJyYXkobXNnKTttc2cgPSBcIlwiO2ZvciAodmFyIGkgPSAwOyBpIDwgdHlwZWQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgIG1zZyArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKHR5cGVkW2ldKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1idWZmZXJzLnB1c2gobXNnKTtidWZmZXJUYWlsID0gc2xpY2VCdWZmZXIoYnVmZmVyVGFpbCwgbXNnTGVuZ3RoKTtcbiAgICAgICAgICB9dmFyIHRvdGFsID0gYnVmZmVycy5sZW5ndGg7YnVmZmVycy5mb3JFYWNoKGZ1bmN0aW9uIChidWZmZXIsIGkpIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKGV4cG9ydHMuZGVjb2RlUGFja2V0KGJ1ZmZlciwgYmluYXJ5VHlwZSwgdHJ1ZSksIGksIHRvdGFsKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgIH0pLmNhbGwodGhpcywgdHlwZW9mIHNlbGYgIT09IFwidW5kZWZpbmVkXCIgPyBzZWxmIDogdHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiA/IHdpbmRvdyA6IHR5cGVvZiBnbG9iYWwgIT09IFwidW5kZWZpbmVkXCIgPyBnbG9iYWwgOiB7fSk7XG4gICAgfSwgeyBcIi4va2V5c1wiOiAyMCwgYWZ0ZXI6IDExLCBcImFycmF5YnVmZmVyLnNsaWNlXCI6IDEyLCBcImJhc2U2NC1hcnJheWJ1ZmZlclwiOiAxMywgYmxvYjogMTQsIFwiaGFzLWJpbmFyeVwiOiAyMSwgdXRmODogMjkgfV0sIDIwOiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuICAgICAgbW9kdWxlLmV4cG9ydHMgPSBPYmplY3Qua2V5cyB8fCBmdW5jdGlvbiBrZXlzKG9iaikge1xuICAgICAgICB2YXIgYXJyID0gW107dmFyIGhhcyA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7Zm9yICh2YXIgaSBpbiBvYmopIHtcbiAgICAgICAgICBpZiAoaGFzLmNhbGwob2JqLCBpKSkge1xuICAgICAgICAgICAgYXJyLnB1c2goaSk7XG4gICAgICAgICAgfVxuICAgICAgICB9cmV0dXJuIGFycjtcbiAgICAgIH07XG4gICAgfSwge31dLCAyMTogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcbiAgICAgIChmdW5jdGlvbiAoZ2xvYmFsKSB7XG4gICAgICAgIHZhciBpc0FycmF5ID0gX2RlcmVxXyhcImlzYXJyYXlcIik7bW9kdWxlLmV4cG9ydHMgPSBoYXNCaW5hcnk7ZnVuY3Rpb24gaGFzQmluYXJ5KGRhdGEpIHtcbiAgICAgICAgICBmdW5jdGlvbiBfaGFzQmluYXJ5KG9iaikge1xuICAgICAgICAgICAgaWYgKCFvYmopIHJldHVybiBmYWxzZTtpZiAoZ2xvYmFsLkJ1ZmZlciAmJiBnbG9iYWwuQnVmZmVyLmlzQnVmZmVyKG9iaikgfHwgZ2xvYmFsLkFycmF5QnVmZmVyICYmIG9iaiBpbnN0YW5jZW9mIEFycmF5QnVmZmVyIHx8IGdsb2JhbC5CbG9iICYmIG9iaiBpbnN0YW5jZW9mIEJsb2IgfHwgZ2xvYmFsLkZpbGUgJiYgb2JqIGluc3RhbmNlb2YgRmlsZSkge1xuICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1pZiAoaXNBcnJheShvYmopKSB7XG4gICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb2JqLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKF9oYXNCaW5hcnkob2JqW2ldKSkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKG9iaiAmJiBcIm9iamVjdFwiID09IHR5cGVvZiBvYmopIHtcbiAgICAgICAgICAgICAgaWYgKG9iai50b0pTT04pIHtcbiAgICAgICAgICAgICAgICBvYmogPSBvYmoudG9KU09OKCk7XG4gICAgICAgICAgICAgIH1mb3IgKHZhciBrZXkgaW4gb2JqKSB7XG4gICAgICAgICAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkgJiYgX2hhc0JpbmFyeShvYmpba2V5XSkpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfXJldHVybiBmYWxzZTtcbiAgICAgICAgICB9cmV0dXJuIF9oYXNCaW5hcnkoZGF0YSk7XG4gICAgICAgIH1cbiAgICAgIH0pLmNhbGwodGhpcywgdHlwZW9mIHNlbGYgIT09IFwidW5kZWZpbmVkXCIgPyBzZWxmIDogdHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiA/IHdpbmRvdyA6IHR5cGVvZiBnbG9iYWwgIT09IFwidW5kZWZpbmVkXCIgPyBnbG9iYWwgOiB7fSk7XG4gICAgfSwgeyBpc2FycmF5OiAyNCB9XSwgMjI6IFtmdW5jdGlvbiAoX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG4gICAgICB0cnkge1xuICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IHR5cGVvZiBYTUxIdHRwUmVxdWVzdCAhPT0gXCJ1bmRlZmluZWRcIiAmJiBcIndpdGhDcmVkZW50aWFsc1wiIGluIG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIG1vZHVsZS5leHBvcnRzID0gZmFsc2U7XG4gICAgICB9XG4gICAgfSwge31dLCAyMzogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcbiAgICAgIHZhciBpbmRleE9mID0gW10uaW5kZXhPZjttb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChhcnIsIG9iaikge1xuICAgICAgICBpZiAoaW5kZXhPZikgcmV0dXJuIGFyci5pbmRleE9mKG9iaik7Zm9yICh2YXIgaSA9IDA7IGkgPCBhcnIubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICBpZiAoYXJyW2ldID09PSBvYmopIHJldHVybiBpO1xuICAgICAgICB9cmV0dXJuIC0xO1xuICAgICAgfTtcbiAgICB9LCB7fV0sIDI0OiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuICAgICAgbW9kdWxlLmV4cG9ydHMgPSBBcnJheS5pc0FycmF5IHx8IGZ1bmN0aW9uIChhcnIpIHtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChhcnIpID09IFwiW29iamVjdCBBcnJheV1cIjtcbiAgICAgIH07XG4gICAgfSwge31dLCAyNTogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcbiAgICAgIHZhciBzID0gMWUzO3ZhciBtID0gcyAqIDYwO3ZhciBoID0gbSAqIDYwO3ZhciBkID0gaCAqIDI0O3ZhciB5ID0gZCAqIDM2NS4yNTttb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uICh2YWwsIG9wdGlvbnMpIHtcbiAgICAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307aWYgKFwic3RyaW5nXCIgPT0gdHlwZW9mIHZhbCkgcmV0dXJuIHBhcnNlKHZhbCk7cmV0dXJuIG9wdGlvbnMubG9uZyA/IGxvbmcodmFsKSA6IHNob3J0KHZhbCk7XG4gICAgICB9O2Z1bmN0aW9uIHBhcnNlKHN0cikge1xuICAgICAgICBzdHIgPSBcIlwiICsgc3RyO2lmIChzdHIubGVuZ3RoID4gMWU0KSByZXR1cm47dmFyIG1hdGNoID0gL14oKD86XFxkKyk/XFwuP1xcZCspICoobWlsbGlzZWNvbmRzP3xtc2Vjcz98bXN8c2Vjb25kcz98c2Vjcz98c3xtaW51dGVzP3xtaW5zP3xtfGhvdXJzP3xocnM/fGh8ZGF5cz98ZHx5ZWFycz98eXJzP3x5KT8kL2kuZXhlYyhzdHIpO2lmICghbWF0Y2gpIHJldHVybjt2YXIgbiA9IHBhcnNlRmxvYXQobWF0Y2hbMV0pO3ZhciB0eXBlID0gKG1hdGNoWzJdIHx8IFwibXNcIikudG9Mb3dlckNhc2UoKTtzd2l0Y2ggKHR5cGUpIHtjYXNlIFwieWVhcnNcIjpjYXNlIFwieWVhclwiOmNhc2UgXCJ5cnNcIjpjYXNlIFwieXJcIjpjYXNlIFwieVwiOlxuICAgICAgICAgICAgcmV0dXJuIG4gKiB5O2Nhc2UgXCJkYXlzXCI6Y2FzZSBcImRheVwiOmNhc2UgXCJkXCI6XG4gICAgICAgICAgICByZXR1cm4gbiAqIGQ7Y2FzZSBcImhvdXJzXCI6Y2FzZSBcImhvdXJcIjpjYXNlIFwiaHJzXCI6Y2FzZSBcImhyXCI6Y2FzZSBcImhcIjpcbiAgICAgICAgICAgIHJldHVybiBuICogaDtjYXNlIFwibWludXRlc1wiOmNhc2UgXCJtaW51dGVcIjpjYXNlIFwibWluc1wiOmNhc2UgXCJtaW5cIjpjYXNlIFwibVwiOlxuICAgICAgICAgICAgcmV0dXJuIG4gKiBtO2Nhc2UgXCJzZWNvbmRzXCI6Y2FzZSBcInNlY29uZFwiOmNhc2UgXCJzZWNzXCI6Y2FzZSBcInNlY1wiOmNhc2UgXCJzXCI6XG4gICAgICAgICAgICByZXR1cm4gbiAqIHM7Y2FzZSBcIm1pbGxpc2Vjb25kc1wiOmNhc2UgXCJtaWxsaXNlY29uZFwiOmNhc2UgXCJtc2Vjc1wiOmNhc2UgXCJtc2VjXCI6Y2FzZSBcIm1zXCI6XG4gICAgICAgICAgICByZXR1cm4gbjt9XG4gICAgICB9ZnVuY3Rpb24gc2hvcnQobXMpIHtcbiAgICAgICAgaWYgKG1zID49IGQpIHJldHVybiBNYXRoLnJvdW5kKG1zIC8gZCkgKyBcImRcIjtpZiAobXMgPj0gaCkgcmV0dXJuIE1hdGgucm91bmQobXMgLyBoKSArIFwiaFwiO2lmIChtcyA+PSBtKSByZXR1cm4gTWF0aC5yb3VuZChtcyAvIG0pICsgXCJtXCI7aWYgKG1zID49IHMpIHJldHVybiBNYXRoLnJvdW5kKG1zIC8gcykgKyBcInNcIjtyZXR1cm4gbXMgKyBcIm1zXCI7XG4gICAgICB9ZnVuY3Rpb24gbG9uZyhtcykge1xuICAgICAgICByZXR1cm4gcGx1cmFsKG1zLCBkLCBcImRheVwiKSB8fCBwbHVyYWwobXMsIGgsIFwiaG91clwiKSB8fCBwbHVyYWwobXMsIG0sIFwibWludXRlXCIpIHx8IHBsdXJhbChtcywgcywgXCJzZWNvbmRcIikgfHwgbXMgKyBcIiBtc1wiO1xuICAgICAgfWZ1bmN0aW9uIHBsdXJhbChtcywgbiwgbmFtZSkge1xuICAgICAgICBpZiAobXMgPCBuKSByZXR1cm47aWYgKG1zIDwgbiAqIDEuNSkgcmV0dXJuIE1hdGguZmxvb3IobXMgLyBuKSArIFwiIFwiICsgbmFtZTtyZXR1cm4gTWF0aC5jZWlsKG1zIC8gbikgKyBcIiBcIiArIG5hbWUgKyBcInNcIjtcbiAgICAgIH1cbiAgICB9LCB7fV0sIDI2OiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuICAgICAgKGZ1bmN0aW9uIChnbG9iYWwpIHtcbiAgICAgICAgdmFyIHJ2YWxpZGNoYXJzID0gL15bXFxdLDp7fVxcc10qJC87dmFyIHJ2YWxpZGVzY2FwZSA9IC9cXFxcKD86W1wiXFxcXFxcL2JmbnJ0XXx1WzAtOWEtZkEtRl17NH0pL2c7dmFyIHJ2YWxpZHRva2VucyA9IC9cIlteXCJcXFxcXFxuXFxyXSpcInx0cnVlfGZhbHNlfG51bGx8LT9cXGQrKD86XFwuXFxkKik/KD86W2VFXVsrXFwtXT9cXGQrKT8vZzt2YXIgcnZhbGlkYnJhY2VzID0gLyg/Ol58OnwsKSg/OlxccypcXFspKy9nO3ZhciBydHJpbUxlZnQgPSAvXlxccysvO3ZhciBydHJpbVJpZ2h0ID0gL1xccyskLzttb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIHBhcnNlanNvbihkYXRhKSB7XG4gICAgICAgICAgaWYgKFwic3RyaW5nXCIgIT0gdHlwZW9mIGRhdGEgfHwgIWRhdGEpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgIH1kYXRhID0gZGF0YS5yZXBsYWNlKHJ0cmltTGVmdCwgXCJcIikucmVwbGFjZShydHJpbVJpZ2h0LCBcIlwiKTtpZiAoZ2xvYmFsLkpTT04gJiYgSlNPTi5wYXJzZSkge1xuICAgICAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UoZGF0YSk7XG4gICAgICAgICAgfWlmIChydmFsaWRjaGFycy50ZXN0KGRhdGEucmVwbGFjZShydmFsaWRlc2NhcGUsIFwiQFwiKS5yZXBsYWNlKHJ2YWxpZHRva2VucywgXCJdXCIpLnJlcGxhY2UocnZhbGlkYnJhY2VzLCBcIlwiKSkpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgRnVuY3Rpb24oXCJyZXR1cm4gXCIgKyBkYXRhKSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgIH0pLmNhbGwodGhpcywgdHlwZW9mIHNlbGYgIT09IFwidW5kZWZpbmVkXCIgPyBzZWxmIDogdHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiA/IHdpbmRvdyA6IHR5cGVvZiBnbG9iYWwgIT09IFwidW5kZWZpbmVkXCIgPyBnbG9iYWwgOiB7fSk7XG4gICAgfSwge31dLCAyNzogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcbiAgICAgIGV4cG9ydHMuZW5jb2RlID0gZnVuY3Rpb24gKG9iaikge1xuICAgICAgICB2YXIgc3RyID0gXCJcIjtmb3IgKHZhciBpIGluIG9iaikge1xuICAgICAgICAgIGlmIChvYmouaGFzT3duUHJvcGVydHkoaSkpIHtcbiAgICAgICAgICAgIGlmIChzdHIubGVuZ3RoKSBzdHIgKz0gXCImXCI7c3RyICs9IGVuY29kZVVSSUNvbXBvbmVudChpKSArIFwiPVwiICsgZW5jb2RlVVJJQ29tcG9uZW50KG9ialtpXSk7XG4gICAgICAgICAgfVxuICAgICAgICB9cmV0dXJuIHN0cjtcbiAgICAgIH07ZXhwb3J0cy5kZWNvZGUgPSBmdW5jdGlvbiAocXMpIHtcbiAgICAgICAgdmFyIHFyeSA9IHt9O3ZhciBwYWlycyA9IHFzLnNwbGl0KFwiJlwiKTtmb3IgKHZhciBpID0gMCwgbCA9IHBhaXJzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICAgIHZhciBwYWlyID0gcGFpcnNbaV0uc3BsaXQoXCI9XCIpO3FyeVtkZWNvZGVVUklDb21wb25lbnQocGFpclswXSldID0gZGVjb2RlVVJJQ29tcG9uZW50KHBhaXJbMV0pO1xuICAgICAgICB9cmV0dXJuIHFyeTtcbiAgICAgIH07XG4gICAgfSwge31dLCAyODogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcbiAgICAgIHZhciByZSA9IC9eKD86KD8hW146QF0rOlteOkBcXC9dKkApKGh0dHB8aHR0cHN8d3N8d3NzKTpcXC9cXC8pPygoPzooKFteOkBdKikoPzo6KFteOkBdKikpPyk/QCk/KCg/OlthLWYwLTldezAsNH06KXsyLDd9W2EtZjAtOV17MCw0fXxbXjpcXC8/I10qKSg/OjooXFxkKikpPykoKChcXC8oPzpbXj8jXSg/IVtePyNcXC9dKlxcLltePyNcXC8uXSsoPzpbPyNdfCQpKSkqXFwvPyk/KFtePyNcXC9dKikpKD86XFw/KFteI10qKSk/KD86IyguKikpPykvO3ZhciBwYXJ0cyA9IFtcInNvdXJjZVwiLCBcInByb3RvY29sXCIsIFwiYXV0aG9yaXR5XCIsIFwidXNlckluZm9cIiwgXCJ1c2VyXCIsIFwicGFzc3dvcmRcIiwgXCJob3N0XCIsIFwicG9ydFwiLCBcInJlbGF0aXZlXCIsIFwicGF0aFwiLCBcImRpcmVjdG9yeVwiLCBcImZpbGVcIiwgXCJxdWVyeVwiLCBcImFuY2hvclwiXTttb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIHBhcnNldXJpKHN0cikge1xuICAgICAgICB2YXIgc3JjID0gc3RyLFxuICAgICAgICAgICAgYiA9IHN0ci5pbmRleE9mKFwiW1wiKSxcbiAgICAgICAgICAgIGUgPSBzdHIuaW5kZXhPZihcIl1cIik7aWYgKGIgIT0gLTEgJiYgZSAhPSAtMSkge1xuICAgICAgICAgIHN0ciA9IHN0ci5zdWJzdHJpbmcoMCwgYikgKyBzdHIuc3Vic3RyaW5nKGIsIGUpLnJlcGxhY2UoLzovZywgXCI7XCIpICsgc3RyLnN1YnN0cmluZyhlLCBzdHIubGVuZ3RoKTtcbiAgICAgICAgfXZhciBtID0gcmUuZXhlYyhzdHIgfHwgXCJcIiksXG4gICAgICAgICAgICB1cmkgPSB7fSxcbiAgICAgICAgICAgIGkgPSAxNDt3aGlsZSAoaS0tKSB7XG4gICAgICAgICAgdXJpW3BhcnRzW2ldXSA9IG1baV0gfHwgXCJcIjtcbiAgICAgICAgfWlmIChiICE9IC0xICYmIGUgIT0gLTEpIHtcbiAgICAgICAgICB1cmkuc291cmNlID0gc3JjO3VyaS5ob3N0ID0gdXJpLmhvc3Quc3Vic3RyaW5nKDEsIHVyaS5ob3N0Lmxlbmd0aCAtIDEpLnJlcGxhY2UoLzsvZywgXCI6XCIpO3VyaS5hdXRob3JpdHkgPSB1cmkuYXV0aG9yaXR5LnJlcGxhY2UoXCJbXCIsIFwiXCIpLnJlcGxhY2UoXCJdXCIsIFwiXCIpLnJlcGxhY2UoLzsvZywgXCI6XCIpO3VyaS5pcHY2dXJpID0gdHJ1ZTtcbiAgICAgICAgfXJldHVybiB1cmk7XG4gICAgICB9O1xuICAgIH0sIHt9XSwgMjk6IFtmdW5jdGlvbiAoX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG4gICAgICAoZnVuY3Rpb24gKGdsb2JhbCkge1xuICAgICAgICAoZnVuY3Rpb24gKHJvb3QpIHtcbiAgICAgICAgICB2YXIgZnJlZUV4cG9ydHMgPSB0eXBlb2YgZXhwb3J0cyA9PSBcIm9iamVjdFwiICYmIGV4cG9ydHM7dmFyIGZyZWVNb2R1bGUgPSB0eXBlb2YgbW9kdWxlID09IFwib2JqZWN0XCIgJiYgbW9kdWxlICYmIG1vZHVsZS5leHBvcnRzID09IGZyZWVFeHBvcnRzICYmIG1vZHVsZTt2YXIgZnJlZUdsb2JhbCA9IHR5cGVvZiBnbG9iYWwgPT0gXCJvYmplY3RcIiAmJiBnbG9iYWw7aWYgKGZyZWVHbG9iYWwuZ2xvYmFsID09PSBmcmVlR2xvYmFsIHx8IGZyZWVHbG9iYWwud2luZG93ID09PSBmcmVlR2xvYmFsKSB7XG4gICAgICAgICAgICByb290ID0gZnJlZUdsb2JhbDtcbiAgICAgICAgICB9dmFyIHN0cmluZ0Zyb21DaGFyQ29kZSA9IFN0cmluZy5mcm9tQ2hhckNvZGU7ZnVuY3Rpb24gdWNzMmRlY29kZShzdHJpbmcpIHtcbiAgICAgICAgICAgIHZhciBvdXRwdXQgPSBbXTt2YXIgY291bnRlciA9IDA7dmFyIGxlbmd0aCA9IHN0cmluZy5sZW5ndGg7dmFyIHZhbHVlO3ZhciBleHRyYTt3aGlsZSAoY291bnRlciA8IGxlbmd0aCkge1xuICAgICAgICAgICAgICB2YWx1ZSA9IHN0cmluZy5jaGFyQ29kZUF0KGNvdW50ZXIrKyk7aWYgKHZhbHVlID49IDU1Mjk2ICYmIHZhbHVlIDw9IDU2MzE5ICYmIGNvdW50ZXIgPCBsZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBleHRyYSA9IHN0cmluZy5jaGFyQ29kZUF0KGNvdW50ZXIrKyk7aWYgKChleHRyYSAmIDY0NTEyKSA9PSA1NjMyMCkge1xuICAgICAgICAgICAgICAgICAgb3V0cHV0LnB1c2goKCh2YWx1ZSAmIDEwMjMpIDw8IDEwKSArIChleHRyYSAmIDEwMjMpICsgNjU1MzYpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICBvdXRwdXQucHVzaCh2YWx1ZSk7Y291bnRlci0tO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBvdXRwdXQucHVzaCh2YWx1ZSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1yZXR1cm4gb3V0cHV0O1xuICAgICAgICAgIH1mdW5jdGlvbiB1Y3MyZW5jb2RlKGFycmF5KSB7XG4gICAgICAgICAgICB2YXIgbGVuZ3RoID0gYXJyYXkubGVuZ3RoO3ZhciBpbmRleCA9IC0xO3ZhciB2YWx1ZTt2YXIgb3V0cHV0ID0gXCJcIjt3aGlsZSAoKytpbmRleCA8IGxlbmd0aCkge1xuICAgICAgICAgICAgICB2YWx1ZSA9IGFycmF5W2luZGV4XTtpZiAodmFsdWUgPiA2NTUzNSkge1xuICAgICAgICAgICAgICAgIHZhbHVlIC09IDY1NTM2O291dHB1dCArPSBzdHJpbmdGcm9tQ2hhckNvZGUodmFsdWUgPj4+IDEwICYgMTAyMyB8IDU1Mjk2KTt2YWx1ZSA9IDU2MzIwIHwgdmFsdWUgJiAxMDIzO1xuICAgICAgICAgICAgICB9b3V0cHV0ICs9IHN0cmluZ0Zyb21DaGFyQ29kZSh2YWx1ZSk7XG4gICAgICAgICAgICB9cmV0dXJuIG91dHB1dDtcbiAgICAgICAgICB9ZnVuY3Rpb24gY2hlY2tTY2FsYXJWYWx1ZShjb2RlUG9pbnQpIHtcbiAgICAgICAgICAgIGlmIChjb2RlUG9pbnQgPj0gNTUyOTYgJiYgY29kZVBvaW50IDw9IDU3MzQzKSB7XG4gICAgICAgICAgICAgIHRocm93IEVycm9yKFwiTG9uZSBzdXJyb2dhdGUgVStcIiArIGNvZGVQb2ludC50b1N0cmluZygxNikudG9VcHBlckNhc2UoKSArIFwiIGlzIG5vdCBhIHNjYWxhciB2YWx1ZVwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9ZnVuY3Rpb24gY3JlYXRlQnl0ZShjb2RlUG9pbnQsIHNoaWZ0KSB7XG4gICAgICAgICAgICByZXR1cm4gc3RyaW5nRnJvbUNoYXJDb2RlKGNvZGVQb2ludCA+PiBzaGlmdCAmIDYzIHwgMTI4KTtcbiAgICAgICAgICB9ZnVuY3Rpb24gZW5jb2RlQ29kZVBvaW50KGNvZGVQb2ludCkge1xuICAgICAgICAgICAgaWYgKChjb2RlUG9pbnQgJiA0Mjk0OTY3MTY4KSA9PSAwKSB7XG4gICAgICAgICAgICAgIHJldHVybiBzdHJpbmdGcm9tQ2hhckNvZGUoY29kZVBvaW50KTtcbiAgICAgICAgICAgIH12YXIgc3ltYm9sID0gXCJcIjtpZiAoKGNvZGVQb2ludCAmIDQyOTQ5NjUyNDgpID09IDApIHtcbiAgICAgICAgICAgICAgc3ltYm9sID0gc3RyaW5nRnJvbUNoYXJDb2RlKGNvZGVQb2ludCA+PiA2ICYgMzEgfCAxOTIpO1xuICAgICAgICAgICAgfSBlbHNlIGlmICgoY29kZVBvaW50ICYgNDI5NDkwMTc2MCkgPT0gMCkge1xuICAgICAgICAgICAgICBjaGVja1NjYWxhclZhbHVlKGNvZGVQb2ludCk7c3ltYm9sID0gc3RyaW5nRnJvbUNoYXJDb2RlKGNvZGVQb2ludCA+PiAxMiAmIDE1IHwgMjI0KTtzeW1ib2wgKz0gY3JlYXRlQnl0ZShjb2RlUG9pbnQsIDYpO1xuICAgICAgICAgICAgfSBlbHNlIGlmICgoY29kZVBvaW50ICYgNDI5Mjg3MDE0NCkgPT0gMCkge1xuICAgICAgICAgICAgICBzeW1ib2wgPSBzdHJpbmdGcm9tQ2hhckNvZGUoY29kZVBvaW50ID4+IDE4ICYgNyB8IDI0MCk7c3ltYm9sICs9IGNyZWF0ZUJ5dGUoY29kZVBvaW50LCAxMik7c3ltYm9sICs9IGNyZWF0ZUJ5dGUoY29kZVBvaW50LCA2KTtcbiAgICAgICAgICAgIH1zeW1ib2wgKz0gc3RyaW5nRnJvbUNoYXJDb2RlKGNvZGVQb2ludCAmIDYzIHwgMTI4KTtyZXR1cm4gc3ltYm9sO1xuICAgICAgICAgIH1mdW5jdGlvbiB1dGY4ZW5jb2RlKHN0cmluZykge1xuICAgICAgICAgICAgdmFyIGNvZGVQb2ludHMgPSB1Y3MyZGVjb2RlKHN0cmluZyk7dmFyIGxlbmd0aCA9IGNvZGVQb2ludHMubGVuZ3RoO3ZhciBpbmRleCA9IC0xO3ZhciBjb2RlUG9pbnQ7dmFyIGJ5dGVTdHJpbmcgPSBcIlwiO3doaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgICAgICAgICAgIGNvZGVQb2ludCA9IGNvZGVQb2ludHNbaW5kZXhdO2J5dGVTdHJpbmcgKz0gZW5jb2RlQ29kZVBvaW50KGNvZGVQb2ludCk7XG4gICAgICAgICAgICB9cmV0dXJuIGJ5dGVTdHJpbmc7XG4gICAgICAgICAgfWZ1bmN0aW9uIHJlYWRDb250aW51YXRpb25CeXRlKCkge1xuICAgICAgICAgICAgaWYgKGJ5dGVJbmRleCA+PSBieXRlQ291bnQpIHtcbiAgICAgICAgICAgICAgdGhyb3cgRXJyb3IoXCJJbnZhbGlkIGJ5dGUgaW5kZXhcIik7XG4gICAgICAgICAgICB9dmFyIGNvbnRpbnVhdGlvbkJ5dGUgPSBieXRlQXJyYXlbYnl0ZUluZGV4XSAmIDI1NTtieXRlSW5kZXgrKztpZiAoKGNvbnRpbnVhdGlvbkJ5dGUgJiAxOTIpID09IDEyOCkge1xuICAgICAgICAgICAgICByZXR1cm4gY29udGludWF0aW9uQnl0ZSAmIDYzO1xuICAgICAgICAgICAgfXRocm93IEVycm9yKFwiSW52YWxpZCBjb250aW51YXRpb24gYnl0ZVwiKTtcbiAgICAgICAgICB9ZnVuY3Rpb24gZGVjb2RlU3ltYm9sKCkge1xuICAgICAgICAgICAgdmFyIGJ5dGUxO3ZhciBieXRlMjt2YXIgYnl0ZTM7dmFyIGJ5dGU0O3ZhciBjb2RlUG9pbnQ7aWYgKGJ5dGVJbmRleCA+IGJ5dGVDb3VudCkge1xuICAgICAgICAgICAgICB0aHJvdyBFcnJvcihcIkludmFsaWQgYnl0ZSBpbmRleFwiKTtcbiAgICAgICAgICAgIH1pZiAoYnl0ZUluZGV4ID09IGJ5dGVDb3VudCkge1xuICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9Ynl0ZTEgPSBieXRlQXJyYXlbYnl0ZUluZGV4XSAmIDI1NTtieXRlSW5kZXgrKztpZiAoKGJ5dGUxICYgMTI4KSA9PSAwKSB7XG4gICAgICAgICAgICAgIHJldHVybiBieXRlMTtcbiAgICAgICAgICAgIH1pZiAoKGJ5dGUxICYgMjI0KSA9PSAxOTIpIHtcbiAgICAgICAgICAgICAgdmFyIGJ5dGUyID0gcmVhZENvbnRpbnVhdGlvbkJ5dGUoKTtjb2RlUG9pbnQgPSAoYnl0ZTEgJiAzMSkgPDwgNiB8IGJ5dGUyO2lmIChjb2RlUG9pbnQgPj0gMTI4KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvZGVQb2ludDtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBFcnJvcihcIkludmFsaWQgY29udGludWF0aW9uIGJ5dGVcIik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1pZiAoKGJ5dGUxICYgMjQwKSA9PSAyMjQpIHtcbiAgICAgICAgICAgICAgYnl0ZTIgPSByZWFkQ29udGludWF0aW9uQnl0ZSgpO2J5dGUzID0gcmVhZENvbnRpbnVhdGlvbkJ5dGUoKTtjb2RlUG9pbnQgPSAoYnl0ZTEgJiAxNSkgPDwgMTIgfCBieXRlMiA8PCA2IHwgYnl0ZTM7aWYgKGNvZGVQb2ludCA+PSAyMDQ4KSB7XG4gICAgICAgICAgICAgICAgY2hlY2tTY2FsYXJWYWx1ZShjb2RlUG9pbnQpO3JldHVybiBjb2RlUG9pbnQ7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgRXJyb3IoXCJJbnZhbGlkIGNvbnRpbnVhdGlvbiBieXRlXCIpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9aWYgKChieXRlMSAmIDI0OCkgPT0gMjQwKSB7XG4gICAgICAgICAgICAgIGJ5dGUyID0gcmVhZENvbnRpbnVhdGlvbkJ5dGUoKTtieXRlMyA9IHJlYWRDb250aW51YXRpb25CeXRlKCk7Ynl0ZTQgPSByZWFkQ29udGludWF0aW9uQnl0ZSgpO2NvZGVQb2ludCA9IChieXRlMSAmIDE1KSA8PCAxOCB8IGJ5dGUyIDw8IDEyIHwgYnl0ZTMgPDwgNiB8IGJ5dGU0O2lmIChjb2RlUG9pbnQgPj0gNjU1MzYgJiYgY29kZVBvaW50IDw9IDExMTQxMTEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY29kZVBvaW50O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIFVURi04IGRldGVjdGVkXCIpO1xuICAgICAgICAgIH12YXIgYnl0ZUFycmF5O3ZhciBieXRlQ291bnQ7dmFyIGJ5dGVJbmRleDtmdW5jdGlvbiB1dGY4ZGVjb2RlKGJ5dGVTdHJpbmcpIHtcbiAgICAgICAgICAgIGJ5dGVBcnJheSA9IHVjczJkZWNvZGUoYnl0ZVN0cmluZyk7Ynl0ZUNvdW50ID0gYnl0ZUFycmF5Lmxlbmd0aDtieXRlSW5kZXggPSAwO3ZhciBjb2RlUG9pbnRzID0gW107dmFyIHRtcDt3aGlsZSAoKHRtcCA9IGRlY29kZVN5bWJvbCgpKSAhPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgY29kZVBvaW50cy5wdXNoKHRtcCk7XG4gICAgICAgICAgICB9cmV0dXJuIHVjczJlbmNvZGUoY29kZVBvaW50cyk7XG4gICAgICAgICAgfXZhciB1dGY4ID0geyB2ZXJzaW9uOiBcIjIuMC4wXCIsIGVuY29kZTogdXRmOGVuY29kZSwgZGVjb2RlOiB1dGY4ZGVjb2RlIH07aWYgKHR5cGVvZiBkZWZpbmUgPT0gXCJmdW5jdGlvblwiICYmIHR5cGVvZiBkZWZpbmUuYW1kID09IFwib2JqZWN0XCIgJiYgZGVmaW5lLmFtZCkge1xuICAgICAgICAgICAgZGVmaW5lKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHV0Zjg7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IGVsc2UgaWYgKGZyZWVFeHBvcnRzICYmICFmcmVlRXhwb3J0cy5ub2RlVHlwZSkge1xuICAgICAgICAgICAgaWYgKGZyZWVNb2R1bGUpIHtcbiAgICAgICAgICAgICAgZnJlZU1vZHVsZS5leHBvcnRzID0gdXRmODtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHZhciBvYmplY3QgPSB7fTt2YXIgaGFzT3duUHJvcGVydHkgPSBvYmplY3QuaGFzT3duUHJvcGVydHk7Zm9yICh2YXIga2V5IGluIHV0ZjgpIHtcbiAgICAgICAgICAgICAgICBoYXNPd25Qcm9wZXJ0eS5jYWxsKHV0ZjgsIGtleSkgJiYgKGZyZWVFeHBvcnRzW2tleV0gPSB1dGY4W2tleV0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJvb3QudXRmOCA9IHV0Zjg7XG4gICAgICAgICAgfVxuICAgICAgICB9KSh0aGlzKTtcbiAgICAgIH0pLmNhbGwodGhpcywgdHlwZW9mIHNlbGYgIT09IFwidW5kZWZpbmVkXCIgPyBzZWxmIDogdHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiA/IHdpbmRvdyA6IHR5cGVvZiBnbG9iYWwgIT09IFwidW5kZWZpbmVkXCIgPyBnbG9iYWwgOiB7fSk7XG4gICAgfSwge31dLCAzMDogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcbiAgICAgIFwidXNlIHN0cmljdFwiO3ZhciBhbHBoYWJldCA9IFwiMDEyMzQ1Njc4OUFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXotX1wiLnNwbGl0KFwiXCIpLFxuICAgICAgICAgIGxlbmd0aCA9IDY0LFxuICAgICAgICAgIG1hcCA9IHt9LFxuICAgICAgICAgIHNlZWQgPSAwLFxuICAgICAgICAgIGkgPSAwLFxuICAgICAgICAgIHByZXY7ZnVuY3Rpb24gZW5jb2RlKG51bSkge1xuICAgICAgICB2YXIgZW5jb2RlZCA9IFwiXCI7ZG8ge1xuICAgICAgICAgIGVuY29kZWQgPSBhbHBoYWJldFtudW0gJSBsZW5ndGhdICsgZW5jb2RlZDtudW0gPSBNYXRoLmZsb29yKG51bSAvIGxlbmd0aCk7XG4gICAgICAgIH0gd2hpbGUgKG51bSA+IDApO3JldHVybiBlbmNvZGVkO1xuICAgICAgfWZ1bmN0aW9uIGRlY29kZShzdHIpIHtcbiAgICAgICAgdmFyIGRlY29kZWQgPSAwO2ZvciAoaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBkZWNvZGVkID0gZGVjb2RlZCAqIGxlbmd0aCArIG1hcFtzdHIuY2hhckF0KGkpXTtcbiAgICAgICAgfXJldHVybiBkZWNvZGVkO1xuICAgICAgfWZ1bmN0aW9uIHllYXN0KCkge1xuICAgICAgICB2YXIgbm93ID0gZW5jb2RlKCtuZXcgRGF0ZSgpKTtpZiAobm93ICE9PSBwcmV2KSByZXR1cm4gc2VlZCA9IDAsIHByZXYgPSBub3c7cmV0dXJuIG5vdyArIFwiLlwiICsgZW5jb2RlKHNlZWQrKyk7XG4gICAgICB9Zm9yICg7IGkgPCBsZW5ndGg7IGkrKykgbWFwW2FscGhhYmV0W2ldXSA9IGk7eWVhc3QuZW5jb2RlID0gZW5jb2RlO3llYXN0LmRlY29kZSA9IGRlY29kZTttb2R1bGUuZXhwb3J0cyA9IHllYXN0O1xuICAgIH0sIHt9XSwgMzE6IFtmdW5jdGlvbiAoX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG4gICAgICB2YXIgdXJsID0gX2RlcmVxXyhcIi4vdXJsXCIpO3ZhciBwYXJzZXIgPSBfZGVyZXFfKFwic29ja2V0LmlvLXBhcnNlclwiKTt2YXIgTWFuYWdlciA9IF9kZXJlcV8oXCIuL21hbmFnZXJcIik7dmFyIGRlYnVnID0gX2RlcmVxXyhcImRlYnVnXCIpKFwic29ja2V0LmlvLWNsaWVudFwiKTttb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHMgPSBsb29rdXA7dmFyIGNhY2hlID0gZXhwb3J0cy5tYW5hZ2VycyA9IHt9O2Z1bmN0aW9uIGxvb2t1cCh1cmksIG9wdHMpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB1cmkgPT0gXCJvYmplY3RcIikge1xuICAgICAgICAgIG9wdHMgPSB1cmk7dXJpID0gdW5kZWZpbmVkO1xuICAgICAgICB9b3B0cyA9IG9wdHMgfHwge307dmFyIHBhcnNlZCA9IHVybCh1cmkpO3ZhciBzb3VyY2UgPSBwYXJzZWQuc291cmNlO3ZhciBpZCA9IHBhcnNlZC5pZDt2YXIgcGF0aCA9IHBhcnNlZC5wYXRoO3ZhciBzYW1lTmFtZXNwYWNlID0gY2FjaGVbaWRdICYmIHBhdGggaW4gY2FjaGVbaWRdLm5zcHM7dmFyIG5ld0Nvbm5lY3Rpb24gPSBvcHRzLmZvcmNlTmV3IHx8IG9wdHNbXCJmb3JjZSBuZXcgY29ubmVjdGlvblwiXSB8fCBmYWxzZSA9PT0gb3B0cy5tdWx0aXBsZXggfHwgc2FtZU5hbWVzcGFjZTt2YXIgaW87aWYgKG5ld0Nvbm5lY3Rpb24pIHtcbiAgICAgICAgICBkZWJ1ZyhcImlnbm9yaW5nIHNvY2tldCBjYWNoZSBmb3IgJXNcIiwgc291cmNlKTtpbyA9IE1hbmFnZXIoc291cmNlLCBvcHRzKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAoIWNhY2hlW2lkXSkge1xuICAgICAgICAgICAgZGVidWcoXCJuZXcgaW8gaW5zdGFuY2UgZm9yICVzXCIsIHNvdXJjZSk7Y2FjaGVbaWRdID0gTWFuYWdlcihzb3VyY2UsIG9wdHMpO1xuICAgICAgICAgIH1pbyA9IGNhY2hlW2lkXTtcbiAgICAgICAgfXJldHVybiBpby5zb2NrZXQocGFyc2VkLnBhdGgpO1xuICAgICAgfWV4cG9ydHMucHJvdG9jb2wgPSBwYXJzZXIucHJvdG9jb2w7ZXhwb3J0cy5jb25uZWN0ID0gbG9va3VwO2V4cG9ydHMuTWFuYWdlciA9IF9kZXJlcV8oXCIuL21hbmFnZXJcIik7ZXhwb3J0cy5Tb2NrZXQgPSBfZGVyZXFfKFwiLi9zb2NrZXRcIik7XG4gICAgfSwgeyBcIi4vbWFuYWdlclwiOiAzMiwgXCIuL3NvY2tldFwiOiAzNCwgXCIuL3VybFwiOiAzNSwgZGVidWc6IDM5LCBcInNvY2tldC5pby1wYXJzZXJcIjogNDcgfV0sIDMyOiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuICAgICAgdmFyIGVpbyA9IF9kZXJlcV8oXCJlbmdpbmUuaW8tY2xpZW50XCIpO3ZhciBTb2NrZXQgPSBfZGVyZXFfKFwiLi9zb2NrZXRcIik7dmFyIEVtaXR0ZXIgPSBfZGVyZXFfKFwiY29tcG9uZW50LWVtaXR0ZXJcIik7dmFyIHBhcnNlciA9IF9kZXJlcV8oXCJzb2NrZXQuaW8tcGFyc2VyXCIpO3ZhciBvbiA9IF9kZXJlcV8oXCIuL29uXCIpO3ZhciBiaW5kID0gX2RlcmVxXyhcImNvbXBvbmVudC1iaW5kXCIpO3ZhciBkZWJ1ZyA9IF9kZXJlcV8oXCJkZWJ1Z1wiKShcInNvY2tldC5pby1jbGllbnQ6bWFuYWdlclwiKTt2YXIgaW5kZXhPZiA9IF9kZXJlcV8oXCJpbmRleG9mXCIpO3ZhciBCYWNrb2ZmID0gX2RlcmVxXyhcImJhY2tvMlwiKTt2YXIgaGFzID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eTttb2R1bGUuZXhwb3J0cyA9IE1hbmFnZXI7ZnVuY3Rpb24gTWFuYWdlcih1cmksIG9wdHMpIHtcbiAgICAgICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIE1hbmFnZXIpKSByZXR1cm4gbmV3IE1hbmFnZXIodXJpLCBvcHRzKTtpZiAodXJpICYmIFwib2JqZWN0XCIgPT0gdHlwZW9mIHVyaSkge1xuICAgICAgICAgIG9wdHMgPSB1cmk7dXJpID0gdW5kZWZpbmVkO1xuICAgICAgICB9b3B0cyA9IG9wdHMgfHwge307b3B0cy5wYXRoID0gb3B0cy5wYXRoIHx8IFwiL3NvY2tldC5pb1wiO3RoaXMubnNwcyA9IHt9O3RoaXMuc3VicyA9IFtdO3RoaXMub3B0cyA9IG9wdHM7dGhpcy5yZWNvbm5lY3Rpb24ob3B0cy5yZWNvbm5lY3Rpb24gIT09IGZhbHNlKTt0aGlzLnJlY29ubmVjdGlvbkF0dGVtcHRzKG9wdHMucmVjb25uZWN0aW9uQXR0ZW1wdHMgfHwgSW5maW5pdHkpO3RoaXMucmVjb25uZWN0aW9uRGVsYXkob3B0cy5yZWNvbm5lY3Rpb25EZWxheSB8fCAxZTMpO3RoaXMucmVjb25uZWN0aW9uRGVsYXlNYXgob3B0cy5yZWNvbm5lY3Rpb25EZWxheU1heCB8fCA1ZTMpO3RoaXMucmFuZG9taXphdGlvbkZhY3RvcihvcHRzLnJhbmRvbWl6YXRpb25GYWN0b3IgfHwgLjUpO3RoaXMuYmFja29mZiA9IG5ldyBCYWNrb2ZmKHsgbWluOiB0aGlzLnJlY29ubmVjdGlvbkRlbGF5KCksIG1heDogdGhpcy5yZWNvbm5lY3Rpb25EZWxheU1heCgpLCBqaXR0ZXI6IHRoaXMucmFuZG9taXphdGlvbkZhY3RvcigpIH0pO3RoaXMudGltZW91dChudWxsID09IG9wdHMudGltZW91dCA/IDJlNCA6IG9wdHMudGltZW91dCk7dGhpcy5yZWFkeVN0YXRlID0gXCJjbG9zZWRcIjt0aGlzLnVyaSA9IHVyaTt0aGlzLmNvbm5lY3RpbmcgPSBbXTt0aGlzLmxhc3RQaW5nID0gbnVsbDt0aGlzLmVuY29kaW5nID0gZmFsc2U7dGhpcy5wYWNrZXRCdWZmZXIgPSBbXTt0aGlzLmVuY29kZXIgPSBuZXcgcGFyc2VyLkVuY29kZXIoKTt0aGlzLmRlY29kZXIgPSBuZXcgcGFyc2VyLkRlY29kZXIoKTt0aGlzLmF1dG9Db25uZWN0ID0gb3B0cy5hdXRvQ29ubmVjdCAhPT0gZmFsc2U7aWYgKHRoaXMuYXV0b0Nvbm5lY3QpIHRoaXMub3BlbigpO1xuICAgICAgfU1hbmFnZXIucHJvdG90eXBlLmVtaXRBbGwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuZW1pdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO2ZvciAodmFyIG5zcCBpbiB0aGlzLm5zcHMpIHtcbiAgICAgICAgICBpZiAoaGFzLmNhbGwodGhpcy5uc3BzLCBuc3ApKSB7XG4gICAgICAgICAgICB0aGlzLm5zcHNbbnNwXS5lbWl0LmFwcGx5KHRoaXMubnNwc1tuc3BdLCBhcmd1bWVudHMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfTtNYW5hZ2VyLnByb3RvdHlwZS51cGRhdGVTb2NrZXRJZHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZvciAodmFyIG5zcCBpbiB0aGlzLm5zcHMpIHtcbiAgICAgICAgICBpZiAoaGFzLmNhbGwodGhpcy5uc3BzLCBuc3ApKSB7XG4gICAgICAgICAgICB0aGlzLm5zcHNbbnNwXS5pZCA9IHRoaXMuZW5naW5lLmlkO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfTtFbWl0dGVyKE1hbmFnZXIucHJvdG90eXBlKTtNYW5hZ2VyLnByb3RvdHlwZS5yZWNvbm5lY3Rpb24gPSBmdW5jdGlvbiAodikge1xuICAgICAgICBpZiAoIWFyZ3VtZW50cy5sZW5ndGgpIHJldHVybiB0aGlzLl9yZWNvbm5lY3Rpb247dGhpcy5fcmVjb25uZWN0aW9uID0gISF2O3JldHVybiB0aGlzO1xuICAgICAgfTtNYW5hZ2VyLnByb3RvdHlwZS5yZWNvbm5lY3Rpb25BdHRlbXB0cyA9IGZ1bmN0aW9uICh2KSB7XG4gICAgICAgIGlmICghYXJndW1lbnRzLmxlbmd0aCkgcmV0dXJuIHRoaXMuX3JlY29ubmVjdGlvbkF0dGVtcHRzO3RoaXMuX3JlY29ubmVjdGlvbkF0dGVtcHRzID0gdjtyZXR1cm4gdGhpcztcbiAgICAgIH07TWFuYWdlci5wcm90b3R5cGUucmVjb25uZWN0aW9uRGVsYXkgPSBmdW5jdGlvbiAodikge1xuICAgICAgICBpZiAoIWFyZ3VtZW50cy5sZW5ndGgpIHJldHVybiB0aGlzLl9yZWNvbm5lY3Rpb25EZWxheTt0aGlzLl9yZWNvbm5lY3Rpb25EZWxheSA9IHY7dGhpcy5iYWNrb2ZmICYmIHRoaXMuYmFja29mZi5zZXRNaW4odik7cmV0dXJuIHRoaXM7XG4gICAgICB9O01hbmFnZXIucHJvdG90eXBlLnJhbmRvbWl6YXRpb25GYWN0b3IgPSBmdW5jdGlvbiAodikge1xuICAgICAgICBpZiAoIWFyZ3VtZW50cy5sZW5ndGgpIHJldHVybiB0aGlzLl9yYW5kb21pemF0aW9uRmFjdG9yO3RoaXMuX3JhbmRvbWl6YXRpb25GYWN0b3IgPSB2O3RoaXMuYmFja29mZiAmJiB0aGlzLmJhY2tvZmYuc2V0Sml0dGVyKHYpO3JldHVybiB0aGlzO1xuICAgICAgfTtNYW5hZ2VyLnByb3RvdHlwZS5yZWNvbm5lY3Rpb25EZWxheU1heCA9IGZ1bmN0aW9uICh2KSB7XG4gICAgICAgIGlmICghYXJndW1lbnRzLmxlbmd0aCkgcmV0dXJuIHRoaXMuX3JlY29ubmVjdGlvbkRlbGF5TWF4O3RoaXMuX3JlY29ubmVjdGlvbkRlbGF5TWF4ID0gdjt0aGlzLmJhY2tvZmYgJiYgdGhpcy5iYWNrb2ZmLnNldE1heCh2KTtyZXR1cm4gdGhpcztcbiAgICAgIH07TWFuYWdlci5wcm90b3R5cGUudGltZW91dCA9IGZ1bmN0aW9uICh2KSB7XG4gICAgICAgIGlmICghYXJndW1lbnRzLmxlbmd0aCkgcmV0dXJuIHRoaXMuX3RpbWVvdXQ7dGhpcy5fdGltZW91dCA9IHY7cmV0dXJuIHRoaXM7XG4gICAgICB9O01hbmFnZXIucHJvdG90eXBlLm1heWJlUmVjb25uZWN0T25PcGVuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMucmVjb25uZWN0aW5nICYmIHRoaXMuX3JlY29ubmVjdGlvbiAmJiB0aGlzLmJhY2tvZmYuYXR0ZW1wdHMgPT09IDApIHtcbiAgICAgICAgICB0aGlzLnJlY29ubmVjdCgpO1xuICAgICAgICB9XG4gICAgICB9O01hbmFnZXIucHJvdG90eXBlLm9wZW4gPSBNYW5hZ2VyLnByb3RvdHlwZS5jb25uZWN0ID0gZnVuY3Rpb24gKGZuKSB7XG4gICAgICAgIGRlYnVnKFwicmVhZHlTdGF0ZSAlc1wiLCB0aGlzLnJlYWR5U3RhdGUpO2lmICh+dGhpcy5yZWFkeVN0YXRlLmluZGV4T2YoXCJvcGVuXCIpKSByZXR1cm4gdGhpcztkZWJ1ZyhcIm9wZW5pbmcgJXNcIiwgdGhpcy51cmkpO3RoaXMuZW5naW5lID0gZWlvKHRoaXMudXJpLCB0aGlzLm9wdHMpO3ZhciBzb2NrZXQgPSB0aGlzLmVuZ2luZTt2YXIgc2VsZiA9IHRoaXM7dGhpcy5yZWFkeVN0YXRlID0gXCJvcGVuaW5nXCI7dGhpcy5za2lwUmVjb25uZWN0ID0gZmFsc2U7dmFyIG9wZW5TdWIgPSBvbihzb2NrZXQsIFwib3BlblwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgc2VsZi5vbm9wZW4oKTtmbiAmJiBmbigpO1xuICAgICAgICB9KTt2YXIgZXJyb3JTdWIgPSBvbihzb2NrZXQsIFwiZXJyb3JcIiwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICBkZWJ1ZyhcImNvbm5lY3RfZXJyb3JcIik7c2VsZi5jbGVhbnVwKCk7c2VsZi5yZWFkeVN0YXRlID0gXCJjbG9zZWRcIjtzZWxmLmVtaXRBbGwoXCJjb25uZWN0X2Vycm9yXCIsIGRhdGEpO2lmIChmbikge1xuICAgICAgICAgICAgdmFyIGVyciA9IG5ldyBFcnJvcihcIkNvbm5lY3Rpb24gZXJyb3JcIik7ZXJyLmRhdGEgPSBkYXRhO2ZuKGVycik7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHNlbGYubWF5YmVSZWNvbm5lY3RPbk9wZW4oKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO2lmIChmYWxzZSAhPT0gdGhpcy5fdGltZW91dCkge1xuICAgICAgICAgIHZhciB0aW1lb3V0ID0gdGhpcy5fdGltZW91dDtkZWJ1ZyhcImNvbm5lY3QgYXR0ZW1wdCB3aWxsIHRpbWVvdXQgYWZ0ZXIgJWRcIiwgdGltZW91dCk7dmFyIHRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBkZWJ1ZyhcImNvbm5lY3QgYXR0ZW1wdCB0aW1lZCBvdXQgYWZ0ZXIgJWRcIiwgdGltZW91dCk7b3BlblN1Yi5kZXN0cm95KCk7c29ja2V0LmNsb3NlKCk7c29ja2V0LmVtaXQoXCJlcnJvclwiLCBcInRpbWVvdXRcIik7c2VsZi5lbWl0QWxsKFwiY29ubmVjdF90aW1lb3V0XCIsIHRpbWVvdXQpO1xuICAgICAgICAgIH0sIHRpbWVvdXQpO3RoaXMuc3Vicy5wdXNoKHsgZGVzdHJveTogZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVyKTtcbiAgICAgICAgICAgIH0gfSk7XG4gICAgICAgIH10aGlzLnN1YnMucHVzaChvcGVuU3ViKTt0aGlzLnN1YnMucHVzaChlcnJvclN1Yik7cmV0dXJuIHRoaXM7XG4gICAgICB9O01hbmFnZXIucHJvdG90eXBlLm9ub3BlbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZGVidWcoXCJvcGVuXCIpO3RoaXMuY2xlYW51cCgpO3RoaXMucmVhZHlTdGF0ZSA9IFwib3BlblwiO3RoaXMuZW1pdChcIm9wZW5cIik7dmFyIHNvY2tldCA9IHRoaXMuZW5naW5lO3RoaXMuc3Vicy5wdXNoKG9uKHNvY2tldCwgXCJkYXRhXCIsIGJpbmQodGhpcywgXCJvbmRhdGFcIikpKTt0aGlzLnN1YnMucHVzaChvbihzb2NrZXQsIFwicGluZ1wiLCBiaW5kKHRoaXMsIFwib25waW5nXCIpKSk7dGhpcy5zdWJzLnB1c2gob24oc29ja2V0LCBcInBvbmdcIiwgYmluZCh0aGlzLCBcIm9ucG9uZ1wiKSkpO3RoaXMuc3Vicy5wdXNoKG9uKHNvY2tldCwgXCJlcnJvclwiLCBiaW5kKHRoaXMsIFwib25lcnJvclwiKSkpO3RoaXMuc3Vicy5wdXNoKG9uKHNvY2tldCwgXCJjbG9zZVwiLCBiaW5kKHRoaXMsIFwib25jbG9zZVwiKSkpO3RoaXMuc3Vicy5wdXNoKG9uKHRoaXMuZGVjb2RlciwgXCJkZWNvZGVkXCIsIGJpbmQodGhpcywgXCJvbmRlY29kZWRcIikpKTtcbiAgICAgIH07TWFuYWdlci5wcm90b3R5cGUub25waW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmxhc3RQaW5nID0gbmV3IERhdGUoKTt0aGlzLmVtaXRBbGwoXCJwaW5nXCIpO1xuICAgICAgfTtNYW5hZ2VyLnByb3RvdHlwZS5vbnBvbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuZW1pdEFsbChcInBvbmdcIiwgbmV3IERhdGUoKSAtIHRoaXMubGFzdFBpbmcpO1xuICAgICAgfTtNYW5hZ2VyLnByb3RvdHlwZS5vbmRhdGEgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICB0aGlzLmRlY29kZXIuYWRkKGRhdGEpO1xuICAgICAgfTtNYW5hZ2VyLnByb3RvdHlwZS5vbmRlY29kZWQgPSBmdW5jdGlvbiAocGFja2V0KSB7XG4gICAgICAgIHRoaXMuZW1pdChcInBhY2tldFwiLCBwYWNrZXQpO1xuICAgICAgfTtNYW5hZ2VyLnByb3RvdHlwZS5vbmVycm9yID0gZnVuY3Rpb24gKGVycikge1xuICAgICAgICBkZWJ1ZyhcImVycm9yXCIsIGVycik7dGhpcy5lbWl0QWxsKFwiZXJyb3JcIiwgZXJyKTtcbiAgICAgIH07TWFuYWdlci5wcm90b3R5cGUuc29ja2V0ID0gZnVuY3Rpb24gKG5zcCkge1xuICAgICAgICB2YXIgc29ja2V0ID0gdGhpcy5uc3BzW25zcF07aWYgKCFzb2NrZXQpIHtcbiAgICAgICAgICBzb2NrZXQgPSBuZXcgU29ja2V0KHRoaXMsIG5zcCk7dGhpcy5uc3BzW25zcF0gPSBzb2NrZXQ7dmFyIHNlbGYgPSB0aGlzO3NvY2tldC5vbihcImNvbm5lY3RpbmdcIiwgb25Db25uZWN0aW5nKTtcbiAgICAgICAgICBzb2NrZXQub24oXCJjb25uZWN0XCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHNvY2tldC5pZCA9IHNlbGYuZW5naW5lLmlkO1xuICAgICAgICAgIH0pO2lmICh0aGlzLmF1dG9Db25uZWN0KSB7XG4gICAgICAgICAgICBvbkNvbm5lY3RpbmcoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1mdW5jdGlvbiBvbkNvbm5lY3RpbmcoKSB7XG4gICAgICAgICAgaWYgKCEgfmluZGV4T2Yoc2VsZi5jb25uZWN0aW5nLCBzb2NrZXQpKSB7XG4gICAgICAgICAgICBzZWxmLmNvbm5lY3RpbmcucHVzaChzb2NrZXQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfXJldHVybiBzb2NrZXQ7XG4gICAgICB9O01hbmFnZXIucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbiAoc29ja2V0KSB7XG4gICAgICAgIHZhciBpbmRleCA9IGluZGV4T2YodGhpcy5jb25uZWN0aW5nLCBzb2NrZXQpO2lmICh+aW5kZXgpIHRoaXMuY29ubmVjdGluZy5zcGxpY2UoaW5kZXgsIDEpO2lmICh0aGlzLmNvbm5lY3RpbmcubGVuZ3RoKSByZXR1cm47dGhpcy5jbG9zZSgpO1xuICAgICAgfTtNYW5hZ2VyLnByb3RvdHlwZS5wYWNrZXQgPSBmdW5jdGlvbiAocGFja2V0KSB7XG4gICAgICAgIGRlYnVnKFwid3JpdGluZyBwYWNrZXQgJWpcIiwgcGFja2V0KTt2YXIgc2VsZiA9IHRoaXM7aWYgKCFzZWxmLmVuY29kaW5nKSB7XG4gICAgICAgICAgc2VsZi5lbmNvZGluZyA9IHRydWU7dGhpcy5lbmNvZGVyLmVuY29kZShwYWNrZXQsIGZ1bmN0aW9uIChlbmNvZGVkUGFja2V0cykge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbmNvZGVkUGFja2V0cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICBzZWxmLmVuZ2luZS53cml0ZShlbmNvZGVkUGFja2V0c1tpXSwgcGFja2V0Lm9wdGlvbnMpO1xuICAgICAgICAgICAgfXNlbGYuZW5jb2RpbmcgPSBmYWxzZTtzZWxmLnByb2Nlc3NQYWNrZXRRdWV1ZSgpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHNlbGYucGFja2V0QnVmZmVyLnB1c2gocGFja2V0KTtcbiAgICAgICAgfVxuICAgICAgfTtNYW5hZ2VyLnByb3RvdHlwZS5wcm9jZXNzUGFja2V0UXVldWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnBhY2tldEJ1ZmZlci5sZW5ndGggPiAwICYmICF0aGlzLmVuY29kaW5nKSB7XG4gICAgICAgICAgdmFyIHBhY2sgPSB0aGlzLnBhY2tldEJ1ZmZlci5zaGlmdCgpO3RoaXMucGFja2V0KHBhY2spO1xuICAgICAgICB9XG4gICAgICB9O01hbmFnZXIucHJvdG90eXBlLmNsZWFudXAgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGRlYnVnKFwiY2xlYW51cFwiKTt2YXIgc3ViO3doaWxlIChzdWIgPSB0aGlzLnN1YnMuc2hpZnQoKSkgc3ViLmRlc3Ryb3koKTt0aGlzLnBhY2tldEJ1ZmZlciA9IFtdO3RoaXMuZW5jb2RpbmcgPSBmYWxzZTt0aGlzLmxhc3RQaW5nID0gbnVsbDt0aGlzLmRlY29kZXIuZGVzdHJveSgpO1xuICAgICAgfTtNYW5hZ2VyLnByb3RvdHlwZS5jbG9zZSA9IE1hbmFnZXIucHJvdG90eXBlLmRpc2Nvbm5lY3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGRlYnVnKFwiZGlzY29ubmVjdFwiKTt0aGlzLnNraXBSZWNvbm5lY3QgPSB0cnVlO3RoaXMucmVjb25uZWN0aW5nID0gZmFsc2U7aWYgKFwib3BlbmluZ1wiID09IHRoaXMucmVhZHlTdGF0ZSkge1xuICAgICAgICAgIHRoaXMuY2xlYW51cCgpO1xuICAgICAgICB9dGhpcy5iYWNrb2ZmLnJlc2V0KCk7dGhpcy5yZWFkeVN0YXRlID0gXCJjbG9zZWRcIjtpZiAodGhpcy5lbmdpbmUpIHRoaXMuZW5naW5lLmNsb3NlKCk7XG4gICAgICB9O01hbmFnZXIucHJvdG90eXBlLm9uY2xvc2UgPSBmdW5jdGlvbiAocmVhc29uKSB7XG4gICAgICAgIGRlYnVnKFwib25jbG9zZVwiKTt0aGlzLmNsZWFudXAoKTt0aGlzLmJhY2tvZmYucmVzZXQoKTt0aGlzLnJlYWR5U3RhdGUgPSBcImNsb3NlZFwiO3RoaXMuZW1pdChcImNsb3NlXCIsIHJlYXNvbik7aWYgKHRoaXMuX3JlY29ubmVjdGlvbiAmJiAhdGhpcy5za2lwUmVjb25uZWN0KSB7XG4gICAgICAgICAgdGhpcy5yZWNvbm5lY3QoKTtcbiAgICAgICAgfVxuICAgICAgfTtNYW5hZ2VyLnByb3RvdHlwZS5yZWNvbm5lY3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnJlY29ubmVjdGluZyB8fCB0aGlzLnNraXBSZWNvbm5lY3QpIHJldHVybiB0aGlzO3ZhciBzZWxmID0gdGhpcztpZiAodGhpcy5iYWNrb2ZmLmF0dGVtcHRzID49IHRoaXMuX3JlY29ubmVjdGlvbkF0dGVtcHRzKSB7XG4gICAgICAgICAgZGVidWcoXCJyZWNvbm5lY3QgZmFpbGVkXCIpO3RoaXMuYmFja29mZi5yZXNldCgpO3RoaXMuZW1pdEFsbChcInJlY29ubmVjdF9mYWlsZWRcIik7dGhpcy5yZWNvbm5lY3RpbmcgPSBmYWxzZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2YXIgZGVsYXkgPSB0aGlzLmJhY2tvZmYuZHVyYXRpb24oKTtkZWJ1ZyhcIndpbGwgd2FpdCAlZG1zIGJlZm9yZSByZWNvbm5lY3QgYXR0ZW1wdFwiLCBkZWxheSk7dGhpcy5yZWNvbm5lY3RpbmcgPSB0cnVlO3ZhciB0aW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHNlbGYuc2tpcFJlY29ubmVjdCkgcmV0dXJuO2RlYnVnKFwiYXR0ZW1wdGluZyByZWNvbm5lY3RcIik7c2VsZi5lbWl0QWxsKFwicmVjb25uZWN0X2F0dGVtcHRcIiwgc2VsZi5iYWNrb2ZmLmF0dGVtcHRzKTtzZWxmLmVtaXRBbGwoXCJyZWNvbm5lY3RpbmdcIiwgc2VsZi5iYWNrb2ZmLmF0dGVtcHRzKTtpZiAoc2VsZi5za2lwUmVjb25uZWN0KSByZXR1cm47c2VsZi5vcGVuKGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgICAgIGRlYnVnKFwicmVjb25uZWN0IGF0dGVtcHQgZXJyb3JcIik7c2VsZi5yZWNvbm5lY3RpbmcgPSBmYWxzZTtzZWxmLnJlY29ubmVjdCgpO3NlbGYuZW1pdEFsbChcInJlY29ubmVjdF9lcnJvclwiLCBlcnIuZGF0YSk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZGVidWcoXCJyZWNvbm5lY3Qgc3VjY2Vzc1wiKTtzZWxmLm9ucmVjb25uZWN0KCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0sIGRlbGF5KTt0aGlzLnN1YnMucHVzaCh7IGRlc3Ryb3k6IGZ1bmN0aW9uIGRlc3Ryb3koKSB7XG4gICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lcik7XG4gICAgICAgICAgICB9IH0pO1xuICAgICAgICB9XG4gICAgICB9O01hbmFnZXIucHJvdG90eXBlLm9ucmVjb25uZWN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYXR0ZW1wdCA9IHRoaXMuYmFja29mZi5hdHRlbXB0czt0aGlzLnJlY29ubmVjdGluZyA9IGZhbHNlO3RoaXMuYmFja29mZi5yZXNldCgpO3RoaXMudXBkYXRlU29ja2V0SWRzKCk7dGhpcy5lbWl0QWxsKFwicmVjb25uZWN0XCIsIGF0dGVtcHQpO1xuICAgICAgfTtcbiAgICB9LCB7IFwiLi9vblwiOiAzMywgXCIuL3NvY2tldFwiOiAzNCwgYmFja28yOiAzNiwgXCJjb21wb25lbnQtYmluZFwiOiAzNywgXCJjb21wb25lbnQtZW1pdHRlclwiOiAzOCwgZGVidWc6IDM5LCBcImVuZ2luZS5pby1jbGllbnRcIjogMSwgaW5kZXhvZjogNDIsIFwic29ja2V0LmlvLXBhcnNlclwiOiA0NyB9XSwgMzM6IFtmdW5jdGlvbiAoX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG4gICAgICBtb2R1bGUuZXhwb3J0cyA9IG9uO2Z1bmN0aW9uIG9uKG9iaiwgZXYsIGZuKSB7XG4gICAgICAgIG9iai5vbihldiwgZm4pO3JldHVybiB7IGRlc3Ryb3k6IGZ1bmN0aW9uIGRlc3Ryb3koKSB7XG4gICAgICAgICAgICBvYmoucmVtb3ZlTGlzdGVuZXIoZXYsIGZuKTtcbiAgICAgICAgICB9IH07XG4gICAgICB9XG4gICAgfSwge31dLCAzNDogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcbiAgICAgIHZhciBwYXJzZXIgPSBfZGVyZXFfKFwic29ja2V0LmlvLXBhcnNlclwiKTt2YXIgRW1pdHRlciA9IF9kZXJlcV8oXCJjb21wb25lbnQtZW1pdHRlclwiKTt2YXIgdG9BcnJheSA9IF9kZXJlcV8oXCJ0by1hcnJheVwiKTt2YXIgb24gPSBfZGVyZXFfKFwiLi9vblwiKTt2YXIgYmluZCA9IF9kZXJlcV8oXCJjb21wb25lbnQtYmluZFwiKTt2YXIgZGVidWcgPSBfZGVyZXFfKFwiZGVidWdcIikoXCJzb2NrZXQuaW8tY2xpZW50OnNvY2tldFwiKTt2YXIgaGFzQmluID0gX2RlcmVxXyhcImhhcy1iaW5hcnlcIik7bW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzID0gU29ja2V0O3ZhciBldmVudHMgPSB7IGNvbm5lY3Q6IDEsIGNvbm5lY3RfZXJyb3I6IDEsIGNvbm5lY3RfdGltZW91dDogMSwgY29ubmVjdGluZzogMSwgZGlzY29ubmVjdDogMSwgZXJyb3I6IDEsIHJlY29ubmVjdDogMSwgcmVjb25uZWN0X2F0dGVtcHQ6IDEsIHJlY29ubmVjdF9mYWlsZWQ6IDEsIHJlY29ubmVjdF9lcnJvcjogMSwgcmVjb25uZWN0aW5nOiAxLCBwaW5nOiAxLCBwb25nOiAxIH07dmFyIGVtaXQgPSBFbWl0dGVyLnByb3RvdHlwZS5lbWl0O2Z1bmN0aW9uIFNvY2tldChpbywgbnNwKSB7XG4gICAgICAgIHRoaXMuaW8gPSBpbzt0aGlzLm5zcCA9IG5zcDt0aGlzLmpzb24gPSB0aGlzO3RoaXMuaWRzID0gMDt0aGlzLmFja3MgPSB7fTt0aGlzLnJlY2VpdmVCdWZmZXIgPSBbXTt0aGlzLnNlbmRCdWZmZXIgPSBbXTt0aGlzLmNvbm5lY3RlZCA9IGZhbHNlO3RoaXMuZGlzY29ubmVjdGVkID0gdHJ1ZTtpZiAodGhpcy5pby5hdXRvQ29ubmVjdCkgdGhpcy5vcGVuKCk7XG4gICAgICB9RW1pdHRlcihTb2NrZXQucHJvdG90eXBlKTtTb2NrZXQucHJvdG90eXBlLnN1YkV2ZW50cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuc3VicykgcmV0dXJuO3ZhciBpbyA9IHRoaXMuaW87dGhpcy5zdWJzID0gW29uKGlvLCBcIm9wZW5cIiwgYmluZCh0aGlzLCBcIm9ub3BlblwiKSksIG9uKGlvLCBcInBhY2tldFwiLCBiaW5kKHRoaXMsIFwib25wYWNrZXRcIikpLCBvbihpbywgXCJjbG9zZVwiLCBiaW5kKHRoaXMsIFwib25jbG9zZVwiKSldO1xuICAgICAgfTtTb2NrZXQucHJvdG90eXBlLm9wZW4gPSBTb2NrZXQucHJvdG90eXBlLmNvbm5lY3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLmNvbm5lY3RlZCkgcmV0dXJuIHRoaXM7dGhpcy5zdWJFdmVudHMoKTt0aGlzLmlvLm9wZW4oKTtpZiAoXCJvcGVuXCIgPT0gdGhpcy5pby5yZWFkeVN0YXRlKSB0aGlzLm9ub3BlbigpO3RoaXMuZW1pdChcImNvbm5lY3RpbmdcIik7cmV0dXJuIHRoaXM7XG4gICAgICB9O1NvY2tldC5wcm90b3R5cGUuc2VuZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSB0b0FycmF5KGFyZ3VtZW50cyk7YXJncy51bnNoaWZ0KFwibWVzc2FnZVwiKTt0aGlzLmVtaXQuYXBwbHkodGhpcywgYXJncyk7cmV0dXJuIHRoaXM7XG4gICAgICB9O1NvY2tldC5wcm90b3R5cGUuZW1pdCA9IGZ1bmN0aW9uIChldikge1xuICAgICAgICBpZiAoZXZlbnRzLmhhc093blByb3BlcnR5KGV2KSkge1xuICAgICAgICAgIGVtaXQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtyZXR1cm4gdGhpcztcbiAgICAgICAgfXZhciBhcmdzID0gdG9BcnJheShhcmd1bWVudHMpO3ZhciBwYXJzZXJUeXBlID0gcGFyc2VyLkVWRU5UO2lmIChoYXNCaW4oYXJncykpIHtcbiAgICAgICAgICBwYXJzZXJUeXBlID0gcGFyc2VyLkJJTkFSWV9FVkVOVDtcbiAgICAgICAgfXZhciBwYWNrZXQgPSB7IHR5cGU6IHBhcnNlclR5cGUsIGRhdGE6IGFyZ3MgfTtwYWNrZXQub3B0aW9ucyA9IHt9O3BhY2tldC5vcHRpb25zLmNvbXByZXNzID0gIXRoaXMuZmxhZ3MgfHwgZmFsc2UgIT09IHRoaXMuZmxhZ3MuY29tcHJlc3M7aWYgKFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgYXJnc1thcmdzLmxlbmd0aCAtIDFdKSB7XG4gICAgICAgICAgZGVidWcoXCJlbWl0dGluZyBwYWNrZXQgd2l0aCBhY2sgaWQgJWRcIiwgdGhpcy5pZHMpO3RoaXMuYWNrc1t0aGlzLmlkc10gPSBhcmdzLnBvcCgpO3BhY2tldC5pZCA9IHRoaXMuaWRzKys7XG4gICAgICAgIH1pZiAodGhpcy5jb25uZWN0ZWQpIHtcbiAgICAgICAgICB0aGlzLnBhY2tldChwYWNrZXQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMuc2VuZEJ1ZmZlci5wdXNoKHBhY2tldCk7XG4gICAgICAgIH1kZWxldGUgdGhpcy5mbGFncztyZXR1cm4gdGhpcztcbiAgICAgIH07U29ja2V0LnByb3RvdHlwZS5wYWNrZXQgPSBmdW5jdGlvbiAocGFja2V0KSB7XG4gICAgICAgIHBhY2tldC5uc3AgPSB0aGlzLm5zcDt0aGlzLmlvLnBhY2tldChwYWNrZXQpO1xuICAgICAgfTtTb2NrZXQucHJvdG90eXBlLm9ub3BlbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZGVidWcoXCJ0cmFuc3BvcnQgaXMgb3BlbiAtIGNvbm5lY3RpbmdcIik7aWYgKFwiL1wiICE9IHRoaXMubnNwKSB7XG4gICAgICAgICAgdGhpcy5wYWNrZXQoeyB0eXBlOiBwYXJzZXIuQ09OTkVDVCB9KTtcbiAgICAgICAgfVxuICAgICAgfTtTb2NrZXQucHJvdG90eXBlLm9uY2xvc2UgPSBmdW5jdGlvbiAocmVhc29uKSB7XG4gICAgICAgIGRlYnVnKFwiY2xvc2UgKCVzKVwiLCByZWFzb24pO3RoaXMuY29ubmVjdGVkID0gZmFsc2U7dGhpcy5kaXNjb25uZWN0ZWQgPSB0cnVlO2RlbGV0ZSB0aGlzLmlkO3RoaXMuZW1pdChcImRpc2Nvbm5lY3RcIiwgcmVhc29uKTtcbiAgICAgIH07U29ja2V0LnByb3RvdHlwZS5vbnBhY2tldCA9IGZ1bmN0aW9uIChwYWNrZXQpIHtcbiAgICAgICAgaWYgKHBhY2tldC5uc3AgIT0gdGhpcy5uc3ApIHJldHVybjtzd2l0Y2ggKHBhY2tldC50eXBlKSB7Y2FzZSBwYXJzZXIuQ09OTkVDVDpcbiAgICAgICAgICAgIHRoaXMub25jb25uZWN0KCk7YnJlYWs7Y2FzZSBwYXJzZXIuRVZFTlQ6XG4gICAgICAgICAgICB0aGlzLm9uZXZlbnQocGFja2V0KTticmVhaztjYXNlIHBhcnNlci5CSU5BUllfRVZFTlQ6XG4gICAgICAgICAgICB0aGlzLm9uZXZlbnQocGFja2V0KTticmVhaztjYXNlIHBhcnNlci5BQ0s6XG4gICAgICAgICAgICB0aGlzLm9uYWNrKHBhY2tldCk7YnJlYWs7Y2FzZSBwYXJzZXIuQklOQVJZX0FDSzpcbiAgICAgICAgICAgIHRoaXMub25hY2socGFja2V0KTticmVhaztjYXNlIHBhcnNlci5ESVNDT05ORUNUOlxuICAgICAgICAgICAgdGhpcy5vbmRpc2Nvbm5lY3QoKTticmVhaztjYXNlIHBhcnNlci5FUlJPUjpcbiAgICAgICAgICAgIHRoaXMuZW1pdChcImVycm9yXCIsIHBhY2tldC5kYXRhKTticmVhazt9XG4gICAgICB9O1NvY2tldC5wcm90b3R5cGUub25ldmVudCA9IGZ1bmN0aW9uIChwYWNrZXQpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSBwYWNrZXQuZGF0YSB8fCBbXTtkZWJ1ZyhcImVtaXR0aW5nIGV2ZW50ICVqXCIsIGFyZ3MpO2lmIChudWxsICE9IHBhY2tldC5pZCkge1xuICAgICAgICAgIGRlYnVnKFwiYXR0YWNoaW5nIGFjayBjYWxsYmFjayB0byBldmVudFwiKTthcmdzLnB1c2godGhpcy5hY2socGFja2V0LmlkKSk7XG4gICAgICAgIH1pZiAodGhpcy5jb25uZWN0ZWQpIHtcbiAgICAgICAgICBlbWl0LmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMucmVjZWl2ZUJ1ZmZlci5wdXNoKGFyZ3MpO1xuICAgICAgICB9XG4gICAgICB9O1NvY2tldC5wcm90b3R5cGUuYWNrID0gZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpczt2YXIgc2VudCA9IGZhbHNlO3JldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgaWYgKHNlbnQpIHJldHVybjtzZW50ID0gdHJ1ZTt2YXIgYXJncyA9IHRvQXJyYXkoYXJndW1lbnRzKTtkZWJ1ZyhcInNlbmRpbmcgYWNrICVqXCIsIGFyZ3MpO3ZhciB0eXBlID0gaGFzQmluKGFyZ3MpID8gcGFyc2VyLkJJTkFSWV9BQ0sgOiBwYXJzZXIuQUNLO3NlbGYucGFja2V0KHsgdHlwZTogdHlwZSwgaWQ6IGlkLCBkYXRhOiBhcmdzIH0pO1xuICAgICAgICB9O1xuICAgICAgfTtTb2NrZXQucHJvdG90eXBlLm9uYWNrID0gZnVuY3Rpb24gKHBhY2tldCkge1xuICAgICAgICB2YXIgYWNrID0gdGhpcy5hY2tzW3BhY2tldC5pZF07aWYgKFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgYWNrKSB7XG4gICAgICAgICAgZGVidWcoXCJjYWxsaW5nIGFjayAlcyB3aXRoICVqXCIsIHBhY2tldC5pZCwgcGFja2V0LmRhdGEpO2Fjay5hcHBseSh0aGlzLCBwYWNrZXQuZGF0YSk7ZGVsZXRlIHRoaXMuYWNrc1twYWNrZXQuaWRdO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGRlYnVnKFwiYmFkIGFjayAlc1wiLCBwYWNrZXQuaWQpO1xuICAgICAgICB9XG4gICAgICB9O1NvY2tldC5wcm90b3R5cGUub25jb25uZWN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmNvbm5lY3RlZCA9IHRydWU7dGhpcy5kaXNjb25uZWN0ZWQgPSBmYWxzZTt0aGlzLmVtaXQoXCJjb25uZWN0XCIpO3RoaXMuZW1pdEJ1ZmZlcmVkKCk7XG4gICAgICB9O1NvY2tldC5wcm90b3R5cGUuZW1pdEJ1ZmZlcmVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgaTtmb3IgKGkgPSAwOyBpIDwgdGhpcy5yZWNlaXZlQnVmZmVyLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgZW1pdC5hcHBseSh0aGlzLCB0aGlzLnJlY2VpdmVCdWZmZXJbaV0pO1xuICAgICAgICB9dGhpcy5yZWNlaXZlQnVmZmVyID0gW107Zm9yIChpID0gMDsgaSA8IHRoaXMuc2VuZEJ1ZmZlci5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIHRoaXMucGFja2V0KHRoaXMuc2VuZEJ1ZmZlcltpXSk7XG4gICAgICAgIH10aGlzLnNlbmRCdWZmZXIgPSBbXTtcbiAgICAgIH07U29ja2V0LnByb3RvdHlwZS5vbmRpc2Nvbm5lY3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGRlYnVnKFwic2VydmVyIGRpc2Nvbm5lY3QgKCVzKVwiLCB0aGlzLm5zcCk7dGhpcy5kZXN0cm95KCk7dGhpcy5vbmNsb3NlKFwiaW8gc2VydmVyIGRpc2Nvbm5lY3RcIik7XG4gICAgICB9O1NvY2tldC5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuc3Vicykge1xuICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5zdWJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB0aGlzLnN1YnNbaV0uZGVzdHJveSgpO1xuICAgICAgICAgIH10aGlzLnN1YnMgPSBudWxsO1xuICAgICAgICB9dGhpcy5pby5kZXN0cm95KHRoaXMpO1xuICAgICAgfTtTb2NrZXQucHJvdG90eXBlLmNsb3NlID0gU29ja2V0LnByb3RvdHlwZS5kaXNjb25uZWN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5jb25uZWN0ZWQpIHtcbiAgICAgICAgICBkZWJ1ZyhcInBlcmZvcm1pbmcgZGlzY29ubmVjdCAoJXMpXCIsIHRoaXMubnNwKTt0aGlzLnBhY2tldCh7IHR5cGU6IHBhcnNlci5ESVNDT05ORUNUIH0pO1xuICAgICAgICB9dGhpcy5kZXN0cm95KCk7aWYgKHRoaXMuY29ubmVjdGVkKSB7XG4gICAgICAgICAgdGhpcy5vbmNsb3NlKFwiaW8gY2xpZW50IGRpc2Nvbm5lY3RcIik7XG4gICAgICAgIH1yZXR1cm4gdGhpcztcbiAgICAgIH07U29ja2V0LnByb3RvdHlwZS5jb21wcmVzcyA9IGZ1bmN0aW9uIChjb21wcmVzcykge1xuICAgICAgICB0aGlzLmZsYWdzID0gdGhpcy5mbGFncyB8fCB7fTt0aGlzLmZsYWdzLmNvbXByZXNzID0gY29tcHJlc3M7cmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgIH0sIHsgXCIuL29uXCI6IDMzLCBcImNvbXBvbmVudC1iaW5kXCI6IDM3LCBcImNvbXBvbmVudC1lbWl0dGVyXCI6IDM4LCBkZWJ1ZzogMzksIFwiaGFzLWJpbmFyeVwiOiA0MSwgXCJzb2NrZXQuaW8tcGFyc2VyXCI6IDQ3LCBcInRvLWFycmF5XCI6IDUxIH1dLCAzNTogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcbiAgICAgIChmdW5jdGlvbiAoZ2xvYmFsKSB7XG4gICAgICAgIHZhciBwYXJzZXVyaSA9IF9kZXJlcV8oXCJwYXJzZXVyaVwiKTt2YXIgZGVidWcgPSBfZGVyZXFfKFwiZGVidWdcIikoXCJzb2NrZXQuaW8tY2xpZW50OnVybFwiKTttb2R1bGUuZXhwb3J0cyA9IHVybDtmdW5jdGlvbiB1cmwodXJpLCBsb2MpIHtcbiAgICAgICAgICB2YXIgb2JqID0gdXJpO3ZhciBsb2MgPSBsb2MgfHwgZ2xvYmFsLmxvY2F0aW9uO2lmIChudWxsID09IHVyaSkgdXJpID0gbG9jLnByb3RvY29sICsgXCIvL1wiICsgbG9jLmhvc3Q7aWYgKFwic3RyaW5nXCIgPT0gdHlwZW9mIHVyaSkge1xuICAgICAgICAgICAgaWYgKFwiL1wiID09IHVyaS5jaGFyQXQoMCkpIHtcbiAgICAgICAgICAgICAgaWYgKFwiL1wiID09IHVyaS5jaGFyQXQoMSkpIHtcbiAgICAgICAgICAgICAgICB1cmkgPSBsb2MucHJvdG9jb2wgKyB1cmk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdXJpID0gbG9jLmhvc3QgKyB1cmk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1pZiAoIS9eKGh0dHBzP3x3c3M/KTpcXC9cXC8vLnRlc3QodXJpKSkge1xuICAgICAgICAgICAgICBkZWJ1ZyhcInByb3RvY29sLWxlc3MgdXJsICVzXCIsIHVyaSk7aWYgKFwidW5kZWZpbmVkXCIgIT0gdHlwZW9mIGxvYykge1xuICAgICAgICAgICAgICAgIHVyaSA9IGxvYy5wcm90b2NvbCArIFwiLy9cIiArIHVyaTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB1cmkgPSBcImh0dHBzOi8vXCIgKyB1cmk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1kZWJ1ZyhcInBhcnNlICVzXCIsIHVyaSk7b2JqID0gcGFyc2V1cmkodXJpKTtcbiAgICAgICAgICB9aWYgKCFvYmoucG9ydCkge1xuICAgICAgICAgICAgaWYgKC9eKGh0dHB8d3MpJC8udGVzdChvYmoucHJvdG9jb2wpKSB7XG4gICAgICAgICAgICAgIG9iai5wb3J0ID0gXCI4MFwiO1xuICAgICAgICAgICAgfSBlbHNlIGlmICgvXihodHRwfHdzKXMkLy50ZXN0KG9iai5wcm90b2NvbCkpIHtcbiAgICAgICAgICAgICAgb2JqLnBvcnQgPSBcIjQ0M1wiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1vYmoucGF0aCA9IG9iai5wYXRoIHx8IFwiL1wiO3ZhciBpcHY2ID0gb2JqLmhvc3QuaW5kZXhPZihcIjpcIikgIT09IC0xO3ZhciBob3N0ID0gaXB2NiA/IFwiW1wiICsgb2JqLmhvc3QgKyBcIl1cIiA6IG9iai5ob3N0O29iai5pZCA9IG9iai5wcm90b2NvbCArIFwiOi8vXCIgKyBob3N0ICsgXCI6XCIgKyBvYmoucG9ydDtvYmouaHJlZiA9IG9iai5wcm90b2NvbCArIFwiOi8vXCIgKyBob3N0ICsgKGxvYyAmJiBsb2MucG9ydCA9PSBvYmoucG9ydCA/IFwiXCIgOiBcIjpcIiArIG9iai5wb3J0KTtyZXR1cm4gb2JqO1xuICAgICAgICB9XG4gICAgICB9KS5jYWxsKHRoaXMsIHR5cGVvZiBzZWxmICE9PSBcInVuZGVmaW5lZFwiID8gc2VsZiA6IHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgPyB3aW5kb3cgOiB0eXBlb2YgZ2xvYmFsICE9PSBcInVuZGVmaW5lZFwiID8gZ2xvYmFsIDoge30pO1xuICAgIH0sIHsgZGVidWc6IDM5LCBwYXJzZXVyaTogNDUgfV0sIDM2OiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuICAgICAgbW9kdWxlLmV4cG9ydHMgPSBCYWNrb2ZmO2Z1bmN0aW9uIEJhY2tvZmYob3B0cykge1xuICAgICAgICBvcHRzID0gb3B0cyB8fCB7fTt0aGlzLm1zID0gb3B0cy5taW4gfHwgMTAwO3RoaXMubWF4ID0gb3B0cy5tYXggfHwgMWU0O3RoaXMuZmFjdG9yID0gb3B0cy5mYWN0b3IgfHwgMjt0aGlzLmppdHRlciA9IG9wdHMuaml0dGVyID4gMCAmJiBvcHRzLmppdHRlciA8PSAxID8gb3B0cy5qaXR0ZXIgOiAwO3RoaXMuYXR0ZW1wdHMgPSAwO1xuICAgICAgfUJhY2tvZmYucHJvdG90eXBlLmR1cmF0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbXMgPSB0aGlzLm1zICogTWF0aC5wb3codGhpcy5mYWN0b3IsIHRoaXMuYXR0ZW1wdHMrKyk7aWYgKHRoaXMuaml0dGVyKSB7XG4gICAgICAgICAgdmFyIHJhbmQgPSBNYXRoLnJhbmRvbSgpO3ZhciBkZXZpYXRpb24gPSBNYXRoLmZsb29yKHJhbmQgKiB0aGlzLmppdHRlciAqIG1zKTttcyA9IChNYXRoLmZsb29yKHJhbmQgKiAxMCkgJiAxKSA9PSAwID8gbXMgLSBkZXZpYXRpb24gOiBtcyArIGRldmlhdGlvbjtcbiAgICAgICAgfXJldHVybiBNYXRoLm1pbihtcywgdGhpcy5tYXgpIHwgMDtcbiAgICAgIH07QmFja29mZi5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuYXR0ZW1wdHMgPSAwO1xuICAgICAgfTtCYWNrb2ZmLnByb3RvdHlwZS5zZXRNaW4gPSBmdW5jdGlvbiAobWluKSB7XG4gICAgICAgIHRoaXMubXMgPSBtaW47XG4gICAgICB9O0JhY2tvZmYucHJvdG90eXBlLnNldE1heCA9IGZ1bmN0aW9uIChtYXgpIHtcbiAgICAgICAgdGhpcy5tYXggPSBtYXg7XG4gICAgICB9O0JhY2tvZmYucHJvdG90eXBlLnNldEppdHRlciA9IGZ1bmN0aW9uIChqaXR0ZXIpIHtcbiAgICAgICAgdGhpcy5qaXR0ZXIgPSBqaXR0ZXI7XG4gICAgICB9O1xuICAgIH0sIHt9XSwgMzc6IFtmdW5jdGlvbiAoX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG4gICAgICB2YXIgc2xpY2UgPSBbXS5zbGljZTttb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChvYmosIGZuKSB7XG4gICAgICAgIGlmIChcInN0cmluZ1wiID09IHR5cGVvZiBmbikgZm4gPSBvYmpbZm5dO2lmIChcImZ1bmN0aW9uXCIgIT0gdHlwZW9mIGZuKSB0aHJvdyBuZXcgRXJyb3IoXCJiaW5kKCkgcmVxdWlyZXMgYSBmdW5jdGlvblwiKTt2YXIgYXJncyA9IHNsaWNlLmNhbGwoYXJndW1lbnRzLCAyKTtyZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJldHVybiBmbi5hcHBseShvYmosIGFyZ3MuY29uY2F0KHNsaWNlLmNhbGwoYXJndW1lbnRzKSkpO1xuICAgICAgICB9O1xuICAgICAgfTtcbiAgICB9LCB7fV0sIDM4OiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuICAgICAgbW9kdWxlLmV4cG9ydHMgPSBFbWl0dGVyO2Z1bmN0aW9uIEVtaXR0ZXIob2JqKSB7XG4gICAgICAgIGlmIChvYmopIHJldHVybiBtaXhpbihvYmopO1xuICAgICAgfWZ1bmN0aW9uIG1peGluKG9iaikge1xuICAgICAgICBmb3IgKHZhciBrZXkgaW4gRW1pdHRlci5wcm90b3R5cGUpIHtcbiAgICAgICAgICBvYmpba2V5XSA9IEVtaXR0ZXIucHJvdG90eXBlW2tleV07XG4gICAgICAgIH1yZXR1cm4gb2JqO1xuICAgICAgfUVtaXR0ZXIucHJvdG90eXBlLm9uID0gRW1pdHRlci5wcm90b3R5cGUuYWRkRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uIChldmVudCwgZm4pIHtcbiAgICAgICAgdGhpcy5fY2FsbGJhY2tzID0gdGhpcy5fY2FsbGJhY2tzIHx8IHt9Oyh0aGlzLl9jYWxsYmFja3NbXCIkXCIgKyBldmVudF0gPSB0aGlzLl9jYWxsYmFja3NbXCIkXCIgKyBldmVudF0gfHwgW10pLnB1c2goZm4pO3JldHVybiB0aGlzO1xuICAgICAgfTtFbWl0dGVyLnByb3RvdHlwZS5vbmNlID0gZnVuY3Rpb24gKGV2ZW50LCBmbikge1xuICAgICAgICBmdW5jdGlvbiBvbigpIHtcbiAgICAgICAgICB0aGlzLm9mZihldmVudCwgb24pO2ZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgIH1vbi5mbiA9IGZuO3RoaXMub24oZXZlbnQsIG9uKTtyZXR1cm4gdGhpcztcbiAgICAgIH07RW1pdHRlci5wcm90b3R5cGUub2ZmID0gRW1pdHRlci5wcm90b3R5cGUucmVtb3ZlTGlzdGVuZXIgPSBFbWl0dGVyLnByb3RvdHlwZS5yZW1vdmVBbGxMaXN0ZW5lcnMgPSBFbWl0dGVyLnByb3RvdHlwZS5yZW1vdmVFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKGV2ZW50LCBmbikge1xuICAgICAgICB0aGlzLl9jYWxsYmFja3MgPSB0aGlzLl9jYWxsYmFja3MgfHwge307aWYgKDAgPT0gYXJndW1lbnRzLmxlbmd0aCkge1xuICAgICAgICAgIHRoaXMuX2NhbGxiYWNrcyA9IHt9O3JldHVybiB0aGlzO1xuICAgICAgICB9dmFyIGNhbGxiYWNrcyA9IHRoaXMuX2NhbGxiYWNrc1tcIiRcIiArIGV2ZW50XTtpZiAoIWNhbGxiYWNrcykgcmV0dXJuIHRoaXM7aWYgKDEgPT0gYXJndW1lbnRzLmxlbmd0aCkge1xuICAgICAgICAgIGRlbGV0ZSB0aGlzLl9jYWxsYmFja3NbXCIkXCIgKyBldmVudF07cmV0dXJuIHRoaXM7XG4gICAgICAgIH12YXIgY2I7Zm9yICh2YXIgaSA9IDA7IGkgPCBjYWxsYmFja3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBjYiA9IGNhbGxiYWNrc1tpXTtpZiAoY2IgPT09IGZuIHx8IGNiLmZuID09PSBmbikge1xuICAgICAgICAgICAgY2FsbGJhY2tzLnNwbGljZShpLCAxKTticmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1yZXR1cm4gdGhpcztcbiAgICAgIH07RW1pdHRlci5wcm90b3R5cGUuZW1pdCA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICB0aGlzLl9jYWxsYmFja3MgPSB0aGlzLl9jYWxsYmFja3MgfHwge307dmFyIGFyZ3MgPSBbXS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSksXG4gICAgICAgICAgICBjYWxsYmFja3MgPSB0aGlzLl9jYWxsYmFja3NbXCIkXCIgKyBldmVudF07aWYgKGNhbGxiYWNrcykge1xuICAgICAgICAgIGNhbGxiYWNrcyA9IGNhbGxiYWNrcy5zbGljZSgwKTtmb3IgKHZhciBpID0gMCwgbGVuID0gY2FsbGJhY2tzLmxlbmd0aDsgaSA8IGxlbjsgKytpKSB7XG4gICAgICAgICAgICBjYWxsYmFja3NbaV0uYXBwbHkodGhpcywgYXJncyk7XG4gICAgICAgICAgfVxuICAgICAgICB9cmV0dXJuIHRoaXM7XG4gICAgICB9O0VtaXR0ZXIucHJvdG90eXBlLmxpc3RlbmVycyA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICB0aGlzLl9jYWxsYmFja3MgPSB0aGlzLl9jYWxsYmFja3MgfHwge307cmV0dXJuIHRoaXMuX2NhbGxiYWNrc1tcIiRcIiArIGV2ZW50XSB8fCBbXTtcbiAgICAgIH07RW1pdHRlci5wcm90b3R5cGUuaGFzTGlzdGVuZXJzID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIHJldHVybiAhIXRoaXMubGlzdGVuZXJzKGV2ZW50KS5sZW5ndGg7XG4gICAgICB9O1xuICAgIH0sIHt9XSwgMzk6IFtmdW5jdGlvbiAoX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG4gICAgICBhcmd1bWVudHNbNF1bMTddWzBdLmFwcGx5KGV4cG9ydHMsIGFyZ3VtZW50cyk7XG4gICAgfSwgeyBcIi4vZGVidWdcIjogNDAsIGR1cDogMTcgfV0sIDQwOiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuICAgICAgYXJndW1lbnRzWzRdWzE4XVswXS5hcHBseShleHBvcnRzLCBhcmd1bWVudHMpO1xuICAgIH0sIHsgZHVwOiAxOCwgbXM6IDQ0IH1dLCA0MTogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcbiAgICAgIChmdW5jdGlvbiAoZ2xvYmFsKSB7XG4gICAgICAgIHZhciBpc0FycmF5ID0gX2RlcmVxXyhcImlzYXJyYXlcIik7bW9kdWxlLmV4cG9ydHMgPSBoYXNCaW5hcnk7ZnVuY3Rpb24gaGFzQmluYXJ5KGRhdGEpIHtcbiAgICAgICAgICBmdW5jdGlvbiBfaGFzQmluYXJ5KG9iaikge1xuICAgICAgICAgICAgaWYgKCFvYmopIHJldHVybiBmYWxzZTtpZiAoZ2xvYmFsLkJ1ZmZlciAmJiBnbG9iYWwuQnVmZmVyLmlzQnVmZmVyICYmIGdsb2JhbC5CdWZmZXIuaXNCdWZmZXIob2JqKSB8fCBnbG9iYWwuQXJyYXlCdWZmZXIgJiYgb2JqIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIgfHwgZ2xvYmFsLkJsb2IgJiYgb2JqIGluc3RhbmNlb2YgQmxvYiB8fCBnbG9iYWwuRmlsZSAmJiBvYmogaW5zdGFuY2VvZiBGaWxlKSB7XG4gICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfWlmIChpc0FycmF5KG9iaikpIHtcbiAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBvYmoubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAoX2hhc0JpbmFyeShvYmpbaV0pKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAob2JqICYmIFwib2JqZWN0XCIgPT0gdHlwZW9mIG9iaikge1xuICAgICAgICAgICAgICBpZiAob2JqLnRvSlNPTiAmJiBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIG9iai50b0pTT04pIHtcbiAgICAgICAgICAgICAgICBvYmogPSBvYmoudG9KU09OKCk7XG4gICAgICAgICAgICAgIH1mb3IgKHZhciBrZXkgaW4gb2JqKSB7XG4gICAgICAgICAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkgJiYgX2hhc0JpbmFyeShvYmpba2V5XSkpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfXJldHVybiBmYWxzZTtcbiAgICAgICAgICB9cmV0dXJuIF9oYXNCaW5hcnkoZGF0YSk7XG4gICAgICAgIH1cbiAgICAgIH0pLmNhbGwodGhpcywgdHlwZW9mIHNlbGYgIT09IFwidW5kZWZpbmVkXCIgPyBzZWxmIDogdHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiA/IHdpbmRvdyA6IHR5cGVvZiBnbG9iYWwgIT09IFwidW5kZWZpbmVkXCIgPyBnbG9iYWwgOiB7fSk7XG4gICAgfSwgeyBpc2FycmF5OiA0MyB9XSwgNDI6IFtmdW5jdGlvbiAoX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG4gICAgICBhcmd1bWVudHNbNF1bMjNdWzBdLmFwcGx5KGV4cG9ydHMsIGFyZ3VtZW50cyk7XG4gICAgfSwgeyBkdXA6IDIzIH1dLCA0MzogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcbiAgICAgIGFyZ3VtZW50c1s0XVsyNF1bMF0uYXBwbHkoZXhwb3J0cywgYXJndW1lbnRzKTtcbiAgICB9LCB7IGR1cDogMjQgfV0sIDQ0OiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuICAgICAgYXJndW1lbnRzWzRdWzI1XVswXS5hcHBseShleHBvcnRzLCBhcmd1bWVudHMpO1xuICAgIH0sIHsgZHVwOiAyNSB9XSwgNDU6IFtmdW5jdGlvbiAoX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG4gICAgICBhcmd1bWVudHNbNF1bMjhdWzBdLmFwcGx5KGV4cG9ydHMsIGFyZ3VtZW50cyk7XG4gICAgfSwgeyBkdXA6IDI4IH1dLCA0NjogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcbiAgICAgIChmdW5jdGlvbiAoZ2xvYmFsKSB7XG4gICAgICAgIHZhciBpc0FycmF5ID0gX2RlcmVxXyhcImlzYXJyYXlcIik7dmFyIGlzQnVmID0gX2RlcmVxXyhcIi4vaXMtYnVmZmVyXCIpO2V4cG9ydHMuZGVjb25zdHJ1Y3RQYWNrZXQgPSBmdW5jdGlvbiAocGFja2V0KSB7XG4gICAgICAgICAgdmFyIGJ1ZmZlcnMgPSBbXTt2YXIgcGFja2V0RGF0YSA9IHBhY2tldC5kYXRhO2Z1bmN0aW9uIF9kZWNvbnN0cnVjdFBhY2tldChkYXRhKSB7XG4gICAgICAgICAgICBpZiAoIWRhdGEpIHJldHVybiBkYXRhO2lmIChpc0J1ZihkYXRhKSkge1xuICAgICAgICAgICAgICB2YXIgcGxhY2Vob2xkZXIgPSB7IF9wbGFjZWhvbGRlcjogdHJ1ZSwgbnVtOiBidWZmZXJzLmxlbmd0aCB9O2J1ZmZlcnMucHVzaChkYXRhKTtyZXR1cm4gcGxhY2Vob2xkZXI7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGlzQXJyYXkoZGF0YSkpIHtcbiAgICAgICAgICAgICAgdmFyIG5ld0RhdGEgPSBuZXcgQXJyYXkoZGF0YS5sZW5ndGgpO2ZvciAodmFyIGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIG5ld0RhdGFbaV0gPSBfZGVjb25zdHJ1Y3RQYWNrZXQoZGF0YVtpXSk7XG4gICAgICAgICAgICAgIH1yZXR1cm4gbmV3RGF0YTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoXCJvYmplY3RcIiA9PSB0eXBlb2YgZGF0YSAmJiAhKGRhdGEgaW5zdGFuY2VvZiBEYXRlKSkge1xuICAgICAgICAgICAgICB2YXIgbmV3RGF0YSA9IHt9O2ZvciAodmFyIGtleSBpbiBkYXRhKSB7XG4gICAgICAgICAgICAgICAgbmV3RGF0YVtrZXldID0gX2RlY29uc3RydWN0UGFja2V0KGRhdGFba2V5XSk7XG4gICAgICAgICAgICAgIH1yZXR1cm4gbmV3RGF0YTtcbiAgICAgICAgICAgIH1yZXR1cm4gZGF0YTtcbiAgICAgICAgICB9dmFyIHBhY2sgPSBwYWNrZXQ7cGFjay5kYXRhID0gX2RlY29uc3RydWN0UGFja2V0KHBhY2tldERhdGEpO3BhY2suYXR0YWNobWVudHMgPSBidWZmZXJzLmxlbmd0aDtyZXR1cm4geyBwYWNrZXQ6IHBhY2ssIGJ1ZmZlcnM6IGJ1ZmZlcnMgfTtcbiAgICAgICAgfTtleHBvcnRzLnJlY29uc3RydWN0UGFja2V0ID0gZnVuY3Rpb24gKHBhY2tldCwgYnVmZmVycykge1xuICAgICAgICAgIHZhciBjdXJQbGFjZUhvbGRlciA9IDA7ZnVuY3Rpb24gX3JlY29uc3RydWN0UGFja2V0KGRhdGEpIHtcbiAgICAgICAgICAgIGlmIChkYXRhICYmIGRhdGEuX3BsYWNlaG9sZGVyKSB7XG4gICAgICAgICAgICAgIHZhciBidWYgPSBidWZmZXJzW2RhdGEubnVtXTtyZXR1cm4gYnVmO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChpc0FycmF5KGRhdGEpKSB7XG4gICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGRhdGFbaV0gPSBfcmVjb25zdHJ1Y3RQYWNrZXQoZGF0YVtpXSk7XG4gICAgICAgICAgICAgIH1yZXR1cm4gZGF0YTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZGF0YSAmJiBcIm9iamVjdFwiID09IHR5cGVvZiBkYXRhKSB7XG4gICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBkYXRhKSB7XG4gICAgICAgICAgICAgICAgZGF0YVtrZXldID0gX3JlY29uc3RydWN0UGFja2V0KGRhdGFba2V5XSk7XG4gICAgICAgICAgICAgIH1yZXR1cm4gZGF0YTtcbiAgICAgICAgICAgIH1yZXR1cm4gZGF0YTtcbiAgICAgICAgICB9cGFja2V0LmRhdGEgPSBfcmVjb25zdHJ1Y3RQYWNrZXQocGFja2V0LmRhdGEpO3BhY2tldC5hdHRhY2htZW50cyA9IHVuZGVmaW5lZDtyZXR1cm4gcGFja2V0O1xuICAgICAgICB9O2V4cG9ydHMucmVtb3ZlQmxvYnMgPSBmdW5jdGlvbiAoZGF0YSwgY2FsbGJhY2spIHtcbiAgICAgICAgICBmdW5jdGlvbiBfcmVtb3ZlQmxvYnMob2JqLCBjdXJLZXksIGNvbnRhaW5pbmdPYmplY3QpIHtcbiAgICAgICAgICAgIGlmICghb2JqKSByZXR1cm4gb2JqO2lmIChnbG9iYWwuQmxvYiAmJiBvYmogaW5zdGFuY2VvZiBCbG9iIHx8IGdsb2JhbC5GaWxlICYmIG9iaiBpbnN0YW5jZW9mIEZpbGUpIHtcbiAgICAgICAgICAgICAgcGVuZGluZ0Jsb2JzKys7dmFyIGZpbGVSZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO2ZpbGVSZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGlmIChjb250YWluaW5nT2JqZWN0KSB7XG4gICAgICAgICAgICAgICAgICBjb250YWluaW5nT2JqZWN0W2N1cktleV0gPSB0aGlzLnJlc3VsdDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgYmxvYmxlc3NEYXRhID0gdGhpcy5yZXN1bHQ7XG4gICAgICAgICAgICAgICAgfWlmICghIC0tcGVuZGluZ0Jsb2JzKSB7XG4gICAgICAgICAgICAgICAgICBjYWxsYmFjayhibG9ibGVzc0RhdGEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfTtmaWxlUmVhZGVyLnJlYWRBc0FycmF5QnVmZmVyKG9iaik7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGlzQXJyYXkob2JqKSkge1xuICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG9iai5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIF9yZW1vdmVCbG9icyhvYmpbaV0sIGksIG9iaik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAob2JqICYmIFwib2JqZWN0XCIgPT0gdHlwZW9mIG9iaiAmJiAhaXNCdWYob2JqKSkge1xuICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XG4gICAgICAgICAgICAgICAgX3JlbW92ZUJsb2JzKG9ialtrZXldLCBrZXksIG9iaik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9dmFyIHBlbmRpbmdCbG9icyA9IDA7dmFyIGJsb2JsZXNzRGF0YSA9IGRhdGE7X3JlbW92ZUJsb2JzKGJsb2JsZXNzRGF0YSk7aWYgKCFwZW5kaW5nQmxvYnMpIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKGJsb2JsZXNzRGF0YSk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgfSkuY2FsbCh0aGlzLCB0eXBlb2Ygc2VsZiAhPT0gXCJ1bmRlZmluZWRcIiA/IHNlbGYgOiB0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiID8gd2luZG93IDogdHlwZW9mIGdsb2JhbCAhPT0gXCJ1bmRlZmluZWRcIiA/IGdsb2JhbCA6IHt9KTtcbiAgICB9LCB7IFwiLi9pcy1idWZmZXJcIjogNDgsIGlzYXJyYXk6IDQzIH1dLCA0NzogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcbiAgICAgIHZhciBkZWJ1ZyA9IF9kZXJlcV8oXCJkZWJ1Z1wiKShcInNvY2tldC5pby1wYXJzZXJcIik7dmFyIGpzb24gPSBfZGVyZXFfKFwianNvbjNcIik7dmFyIGlzQXJyYXkgPSBfZGVyZXFfKFwiaXNhcnJheVwiKTt2YXIgRW1pdHRlciA9IF9kZXJlcV8oXCJjb21wb25lbnQtZW1pdHRlclwiKTt2YXIgYmluYXJ5ID0gX2RlcmVxXyhcIi4vYmluYXJ5XCIpO3ZhciBpc0J1ZiA9IF9kZXJlcV8oXCIuL2lzLWJ1ZmZlclwiKTtleHBvcnRzLnByb3RvY29sID0gNDtleHBvcnRzLnR5cGVzID0gW1wiQ09OTkVDVFwiLCBcIkRJU0NPTk5FQ1RcIiwgXCJFVkVOVFwiLCBcIkJJTkFSWV9FVkVOVFwiLCBcIkFDS1wiLCBcIkJJTkFSWV9BQ0tcIiwgXCJFUlJPUlwiXTtleHBvcnRzLkNPTk5FQ1QgPSAwO2V4cG9ydHMuRElTQ09OTkVDVCA9IDE7ZXhwb3J0cy5FVkVOVCA9IDI7ZXhwb3J0cy5BQ0sgPSAzO2V4cG9ydHMuRVJST1IgPSA0O2V4cG9ydHMuQklOQVJZX0VWRU5UID0gNTtleHBvcnRzLkJJTkFSWV9BQ0sgPSA2O2V4cG9ydHMuRW5jb2RlciA9IEVuY29kZXI7ZXhwb3J0cy5EZWNvZGVyID0gRGVjb2RlcjtmdW5jdGlvbiBFbmNvZGVyKCkge31FbmNvZGVyLnByb3RvdHlwZS5lbmNvZGUgPSBmdW5jdGlvbiAob2JqLCBjYWxsYmFjaykge1xuICAgICAgICBkZWJ1ZyhcImVuY29kaW5nIHBhY2tldCAlalwiLCBvYmopO2lmIChleHBvcnRzLkJJTkFSWV9FVkVOVCA9PSBvYmoudHlwZSB8fCBleHBvcnRzLkJJTkFSWV9BQ0sgPT0gb2JqLnR5cGUpIHtcbiAgICAgICAgICBlbmNvZGVBc0JpbmFyeShvYmosIGNhbGxiYWNrKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2YXIgZW5jb2RpbmcgPSBlbmNvZGVBc1N0cmluZyhvYmopO2NhbGxiYWNrKFtlbmNvZGluZ10pO1xuICAgICAgICB9XG4gICAgICB9O2Z1bmN0aW9uIGVuY29kZUFzU3RyaW5nKG9iaikge1xuICAgICAgICB2YXIgc3RyID0gXCJcIjt2YXIgbnNwID0gZmFsc2U7c3RyICs9IG9iai50eXBlO2lmIChleHBvcnRzLkJJTkFSWV9FVkVOVCA9PSBvYmoudHlwZSB8fCBleHBvcnRzLkJJTkFSWV9BQ0sgPT0gb2JqLnR5cGUpIHtcbiAgICAgICAgICBzdHIgKz0gb2JqLmF0dGFjaG1lbnRzO3N0ciArPSBcIi1cIjtcbiAgICAgICAgfWlmIChvYmoubnNwICYmIFwiL1wiICE9IG9iai5uc3ApIHtcbiAgICAgICAgICBuc3AgPSB0cnVlO3N0ciArPSBvYmoubnNwO1xuICAgICAgICB9aWYgKG51bGwgIT0gb2JqLmlkKSB7XG4gICAgICAgICAgaWYgKG5zcCkge1xuICAgICAgICAgICAgc3RyICs9IFwiLFwiO25zcCA9IGZhbHNlO1xuICAgICAgICAgIH1zdHIgKz0gb2JqLmlkO1xuICAgICAgICB9aWYgKG51bGwgIT0gb2JqLmRhdGEpIHtcbiAgICAgICAgICBpZiAobnNwKSBzdHIgKz0gXCIsXCI7c3RyICs9IGpzb24uc3RyaW5naWZ5KG9iai5kYXRhKTtcbiAgICAgICAgfWRlYnVnKFwiZW5jb2RlZCAlaiBhcyAlc1wiLCBvYmosIHN0cik7cmV0dXJuIHN0cjtcbiAgICAgIH1mdW5jdGlvbiBlbmNvZGVBc0JpbmFyeShvYmosIGNhbGxiYWNrKSB7XG4gICAgICAgIGZ1bmN0aW9uIHdyaXRlRW5jb2RpbmcoYmxvYmxlc3NEYXRhKSB7XG4gICAgICAgICAgdmFyIGRlY29uc3RydWN0aW9uID0gYmluYXJ5LmRlY29uc3RydWN0UGFja2V0KGJsb2JsZXNzRGF0YSk7dmFyIHBhY2sgPSBlbmNvZGVBc1N0cmluZyhkZWNvbnN0cnVjdGlvbi5wYWNrZXQpO3ZhciBidWZmZXJzID0gZGVjb25zdHJ1Y3Rpb24uYnVmZmVycztidWZmZXJzLnVuc2hpZnQocGFjayk7Y2FsbGJhY2soYnVmZmVycyk7XG4gICAgICAgIH1iaW5hcnkucmVtb3ZlQmxvYnMob2JqLCB3cml0ZUVuY29kaW5nKTtcbiAgICAgIH1mdW5jdGlvbiBEZWNvZGVyKCkge1xuICAgICAgICB0aGlzLnJlY29uc3RydWN0b3IgPSBudWxsO1xuICAgICAgfUVtaXR0ZXIoRGVjb2Rlci5wcm90b3R5cGUpO0RlY29kZXIucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgdmFyIHBhY2tldDtpZiAoXCJzdHJpbmdcIiA9PSB0eXBlb2Ygb2JqKSB7XG4gICAgICAgICAgcGFja2V0ID0gZGVjb2RlU3RyaW5nKG9iaik7aWYgKGV4cG9ydHMuQklOQVJZX0VWRU5UID09IHBhY2tldC50eXBlIHx8IGV4cG9ydHMuQklOQVJZX0FDSyA9PSBwYWNrZXQudHlwZSkge1xuICAgICAgICAgICAgdGhpcy5yZWNvbnN0cnVjdG9yID0gbmV3IEJpbmFyeVJlY29uc3RydWN0b3IocGFja2V0KTtpZiAodGhpcy5yZWNvbnN0cnVjdG9yLnJlY29uUGFjay5hdHRhY2htZW50cyA9PT0gMCkge1xuICAgICAgICAgICAgICB0aGlzLmVtaXQoXCJkZWNvZGVkXCIsIHBhY2tldCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuZW1pdChcImRlY29kZWRcIiwgcGFja2V0KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoaXNCdWYob2JqKSB8fCBvYmouYmFzZTY0KSB7XG4gICAgICAgICAgaWYgKCF0aGlzLnJlY29uc3RydWN0b3IpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImdvdCBiaW5hcnkgZGF0YSB3aGVuIG5vdCByZWNvbnN0cnVjdGluZyBhIHBhY2tldFwiKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcGFja2V0ID0gdGhpcy5yZWNvbnN0cnVjdG9yLnRha2VCaW5hcnlEYXRhKG9iaik7aWYgKHBhY2tldCkge1xuICAgICAgICAgICAgICB0aGlzLnJlY29uc3RydWN0b3IgPSBudWxsO3RoaXMuZW1pdChcImRlY29kZWRcIiwgcGFja2V0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVW5rbm93biB0eXBlOiBcIiArIG9iaik7XG4gICAgICAgIH1cbiAgICAgIH07ZnVuY3Rpb24gZGVjb2RlU3RyaW5nKHN0cikge1xuICAgICAgICB2YXIgcCA9IHt9O3ZhciBpID0gMDtwLnR5cGUgPSBOdW1iZXIoc3RyLmNoYXJBdCgwKSk7aWYgKG51bGwgPT0gZXhwb3J0cy50eXBlc1twLnR5cGVdKSByZXR1cm4gZXJyb3IoKTtpZiAoZXhwb3J0cy5CSU5BUllfRVZFTlQgPT0gcC50eXBlIHx8IGV4cG9ydHMuQklOQVJZX0FDSyA9PSBwLnR5cGUpIHtcbiAgICAgICAgICB2YXIgYnVmID0gXCJcIjt3aGlsZSAoc3RyLmNoYXJBdCgrK2kpICE9IFwiLVwiKSB7XG4gICAgICAgICAgICBidWYgKz0gc3RyLmNoYXJBdChpKTtpZiAoaSA9PSBzdHIubGVuZ3RoKSBicmVhaztcbiAgICAgICAgICB9aWYgKGJ1ZiAhPSBOdW1iZXIoYnVmKSB8fCBzdHIuY2hhckF0KGkpICE9IFwiLVwiKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbGxlZ2FsIGF0dGFjaG1lbnRzXCIpO1xuICAgICAgICAgIH1wLmF0dGFjaG1lbnRzID0gTnVtYmVyKGJ1Zik7XG4gICAgICAgIH1pZiAoXCIvXCIgPT0gc3RyLmNoYXJBdChpICsgMSkpIHtcbiAgICAgICAgICBwLm5zcCA9IFwiXCI7d2hpbGUgKCsraSkge1xuICAgICAgICAgICAgdmFyIGMgPSBzdHIuY2hhckF0KGkpO2lmIChcIixcIiA9PSBjKSBicmVhaztwLm5zcCArPSBjO2lmIChpID09IHN0ci5sZW5ndGgpIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBwLm5zcCA9IFwiL1wiO1xuICAgICAgICB9dmFyIG5leHQgPSBzdHIuY2hhckF0KGkgKyAxKTtpZiAoXCJcIiAhPT0gbmV4dCAmJiBOdW1iZXIobmV4dCkgPT0gbmV4dCkge1xuICAgICAgICAgIHAuaWQgPSBcIlwiO3doaWxlICgrK2kpIHtcbiAgICAgICAgICAgIHZhciBjID0gc3RyLmNoYXJBdChpKTtpZiAobnVsbCA9PSBjIHx8IE51bWJlcihjKSAhPSBjKSB7XG4gICAgICAgICAgICAgIC0taTticmVhaztcbiAgICAgICAgICAgIH1wLmlkICs9IHN0ci5jaGFyQXQoaSk7aWYgKGkgPT0gc3RyLmxlbmd0aCkgYnJlYWs7XG4gICAgICAgICAgfXAuaWQgPSBOdW1iZXIocC5pZCk7XG4gICAgICAgIH1pZiAoc3RyLmNoYXJBdCgrK2kpKSB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHAuZGF0YSA9IGpzb24ucGFyc2Uoc3RyLnN1YnN0cihpKSk7XG4gICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgcmV0dXJuIGVycm9yKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9ZGVidWcoXCJkZWNvZGVkICVzIGFzICVqXCIsIHN0ciwgcCk7cmV0dXJuIHA7XG4gICAgICB9RGVjb2Rlci5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMucmVjb25zdHJ1Y3Rvcikge1xuICAgICAgICAgIHRoaXMucmVjb25zdHJ1Y3Rvci5maW5pc2hlZFJlY29uc3RydWN0aW9uKCk7XG4gICAgICAgIH1cbiAgICAgIH07ZnVuY3Rpb24gQmluYXJ5UmVjb25zdHJ1Y3RvcihwYWNrZXQpIHtcbiAgICAgICAgdGhpcy5yZWNvblBhY2sgPSBwYWNrZXQ7dGhpcy5idWZmZXJzID0gW107XG4gICAgICB9QmluYXJ5UmVjb25zdHJ1Y3Rvci5wcm90b3R5cGUudGFrZUJpbmFyeURhdGEgPSBmdW5jdGlvbiAoYmluRGF0YSkge1xuICAgICAgICB0aGlzLmJ1ZmZlcnMucHVzaChiaW5EYXRhKTtpZiAodGhpcy5idWZmZXJzLmxlbmd0aCA9PSB0aGlzLnJlY29uUGFjay5hdHRhY2htZW50cykge1xuICAgICAgICAgIHZhciBwYWNrZXQgPSBiaW5hcnkucmVjb25zdHJ1Y3RQYWNrZXQodGhpcy5yZWNvblBhY2ssIHRoaXMuYnVmZmVycyk7dGhpcy5maW5pc2hlZFJlY29uc3RydWN0aW9uKCk7cmV0dXJuIHBhY2tldDtcbiAgICAgICAgfXJldHVybiBudWxsO1xuICAgICAgfTtCaW5hcnlSZWNvbnN0cnVjdG9yLnByb3RvdHlwZS5maW5pc2hlZFJlY29uc3RydWN0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnJlY29uUGFjayA9IG51bGw7dGhpcy5idWZmZXJzID0gW107XG4gICAgICB9O2Z1bmN0aW9uIGVycm9yKGRhdGEpIHtcbiAgICAgICAgcmV0dXJuIHsgdHlwZTogZXhwb3J0cy5FUlJPUiwgZGF0YTogXCJwYXJzZXIgZXJyb3JcIiB9O1xuICAgICAgfVxuICAgIH0sIHsgXCIuL2JpbmFyeVwiOiA0NiwgXCIuL2lzLWJ1ZmZlclwiOiA0OCwgXCJjb21wb25lbnQtZW1pdHRlclwiOiA0OSwgZGVidWc6IDM5LCBpc2FycmF5OiA0MywganNvbjM6IDUwIH1dLCA0ODogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcbiAgICAgIChmdW5jdGlvbiAoZ2xvYmFsKSB7XG4gICAgICAgIG1vZHVsZS5leHBvcnRzID0gaXNCdWY7ZnVuY3Rpb24gaXNCdWYob2JqKSB7XG4gICAgICAgICAgcmV0dXJuIGdsb2JhbC5CdWZmZXIgJiYgZ2xvYmFsLkJ1ZmZlci5pc0J1ZmZlcihvYmopIHx8IGdsb2JhbC5BcnJheUJ1ZmZlciAmJiBvYmogaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcjtcbiAgICAgICAgfVxuICAgICAgfSkuY2FsbCh0aGlzLCB0eXBlb2Ygc2VsZiAhPT0gXCJ1bmRlZmluZWRcIiA/IHNlbGYgOiB0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiID8gd2luZG93IDogdHlwZW9mIGdsb2JhbCAhPT0gXCJ1bmRlZmluZWRcIiA/IGdsb2JhbCA6IHt9KTtcbiAgICB9LCB7fV0sIDQ5OiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuICAgICAgYXJndW1lbnRzWzRdWzE1XVswXS5hcHBseShleHBvcnRzLCBhcmd1bWVudHMpO1xuICAgIH0sIHsgZHVwOiAxNSB9XSwgNTA6IFtmdW5jdGlvbiAoX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG4gICAgICAoZnVuY3Rpb24gKGdsb2JhbCkge1xuICAgICAgICAoZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHZhciBpc0xvYWRlciA9IHR5cGVvZiBkZWZpbmUgPT09IFwiZnVuY3Rpb25cIiAmJiBkZWZpbmUuYW1kO3ZhciBvYmplY3RUeXBlcyA9IHsgXCJmdW5jdGlvblwiOiB0cnVlLCBvYmplY3Q6IHRydWUgfTt2YXIgZnJlZUV4cG9ydHMgPSBvYmplY3RUeXBlc1t0eXBlb2YgZXhwb3J0c10gJiYgZXhwb3J0cyAmJiAhZXhwb3J0cy5ub2RlVHlwZSAmJiBleHBvcnRzO3ZhciByb290ID0gb2JqZWN0VHlwZXNbdHlwZW9mIHdpbmRvd10gJiYgd2luZG93IHx8IHRoaXMsXG4gICAgICAgICAgICAgIGZyZWVHbG9iYWwgPSBmcmVlRXhwb3J0cyAmJiBvYmplY3RUeXBlc1t0eXBlb2YgbW9kdWxlXSAmJiBtb2R1bGUgJiYgIW1vZHVsZS5ub2RlVHlwZSAmJiB0eXBlb2YgZ2xvYmFsID09IFwib2JqZWN0XCIgJiYgZ2xvYmFsO2lmIChmcmVlR2xvYmFsICYmIChmcmVlR2xvYmFsW1wiZ2xvYmFsXCJdID09PSBmcmVlR2xvYmFsIHx8IGZyZWVHbG9iYWxbXCJ3aW5kb3dcIl0gPT09IGZyZWVHbG9iYWwgfHwgZnJlZUdsb2JhbFtcInNlbGZcIl0gPT09IGZyZWVHbG9iYWwpKSB7XG4gICAgICAgICAgICByb290ID0gZnJlZUdsb2JhbDtcbiAgICAgICAgICB9ZnVuY3Rpb24gcnVuSW5Db250ZXh0KGNvbnRleHQsIGV4cG9ydHMpIHtcbiAgICAgICAgICAgIGNvbnRleHQgfHwgKGNvbnRleHQgPSByb290W1wiT2JqZWN0XCJdKCkpO2V4cG9ydHMgfHwgKGV4cG9ydHMgPSByb290W1wiT2JqZWN0XCJdKCkpO3ZhciBOdW1iZXIgPSBjb250ZXh0W1wiTnVtYmVyXCJdIHx8IHJvb3RbXCJOdW1iZXJcIl0sXG4gICAgICAgICAgICAgICAgU3RyaW5nID0gY29udGV4dFtcIlN0cmluZ1wiXSB8fCByb290W1wiU3RyaW5nXCJdLFxuICAgICAgICAgICAgICAgIE9iamVjdCA9IGNvbnRleHRbXCJPYmplY3RcIl0gfHwgcm9vdFtcIk9iamVjdFwiXSxcbiAgICAgICAgICAgICAgICBEYXRlID0gY29udGV4dFtcIkRhdGVcIl0gfHwgcm9vdFtcIkRhdGVcIl0sXG4gICAgICAgICAgICAgICAgU3ludGF4RXJyb3IgPSBjb250ZXh0W1wiU3ludGF4RXJyb3JcIl0gfHwgcm9vdFtcIlN5bnRheEVycm9yXCJdLFxuICAgICAgICAgICAgICAgIFR5cGVFcnJvciA9IGNvbnRleHRbXCJUeXBlRXJyb3JcIl0gfHwgcm9vdFtcIlR5cGVFcnJvclwiXSxcbiAgICAgICAgICAgICAgICBNYXRoID0gY29udGV4dFtcIk1hdGhcIl0gfHwgcm9vdFtcIk1hdGhcIl0sXG4gICAgICAgICAgICAgICAgbmF0aXZlSlNPTiA9IGNvbnRleHRbXCJKU09OXCJdIHx8IHJvb3RbXCJKU09OXCJdO2lmICh0eXBlb2YgbmF0aXZlSlNPTiA9PSBcIm9iamVjdFwiICYmIG5hdGl2ZUpTT04pIHtcbiAgICAgICAgICAgICAgZXhwb3J0cy5zdHJpbmdpZnkgPSBuYXRpdmVKU09OLnN0cmluZ2lmeTtleHBvcnRzLnBhcnNlID0gbmF0aXZlSlNPTi5wYXJzZTtcbiAgICAgICAgICAgIH12YXIgb2JqZWN0UHJvdG8gPSBPYmplY3QucHJvdG90eXBlLFxuICAgICAgICAgICAgICAgIGdldENsYXNzID0gb2JqZWN0UHJvdG8udG9TdHJpbmcsXG4gICAgICAgICAgICAgICAgaXNQcm9wZXJ0eSxcbiAgICAgICAgICAgICAgICBmb3JFYWNoLFxuICAgICAgICAgICAgICAgIHVuZGVmO3ZhciBpc0V4dGVuZGVkID0gbmV3IERhdGUoLTB4Yzc4MmI1YjgwMGNlYyk7dHJ5IHtcbiAgICAgICAgICAgICAgaXNFeHRlbmRlZCA9IGlzRXh0ZW5kZWQuZ2V0VVRDRnVsbFllYXIoKSA9PSAtMTA5MjUyICYmIGlzRXh0ZW5kZWQuZ2V0VVRDTW9udGgoKSA9PT0gMCAmJiBpc0V4dGVuZGVkLmdldFVUQ0RhdGUoKSA9PT0gMSAmJiBpc0V4dGVuZGVkLmdldFVUQ0hvdXJzKCkgPT0gMTAgJiYgaXNFeHRlbmRlZC5nZXRVVENNaW51dGVzKCkgPT0gMzcgJiYgaXNFeHRlbmRlZC5nZXRVVENTZWNvbmRzKCkgPT0gNiAmJiBpc0V4dGVuZGVkLmdldFVUQ01pbGxpc2Vjb25kcygpID09IDcwODtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGV4Y2VwdGlvbikge31mdW5jdGlvbiBoYXMobmFtZSkge1xuICAgICAgICAgICAgICBpZiAoaGFzW25hbWVdICE9PSB1bmRlZikge1xuICAgICAgICAgICAgICAgIHJldHVybiBoYXNbbmFtZV07XG4gICAgICAgICAgICAgIH12YXIgaXNTdXBwb3J0ZWQ7aWYgKG5hbWUgPT0gXCJidWctc3RyaW5nLWNoYXItaW5kZXhcIikge1xuICAgICAgICAgICAgICAgIGlzU3VwcG9ydGVkID0gXCJhXCJbMF0gIT0gXCJhXCI7XG4gICAgICAgICAgICAgIH0gZWxzZSBpZiAobmFtZSA9PSBcImpzb25cIikge1xuICAgICAgICAgICAgICAgIGlzU3VwcG9ydGVkID0gaGFzKFwianNvbi1zdHJpbmdpZnlcIikgJiYgaGFzKFwianNvbi1wYXJzZVwiKTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWUsXG4gICAgICAgICAgICAgICAgICAgIHNlcmlhbGl6ZWQgPSBcIntcXFwiYVxcXCI6WzEsdHJ1ZSxmYWxzZSxudWxsLFxcXCJcXFxcdTAwMDBcXFxcYlxcXFxuXFxcXGZcXFxcclxcXFx0XFxcIl19XCI7aWYgKG5hbWUgPT0gXCJqc29uLXN0cmluZ2lmeVwiKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgc3RyaW5naWZ5ID0gZXhwb3J0cy5zdHJpbmdpZnksXG4gICAgICAgICAgICAgICAgICAgICAgc3RyaW5naWZ5U3VwcG9ydGVkID0gdHlwZW9mIHN0cmluZ2lmeSA9PSBcImZ1bmN0aW9uXCIgJiYgaXNFeHRlbmRlZDtpZiAoc3RyaW5naWZ5U3VwcG9ydGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICh2YWx1ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgICAgICAgICAgICAgfSkudG9KU09OID0gdmFsdWU7dHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICBzdHJpbmdpZnlTdXBwb3J0ZWQgPSBzdHJpbmdpZnkoMCkgPT09IFwiMFwiICYmIHN0cmluZ2lmeShuZXcgTnVtYmVyKCkpID09PSBcIjBcIiAmJiBzdHJpbmdpZnkobmV3IFN0cmluZygpKSA9PSAnXCJcIicgJiYgc3RyaW5naWZ5KGdldENsYXNzKSA9PT0gdW5kZWYgJiYgc3RyaW5naWZ5KHVuZGVmKSA9PT0gdW5kZWYgJiYgc3RyaW5naWZ5KCkgPT09IHVuZGVmICYmIHN0cmluZ2lmeSh2YWx1ZSkgPT09IFwiMVwiICYmIHN0cmluZ2lmeShbdmFsdWVdKSA9PSBcIlsxXVwiICYmIHN0cmluZ2lmeShbdW5kZWZdKSA9PSBcIltudWxsXVwiICYmIHN0cmluZ2lmeShudWxsKSA9PSBcIm51bGxcIiAmJiBzdHJpbmdpZnkoW3VuZGVmLCBnZXRDbGFzcywgbnVsbF0pID09IFwiW251bGwsbnVsbCxudWxsXVwiICYmIHN0cmluZ2lmeSh7IGE6IFt2YWx1ZSwgdHJ1ZSwgZmFsc2UsIG51bGwsIFwiXFx4MDBcXGJcXG5cXGZcXHJcdFwiXSB9KSA9PSBzZXJpYWxpemVkICYmIHN0cmluZ2lmeShudWxsLCB2YWx1ZSkgPT09IFwiMVwiICYmIHN0cmluZ2lmeShbMSwgMl0sIG51bGwsIDEpID09IFwiW1xcbiAxLFxcbiAyXFxuXVwiICYmIHN0cmluZ2lmeShuZXcgRGF0ZSgtODY0ZTEzKSkgPT0gJ1wiLTI3MTgyMS0wNC0yMFQwMDowMDowMC4wMDBaXCInICYmIHN0cmluZ2lmeShuZXcgRGF0ZSg4NjRlMTMpKSA9PSAnXCIrMjc1NzYwLTA5LTEzVDAwOjAwOjAwLjAwMFpcIicgJiYgc3RyaW5naWZ5KG5ldyBEYXRlKC02MjE5ODc1NTJlNSkpID09ICdcIi0wMDAwMDEtMDEtMDFUMDA6MDA6MDAuMDAwWlwiJyAmJiBzdHJpbmdpZnkobmV3IERhdGUoLTEpKSA9PSAnXCIxOTY5LTEyLTMxVDIzOjU5OjU5Ljk5OVpcIic7XG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGV4Y2VwdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgIHN0cmluZ2lmeVN1cHBvcnRlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9aXNTdXBwb3J0ZWQgPSBzdHJpbmdpZnlTdXBwb3J0ZWQ7XG4gICAgICAgICAgICAgICAgfWlmIChuYW1lID09IFwianNvbi1wYXJzZVwiKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgcGFyc2UgPSBleHBvcnRzLnBhcnNlO2lmICh0eXBlb2YgcGFyc2UgPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcnNlKFwiMFwiKSA9PT0gMCAmJiAhcGFyc2UoZmFsc2UpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHBhcnNlKHNlcmlhbGl6ZWQpO3ZhciBwYXJzZVN1cHBvcnRlZCA9IHZhbHVlW1wiYVwiXS5sZW5ndGggPT0gNSAmJiB2YWx1ZVtcImFcIl1bMF0gPT09IDE7aWYgKHBhcnNlU3VwcG9ydGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VTdXBwb3J0ZWQgPSAhcGFyc2UoJ1wiXHRcIicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChleGNlcHRpb24pIHt9aWYgKHBhcnNlU3VwcG9ydGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlU3VwcG9ydGVkID0gcGFyc2UoXCIwMVwiKSAhPT0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChleGNlcHRpb24pIHt9XG4gICAgICAgICAgICAgICAgICAgICAgICAgIH1pZiAocGFyc2VTdXBwb3J0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VTdXBwb3J0ZWQgPSBwYXJzZShcIjEuXCIpICE9PSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGV4Y2VwdGlvbikge31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXhjZXB0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgcGFyc2VTdXBwb3J0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfWlzU3VwcG9ydGVkID0gcGFyc2VTdXBwb3J0ZWQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9cmV0dXJuIGhhc1tuYW1lXSA9ICEhaXNTdXBwb3J0ZWQ7XG4gICAgICAgICAgICB9aWYgKCFoYXMoXCJqc29uXCIpKSB7XG4gICAgICAgICAgICAgIHZhciBmdW5jdGlvbkNsYXNzID0gXCJbb2JqZWN0IEZ1bmN0aW9uXVwiLFxuICAgICAgICAgICAgICAgICAgZGF0ZUNsYXNzID0gXCJbb2JqZWN0IERhdGVdXCIsXG4gICAgICAgICAgICAgICAgICBudW1iZXJDbGFzcyA9IFwiW29iamVjdCBOdW1iZXJdXCIsXG4gICAgICAgICAgICAgICAgICBzdHJpbmdDbGFzcyA9IFwiW29iamVjdCBTdHJpbmddXCIsXG4gICAgICAgICAgICAgICAgICBhcnJheUNsYXNzID0gXCJbb2JqZWN0IEFycmF5XVwiLFxuICAgICAgICAgICAgICAgICAgYm9vbGVhbkNsYXNzID0gXCJbb2JqZWN0IEJvb2xlYW5dXCI7dmFyIGNoYXJJbmRleEJ1Z2d5ID0gaGFzKFwiYnVnLXN0cmluZy1jaGFyLWluZGV4XCIpO2lmICghaXNFeHRlbmRlZCkge1xuICAgICAgICAgICAgICAgIHZhciBmbG9vciA9IE1hdGguZmxvb3I7dmFyIE1vbnRocyA9IFswLCAzMSwgNTksIDkwLCAxMjAsIDE1MSwgMTgxLCAyMTIsIDI0MywgMjczLCAzMDQsIDMzNF07dmFyIGdldERheSA9IGZ1bmN0aW9uIGdldERheSh5ZWFyLCBtb250aCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIE1vbnRoc1ttb250aF0gKyAzNjUgKiAoeWVhciAtIDE5NzApICsgZmxvb3IoKHllYXIgLSAxOTY5ICsgKG1vbnRoID0gKyhtb250aCA+IDEpKSkgLyA0KSAtIGZsb29yKCh5ZWFyIC0gMTkwMSArIG1vbnRoKSAvIDEwMCkgKyBmbG9vcigoeWVhciAtIDE2MDEgKyBtb250aCkgLyA0MDApO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgIH1pZiAoIShpc1Byb3BlcnR5ID0gb2JqZWN0UHJvdG8uaGFzT3duUHJvcGVydHkpKSB7XG4gICAgICAgICAgICAgICAgaXNQcm9wZXJ0eSA9IGZ1bmN0aW9uIChwcm9wZXJ0eSkge1xuICAgICAgICAgICAgICAgICAgdmFyIG1lbWJlcnMgPSB7fSxcbiAgICAgICAgICAgICAgICAgICAgICBjb25zdHJ1Y3RvcjtpZiAoKG1lbWJlcnMuX19wcm90b19fID0gbnVsbCwgbWVtYmVycy5fX3Byb3RvX18gPSB7IHRvU3RyaW5nOiAxIH0sIG1lbWJlcnMpLnRvU3RyaW5nICE9IGdldENsYXNzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlzUHJvcGVydHkgPSBmdW5jdGlvbiAocHJvcGVydHkpIHtcbiAgICAgICAgICAgICAgICAgICAgICB2YXIgb3JpZ2luYWwgPSB0aGlzLl9fcHJvdG9fXyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gKHByb3BlcnR5IGluICh0aGlzLl9fcHJvdG9fXyA9IG51bGwsIHRoaXMpKTt0aGlzLl9fcHJvdG9fXyA9IG9yaWdpbmFsO3JldHVybiByZXN1bHQ7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjb25zdHJ1Y3RvciA9IG1lbWJlcnMuY29uc3RydWN0b3I7aXNQcm9wZXJ0eSA9IGZ1bmN0aW9uIChwcm9wZXJ0eSkge1xuICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXJlbnQgPSAodGhpcy5jb25zdHJ1Y3RvciB8fCBjb25zdHJ1Y3RvcikucHJvdG90eXBlO3JldHVybiBwcm9wZXJ0eSBpbiB0aGlzICYmICEocHJvcGVydHkgaW4gcGFyZW50ICYmIHRoaXNbcHJvcGVydHldID09PSBwYXJlbnRbcHJvcGVydHldKTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgIH1tZW1iZXJzID0gbnVsbDtyZXR1cm4gaXNQcm9wZXJ0eS5jYWxsKHRoaXMsIHByb3BlcnR5KTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICB9Zm9yRWFjaCA9IGZ1bmN0aW9uIChvYmplY3QsIGNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNpemUgPSAwLFxuICAgICAgICAgICAgICAgICAgICBQcm9wZXJ0aWVzLFxuICAgICAgICAgICAgICAgICAgICBtZW1iZXJzLFxuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eTsoUHJvcGVydGllcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgIHRoaXMudmFsdWVPZiA9IDA7XG4gICAgICAgICAgICAgICAgfSkucHJvdG90eXBlLnZhbHVlT2YgPSAwO21lbWJlcnMgPSBuZXcgUHJvcGVydGllcygpO2ZvciAocHJvcGVydHkgaW4gbWVtYmVycykge1xuICAgICAgICAgICAgICAgICAgaWYgKGlzUHJvcGVydHkuY2FsbChtZW1iZXJzLCBwcm9wZXJ0eSkpIHtcbiAgICAgICAgICAgICAgICAgICAgc2l6ZSsrO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1Qcm9wZXJ0aWVzID0gbWVtYmVycyA9IG51bGw7aWYgKCFzaXplKSB7XG4gICAgICAgICAgICAgICAgICBtZW1iZXJzID0gW1widmFsdWVPZlwiLCBcInRvU3RyaW5nXCIsIFwidG9Mb2NhbGVTdHJpbmdcIiwgXCJwcm9wZXJ0eUlzRW51bWVyYWJsZVwiLCBcImlzUHJvdG90eXBlT2ZcIiwgXCJoYXNPd25Qcm9wZXJ0eVwiLCBcImNvbnN0cnVjdG9yXCJdO2ZvckVhY2ggPSBmdW5jdGlvbiAob2JqZWN0LCBjYWxsYmFjaykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaXNGdW5jdGlvbiA9IGdldENsYXNzLmNhbGwob2JqZWN0KSA9PSBmdW5jdGlvbkNsYXNzLFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydHksXG4gICAgICAgICAgICAgICAgICAgICAgICBsZW5ndGg7dmFyIGhhc1Byb3BlcnR5ID0gIWlzRnVuY3Rpb24gJiYgdHlwZW9mIG9iamVjdC5jb25zdHJ1Y3RvciAhPSBcImZ1bmN0aW9uXCIgJiYgb2JqZWN0VHlwZXNbdHlwZW9mIG9iamVjdC5oYXNPd25Qcm9wZXJ0eV0gJiYgb2JqZWN0Lmhhc093blByb3BlcnR5IHx8IGlzUHJvcGVydHk7Zm9yIChwcm9wZXJ0eSBpbiBvYmplY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICBpZiAoIShpc0Z1bmN0aW9uICYmIHByb3BlcnR5ID09IFwicHJvdG90eXBlXCIpICYmIGhhc1Byb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKHByb3BlcnR5KTtcbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1mb3IgKGxlbmd0aCA9IG1lbWJlcnMubGVuZ3RoOyBwcm9wZXJ0eSA9IG1lbWJlcnNbLS1sZW5ndGhdOyBoYXNQcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpICYmIGNhbGxiYWNrKHByb3BlcnR5KSk7XG4gICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc2l6ZSA9PSAyKSB7XG4gICAgICAgICAgICAgICAgICBmb3JFYWNoID0gZnVuY3Rpb24gKG9iamVjdCwgY2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1lbWJlcnMgPSB7fSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzRnVuY3Rpb24gPSBnZXRDbGFzcy5jYWxsKG9iamVjdCkgPT0gZnVuY3Rpb25DbGFzcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnR5O2ZvciAocHJvcGVydHkgaW4gb2JqZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgaWYgKCEoaXNGdW5jdGlvbiAmJiBwcm9wZXJ0eSA9PSBcInByb3RvdHlwZVwiKSAmJiAhaXNQcm9wZXJ0eS5jYWxsKG1lbWJlcnMsIHByb3BlcnR5KSAmJiAobWVtYmVyc1twcm9wZXJ0eV0gPSAxKSAmJiBpc1Byb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKHByb3BlcnR5KTtcbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIGZvckVhY2ggPSBmdW5jdGlvbiAob2JqZWN0LCBjYWxsYmFjaykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaXNGdW5jdGlvbiA9IGdldENsYXNzLmNhbGwob2JqZWN0KSA9PSBmdW5jdGlvbkNsYXNzLFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydHksXG4gICAgICAgICAgICAgICAgICAgICAgICBpc0NvbnN0cnVjdG9yO2ZvciAocHJvcGVydHkgaW4gb2JqZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgaWYgKCEoaXNGdW5jdGlvbiAmJiBwcm9wZXJ0eSA9PSBcInByb3RvdHlwZVwiKSAmJiBpc1Byb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSkgJiYgIShpc0NvbnN0cnVjdG9yID0gcHJvcGVydHkgPT09IFwiY29uc3RydWN0b3JcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKHByb3BlcnR5KTtcbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1pZiAoaXNDb25zdHJ1Y3RvciB8fCBpc1Byb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSA9IFwiY29uc3RydWN0b3JcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhwcm9wZXJ0eSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfXJldHVybiBmb3JFYWNoKG9iamVjdCwgY2FsbGJhY2spO1xuICAgICAgICAgICAgICB9O2lmICghaGFzKFwianNvbi1zdHJpbmdpZnlcIikpIHtcbiAgICAgICAgICAgICAgICB2YXIgRXNjYXBlcyA9IHsgOTI6IFwiXFxcXFxcXFxcIiwgMzQ6ICdcXFxcXCInLCA4OiBcIlxcXFxiXCIsIDEyOiBcIlxcXFxmXCIsIDEwOiBcIlxcXFxuXCIsIDEzOiBcIlxcXFxyXCIsIDk6IFwiXFxcXHRcIiB9O3ZhciBsZWFkaW5nWmVyb2VzID0gXCIwMDAwMDBcIjt2YXIgdG9QYWRkZWRTdHJpbmcgPSBmdW5jdGlvbiB0b1BhZGRlZFN0cmluZyh3aWR0aCwgdmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiAobGVhZGluZ1plcm9lcyArICh2YWx1ZSB8fCAwKSkuc2xpY2UoLXdpZHRoKTtcbiAgICAgICAgICAgICAgICB9O3ZhciB1bmljb2RlUHJlZml4ID0gXCJcXFxcdTAwXCI7dmFyIHF1b3RlID0gZnVuY3Rpb24gcXVvdGUodmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSAnXCInLFxuICAgICAgICAgICAgICAgICAgICAgIGluZGV4ID0gMCxcbiAgICAgICAgICAgICAgICAgICAgICBsZW5ndGggPSB2YWx1ZS5sZW5ndGgsXG4gICAgICAgICAgICAgICAgICAgICAgdXNlQ2hhckluZGV4ID0gIWNoYXJJbmRleEJ1Z2d5IHx8IGxlbmd0aCA+IDEwO3ZhciBzeW1ib2xzID0gdXNlQ2hhckluZGV4ICYmIChjaGFySW5kZXhCdWdneSA/IHZhbHVlLnNwbGl0KFwiXCIpIDogdmFsdWUpO2ZvciAoOyBpbmRleCA8IGxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY2hhckNvZGUgPSB2YWx1ZS5jaGFyQ29kZUF0KGluZGV4KTtzd2l0Y2ggKGNoYXJDb2RlKSB7Y2FzZSA4OmNhc2UgOTpjYXNlIDEwOmNhc2UgMTI6Y2FzZSAxMzpjYXNlIDM0OmNhc2UgOTI6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgKz0gRXNjYXBlc1tjaGFyQ29kZV07YnJlYWs7ZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjaGFyQ29kZSA8IDMyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSB1bmljb2RlUHJlZml4ICsgdG9QYWRkZWRTdHJpbmcoMiwgY2hhckNvZGUudG9TdHJpbmcoMTYpKTticmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1yZXN1bHQgKz0gdXNlQ2hhckluZGV4ID8gc3ltYm9sc1tpbmRleF0gOiB2YWx1ZS5jaGFyQXQoaW5kZXgpO31cbiAgICAgICAgICAgICAgICAgIH1yZXR1cm4gcmVzdWx0ICsgJ1wiJztcbiAgICAgICAgICAgICAgICB9O3ZhciBzZXJpYWxpemUgPSBmdW5jdGlvbiBzZXJpYWxpemUocHJvcGVydHksIG9iamVjdCwgY2FsbGJhY2ssIHByb3BlcnRpZXMsIHdoaXRlc3BhY2UsIGluZGVudGF0aW9uLCBzdGFjaykge1xuICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlLCBjbGFzc05hbWUsIHllYXIsIG1vbnRoLCBkYXRlLCB0aW1lLCBob3VycywgbWludXRlcywgc2Vjb25kcywgbWlsbGlzZWNvbmRzLCByZXN1bHRzLCBlbGVtZW50LCBpbmRleCwgbGVuZ3RoLCBwcmVmaXgsIHJlc3VsdDt0cnkge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IG9iamVjdFtwcm9wZXJ0eV07XG4gICAgICAgICAgICAgICAgICB9IGNhdGNoIChleGNlcHRpb24pIHt9aWYgKHR5cGVvZiB2YWx1ZSA9PSBcIm9iamVjdFwiICYmIHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZSA9IGdldENsYXNzLmNhbGwodmFsdWUpO2lmIChjbGFzc05hbWUgPT0gZGF0ZUNsYXNzICYmICFpc1Byb3BlcnR5LmNhbGwodmFsdWUsIFwidG9KU09OXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlID4gLTEgLyAwICYmIHZhbHVlIDwgMSAvIDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnZXREYXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZSA9IGZsb29yKHZhbHVlIC8gODY0ZTUpO2ZvciAoeWVhciA9IGZsb29yKGRhdGUgLyAzNjUuMjQyNSkgKyAxOTcwIC0gMTsgZ2V0RGF5KHllYXIgKyAxLCAwKSA8PSBkYXRlOyB5ZWFyKyspO2ZvciAobW9udGggPSBmbG9vcigoZGF0ZSAtIGdldERheSh5ZWFyLCAwKSkgLyAzMC40Mik7IGdldERheSh5ZWFyLCBtb250aCArIDEpIDw9IGRhdGU7IG1vbnRoKyspO2RhdGUgPSAxICsgZGF0ZSAtIGdldERheSh5ZWFyLCBtb250aCk7dGltZSA9ICh2YWx1ZSAlIDg2NGU1ICsgODY0ZTUpICUgODY0ZTU7aG91cnMgPSBmbG9vcih0aW1lIC8gMzZlNSkgJSAyNDttaW51dGVzID0gZmxvb3IodGltZSAvIDZlNCkgJSA2MDtzZWNvbmRzID0gZmxvb3IodGltZSAvIDFlMykgJSA2MDttaWxsaXNlY29uZHMgPSB0aW1lICUgMWUzO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgeWVhciA9IHZhbHVlLmdldFVUQ0Z1bGxZZWFyKCk7bW9udGggPSB2YWx1ZS5nZXRVVENNb250aCgpO2RhdGUgPSB2YWx1ZS5nZXRVVENEYXRlKCk7aG91cnMgPSB2YWx1ZS5nZXRVVENIb3VycygpO21pbnV0ZXMgPSB2YWx1ZS5nZXRVVENNaW51dGVzKCk7c2Vjb25kcyA9IHZhbHVlLmdldFVUQ1NlY29uZHMoKTttaWxsaXNlY29uZHMgPSB2YWx1ZS5nZXRVVENNaWxsaXNlY29uZHMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH12YWx1ZSA9ICh5ZWFyIDw9IDAgfHwgeWVhciA+PSAxZTQgPyAoeWVhciA8IDAgPyBcIi1cIiA6IFwiK1wiKSArIHRvUGFkZGVkU3RyaW5nKDYsIHllYXIgPCAwID8gLXllYXIgOiB5ZWFyKSA6IHRvUGFkZGVkU3RyaW5nKDQsIHllYXIpKSArIFwiLVwiICsgdG9QYWRkZWRTdHJpbmcoMiwgbW9udGggKyAxKSArIFwiLVwiICsgdG9QYWRkZWRTdHJpbmcoMiwgZGF0ZSkgKyBcIlRcIiArIHRvUGFkZGVkU3RyaW5nKDIsIGhvdXJzKSArIFwiOlwiICsgdG9QYWRkZWRTdHJpbmcoMiwgbWludXRlcykgKyBcIjpcIiArIHRvUGFkZGVkU3RyaW5nKDIsIHNlY29uZHMpICsgXCIuXCIgKyB0b1BhZGRlZFN0cmluZygzLCBtaWxsaXNlY29uZHMpICsgXCJaXCI7XG4gICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHZhbHVlLnRvSlNPTiA9PSBcImZ1bmN0aW9uXCIgJiYgKGNsYXNzTmFtZSAhPSBudW1iZXJDbGFzcyAmJiBjbGFzc05hbWUgIT0gc3RyaW5nQ2xhc3MgJiYgY2xhc3NOYW1lICE9IGFycmF5Q2xhc3MgfHwgaXNQcm9wZXJ0eS5jYWxsKHZhbHVlLCBcInRvSlNPTlwiKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlLnRvSlNPTihwcm9wZXJ0eSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1pZiAoY2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBjYWxsYmFjay5jYWxsKG9iamVjdCwgcHJvcGVydHksIHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgIH1pZiAodmFsdWUgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwibnVsbFwiO1xuICAgICAgICAgICAgICAgICAgfWNsYXNzTmFtZSA9IGdldENsYXNzLmNhbGwodmFsdWUpO2lmIChjbGFzc05hbWUgPT0gYm9vbGVhbkNsYXNzKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBcIlwiICsgdmFsdWU7XG4gICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNsYXNzTmFtZSA9PSBudW1iZXJDbGFzcykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWUgPiAtMSAvIDAgJiYgdmFsdWUgPCAxIC8gMCA/IFwiXCIgKyB2YWx1ZSA6IFwibnVsbFwiO1xuICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjbGFzc05hbWUgPT0gc3RyaW5nQ2xhc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHF1b3RlKFwiXCIgKyB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICB9aWYgKHR5cGVvZiB2YWx1ZSA9PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAobGVuZ3RoID0gc3RhY2subGVuZ3RoOyBsZW5ndGgtLTspIHtcbiAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RhY2tbbGVuZ3RoXSA9PT0gdmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IFR5cGVFcnJvcigpO1xuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfXN0YWNrLnB1c2godmFsdWUpO3Jlc3VsdHMgPSBbXTtwcmVmaXggPSBpbmRlbnRhdGlvbjtpbmRlbnRhdGlvbiArPSB3aGl0ZXNwYWNlO2lmIChjbGFzc05hbWUgPT0gYXJyYXlDbGFzcykge1xuICAgICAgICAgICAgICAgICAgICAgIGZvciAoaW5kZXggPSAwLCBsZW5ndGggPSB2YWx1ZS5sZW5ndGg7IGluZGV4IDwgbGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50ID0gc2VyaWFsaXplKGluZGV4LCB2YWx1ZSwgY2FsbGJhY2ssIHByb3BlcnRpZXMsIHdoaXRlc3BhY2UsIGluZGVudGF0aW9uLCBzdGFjayk7cmVzdWx0cy5wdXNoKGVsZW1lbnQgPT09IHVuZGVmID8gXCJudWxsXCIgOiBlbGVtZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICB9cmVzdWx0ID0gcmVzdWx0cy5sZW5ndGggPyB3aGl0ZXNwYWNlID8gXCJbXFxuXCIgKyBpbmRlbnRhdGlvbiArIHJlc3VsdHMuam9pbihcIixcXG5cIiArIGluZGVudGF0aW9uKSArIFwiXFxuXCIgKyBwcmVmaXggKyBcIl1cIiA6IFwiW1wiICsgcmVzdWx0cy5qb2luKFwiLFwiKSArIFwiXVwiIDogXCJbXVwiO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgIGZvckVhY2gocHJvcGVydGllcyB8fCB2YWx1ZSwgZnVuY3Rpb24gKHByb3BlcnR5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbWVudCA9IHNlcmlhbGl6ZShwcm9wZXJ0eSwgdmFsdWUsIGNhbGxiYWNrLCBwcm9wZXJ0aWVzLCB3aGl0ZXNwYWNlLCBpbmRlbnRhdGlvbiwgc3RhY2spO2lmIChlbGVtZW50ICE9PSB1bmRlZikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRzLnB1c2gocXVvdGUocHJvcGVydHkpICsgXCI6XCIgKyAod2hpdGVzcGFjZSA/IFwiIFwiIDogXCJcIikgKyBlbGVtZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICB9KTtyZXN1bHQgPSByZXN1bHRzLmxlbmd0aCA/IHdoaXRlc3BhY2UgPyBcIntcXG5cIiArIGluZGVudGF0aW9uICsgcmVzdWx0cy5qb2luKFwiLFxcblwiICsgaW5kZW50YXRpb24pICsgXCJcXG5cIiArIHByZWZpeCArIFwifVwiIDogXCJ7XCIgKyByZXN1bHRzLmpvaW4oXCIsXCIpICsgXCJ9XCIgOiBcInt9XCI7XG4gICAgICAgICAgICAgICAgICAgIH1zdGFjay5wb3AoKTtyZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07ZXhwb3J0cy5zdHJpbmdpZnkgPSBmdW5jdGlvbiAoc291cmNlLCBmaWx0ZXIsIHdpZHRoKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgd2hpdGVzcGFjZSwgY2FsbGJhY2ssIHByb3BlcnRpZXMsIGNsYXNzTmFtZTtpZiAob2JqZWN0VHlwZXNbdHlwZW9mIGZpbHRlcl0gJiYgZmlsdGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgoY2xhc3NOYW1lID0gZ2V0Q2xhc3MuY2FsbChmaWx0ZXIpKSA9PSBmdW5jdGlvbkNsYXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2sgPSBmaWx0ZXI7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY2xhc3NOYW1lID09IGFycmF5Q2xhc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzID0ge307Zm9yICh2YXIgaW5kZXggPSAwLCBsZW5ndGggPSBmaWx0ZXIubGVuZ3RoLCB2YWx1ZTsgaW5kZXggPCBsZW5ndGg7IHZhbHVlID0gZmlsdGVyW2luZGV4KytdLCAoY2xhc3NOYW1lID0gZ2V0Q2xhc3MuY2FsbCh2YWx1ZSksIGNsYXNzTmFtZSA9PSBzdHJpbmdDbGFzcyB8fCBjbGFzc05hbWUgPT0gbnVtYmVyQ2xhc3MpICYmIChwcm9wZXJ0aWVzW3ZhbHVlXSA9IDEpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfWlmICh3aWR0aCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoKGNsYXNzTmFtZSA9IGdldENsYXNzLmNhbGwod2lkdGgpKSA9PSBudW1iZXJDbGFzcykge1xuICAgICAgICAgICAgICAgICAgICAgIGlmICgod2lkdGggLT0gd2lkdGggJSAxKSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAod2hpdGVzcGFjZSA9IFwiXCIsIHdpZHRoID4gMTAgJiYgKHdpZHRoID0gMTApOyB3aGl0ZXNwYWNlLmxlbmd0aCA8IHdpZHRoOyB3aGl0ZXNwYWNlICs9IFwiIFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY2xhc3NOYW1lID09IHN0cmluZ0NsYXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgd2hpdGVzcGFjZSA9IHdpZHRoLmxlbmd0aCA8PSAxMCA/IHdpZHRoIDogd2lkdGguc2xpY2UoMCwgMTApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9cmV0dXJuIHNlcmlhbGl6ZShcIlwiLCAodmFsdWUgPSB7fSwgdmFsdWVbXCJcIl0gPSBzb3VyY2UsIHZhbHVlKSwgY2FsbGJhY2ssIHByb3BlcnRpZXMsIHdoaXRlc3BhY2UsIFwiXCIsIFtdKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICB9aWYgKCFoYXMoXCJqc29uLXBhcnNlXCIpKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZyb21DaGFyQ29kZSA9IFN0cmluZy5mcm9tQ2hhckNvZGU7dmFyIFVuZXNjYXBlcyA9IHsgOTI6IFwiXFxcXFwiLCAzNDogJ1wiJywgNDc6IFwiL1wiLCA5ODogXCJcXGJcIiwgMTE2OiBcIlx0XCIsIDExMDogXCJcXG5cIiwgMTAyOiBcIlxcZlwiLCAxMTQ6IFwiXFxyXCIgfTt2YXIgSW5kZXgsIFNvdXJjZTt2YXIgYWJvcnQgPSBmdW5jdGlvbiBhYm9ydCgpIHtcbiAgICAgICAgICAgICAgICAgIEluZGV4ID0gU291cmNlID0gbnVsbDt0aHJvdyBTeW50YXhFcnJvcigpO1xuICAgICAgICAgICAgICAgIH07dmFyIGxleCA9IGZ1bmN0aW9uIGxleCgpIHtcbiAgICAgICAgICAgICAgICAgIHZhciBzb3VyY2UgPSBTb3VyY2UsXG4gICAgICAgICAgICAgICAgICAgICAgbGVuZ3RoID0gc291cmNlLmxlbmd0aCxcbiAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgICBiZWdpbixcbiAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbixcbiAgICAgICAgICAgICAgICAgICAgICBpc1NpZ25lZCxcbiAgICAgICAgICAgICAgICAgICAgICBjaGFyQ29kZTt3aGlsZSAoSW5kZXggPCBsZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgY2hhckNvZGUgPSBzb3VyY2UuY2hhckNvZGVBdChJbmRleCk7c3dpdGNoIChjaGFyQ29kZSkge2Nhc2UgOTpjYXNlIDEwOmNhc2UgMTM6Y2FzZSAzMjpcbiAgICAgICAgICAgICAgICAgICAgICAgIEluZGV4Kys7YnJlYWs7Y2FzZSAxMjM6Y2FzZSAxMjU6Y2FzZSA5MTpjYXNlIDkzOmNhc2UgNTg6Y2FzZSA0NDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gY2hhckluZGV4QnVnZ3kgPyBzb3VyY2UuY2hhckF0KEluZGV4KSA6IHNvdXJjZVtJbmRleF07SW5kZXgrKztyZXR1cm4gdmFsdWU7Y2FzZSAzNDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFsdWUgPSBcIkBcIiwgSW5kZXgrKzsgSW5kZXggPCBsZW5ndGg7KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGNoYXJDb2RlID0gc291cmNlLmNoYXJDb2RlQXQoSW5kZXgpO2lmIChjaGFyQ29kZSA8IDMyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWJvcnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjaGFyQ29kZSA9PSA5Mikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYXJDb2RlID0gc291cmNlLmNoYXJDb2RlQXQoKytJbmRleCk7c3dpdGNoIChjaGFyQ29kZSkge2Nhc2UgOTI6Y2FzZSAzNDpjYXNlIDQ3OmNhc2UgOTg6Y2FzZSAxMTY6Y2FzZSAxMTA6Y2FzZSAxMDI6Y2FzZSAxMTQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlICs9IFVuZXNjYXBlc1tjaGFyQ29kZV07SW5kZXgrKzticmVhaztjYXNlIDExNzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmVnaW4gPSArK0luZGV4O2ZvciAocG9zaXRpb24gPSBJbmRleCArIDQ7IEluZGV4IDwgcG9zaXRpb247IEluZGV4KyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFyQ29kZSA9IHNvdXJjZS5jaGFyQ29kZUF0KEluZGV4KTtpZiAoIShjaGFyQ29kZSA+PSA0OCAmJiBjaGFyQ29kZSA8PSA1NyB8fCBjaGFyQ29kZSA+PSA5NyAmJiBjaGFyQ29kZSA8PSAxMDIgfHwgY2hhckNvZGUgPj0gNjUgJiYgY2hhckNvZGUgPD0gNzApKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhYm9ydCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfXZhbHVlICs9IGZyb21DaGFyQ29kZShcIjB4XCIgKyBzb3VyY2Uuc2xpY2UoYmVnaW4sIEluZGV4KSk7YnJlYWs7ZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWJvcnQoKTt9XG4gICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNoYXJDb2RlID09IDM0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9Y2hhckNvZGUgPSBzb3VyY2UuY2hhckNvZGVBdChJbmRleCk7YmVnaW4gPSBJbmRleDt3aGlsZSAoY2hhckNvZGUgPj0gMzIgJiYgY2hhckNvZGUgIT0gOTIgJiYgY2hhckNvZGUgIT0gMzQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYXJDb2RlID0gc291cmNlLmNoYXJDb2RlQXQoKytJbmRleCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfXZhbHVlICs9IHNvdXJjZS5zbGljZShiZWdpbiwgSW5kZXgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9aWYgKHNvdXJjZS5jaGFyQ29kZUF0KEluZGV4KSA9PSAzNCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBJbmRleCsrO3JldHVybiB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1hYm9ydCgpO2RlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBiZWdpbiA9IEluZGV4O2lmIChjaGFyQ29kZSA9PSA0NSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBpc1NpZ25lZCA9IHRydWU7Y2hhckNvZGUgPSBzb3VyY2UuY2hhckNvZGVBdCgrK0luZGV4KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1pZiAoY2hhckNvZGUgPj0gNDggJiYgY2hhckNvZGUgPD0gNTcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNoYXJDb2RlID09IDQ4ICYmIChjaGFyQ29kZSA9IHNvdXJjZS5jaGFyQ29kZUF0KEluZGV4ICsgMSksIGNoYXJDb2RlID49IDQ4ICYmIGNoYXJDb2RlIDw9IDU3KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFib3J0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIH1pc1NpZ25lZCA9IGZhbHNlO2ZvciAoOyBJbmRleCA8IGxlbmd0aCAmJiAoY2hhckNvZGUgPSBzb3VyY2UuY2hhckNvZGVBdChJbmRleCksIGNoYXJDb2RlID49IDQ4ICYmIGNoYXJDb2RlIDw9IDU3KTsgSW5kZXgrKyk7aWYgKHNvdXJjZS5jaGFyQ29kZUF0KEluZGV4KSA9PSA0Nikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uID0gKytJbmRleDtmb3IgKDsgcG9zaXRpb24gPCBsZW5ndGggJiYgKGNoYXJDb2RlID0gc291cmNlLmNoYXJDb2RlQXQocG9zaXRpb24pLCBjaGFyQ29kZSA+PSA0OCAmJiBjaGFyQ29kZSA8PSA1Nyk7IHBvc2l0aW9uKyspO2lmIChwb3NpdGlvbiA9PSBJbmRleCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWJvcnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9SW5kZXggPSBwb3NpdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfWNoYXJDb2RlID0gc291cmNlLmNoYXJDb2RlQXQoSW5kZXgpO2lmIChjaGFyQ29kZSA9PSAxMDEgfHwgY2hhckNvZGUgPT0gNjkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFyQ29kZSA9IHNvdXJjZS5jaGFyQ29kZUF0KCsrSW5kZXgpO2lmIChjaGFyQ29kZSA9PSA0MyB8fCBjaGFyQ29kZSA9PSA0NSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSW5kZXgrKztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9Zm9yIChwb3NpdGlvbiA9IEluZGV4OyBwb3NpdGlvbiA8IGxlbmd0aCAmJiAoY2hhckNvZGUgPSBzb3VyY2UuY2hhckNvZGVBdChwb3NpdGlvbiksIGNoYXJDb2RlID49IDQ4ICYmIGNoYXJDb2RlIDw9IDU3KTsgcG9zaXRpb24rKyk7aWYgKHBvc2l0aW9uID09IEluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhYm9ydCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1JbmRleCA9IHBvc2l0aW9uO1xuICAgICAgICAgICAgICAgICAgICAgICAgICB9cmV0dXJuICtzb3VyY2Uuc2xpY2UoYmVnaW4sIEluZGV4KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1pZiAoaXNTaWduZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgYWJvcnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1pZiAoc291cmNlLnNsaWNlKEluZGV4LCBJbmRleCArIDQpID09IFwidHJ1ZVwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIEluZGV4ICs9IDQ7cmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHNvdXJjZS5zbGljZShJbmRleCwgSW5kZXggKyA1KSA9PSBcImZhbHNlXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgSW5kZXggKz0gNTtyZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHNvdXJjZS5zbGljZShJbmRleCwgSW5kZXggKyA0KSA9PSBcIm51bGxcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBJbmRleCArPSA0O3JldHVybiBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgfWFib3J0KCk7fVxuICAgICAgICAgICAgICAgICAgfXJldHVybiBcIiRcIjtcbiAgICAgICAgICAgICAgICB9O3ZhciBnZXQgPSBmdW5jdGlvbiBnZXQodmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgIHZhciByZXN1bHRzLCBoYXNNZW1iZXJzO2lmICh2YWx1ZSA9PSBcIiRcIikge1xuICAgICAgICAgICAgICAgICAgICBhYm9ydCgpO1xuICAgICAgICAgICAgICAgICAgfWlmICh0eXBlb2YgdmFsdWUgPT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICAgICAgICBpZiAoKGNoYXJJbmRleEJ1Z2d5ID8gdmFsdWUuY2hhckF0KDApIDogdmFsdWVbMF0pID09IFwiQFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlLnNsaWNlKDEpO1xuICAgICAgICAgICAgICAgICAgICB9aWYgKHZhbHVlID09IFwiW1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgcmVzdWx0cyA9IFtdO2ZvciAoOzsgaGFzTWVtYmVycyB8fCAoaGFzTWVtYmVycyA9IHRydWUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IGxleCgpO2lmICh2YWx1ZSA9PSBcIl1cIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1pZiAoaGFzTWVtYmVycykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUgPT0gXCIsXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IGxleCgpO2lmICh2YWx1ZSA9PSBcIl1cIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWJvcnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWJvcnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfWlmICh2YWx1ZSA9PSBcIixcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBhYm9ydCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfXJlc3VsdHMucHVzaChnZXQodmFsdWUpKTtcbiAgICAgICAgICAgICAgICAgICAgICB9cmV0dXJuIHJlc3VsdHM7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodmFsdWUgPT0gXCJ7XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICByZXN1bHRzID0ge307Zm9yICg7OyBoYXNNZW1iZXJzIHx8IChoYXNNZW1iZXJzID0gdHJ1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gbGV4KCk7aWYgKHZhbHVlID09IFwifVwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfWlmIChoYXNNZW1iZXJzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA9PSBcIixcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gbGV4KCk7aWYgKHZhbHVlID09IFwifVwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhYm9ydCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhYm9ydCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9aWYgKHZhbHVlID09IFwiLFwiIHx8IHR5cGVvZiB2YWx1ZSAhPSBcInN0cmluZ1wiIHx8IChjaGFySW5kZXhCdWdneSA/IHZhbHVlLmNoYXJBdCgwKSA6IHZhbHVlWzBdKSAhPSBcIkBcIiB8fCBsZXgoKSAhPSBcIjpcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBhYm9ydCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfXJlc3VsdHNbdmFsdWUuc2xpY2UoMSldID0gZ2V0KGxleCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICB9cmV0dXJuIHJlc3VsdHM7XG4gICAgICAgICAgICAgICAgICAgIH1hYm9ydCgpO1xuICAgICAgICAgICAgICAgICAgfXJldHVybiB2YWx1ZTtcbiAgICAgICAgICAgICAgICB9O3ZhciB1cGRhdGUgPSBmdW5jdGlvbiB1cGRhdGUoc291cmNlLCBwcm9wZXJ0eSwgY2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICAgIHZhciBlbGVtZW50ID0gd2Fsayhzb3VyY2UsIHByb3BlcnR5LCBjYWxsYmFjayk7aWYgKGVsZW1lbnQgPT09IHVuZGVmKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBzb3VyY2VbcHJvcGVydHldO1xuICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc291cmNlW3Byb3BlcnR5XSA9IGVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTt2YXIgd2FsayA9IGZ1bmN0aW9uIHdhbGsoc291cmNlLCBwcm9wZXJ0eSwgY2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IHNvdXJjZVtwcm9wZXJ0eV0sXG4gICAgICAgICAgICAgICAgICAgICAgbGVuZ3RoO2lmICh0eXBlb2YgdmFsdWUgPT0gXCJvYmplY3RcIiAmJiB2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZ2V0Q2xhc3MuY2FsbCh2YWx1ZSkgPT0gYXJyYXlDbGFzcykge1xuICAgICAgICAgICAgICAgICAgICAgIGZvciAobGVuZ3RoID0gdmFsdWUubGVuZ3RoOyBsZW5ndGgtLTspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZSh2YWx1ZSwgbGVuZ3RoLCBjYWxsYmFjayk7XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgIGZvckVhY2godmFsdWUsIGZ1bmN0aW9uIChwcm9wZXJ0eSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlKHZhbHVlLCBwcm9wZXJ0eSwgY2FsbGJhY2spO1xuICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9cmV0dXJuIGNhbGxiYWNrLmNhbGwoc291cmNlLCBwcm9wZXJ0eSwgdmFsdWUpO1xuICAgICAgICAgICAgICAgIH07ZXhwb3J0cy5wYXJzZSA9IGZ1bmN0aW9uIChzb3VyY2UsIGNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0LCB2YWx1ZTtJbmRleCA9IDA7U291cmNlID0gXCJcIiArIHNvdXJjZTtyZXN1bHQgPSBnZXQobGV4KCkpO2lmIChsZXgoKSAhPSBcIiRcIikge1xuICAgICAgICAgICAgICAgICAgICBhYm9ydCgpO1xuICAgICAgICAgICAgICAgICAgfUluZGV4ID0gU291cmNlID0gbnVsbDtyZXR1cm4gY2FsbGJhY2sgJiYgZ2V0Q2xhc3MuY2FsbChjYWxsYmFjaykgPT0gZnVuY3Rpb25DbGFzcyA/IHdhbGsoKHZhbHVlID0ge30sIHZhbHVlW1wiXCJdID0gcmVzdWx0LCB2YWx1ZSksIFwiXCIsIGNhbGxiYWNrKSA6IHJlc3VsdDtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9ZXhwb3J0c1tcInJ1bkluQ29udGV4dFwiXSA9IHJ1bkluQ29udGV4dDtyZXR1cm4gZXhwb3J0cztcbiAgICAgICAgICB9aWYgKGZyZWVFeHBvcnRzICYmICFpc0xvYWRlcikge1xuICAgICAgICAgICAgcnVuSW5Db250ZXh0KHJvb3QsIGZyZWVFeHBvcnRzKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFyIG5hdGl2ZUpTT04gPSByb290LkpTT04sXG4gICAgICAgICAgICAgICAgcHJldmlvdXNKU09OID0gcm9vdFtcIkpTT04zXCJdLFxuICAgICAgICAgICAgICAgIGlzUmVzdG9yZWQgPSBmYWxzZTt2YXIgSlNPTjMgPSBydW5JbkNvbnRleHQocm9vdCwgcm9vdFtcIkpTT04zXCJdID0geyBub0NvbmZsaWN0OiBmdW5jdGlvbiBub0NvbmZsaWN0KCkge1xuICAgICAgICAgICAgICAgIGlmICghaXNSZXN0b3JlZCkge1xuICAgICAgICAgICAgICAgICAgaXNSZXN0b3JlZCA9IHRydWU7cm9vdC5KU09OID0gbmF0aXZlSlNPTjtyb290W1wiSlNPTjNcIl0gPSBwcmV2aW91c0pTT047bmF0aXZlSlNPTiA9IHByZXZpb3VzSlNPTiA9IG51bGw7XG4gICAgICAgICAgICAgICAgfXJldHVybiBKU09OMztcbiAgICAgICAgICAgICAgfSB9KTtyb290LkpTT04gPSB7IHBhcnNlOiBKU09OMy5wYXJzZSwgc3RyaW5naWZ5OiBKU09OMy5zdHJpbmdpZnkgfTtcbiAgICAgICAgICB9aWYgKGlzTG9hZGVyKSB7XG4gICAgICAgICAgICBkZWZpbmUoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICByZXR1cm4gSlNPTjM7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pLmNhbGwodGhpcyk7XG4gICAgICB9KS5jYWxsKHRoaXMsIHR5cGVvZiBzZWxmICE9PSBcInVuZGVmaW5lZFwiID8gc2VsZiA6IHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgPyB3aW5kb3cgOiB0eXBlb2YgZ2xvYmFsICE9PSBcInVuZGVmaW5lZFwiID8gZ2xvYmFsIDoge30pO1xuICAgIH0sIHt9XSwgNTE6IFtmdW5jdGlvbiAoX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG4gICAgICBtb2R1bGUuZXhwb3J0cyA9IHRvQXJyYXk7ZnVuY3Rpb24gdG9BcnJheShsaXN0LCBpbmRleCkge1xuICAgICAgICB2YXIgYXJyYXkgPSBbXTtpbmRleCA9IGluZGV4IHx8IDA7Zm9yICh2YXIgaSA9IGluZGV4IHx8IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgYXJyYXlbaSAtIGluZGV4XSA9IGxpc3RbaV07XG4gICAgICAgIH1yZXR1cm4gYXJyYXk7XG4gICAgICB9XG4gICAgfSwge31dIH0sIHt9LCBbMzFdKSgzMSk7XG59KTtcblxuY2MuX1JGcG9wKCk7Il19
